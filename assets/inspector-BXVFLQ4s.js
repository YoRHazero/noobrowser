const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-PQEYP37x.js","assets/webworkerAll-lwlnapI9.js","assets/colorToUniform-BXaCBwVl.js","assets/index-DTfHgk7v.js","assets/index-OUYH55s0.css","assets/connection-Dy1eGPll.js","assets/for-C-OR-lR2.js","assets/connection-hook-gjio2_H-.js","assets/create-split-props-u5h9OPvL.js","assets/slider-Dx28FDq1.js","assets/input-DzNyXDtv.js","assets/WebGPURenderer-CxIYIZZX.js","assets/SharedSystems-CKZ74IMd.js","assets/WebGLRenderer-mIPkJi7I.js"])))=>i.map(i=>d[i]);
import{i as E6,r as z,e as si,v as Ba,u as Ha,w as ja,bc as IX,bd as DX,x as Va,m as Ue,j as v,d as $e,be as NX,bf as LX,bg as kX,bh as OX,bi as zX,bj as UX,h as Ig,bk as FX,bl as BX,bm as HX,bn as jX,bo as VX,bp as GX,bq as WX,br as qX,bs as XX,bt as YX,bu as $X,bv as Dg,bw as KX,bx as ZX,by as QX,bz as JX,bA as eY,bB as tY,bC as nY,bD as iY,l as ua,bE as R6,I as ur,bF as yL,bG as rY,bH as sY,c as Qo,y as P6,bI as aY,bJ as oY,bK as vL,bL as lY,k as cY,bM as uY,bN as J7,B as qe,S as wt,bO as I6,bP as Vy,bQ as od,bR as hY,aC as sm,H as gt,a as hr,bS as dY,bT as Xx,t as Ui,b9 as Au,bU as Rb,bV as pr,bW as mr,bX as fY,bY as pY,bZ as D6,b_ as bL,aB as mY,b$ as gY,c0 as La,c1 as xY,c2 as yY,c3 as N6,c4 as _L,c5 as vY,z as bY,L as _Y,c6 as SY,c7 as wY,c8 as MY,c9 as TY,ba as AY,ca as CY,cb as EY,cc as RY,cd as PY}from"./index-DTfHgk7v.js";import{c as Cu,H as yc,T as ke,B as ec,m as IY,u as bM,a as Ng,b as eE,I as DY}from"./connection-Dy1eGPll.js";import{F as SL}from"./for-C-OR-lR2.js";import{d as wL,s as Pb,R as Ib,e as NY,f as vc,g as il,h as Eu,P as Ru,i as Hn,p as ML,t as TL,j as Zn,w as tE,k as AL,l as CL,v as LY,m as un,n as Xl,o as EL,q as Db,r as RL,x as Nb,y as PL,V as ld,z as sa,G as Lb,A as IL,B as DL,C as Ai,D as kY,E as OY,T as Gy,a as Wy,b as ko,c as Cy,F as zY,H as L6,I as UY,J as FY}from"./connection-hook-gjio2_H-.js";import{c as On}from"./create-split-props-u5h9OPvL.js";import{a as k6,b as O6,c as z6,d as U6,e as BY,S as _M}from"./slider-Dx28FDq1.js";import{F as HY,I as F6,c as jY}from"./input-DzNyXDtv.js";function Kh(){return Kh=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},Kh.apply(null,arguments)}const{withContext:VY}=E6({key:"mark"}),NL=VY("mark");NL.displayName="Mark";function nE(i,e=[]){const t=z.useRef(()=>{throw new Error("Cannot call an event handler while rendering.")});return z.useInsertionEffect(()=>{t.current=i}),z.useCallback((...n)=>t.current?.(...n),e)}function GY(i={}){const e=nE(i.onOpen),t=nE(i.onClose),[n,r]=z.useState(i.defaultOpen||!1),s=i.open!==void 0?i.open:n,a=i.open!==void 0,o=z.useCallback(()=>{a||r(!1),t?.()},[a,t]),l=z.useCallback(()=>{a||r(!0),e?.()},[a,e]),c=z.useCallback(()=>{s?o():l()},[s,l,o]);return{open:s,onOpen:l,onClose:o,onToggle:c,setOpen:r}}const[LL,kb]=si({name:"AccordionContext",hookName:"useAccordionContext",providerName:"<AccordionProvider />"}),[WY]=si({name:"AccordionItemContext",hookName:"useAccordionItemContext",providerName:"<AccordionItemProvider />"}),qY=i=>On()(i,["collapsedHeight","collapsedWidth","defaultOpen","disabled","id","ids","lazyMount","onExitComplete","onOpenChange","open","unmountOnExit"]),XY=(i={})=>{const{lazyMount:e,unmountOnExit:t,...n}=i,r=z.useId(),s=z.useRef(!1),{dir:a}=Ba(),{getRootNode:o}=Ha(),l={id:r,dir:a,getRootNode:o,...n},c=ja(IX,l),u=DX(c,Va);u.visible&&(s.current=!0);const d=!u.visible&&!s.current&&e||t&&!u.visible&&s.current;return{...u,isUnmounted:d}},[kL,Ob]=si({name:"CollapsibleContext",hookName:"useCollapsibleContext",providerName:"<CollapsibleProvider />"}),B6=z.forwardRef((i,e)=>{const[t,n]=qY(i),r=XY(t),s=Ue(r.getRootProps(),n);return v.jsx(kL,{value:r,children:v.jsx($e.div,{...s,ref:e})})});B6.displayName="CollapsibleRoot";const[YY,H6]=si({name:"AccordionItemPropsContext",hookName:"useAccordionItemPropsContext",providerName:"<AccordionItemPropsProvider />"}),$Y=On(),OL=z.forwardRef((i,e)=>{const[t,n]=$Y(i,["value","disabled"]),r=kb(),s=wL(),a=Ue(r.getItemProps(t),n),o=r.getItemState(t),l=r.getItemContentProps(t);return v.jsx(YY,{value:t,children:v.jsx(WY,{value:o,children:v.jsx(B6,{ref:e,open:o.expanded,ids:{content:l.id},...s,...a})})})});OL.displayName="AccordionItem";const j6=z.forwardRef((i,e)=>{const t=Ob();if(t.isUnmounted)return null;const n=Ue(t.getContentProps(),i);return v.jsx($e.div,{...n,ref:e})});j6.displayName="CollapsibleContent";const KY=On(),zL=z.forwardRef((i,e)=>{const t=kb(),n=H6(),r=t.getItemContentProps(n),[,s]=KY(r,["hidden","data-state"]),a=Ue(s,i);return v.jsx(j6,{ref:e,...a})});zL.displayName="AccordionItemContent";const UL=z.forwardRef((i,e)=>{const t=kb(),n=H6(),r=Ue(t.getItemIndicatorProps(n),i);return v.jsx($e.div,{...r,ref:e})});UL.displayName="AccordionItemIndicator";const FL=z.forwardRef((i,e)=>{const t=kb(),n=H6(),r=Ob(),s=t.getItemTriggerProps(n),a=Ue({...s,"aria-controls":r.isUnmounted?void 0:s["aria-controls"]},i);return v.jsx($e.button,{...a,ref:e})});FL.displayName="AccordionItemTrigger";const ZY=i=>{const e=z.useId(),{getRootNode:t}=Ha(),{dir:n}=Ba(),r={id:e,dir:n,getRootNode:t,...i},s=ja(NX,r);return LX(s,Va)},QY=On(),BL=z.forwardRef((i,e)=>{const[t,n]=Pb(i),[r,s]=QY(n,["collapsible","defaultValue","disabled","id","ids","multiple","onFocusChange","onValueChange","orientation","value"]),a=ZY(r),o=Ue(a.getRootProps(),s);return v.jsx(LL,{value:a,children:v.jsx(Ib,{value:t,children:v.jsx($e.div,{...o,ref:e})})})});BL.displayName="AccordionRoot";const JY=On(),HL=z.forwardRef((i,e)=>{const[t,n]=Pb(i),[{value:r},s]=JY(n,["value"]),a=Ue(r.getRootProps(),s);return v.jsx(LL,{value:r,children:v.jsx(Ib,{value:t,children:v.jsx($e.div,{...a,ref:e})})})});HL.displayName="AccordionRootProvider";const[jL,zb]=si({name:"CheckboxContext",hookName:"useCheckboxContext",providerName:"<CheckboxProvider />"}),VL=z.forwardRef((i,e)=>{const t=zb(),n=Ue(t.getControlProps(),i);return v.jsx($e.div,{...n,ref:e})});VL.displayName="CheckboxControl";function e$(i){const{value:e,onChange:t,defaultValue:n}=i,[r,s]=z.useState(n),a=e!==void 0,o=a?e:r,l=z.useCallback(c=>(a||s(c),t?.(c)),[a,t]);return[o,l]}function t$(i={}){const{defaultValue:e,value:t,onValueChange:n,disabled:r,readOnly:s,name:a,invalid:o}=i,l=!(r||s),c=NY(n,{sync:!0}),[u,d]=e$({value:t,defaultValue:e||[],onChange:c}),p=_=>u.some(S=>String(S)===String(_)),m=_=>{p(_)?y(_):g(_)},g=_=>{l&&(p(_)||d(u.concat(_)))},y=_=>{l&&d(u.filter(S=>String(S)!==String(_)))};return{isChecked:p,value:u,name:a,disabled:!!r,readOnly:!!s,invalid:!!o,setValue:d,addValue:g,toggleValue:m,getItemProps:_=>({checked:_.value!=null?p(_.value):void 0,onCheckedChange(){_.value!=null&&m(_.value)},name:a,disabled:r,readOnly:s,invalid:o})}}const[n$,i$]=si({name:"CheckboxGroupContext",hookName:"useCheckboxGroupContext",providerName:"<CheckboxGroupProvider />",strict:!1}),r$=On(),GL=z.forwardRef((i,e)=>{const[t,n]=r$(i,["defaultValue","value","onValueChange","disabled","invalid","readOnly","name"]),r=t$(t);return v.jsx(n$,{value:r,children:v.jsx($e.div,{ref:e,role:"group",...n,...kX.build().group.attrs})})});GL.displayName="CheckboxGroup";const WL=z.forwardRef((i,e)=>{const t=zb(),n=Ue(t.getHiddenInputProps(),i),r=Cu();return v.jsx($e.input,{"aria-describedby":r?.ariaDescribedby,...n,ref:e})});WL.displayName="CheckboxHiddenInput";const qL=z.forwardRef((i,e)=>{const t=zb(),n=Ue(t.getLabelProps(),i);return v.jsx($e.span,{...n,ref:e})});qL.displayName="CheckboxLabel";const s$=(i={})=>{const e=i$(),t=Cu(),n=z.useMemo(()=>Ue(i,e?.getItemProps({value:i.value})??{}),[i,e]),r=z.useId(),{getRootNode:s}=Ha(),{dir:a}=Ba(),o={id:r,ids:{label:t?.ids.label,hiddenInput:t?.ids.control},dir:a,disabled:t?.disabled,readOnly:t?.readOnly,invalid:t?.invalid,required:t?.required,getRootNode:s,...n},l=ja(OX,o);return zX(l,Va)},a$=On(),XL=z.forwardRef((i,e)=>{const[t,n]=a$(i,["checked","defaultChecked","disabled","form","id","ids","invalid","name","onCheckedChange","readOnly","required","value"]),r=s$(t),s=Ue(r.getRootProps(),n);return v.jsx(jL,{value:r,children:v.jsx($e.label,{...s,ref:e})})});XL.displayName="CheckboxRoot";const o$=On(),YL=z.forwardRef((i,e)=>{const[{value:t},n]=o$(i,["value"]),r=Ue(t.getRootProps(),n);return v.jsx(jL,{value:t,children:v.jsx($e.label,{...r,ref:e})})});YL.displayName="CheckboxRootProvider";const $L=z.forwardRef((i,e)=>{const t=Ob(),n=Ue(t.getIndicatorProps(),i);return v.jsx($e.div,{...n,ref:e})});$L.displayName="CollapsibleIndicator";const l$=On(),KL=z.forwardRef((i,e)=>{const[{value:t},n]=l$(i,["value"]),r=Ue(t.getRootProps(),n);return v.jsx(kL,{value:t,children:v.jsx($e.div,{...r,ref:e})})});KL.displayName="CollapsibleRootProvider";const ZL=z.forwardRef((i,e)=>{const t=Ob(),n=Ue(t.getTriggerProps(),i);return v.jsx($e.button,{...n,ref:e})});ZL.displayName="CollapsibleTrigger";const oc=i=>new UX(i),[QL,Pu]=si({name:"DialogContext",hookName:"useDialogContext",providerName:"<DialogProvider />"}),JL=z.forwardRef((i,e)=>{const t=Pu(),n=wL(),r=vc({...n,present:t.open}),s=Ue(t.getBackdropProps(),r.getPresenceProps(),i);return r.unmounted?null:v.jsx($e.div,{...s,ref:Ig(r.ref,e)})});JL.displayName="DialogBackdrop";const ek=z.forwardRef((i,e)=>{const t=Pu(),n=Ue(t.getCloseTriggerProps(),i);return v.jsx($e.button,{...n,ref:e})});ek.displayName="DialogCloseTrigger";const tk=z.forwardRef((i,e)=>{const t=Pu(),n=il(),r=Ue(t.getContentProps(),n.getPresenceProps(),i);return n.unmounted?null:v.jsx($e.div,{...r,ref:Ig(n.ref,e)})});tk.displayName="DialogContent";const nk=z.forwardRef((i,e)=>{const t=Pu(),n=Ue(t.getDescriptionProps(),i);return v.jsx($e.div,{...n,ref:e})});nk.displayName="DialogDescription";const ik=z.forwardRef((i,e)=>{const t=Pu(),n=Ue(t.getPositionerProps(),i);return il().unmounted?null:v.jsx($e.div,{...n,ref:e})});ik.displayName="DialogPositioner";const c$=i=>{const e=z.useId(),{getRootNode:t}=Ha(),{dir:n}=Ba(),r={id:e,getRootNode:t,dir:n,...i},s=ja(FX,r);return BX(s,Va)},u$=i=>{const[e,{children:t,...n}]=Eu(i),[r]=Pb(e),s=c$(n),a=vc(Ue({present:s.open},e));return v.jsx(QL,{value:s,children:v.jsx(Ib,{value:r,children:v.jsx(Ru,{value:a,children:t})})})},h$=i=>{const[e,{value:t,children:n}]=Eu(i),[r]=Pb(e),s=vc(Ue({present:t.open},e));return v.jsx(QL,{value:t,children:v.jsx(Ib,{value:r,children:v.jsx(Ru,{value:s,children:n})})})},rk=z.forwardRef((i,e)=>{const t=Pu(),n=Ue(t.getTitleProps(),i);return v.jsx($e.h2,{...n,ref:e})});rk.displayName="DialogTitle";const sk=z.forwardRef((i,e)=>{const t=Pu(),n=il(),r=Ue({...t.getTriggerProps(),"aria-controls":n.unmounted?void 0:t.getTriggerProps()["aria-controls"]},i);return v.jsx($e.button,{...r,ref:e})});sk.displayName="DialogTrigger";var SM=(i,e)=>{const t=[],n=(r,s,a)=>{s-r>0&&t.push({start:r,end:s,match:a})};if(i.length===0)n(0,e,!1);else{let r=0;for(const s of i)n(r,s.start,!1),n(s.start,s.end,!0),r=s.end;n(r,e,!1)}return t},ak=i=>i.replace(/[|\\{}()[\]^$+*?.-]/g,e=>`\\${e}`);function d$(i){const{text:e,query:t,ignoreCase:n,exactMatch:r}=i;if(r){const u=ak(t),d=new RegExp(`\\b(${u})\\b`,n?"i":""),p=e.match(d);if(!p||p.index===void 0)return[{text:e,match:!1}];const m=p.index,g=m+p[0].length;return SM([{start:m,end:g}],e.length).map(x=>({text:e.slice(x.start,x.end),match:!!x.match}))}const s=n?e.toLowerCase():e,a=n&&typeof t=="string"?t.toLowerCase():t,o=typeof s=="string"?s.indexOf(a):-1;if(o===-1)return[{text:e,match:!1}];const l=o+a.length;return SM([{start:o,end:l}],e.length).map(u=>({text:e.slice(u.start,u.end),match:!!u.match}))}var f$=(i,e,t)=>{const n=i.filter(Boolean).map(s=>ak(s)),r=t?`\\b(${n.join("|")})\\b`:`(${n.join("|")})`;return new RegExp(r,e)},p$=(i,e=!0)=>`${i?"i":""}${e?"g":""}`;function m$(i){const{text:e,query:t,ignoreCase:n,matchAll:r,exactMatch:s}=i;if(t.length===0)return[{text:e,match:!1}];const a=p$(n,r),o=f$(Array.isArray(t)?t:[t],a,s),l=[...e.matchAll(o)].map(c=>({start:c.index||0,end:(c.index||0)+c[0].length}));return SM(l,i.text.length).map(c=>({text:i.text.slice(c.start,c.end),match:!!c.match}))}var g$=i=>{if(i.matchAll==null&&(i.matchAll=Array.isArray(i.query)),!i.matchAll&&Array.isArray(i.query))throw new Error("matchAll must be true when using multiple queries");return i.matchAll?m$(i):d$(i)};const x$=i=>z.useMemo(()=>g$(i),[i]),[ok,rl]=si({name:"ListboxContext",hookName:"useListboxContext",providerName:"<ListboxProvider />"}),lk=z.forwardRef((i,e)=>{const t=rl(),n=Ue(t.getContentProps(),i);return v.jsx($e.div,{...n,ref:e})});lk.displayName="ListboxContent";const y$=HX.build(),ck=z.forwardRef((i,e)=>rl().collection.size!==0?null:v.jsx($e.div,{...y$.empty.attrs,...i,role:"presentation",ref:e}));ck.displayName="ListboxEmpty";const v$=On(),uk=z.forwardRef((i,e)=>{const[t,n]=v$(i,["autoHighlight"]),r=rl(),s=Ue(r.getInputProps(t),n);return v.jsx($e.input,{...s,ref:e})});uk.displayName="ListboxInput";const[b$]=si({name:"ListboxItemContext",hookName:"useListboxItemContext",providerName:"<ListboxItemProvider />"}),[_$,hk]=si({name:"ListboxItemPropsContext",hookName:"useListboxItemPropsContext",providerName:"<ListboxItemPropsProvider />"}),S$=On(),dk=z.forwardRef((i,e)=>{const[t,n]=S$(i,["item","highlightOnHover"]),r=rl(),s=Ue(r.getItemProps(t),n),a=r.getItemState(t);return v.jsx(_$,{value:t,children:v.jsx(b$,{value:a,children:v.jsx($e.div,{...s,ref:e})})})});dk.displayName="ListboxItem";const[w$,M$]=si({name:"ListboxItemGroupPropsContext",hookName:"useListboxItemGroupPropsContext",providerName:"<ListboxItemGroupPropsProvider />"}),T$=On(),fk=z.forwardRef((i,e)=>{const t=z.useId(),[n,r]=T$(i,["id"]),s={id:t,...n},a=rl(),o=Ue(a.getItemGroupProps(s),r);return v.jsx(w$,{value:s,children:v.jsx($e.div,{...o,ref:e})})});fk.displayName="ListboxItemGroup";const pk=z.forwardRef((i,e)=>{const t=rl(),n=M$(),r=Ue(t.getItemGroupLabelProps({htmlFor:n.id}),i);return v.jsx($e.div,{...r,ref:e})});pk.displayName="ListboxItemGroupLabel";const mk=z.forwardRef((i,e)=>{const t=rl(),n=hk(),r=Ue(t.getItemIndicatorProps(n),i);return v.jsx($e.div,{...r,ref:e})});mk.displayName="ListboxItemIndicator";const gk=z.forwardRef((i,e)=>{const t=rl(),n=hk(),r=Ue(t.getItemTextProps(n),i);return v.jsx($e.div,{...r,ref:e})});gk.displayName="ListboxItemText";const xk=z.forwardRef((i,e)=>{const t=rl(),n=Ue(t.getLabelProps(),i);return v.jsx($e.label,{...n,ref:e})});xk.displayName="ListboxLabel";const wM=i=>{const e=z.useId(),{dir:t}=Ba(),{getRootNode:n}=Ha(),r={id:e,dir:t,getRootNode:n,...i},s=ja(jX,r);return VX(s,Va)},A$=(i,e)=>{const[t,n]=On()(i,["collection","defaultHighlightedValue","defaultValue","deselectable","disabled","disallowSelectAll","highlightedValue","id","ids","loopFocus","onHighlightChange","onSelect","onValueChange","orientation","scrollToIndexFn","selectionMode","selectOnHighlight","typeahead","value"]),r=wM(t),s=Ue(r.getRootProps(),n);return v.jsx(ok,{value:r,children:v.jsx($e.div,{...s,ref:e})})},C$=z.forwardRef(A$),E$=(i,e)=>{const[{value:t},n]=On()(i,["value"]),r=Ue(t.getRootProps(),n);return v.jsx(ok,{value:t,children:v.jsx($e.div,{...r,ref:e})})},R$=z.forwardRef(E$),yk=z.forwardRef((i,e)=>{const{children:t,placeholder:n,...r}=i,s=rl(),a=Ue(s.getValueTextProps(),r);return v.jsx($e.span,{...a,ref:e,children:t||s.valueAsString||n})});yk.displayName="ListboxValueText";const[vk,cd]=si({name:"NumberInputContext",hookName:"useNumberInputContext",providerName:"<NumberInputProvider />"}),bk=z.forwardRef((i,e)=>{const t=cd(),n=Ue(t.getControlProps(),i);return v.jsx($e.div,{...n,ref:e})});bk.displayName="NumberInputControl";const _k=z.forwardRef((i,e)=>{const t=cd(),n=Ue(t.getDecrementTriggerProps(),i);return v.jsx($e.button,{...n,ref:e})});_k.displayName="NumberInputDecrementTrigger";const Sk=z.forwardRef((i,e)=>{const t=cd(),n=Ue(t.getIncrementTriggerProps(),i);return v.jsx($e.button,{...n,ref:e})});Sk.displayName="NumberInputIncrementTrigger";const wk=z.forwardRef((i,e)=>{const t=cd(),n=Ue(t.getInputProps(),i),r=Cu();return v.jsx($e.input,{"aria-describedby":r?.ariaDescribedby,...n,ref:e})});wk.displayName="NumberInputInput";const Mk=z.forwardRef((i,e)=>{const t=cd(),n=Ue(t.getLabelProps(),i);return v.jsx($e.label,{...n,ref:e})});Mk.displayName="NumberInputLabel";const P$=i=>{const e=z.useId(),{getRootNode:t}=Ha(),{dir:n,locale:r}=Ba(),s=Cu(),a={id:e,ids:{label:s?.ids.label,input:s?.ids.control},disabled:s?.disabled,readOnly:s?.readOnly,required:s?.required,invalid:s?.invalid,dir:n,locale:r,getRootNode:t,...i},o=ja(GX,a);return WX(o,Va)},I$=On(),Tk=z.forwardRef((i,e)=>{const[t,n]=I$(i,["allowMouseWheel","allowOverflow","clampValueOnBlur","defaultValue","disabled","focusInputOnChange","form","formatOptions","id","ids","inputMode","invalid","locale","max","min","name","onFocusChange","onValueChange","onValueInvalid","pattern","readOnly","required","spinOnPress","step","translations","value"]),r=P$(t),s=Ue(r.getRootProps(),n);return v.jsx(vk,{value:r,children:v.jsx($e.div,{...s,ref:e})})});Tk.displayName="NumberInputRoot";const D$=On(),Ak=z.forwardRef((i,e)=>{const[{value:t},n]=D$(i,["value"]),r=Ue(t.getRootProps(),n);return v.jsx(vk,{value:t,children:v.jsx($e.div,{...r,ref:e})})});Ak.displayName="NumberInputRootProvider";const Ck=z.forwardRef((i,e)=>{const t=cd(),n=Ue(t.getScrubberProps(),i);return v.jsx($e.div,{...n,ref:e})});Ck.displayName="NumberInputScrubber";const Ek=z.forwardRef((i,e)=>{const{children:t,...n}=i,r=cd(),s=Ue(r.getValueTextProps(),n);return v.jsx($e.span,{...s,ref:e,children:t||r.value})});Ek.displayName="NumberInputValueText";const[Rk,sl]=si({name:"PopoverContext",hookName:"usePopoverContext",providerName:"<PopoverProvider />"}),Pk=z.forwardRef((i,e)=>{const t=sl(),n=Ue(t.getAnchorProps(),i);return v.jsx($e.div,{...n,ref:e})});Pk.displayName="PopoverAnchor";const Ik=z.forwardRef((i,e)=>{const t=sl(),n=Ue(t.getArrowProps(),i);return v.jsx($e.div,{...n,ref:e})});Ik.displayName="PopoverArrow";const Dk=z.forwardRef((i,e)=>{const t=sl(),n=Ue(t.getArrowTipProps(),i);return v.jsx($e.div,{...n,ref:e})});Dk.displayName="PopoverArrowTip";const Nk=z.forwardRef((i,e)=>{const t=sl(),n=Ue(t.getCloseTriggerProps(),i);return v.jsx($e.button,{...n,ref:e})});Nk.displayName="PopoverCloseTrigger";const Lk=z.forwardRef((i,e)=>{const t=sl(),n=il(),r=Ue(t.getContentProps(),n.getPresenceProps(),i);return n.unmounted?null:v.jsx($e.div,{...r,ref:Ig(n.ref,e)})});Lk.displayName="PopoverContent";const kk=z.forwardRef((i,e)=>{const t=sl(),n=Ue(t.getDescriptionProps(),i);return v.jsx($e.div,{...n,ref:e})});kk.displayName="PopoverDescription";const Ok=z.forwardRef((i,e)=>{const t=sl(),n=Ue(t.getIndicatorProps(),i);return v.jsx($e.div,{...n,ref:e})});Ok.displayName="PopoverIndicator";const zk=z.forwardRef((i,e)=>{const t=sl(),n=il(),r=Ue(t.getPositionerProps(),i);return n.unmounted?null:v.jsx($e.div,{...r,ref:e})});zk.displayName="PopoverPositioner";const N$=i=>{const e=z.useId(),{getRootNode:t}=Ha(),{dir:n}=Ba(),r={id:e,dir:n,getRootNode:t,...i},s=ja(qX,r);return XX(s,Va)},L$=i=>{const[e,{children:t,...n}]=Eu(i),r=N$(n),s=vc(Ue({present:r.open},e));return v.jsx(Rk,{value:r,children:v.jsx(Ru,{value:s,children:t})})},k$=i=>{const[e,{value:t,children:n}]=Eu(i),r=vc(Ue({present:t.open},e));return v.jsx(Rk,{value:t,children:v.jsx(Ru,{value:r,children:n})})},Uk=z.forwardRef((i,e)=>{const t=sl(),n=Ue(t.getTitleProps(),i);return v.jsx($e.div,{...n,ref:e})});Uk.displayName="PopoverTitle";const Fk=z.forwardRef((i,e)=>{const t=sl(),n=il(),r=Ue({...t.getTriggerProps(),"aria-controls":n.unmounted?void 0:t.getTriggerProps()["aria-controls"]},i);return v.jsx($e.button,{...r,ref:e})});Fk.displayName="PopoverTrigger";const[Bk,Lg]=si({name:"ScrollAreaContext",hookName:"useScrollAreaContext",providerName:"<ScrollAreaProvider />"}),Hk=z.forwardRef((i,e)=>{const t=Lg(),n=Ue(t.getContentProps(),i);return v.jsx($e.div,{...n,ref:e})});Hk.displayName="ScrollAreaContent";const jk=z.forwardRef((i,e)=>{const t=Lg(),n=Ue(t.getCornerProps(),i);return v.jsx($e.div,{...n,ref:e})});jk.displayName="ScrollAreaCorner";const O$=i=>{const e=z.useId(),{getRootNode:t}=Ha(),{dir:n}=Ba(),r={id:e,dir:n,getRootNode:t,...i},s=ja(YX,r);return $X(s,Va)},z$=On(),Vk=z.forwardRef((i,e)=>{const[t,n]=z$(i,["id","ids"]),r=O$(t),s=Ue(r.getRootProps(),n);return v.jsx(Bk,{value:r,children:v.jsx($e.div,{...s,ref:e})})});Vk.displayName="ScrollAreaRoot";const U$=On(),Gk=z.forwardRef((i,e)=>{const[{value:t},n]=U$(i,["value"]),r=Ue(t.getRootProps(),n);return v.jsx(Bk,{value:t,children:v.jsx($e.div,{...r,ref:e})})});Gk.displayName="ScrollAreaRootProvider";const[F$,B$]=si({name:"ScrollAreaScrollbarContext",hookName:"useScrollAreaScrollbarContext",providerName:"<ScrollAreaScrollbarProvider />"}),H$=On(),Wk=z.forwardRef((i,e)=>{const[t,n]=H$(i,["orientation"]),r=Lg(),s=Ue(r.getScrollbarProps(t),n);return v.jsx(F$,{value:t,children:v.jsx($e.div,{...s,ref:e})})});Wk.displayName="ScrollAreaScrollbar";const qk=z.forwardRef((i,e)=>{const t=Lg(),n=B$(),r=Ue(t.getThumbProps(n),i);return v.jsx($e.div,{...r,ref:e})});qk.displayName="ScrollAreaThumb";const Xk=z.forwardRef((i,e)=>{const t=Lg(),n=Ue(t.getViewportProps(),i);return v.jsx($e.div,{...n,ref:e})});Xk.displayName="ScrollAreaViewport";const[Yk,Ub]=si({name:"SegmentGroupContext",hookName:"useSegmentGroupContext",providerName:"<SegmentGroupProvider />"}),$k=z.forwardRef((i,e)=>{const t=Ub(),n=Ue(t.getIndicatorProps(),Dg.indicator.attrs,i);return v.jsx($e.div,{...n,ref:e})});$k.displayName="SegmentGroupIndicator";const[j$]=si({name:"SegmentGroupItemContext",hookName:"useSegmentGroupItemContext",providerName:"<SegmentGroupItemProvider />"}),[V$,Kk]=si({name:"SegmentGroupItemPropsContext",hookName:"useSegmentGroupItemPropsContext",providerName:"<SegmentGroupItemPropsProvider />"}),G$=On(),Zk=z.forwardRef((i,e)=>{const[t,n]=G$(i,["value","disabled","invalid"]),r=Ub(),s=Ue(r.getItemProps(t),Dg.item.attrs,n),a=r.getItemState(t);return v.jsx(V$,{value:t,children:v.jsx(j$,{value:a,children:v.jsx($e.label,{...s,ref:e})})})});Zk.displayName="SegmentGroupItem";const Qk=z.forwardRef((i,e)=>{const t=Ub(),n=Kk(),r=Ue(t.getItemHiddenInputProps(n),i);return v.jsx($e.input,{...r,ref:e})});Qk.displayName="SegmentGroupItemHiddenInput";const Jk=z.forwardRef((i,e)=>{const t=Ub(),n=Kk(),r=Ue(t.getItemTextProps(n),Dg.itemText.attrs,i);return v.jsx($e.span,{...r,ref:e})});Jk.displayName="SegmentGroupItemText";const W$=i=>{const e=z.useId(),{getRootNode:t}=Ha(),{dir:n}=Ba(),r={id:e,dir:n,getRootNode:t,...i},s=ja(KX,r);return ZX(s,Va)},q$=On(),eO=z.forwardRef((i,e)=>{const[t,n]=q$(i,["defaultValue","disabled","form","id","ids","name","onValueChange","orientation","readOnly","value"]),r=W$(t),s=Ue(r.getRootProps(),Dg.root.attrs,n);return v.jsx(Yk,{value:r,children:v.jsx($e.div,{...s,ref:e})})});eO.displayName="SegmentGroupRoot";const X$=On(),tO=z.forwardRef((i,e)=>{const[{value:t},n]=X$(i,["value"]),r=Ue(t.getRootProps(),Dg.root.attrs,n);return v.jsx(Yk,{value:t,children:v.jsx($e.div,{...r,ref:e})})});tO.displayName="SegmentGroupRootProvider";const[nO,Is]=si({name:"SelectContext",hookName:"useSelectContext",providerName:"<SelectProvider />"}),iO=z.forwardRef((i,e)=>{const t=Is(),n=Ue(t.getClearTriggerProps(),i);return v.jsx($e.button,{...n,ref:e})});iO.displayName="SelectClearTrigger";const rO=z.forwardRef((i,e)=>{const t=Is(),n=il(),r=Ue(t.getContentProps(),n.getPresenceProps(),i);return n.unmounted?null:v.jsx($e.div,{...r,ref:Ig(n.ref,e)})});rO.displayName="SelectContent";const sO=z.forwardRef((i,e)=>{const t=Is(),n=Ue(t.getControlProps(),i);return v.jsx($e.div,{...n,ref:e})});sO.displayName="SelectControl";const aO=z.forwardRef((i,e)=>{const t=Is(),n=Ue(t.getHiddenSelectProps(),i),r=t.value.length===0,s=Cu();return v.jsxs($e.select,{"aria-describedby":s?.ariaDescribedby,...n,ref:e,children:[r&&v.jsx("option",{value:""}),t.collection.items.map((a,o)=>v.jsx("option",{value:t.collection.getItemValue(a)??"",disabled:t.collection.getItemDisabled(a),children:t.collection.stringifyItem(a)},o))]})});aO.displayName="SelectHiddenSelect";const oO=z.forwardRef((i,e)=>{const t=Is(),n=Ue(t.getIndicatorProps(),i);return v.jsx($e.div,{...n,ref:e})});oO.displayName="SelectIndicator";const[Y$]=si({name:"SelectItemContext",hookName:"useSelectItemContext",providerName:"<SelectItemProvider />"}),[$$,lO]=si({name:"SelectItemPropsContext",hookName:"useSelectItemPropsContext",providerName:"<SelectItemPropsProvider />"}),K$=On(),cO=z.forwardRef((i,e)=>{const[t,n]=K$(i,["item","persistFocus"]),r=Is(),s=Ue(r.getItemProps(t),n),a=r.getItemState(t);return v.jsx($$,{value:t,children:v.jsx(Y$,{value:a,children:v.jsx($e.div,{...s,ref:e})})})});cO.displayName="SelectItem";const[Z$,Q$]=si({name:"SelectItemGroupPropsContext",hookName:"useSelectItemGroupPropsContext",providerName:"<SelectItemGroupPropsProvider />"}),J$=On(),uO=z.forwardRef((i,e)=>{const t=z.useId(),[n,r]=J$(i,["id"]),s={id:t,...n},a=Is(),o=Ue(a.getItemGroupProps(s),r);return v.jsx(Z$,{value:s,children:v.jsx($e.div,{...o,ref:e})})});uO.displayName="SelectItemGroup";const hO=z.forwardRef((i,e)=>{const t=Is(),n=Q$(),r=Ue(t.getItemGroupLabelProps({htmlFor:n.id}),i);return v.jsx($e.div,{...r,ref:e})});hO.displayName="SelectItemGroupLabel";const dO=z.forwardRef((i,e)=>{const t=Is(),n=lO(),r=Ue(t.getItemIndicatorProps(n),i);return v.jsx($e.div,{...r,ref:e})});dO.displayName="SelectItemIndicator";const fO=z.forwardRef((i,e)=>{const t=Is(),n=lO(),r=Ue(t.getItemTextProps(n),i);return v.jsx($e.span,{...r,ref:e})});fO.displayName="SelectItemText";const pO=z.forwardRef((i,e)=>{const t=Is(),n=Ue(t.getLabelProps(),i);return v.jsx($e.label,{...n,ref:e})});pO.displayName="SelectLabel";const mO=z.forwardRef((i,e)=>{const t=Is(),n=Ue(t.getPositionerProps(),i);return il().unmounted?null:v.jsx($e.div,{...n,ref:e})});mO.displayName="SelectPositioner";const eK=i=>{const e=z.useId(),{dir:t}=Ba(),{getRootNode:n}=Ha(),r=Cu(),s={id:e,ids:{label:r?.ids.label,hiddenSelect:r?.ids.control},disabled:r?.disabled,readOnly:r?.readOnly,invalid:r?.invalid,required:r?.required,dir:t,getRootNode:n,...i},a=ja(QX,s);return JX(a,Va)},tK=(i,e)=>{const[t,n]=Eu(i),[r,s]=On()(n,["closeOnSelect","collection","composite","defaultHighlightedValue","defaultOpen","defaultValue","deselectable","disabled","form","highlightedValue","id","ids","invalid","loopFocus","multiple","name","onFocusOutside","onHighlightChange","onInteractOutside","onOpenChange","onPointerDownOutside","onSelect","onValueChange","open","positioning","readOnly","required","scrollToIndexFn","value"]),a=eK(r),o=vc(Ue({present:a.open},t)),l=Ue(a.getRootProps(),s);return v.jsx(nO,{value:a,children:v.jsx(Ru,{value:o,children:v.jsx($e.div,{...l,ref:e})})})},nK=z.forwardRef(tK),iK=(i,e)=>{const[t,n]=Eu(i),[{value:r},s]=On()(n,["value"]),a=vc(Ue({present:r.open},t)),o=Ue(r.getRootProps(),s);return v.jsx(nO,{value:r,children:v.jsx(Ru,{value:a,children:v.jsx($e.div,{...o,ref:e})})})},rK=z.forwardRef(iK),gO=z.forwardRef((i,e)=>{const t=Is(),n=Ue(t.getTriggerProps(),i);return v.jsx($e.button,{...n,ref:e})});gO.displayName="SelectTrigger";const xO=z.forwardRef((i,e)=>{const{children:t,placeholder:n,...r}=i,s=Is(),a=Ue(s.getValueTextProps(),r);return v.jsx($e.span,{...a,ref:e,children:t||s.valueAsString||n})});xO.displayName="SelectValueText";const[yO,C0]=si({name:"SwitchContext",hookName:"useSwitchContext",providerName:"<SwitchProvider />"}),vO=z.forwardRef((i,e)=>{const t=C0(),n=Ue(t.getControlProps(),i);return v.jsx($e.span,{...n,ref:e})});vO.displayName="SwitchControl";const bO=z.forwardRef((i,e)=>{const t=C0(),n=Ue(t.getHiddenInputProps(),i),r=Cu();return v.jsx($e.input,{"aria-describedby":r?.ariaDescribedby,...n,ref:e})});bO.displayName="SwitchHiddenInput";const _O=z.forwardRef((i,e)=>{const t=C0(),n=Ue(t.getLabelProps(),i);return v.jsx($e.span,{...n,ref:e})});_O.displayName="SwitchLabel";const sK=i=>{const e=z.useId(),{getRootNode:t}=Ha(),{dir:n}=Ba(),r=Cu(),s={id:e,ids:{label:r?.ids.label,hiddenInput:r?.ids.control},dir:n,disabled:r?.disabled,readOnly:r?.readOnly,invalid:r?.invalid,required:r?.required,getRootNode:t,...i},a=ja(eY,s);return tY(a,Va)},aK=On(),SO=z.forwardRef((i,e)=>{const[t,n]=aK(i,["checked","defaultChecked","disabled","form","id","ids","invalid","label","name","onCheckedChange","readOnly","required","value"]),r=sK(t),s=Ue(r.getRootProps(),n);return v.jsx(yO,{value:r,children:v.jsx($e.label,{...s,ref:e})})});SO.displayName="SwitchRoot";const oK=On(),wO=z.forwardRef((i,e)=>{const[{value:t},n]=oK(i,["value"]),r=Ue(t.getRootProps(),n);return v.jsx(yO,{value:t,children:v.jsx($e.label,{...r,ref:e})})});wO.displayName="SwitchRootProvider";const MO=z.forwardRef((i,e)=>{const t=C0(),n=Ue(t.getThumbProps(),i);return v.jsx($e.span,{...n,ref:e})});MO.displayName="SwitchThumb";const[TO,kg]=si({name:"TooltipContext",hookName:"useTooltipContext",providerName:"<TooltipProvider />"}),AO=z.forwardRef((i,e)=>{const t=kg(),n=Ue(t.getArrowProps(),i);return v.jsx($e.div,{...n,ref:e})});AO.displayName="TooltipArrow";const CO=z.forwardRef((i,e)=>{const t=kg(),n=Ue(t.getArrowTipProps(),i);return v.jsx($e.div,{...n,ref:e})});CO.displayName="TooltipArrowTip";const EO=z.forwardRef((i,e)=>{const t=kg(),n=il(),r=Ue(t.getContentProps(),n.getPresenceProps(),i);return n.unmounted?null:v.jsx($e.div,{...r,ref:Ig(n.ref,e)})});EO.displayName="TooltipContent";const RO=z.forwardRef((i,e)=>{const t=kg(),n=Ue(t.getPositionerProps(),i);return il().unmounted?null:v.jsx($e.div,{...n,ref:e})});RO.displayName="TooltipPositioner";const lK=i=>{const e=z.useId(),{getRootNode:t}=Ha(),{dir:n}=Ba(),r={id:e,dir:n,getRootNode:t,...i},s=ja(nY,r);return iY(s,Va)},cK=i=>{const[e,{children:t,...n}]=Eu(i),r=lK(n),s=vc(Ue({present:r.open},e));return v.jsx(TO,{value:r,children:v.jsx(Ru,{value:s,children:t})})},uK=i=>{const[e,{value:t,children:n}]=Eu(i),r=vc(Ue({present:t.open},e));return v.jsx(TO,{value:t,children:v.jsx(Ru,{value:r,children:n})})},PO=z.forwardRef((i,e)=>{const t=kg(),n=Ue(t.getTriggerProps(),i);return v.jsx($e.button,{...n,ref:e})});PO.displayName="TooltipTrigger";const{withProvider:IO,withContext:Og}=ua({key:"accordion"});IO(HL,"root",{forwardAsChild:!0});const hK=IO(BL,"root",{forwardAsChild:!0}),dK=Og(OL,"item",{forwardAsChild:!0}),fK=Og(zL,"itemContent",{forwardAsChild:!0}),pK=Og("div","itemBody"),mK=Og(FL,"itemTrigger",{forwardAsChild:!0}),gK=Og(UL,"itemIndicator",{forwardAsChild:!0,defaultProps:{children:v.jsx(R6,{})}}),Fb=z.forwardRef(function(e,t){return v.jsx(ur,{variant:"ghost","aria-label":"Close",ref:t,...e,children:e.children??v.jsx(yL,{})})});Fb.displayName="CloseButton";const{withProvider:xK,withContext:zg}=ua({key:"card"}),yK=xK("div","root"),vK=zg("div","body");zg("div","header");zg("div","footer");zg("h3","title");zg("p","description");const DO=z.forwardRef(function(e,t){const n=rY({key:"checkmark",recipe:e.recipe}),[r,s]=n.splitVariantProps(e),{checked:a,indeterminate:o,disabled:l,unstyled:c,children:u,...d}=s,p=c?sY:n(r);return v.jsx(Qo.svg,{ref:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3px",strokeLinecap:"round",strokeLinejoin:"round","data-state":o?"indeterminate":a?"checked":"unchecked","data-disabled":P6(l),css:[p,e.css],...d,children:o?v.jsx("path",{d:"M5 12h14"}):a?v.jsx("polyline",{points:"20 6 9 17 4 12"}):null})});DO.displayName="Checkmark";const{withProvider:NO,withContext:LO,useStyles:bK}=ua({key:"checkbox"});NO(YL,"root",{forwardAsChild:!0});const _K=NO(XL,"root",{forwardAsChild:!0});LO(qL,"label",{forwardAsChild:!0});const SK=z.forwardRef(function(e,t){const{checked:n,indeterminate:r,...s}=e,a=zb(),o=bK();return n&&a.checked?v.jsx(Qo.svg,{ref:t,asChild:!0,...s,css:[o.indicator,e.css],children:n}):r&&a.indeterminate?v.jsx(Qo.svg,{ref:t,asChild:!0,...s,css:[o.indicator,e.css],children:r}):v.jsx(DO,{ref:t,checked:a.checked,indeterminate:a.indeterminate,disabled:a.disabled,unstyled:!0,...s,css:[o.indicator,e.css]})}),wK=LO(VL,"control",{forwardAsChild:!0,defaultProps:{children:v.jsx(SK,{})}});Qo(GL,{base:{display:"flex",flexDirection:"column",gap:"1.5"}},{forwardAsChild:!0});const MK=WL,{withProvider:kO,withContext:V6}=ua({key:"collapsible"});kO(KL,"root",{forwardAsChild:!0});const OO=kO(B6,"root",{forwardAsChild:!0}),TK=V6(ZL,"trigger",{forwardAsChild:!0}),zO=V6(j6,"content",{forwardAsChild:!0});V6($L,"indicator",{forwardAsChild:!0});const{withRootProvider:UO,withContext:al}=ua({key:"drawer"});UO(h$,{defaultProps:{unmountOnExit:!0,lazyMount:!0}});const G6=UO(u$,{defaultProps:{unmountOnExit:!0,lazyMount:!0}}),FO=al(sk,"trigger",{forwardAsChild:!0}),W6=al(ik,"positioner",{forwardAsChild:!0}),q6=al(tk,"content",{forwardAsChild:!0});al(nk,"description",{forwardAsChild:!0});al(rk,"title",{forwardAsChild:!0});const X6=al(ek,"closeTrigger",{forwardAsChild:!0});z.forwardRef(function(e,t){const n=Pu();return v.jsx(Qo.button,{...e,ref:t,onClick:()=>n.setOpen(!1)})});const Y6=al(JL,"backdrop",{forwardAsChild:!0}),am=al("div","body"),AK=al("div","footer"),$6=al("div","header"),ss=z.forwardRef(function(e,t){const{direction:n,align:r,justify:s,wrap:a,basis:o,grow:l,shrink:c,inline:u,...d}=e;return v.jsx(Qo.div,{ref:t,...d,css:{display:u?"inline-flex":"flex",flexDirection:n,alignItems:r,justifyContent:s,flexWrap:a,flexBasis:o,flexGrow:l,flexShrink:c,...e.css}})});ss.displayName="Flex";function iE(i){return oY(i,e=>e==="auto"?"auto":`span ${e}/span ${e}`)}const Zr=z.forwardRef(function(e,t){const{area:n,colSpan:r,colStart:s,colEnd:a,rowEnd:o,rowSpan:l,rowStart:c,...u}=e,d=z.useMemo(()=>aY({gridArea:n,gridColumn:iE(r),gridRow:iE(l),gridColumnStart:s,gridColumnEnd:a,gridRowStart:c,gridRowEnd:o}),[n,r,s,a,o,l,c]);return v.jsx(Qo.div,{ref:t,css:[d,e.css],...u})});Zr.displayName="GridItem";function CK(i){const{children:e,query:t,ignoreCase:n,matchAll:r,styles:s}=i;if(typeof e!="string")throw new Error("The children prop of Highlight must be a string");const a=x$({query:t,text:e,matchAll:r,ignoreCase:n});return v.jsx(SL,{each:a,children:(o,l)=>o.match?v.jsx(NL,{css:s,children:o.text},l):v.jsx(z.Fragment,{children:o.text},l)})}const{withContext:EK}=E6({key:"kbd"}),zn=EK("kbd");zn.displayName="Kbd";const{withProvider:BO,withContext:ol}=ua({key:"listbox"}),rE=BO(R$,"root",{forwardAsChild:!0}),MM=BO(C$,"root",{forwardAsChild:!0});ol(uk,"input",{forwardAsChild:!0});const Im=ol(lk,"content",{forwardAsChild:!0});ol(yk,"valueText",{forwardAsChild:!0});const RK=ol(fk,"itemGroup",{forwardAsChild:!0}),PK=ol(pk,"itemGroupLabel",{forwardAsChild:!0}),Dm=ol(dk,"item",{forwardAsChild:!0}),qy=ol(gk,"itemText",{forwardAsChild:!0}),Xy=ol(mk,"itemIndicator",{forwardAsChild:!0,defaultProps:{children:v.jsx(vL,{})}}),TM=ol(xk,"label",{forwardAsChild:!0});ol(ck,"empty",{forwardAsChild:!0});const{withProvider:HO,withContext:ud}=ua({key:"numberInput"});HO(Ak,"root",{forwardAsChild:!0});const qo=HO(Tk,"root",{forwardAsChild:!0});ud(Mk,"label",{forwardAsChild:!0});const Xo=ud(wk,"input",{forwardAsChild:!0}),IK=ud(Sk,"incrementTrigger",{forwardAsChild:!0,defaultProps:{children:v.jsx(lY,{})}}),DK=ud(_k,"decrementTrigger",{forwardAsChild:!0,defaultProps:{children:v.jsx(R6,{})}}),jO=ud(bk,"control",{forwardAsChild:!0,defaultProps:{children:v.jsxs(v.Fragment,{children:[v.jsx(IK,{}),v.jsx(DK,{})]})}});ud(Ck,"scrubber",{forwardAsChild:!0});ud(Ek,"valueText",{forwardAsChild:!0});const{withRootProvider:VO,withContext:ha}=ua({key:"popover"});VO(k$);const K6=VO(L$),Z6=ha(Fk,"trigger",{forwardAsChild:!0}),Q6=ha(zk,"positioner",{forwardAsChild:!0}),J6=ha(Lk,"content",{forwardAsChild:!0}),GO=ha(Dk,"arrowTip",{forwardAsChild:!0}),WO=ha(Ik,"arrow",{forwardAsChild:!0,defaultProps:{children:v.jsx(GO,{})}});ha(Nk,"closeTrigger",{forwardAsChild:!0});ha(Ok,"indicator",{forwardAsChild:!0});ha(Uk,"title",{forwardAsChild:!0});ha(kk,"description",{forwardAsChild:!0});ha("footer","footer");ha("header","header");const qO=ha("div","body");ha(Pk,void 0,{forwardAsChild:!0});const{withProvider:XO,withContext:Ug}=ua({key:"scrollArea"});XO(Gk,"root",{forwardAsChild:!0});const eT=XO(Vk,"root",{forwardAsChild:!0}),tT=Ug(Xk,"viewport",{forwardAsChild:!0}),nT=Ug(Hk,"content",{forwardAsChild:!0}),Bb=Ug(qk,"thumb",{forwardAsChild:!0}),iT=Ug(Wk,"scrollbar",{forwardAsChild:!0,defaultProps:{children:v.jsx(Bb,{})}}),rT=Ug(jk,"corner",{forwardAsChild:!0}),{withProvider:YO,withContext:sT}=ua({key:"segmentGroup"});YO(tO,"root",{forwardAsChild:!0});const AM=YO(eO,"root",{forwardAsChild:!0,forwardProps:["orientation"],defaultProps:{orientation:"horizontal"}}),CM=sT(Zk,"item",{forwardAsChild:!0}),EM=sT(Jk,"itemText",{forwardAsChild:!0}),RM=sT($k,"indicator",{forwardAsChild:!0});function NK(i){return i.map(e=>typeof e=="string"?{value:e,label:e}:e)}const sE=i=>{const{items:e,...t}=i,n=z.useMemo(()=>NK(e),[e]);return v.jsx(SL,{each:n,children:r=>v.jsxs(CM,{value:r.value,disabled:r.disabled,...t,children:[v.jsx(EM,{children:r.label}),v.jsx(PM,{})]},r.value)})},PM=Qk,{withProvider:$O,withContext:Ds}=ua({key:"select"});$O(rK,"root",{forwardAsChild:!0});const Hb=$O(nK,"root",{forwardAsChild:!0,defaultProps:{positioning:{sameWidth:!0}}}),jb=Ds(gO,"trigger",{forwardAsChild:!0}),Vb=Ds(mO,"positioner",{forwardAsChild:!0}),Gb=Ds(rO,"content",{forwardAsChild:!0}),Wb=Ds(xO,"valueText",{forwardAsChild:!0});Ds(iO,"clearTrigger",{forwardAsChild:!0,defaultProps:{children:v.jsx(yL,{boxSize:"1em"})}});Ds(uO,"itemGroup",{forwardAsChild:!0});Ds(hO,"itemGroupLabel",{forwardAsChild:!0});const qb=Ds(cO,"item",{forwardAsChild:!0}),KO=Ds(fO,"itemText",{forwardAsChild:!0}),aT=Ds(dO,"itemIndicator",{forwardAsChild:!0,defaultProps:{children:v.jsx(vL,{})}}),LK=Ds("div","indicatorGroup"),ZO=Ds(oO,"indicator",{forwardAsChild:!0,defaultProps:{children:v.jsx(R6,{})}}),oT=Ds(sO,"control",{forwardAsChild:!0}),kK=Ds(pO,"label",{forwardAsChild:!0}),lT=aO,{useRecipeResult:OK}=E6({key:"separator"}),Iu=z.forwardRef(function(e,t){const{styles:n,className:r,props:s}=OK(e),a=e.orientation||"horizontal";return v.jsx(Qo.span,{ref:t,role:J7(a)?"separator":"presentation","aria-orientation":J7(a)?a:void 0,...uY(s,["orientation"]),className:cY(r,e.className),css:[n,e.css]})});Iu.displayName="Separator";const{withProvider:QO,withContext:cT,useStyles:zK}=ua({key:"switch"});QO(wO,"root",{forwardAsChild:!0});const E0=QO(SO,"root",{forwardAsChild:!0}),UK=cT(_O,"label",{forwardAsChild:!0}),R0=cT(MO,"thumb",{forwardAsChild:!0}),P0=cT(vO,"control",{forwardAsChild:!0,defaultProps:{children:v.jsx(R0,{})}});z.forwardRef(function(e,t){const n=C0(),r=zK(),{fallback:s,children:a,unstyled:o,...l}=e;return v.jsx(Qo.span,{ref:t,"data-checked":P6(n.checked),...l,css:[o?void 0:r.indicator,e.css],children:n.checked?a:s})});z.forwardRef(function(e,t){const n=C0(),{fallback:r,children:s,...a}=e;return v.jsx(Qo.span,{ref:t,"data-checked":P6(n.checked),...a,children:n.checked?s:r})});const I0=bO,{withRootProvider:JO,withContext:Fg}=ua({key:"tooltip"});JO(uK);const FK=JO(cK,{defaultProps:{lazyMount:!0,unmountOnExit:!0}}),BK=Fg(PO,"trigger",{forwardAsChild:!0}),HK=Fg(RO,"positioner",{forwardAsChild:!0}),jK=Fg(EO,"content",{forwardAsChild:!0}),ez=Fg(CO,"arrowTip",{forwardAsChild:!0}),VK=Fg(AO,"arrow",{forwardAsChild:!0,defaultProps:{children:v.jsx(ez,{})}});function GK(){return v.jsxs(qe,{children:[v.jsx(yc,{lineHeight:1.2,size:"5xl",fontWeight:"medium",children:v.jsx(CK,{query:["N","O","Browser"],styles:{color:"black.600",fontSize:"6xl",fontWeight:"bold"},children:"Not Only Observation Browser"})}),v.jsx(Iu,{size:"lg"}),v.jsx(ke,{fontSize:"lg",fontWeight:"medium",my:3,children:"A web-based platform for visualizing and analyzing WFSS data"})]})}function WK(i){const{collapsedSize:e="40px",buttonPosition:t="left",initialExpanded:n=!0,children:r,...s}=i,[a,o]=z.useState(n),l=t==="top-left"?"column":"row";return v.jsx(qe,{...s,children:v.jsxs(wt,{direction:l,alignItems:"flex-start",gapY:0,p:0,m:0,overflow:"hidden",borderWidth:"1px",borderRadius:"md",bg:"bg",height:a?"auto":e,width:a?"auto":e,transition:"width 500ms ease, height 500ms ease",children:[v.jsx(ur,{"aria-label":a?"Collapse":"Expand",size:"sm",variant:"ghost",m:0,p:0,width:e,height:e,onClick:()=>o(c=>!c),zIndex:1,children:v.jsx(qe,{p:0,m:0,as:I6,transform:a?"rotate(45deg)":"rotate(0deg)",transition:"transform 500ms ease"})}),v.jsx(qe,{opacity:a?1:0,pointerEvents:a?"auto":"none",transform:a?"translateY(0)":"translateY(4px)",transition:"opacity 500ms ease",zIndex:0,children:r})]})})}function uT(i,e,t){if(!i)return;if(t(i)===!0)return i;let n=e?i.return:i.child;for(;n;){const r=uT(n,e,t);if(r)return r;n=e?null:n.sibling}}function tz(i){try{return Object.defineProperties(i,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return i}}const hT=tz(z.createContext(null));let dT=class extends z.Component{render(){return z.createElement(hT.Provider,{value:this._reactInternals},this.props.children)}};function nz(){const i=z.useContext(hT);if(i===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=z.useId();return z.useMemo(()=>{for(const t of[i,i?.alternate]){if(!t)continue;const n=uT(t,!1,r=>{let s=r.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}});if(n)return n}},[i,e])}const qK=Symbol.for("react.context"),XK=i=>i!==null&&typeof i=="object"&&"$$typeof"in i&&i.$$typeof===qK;function YK(){const i=nz(),[e]=z.useState(()=>new Map);e.clear();let t=i;for(;t;){const n=t.type;XK(n)&&n!==hT&&!e.has(n)&&e.set(n,z.use(tz(n))),t=t.return}return e}function iz(){const i=YK();return z.useMemo(()=>Array.from(i.keys()).reduce((e,t)=>n=>z.createElement(e,null,z.createElement(t.Provider,{...n,value:i.get(t)})),e=>z.createElement(dT,{...e})),[i])}var In=(i=>(i.Application="application",i.WebGLPipes="webgl-pipes",i.WebGLPipesAdaptor="webgl-pipes-adaptor",i.WebGLSystem="webgl-system",i.WebGPUPipes="webgpu-pipes",i.WebGPUPipesAdaptor="webgpu-pipes-adaptor",i.WebGPUSystem="webgpu-system",i.CanvasSystem="canvas-system",i.CanvasPipesAdaptor="canvas-pipes-adaptor",i.CanvasPipes="canvas-pipes",i.Asset="asset",i.LoadParser="load-parser",i.ResolveParser="resolve-parser",i.CacheParser="cache-parser",i.DetectionParser="detection-parser",i.MaskEffect="mask-effect",i.BlendMode="blend-mode",i.TextureSource="texture-source",i.Environment="environment",i.ShapeBuilder="shape-builder",i.Batcher="batcher",i))(In||{});const IM=i=>{if(typeof i=="function"||typeof i=="object"&&i.extension){if(!i.extension)throw new Error("Extension class must have an extension object");i={...typeof i.extension!="object"?{type:i.extension}:i.extension,ref:i}}if(typeof i=="object")i={...i};else throw new Error("Invalid extension type");return typeof i.type=="string"&&(i.type=[i.type]),i},Yx=(i,e)=>IM(i).priority??e,Es={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...i){return i.map(IM).forEach(e=>{e.type.forEach(t=>this._removeHandlers[t]?.(e))}),this},add(...i){return i.map(IM).forEach(e=>{e.type.forEach(t=>{const n=this._addHandlers,r=this._queue;n[t]?n[t]?.(e):(r[t]=r[t]||[],r[t]?.push(e))})}),this},handle(i,e,t){const n=this._addHandlers,r=this._removeHandlers;if(n[i]||r[i])throw new Error(`Extension type ${i} already has a handler`);n[i]=e,r[i]=t;const s=this._queue;return s[i]&&(s[i]?.forEach(a=>e(a)),delete s[i]),this},handleByMap(i,e){return this.handle(i,t=>{t.name&&(e[t.name]=t.ref)},t=>{t.name&&delete e[t.name]})},handleByNamedList(i,e,t=-1){return this.handle(i,n=>{e.findIndex(s=>s.name===n.name)>=0||(e.push({name:n.name,value:n.ref}),e.sort((s,a)=>Yx(a.value,t)-Yx(s.value,t)))},n=>{const r=e.findIndex(s=>s.name===n.name);r!==-1&&e.splice(r,1)})},handleByList(i,e,t=-1){return this.handle(i,n=>{e.includes(n.ref)||(e.push(n.ref),e.sort((r,s)=>Yx(s,t)-Yx(r,t)))},n=>{const r=e.indexOf(n.ref);r!==-1&&e.splice(r,1)})},mixin(i,...e){for(const t of e)Object.defineProperties(i.prototype,Object.getOwnPropertyDescriptors(t))}},$K={extension:{type:In.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await Vy(()=>import("./browserAll-PQEYP37x.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))}},KK={extension:{type:In.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await Vy(()=>import("./webworkerAll-lwlnapI9.js"),__vite__mapDeps([1,2,3,4,5,6,7,8,9,10]))}};class wr{constructor(e,t,n){this._x=t||0,this._y=n||0,this._observer=e}clone(e){return new wr(e??this._observer,this._x,this._y)}set(e=0,t=e){return(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this._observer._onUpdate(this)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this._observer._onUpdate(this)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this._observer._onUpdate(this))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this._observer._onUpdate(this))}}var z3={exports:{}},aE;function ZK(){return aE||(aE=1,(function(i){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function r(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function s(l,c,u,d,p){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new r(u,d||l,p),g=t?t+c:c;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],m]:l._events[g].push(m):(l._events[g]=m,l._eventsCount++),l}function a(l,c){--l._eventsCount===0?l._events=new n:delete l._events[c]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)e.call(u,d)&&c.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=t?t+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var p=0,m=d.length,g=new Array(m);p<m;p++)g[p]=d[p].fn;return g},o.prototype.listenerCount=function(c){var u=t?t+c:c,d=this._events[u];return d?d.fn?1:d.length:0},o.prototype.emit=function(c,u,d,p,m,g){var y=t?t+c:c;if(!this._events[y])return!1;var x=this._events[y],_=arguments.length,S,w;if(x.fn){switch(x.once&&this.removeListener(c,x.fn,void 0,!0),_){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,u),!0;case 3:return x.fn.call(x.context,u,d),!0;case 4:return x.fn.call(x.context,u,d,p),!0;case 5:return x.fn.call(x.context,u,d,p,m),!0;case 6:return x.fn.call(x.context,u,d,p,m,g),!0}for(w=1,S=new Array(_-1);w<_;w++)S[w-1]=arguments[w];x.fn.apply(x.context,S)}else{var T=x.length,C;for(w=0;w<T;w++)switch(x[w].once&&this.removeListener(c,x[w].fn,void 0,!0),_){case 1:x[w].fn.call(x[w].context);break;case 2:x[w].fn.call(x[w].context,u);break;case 3:x[w].fn.call(x[w].context,u,d);break;case 4:x[w].fn.call(x[w].context,u,d,p);break;default:if(!S)for(C=1,S=new Array(_-1);C<_;C++)S[C-1]=arguments[C];x[w].fn.apply(x[w].context,S)}}return!0},o.prototype.on=function(c,u,d){return s(this,c,u,d,!1)},o.prototype.once=function(c,u,d){return s(this,c,u,d,!0)},o.prototype.removeListener=function(c,u,d,p){var m=t?t+c:c;if(!this._events[m])return this;if(!u)return a(this,m),this;var g=this._events[m];if(g.fn)g.fn===u&&(!p||g.once)&&(!d||g.context===d)&&a(this,m);else{for(var y=0,x=[],_=g.length;y<_;y++)(g[y].fn!==u||p&&!g[y].once||d&&g[y].context!==d)&&x.push(g[y]);x.length?this._events[m]=x.length===1?x[0]:x:a(this,m)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=t?t+c:c,this._events[u]&&a(this,u)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,i.exports=o})(z3)),z3.exports}var QK=ZK();const ll=od(QK),JK=Math.PI*2,eZ=180/Math.PI,tZ=Math.PI/180;let Sn=class rz{constructor(e=0,t=0){this.x=0,this.y=0,this.x=e,this.y=t}clone(){return new rz(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,t=e){return this.x=e,this.y=t,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return U3.x=0,U3.y=0,U3}};const U3=new Sn;class hn{constructor(e=1,t=0,n=0,r=1,s=0,a=0){this.array=null,this.a=e,this.b=t,this.c=n,this.d=r,this.tx=s,this.ty=a}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,t,n,r,s,a){return this.a=e,this.b=t,this.c=n,this.d=r,this.tx=s,this.ty=a,this}toArray(e,t){this.array||(this.array=new Float32Array(9));const n=t||this.array;return e?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(e,t){t=t||new Sn;const n=e.x,r=e.y;return t.x=this.a*n+this.c*r+this.tx,t.y=this.b*n+this.d*r+this.ty,t}applyInverse(e,t){t=t||new Sn;const n=this.a,r=this.b,s=this.c,a=this.d,o=this.tx,l=this.ty,c=1/(n*a+s*-r),u=e.x,d=e.y;return t.x=a*c*u+-s*c*d+(l*s-o*a)*c,t.y=n*c*d+-r*c*u+(-l*n+o*r)*c,t}translate(e,t){return this.tx+=e,this.ty+=t,this}scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=this.a,s=this.c,a=this.tx;return this.a=r*t-this.b*n,this.b=r*n+this.b*t,this.c=s*t-this.d*n,this.d=s*n+this.d*t,this.tx=a*t-this.ty*n,this.ty=a*n+this.ty*t,this}append(e){const t=this.a,n=this.b,r=this.c,s=this.d;return this.a=e.a*t+e.b*r,this.b=e.a*n+e.b*s,this.c=e.c*t+e.d*r,this.d=e.c*n+e.d*s,this.tx=e.tx*t+e.ty*r+this.tx,this.ty=e.tx*n+e.ty*s+this.ty,this}appendFrom(e,t){const n=e.a,r=e.b,s=e.c,a=e.d,o=e.tx,l=e.ty,c=t.a,u=t.b,d=t.c,p=t.d;return this.a=n*c+r*d,this.b=n*u+r*p,this.c=s*c+a*d,this.d=s*u+a*p,this.tx=o*c+l*d+t.tx,this.ty=o*u+l*p+t.ty,this}setTransform(e,t,n,r,s,a,o,l,c){return this.a=Math.cos(o+c)*s,this.b=Math.sin(o+c)*s,this.c=-Math.sin(o-l)*a,this.d=Math.cos(o-l)*a,this.tx=e-(n*this.a+r*this.c),this.ty=t-(n*this.b+r*this.d),this}prepend(e){const t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const n=this.a,r=this.c;this.a=n*e.a+this.b*e.c,this.b=n*e.b+this.b*e.d,this.c=r*e.a+this.d*e.c,this.d=r*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}decompose(e){const t=this.a,n=this.b,r=this.c,s=this.d,a=e.pivot,o=-Math.atan2(-r,s),l=Math.atan2(n,t),c=Math.abs(o+l);return c<1e-5||Math.abs(JK-c)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=o,e.skew.y=l),e.scale.x=Math.sqrt(t*t+n*n),e.scale.y=Math.sqrt(r*r+s*s),e.position.x=this.tx+(a.x*t+a.y*r),e.position.y=this.ty+(a.x*n+a.y*s),e}invert(){const e=this.a,t=this.b,n=this.c,r=this.d,s=this.tx,a=e*r-t*n;return this.a=r/a,this.b=-t/a,this.c=-n/a,this.d=e/a,this.tx=(n*this.ty-r*s)/a,this.ty=-(e*this.ty-t*s)/a,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new hn;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}equals(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return iZ.identity()}static get shared(){return nZ.identity()}}const nZ=new hn,iZ=new hn,Th=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Ah=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ch=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Eh=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],DM=[],sz=[],$x=Math.sign;function rZ(){for(let i=0;i<16;i++){const e=[];DM.push(e);for(let t=0;t<16;t++){const n=$x(Th[i]*Th[t]+Ch[i]*Ah[t]),r=$x(Ah[i]*Th[t]+Eh[i]*Ah[t]),s=$x(Th[i]*Ch[t]+Ch[i]*Eh[t]),a=$x(Ah[i]*Ch[t]+Eh[i]*Eh[t]);for(let o=0;o<16;o++)if(Th[o]===n&&Ah[o]===r&&Ch[o]===s&&Eh[o]===a){e.push(o);break}}}for(let i=0;i<16;i++){const e=new hn;e.set(Th[i],Ah[i],Ch[i],Eh[i],0,0),sz.push(e)}}rZ();const Fn={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:i=>Th[i],uY:i=>Ah[i],vX:i=>Ch[i],vY:i=>Eh[i],inv:i=>i&8?i&15:-i&7,add:(i,e)=>DM[i][e],sub:(i,e)=>DM[i][Fn.inv(e)],rotate180:i=>i^4,isVertical:i=>(i&3)===2,byDirection:(i,e)=>Math.abs(i)*2<=Math.abs(e)?e>=0?Fn.S:Fn.N:Math.abs(e)*2<=Math.abs(i)?i>0?Fn.E:Fn.W:e>0?i>0?Fn.SE:Fn.SW:i>0?Fn.NE:Fn.NW,matrixAppendRotationInv:(i,e,t=0,n=0)=>{const r=sz[Fn.inv(e)];r.tx=t,r.ty=n,i.append(r)},transformRectCoords:(i,e,t,n)=>{const{x:r,y:s,width:a,height:o}=i,{x:l,y:c,width:u,height:d}=e;return t===Fn.E?(n.set(r+l,s+c,a,o),n):t===Fn.S?n.set(u-s-o+l,r+c,o,a):t===Fn.W?n.set(u-r-a+l,d-s-o+c,a,o):t===Fn.N?n.set(s+l,d-r-a+c,o,a):n.set(r+l,s+c,a,o)}},Kx=[new Sn,new Sn,new Sn,new Sn];class Qn{constructor(e=0,t=0,n=0,r=0){this.type="rectangle",this.x=Number(e),this.y=Number(t),this.width=Number(n),this.height=Number(r)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new Qn(0,0,0,0)}clone(){return new Qn(this.x,this.y,this.width,this.height)}copyFromBounds(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,t){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height}strokeContains(e,t,n,r=.5){const{width:s,height:a}=this;if(s<=0||a<=0)return!1;const o=this.x,l=this.y,c=n*(1-r),u=n-c,d=o-c,p=o+s+c,m=l-c,g=l+a+c,y=o+u,x=o+s-u,_=l+u,S=l+a-u;return e>=d&&e<=p&&t>=m&&t<=g&&!(e>y&&e<x&&t>_&&t<S)}intersects(e,t){if(!t){const O=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=O)return!1;const P=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>P}const n=this.left,r=this.right,s=this.top,a=this.bottom;if(r<=n||a<=s)return!1;const o=Kx[0].set(e.left,e.top),l=Kx[1].set(e.left,e.bottom),c=Kx[2].set(e.right,e.top),u=Kx[3].set(e.right,e.bottom);if(c.x<=o.x||l.y<=o.y)return!1;const d=Math.sign(t.a*t.d-t.b*t.c);if(d===0||(t.apply(o,o),t.apply(l,l),t.apply(c,c),t.apply(u,u),Math.max(o.x,l.x,c.x,u.x)<=n||Math.min(o.x,l.x,c.x,u.x)>=r||Math.max(o.y,l.y,c.y,u.y)<=s||Math.min(o.y,l.y,c.y,u.y)>=a))return!1;const p=d*(l.y-o.y),m=d*(o.x-l.x),g=p*n+m*s,y=p*r+m*s,x=p*n+m*a,_=p*r+m*a;if(Math.max(g,y,x,_)<=p*o.x+m*o.y||Math.min(g,y,x,_)>=p*u.x+m*u.y)return!1;const S=d*(o.y-c.y),w=d*(c.x-o.x),T=S*n+w*s,C=S*r+w*s,E=S*n+w*a,D=S*r+w*a;return!(Math.max(T,C,E,D)<=S*o.x+w*o.y||Math.min(T,C,E,D)>=S*u.x+w*u.y)}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2,this}fit(e){const t=Math.max(this.x,e.x),n=Math.min(this.x+this.width,e.x+e.width),r=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(n-t,0),this.y=r,this.height=Math.max(s-r,0),this}ceil(e=1,t=.001){const n=Math.ceil((this.x+this.width-t)*e)/e,r=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=n-this.x,this.height=r-this.y,this}scale(e,t=e){return this.x*=e,this.y*=t,this.width*=e,this.height*=t,this}enlarge(e){const t=Math.min(this.x,e.x),n=Math.max(this.x+this.width,e.x+e.width),r=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=n-t,this.y=r,this.height=s-r,this}getBounds(e){return e||(e=new Qn),e.copyFrom(this),e}containsRect(e){if(this.width<=0||this.height<=0)return!1;const t=e.x,n=e.y,r=e.x+e.width,s=e.y+e.height;return t>=this.x&&t<this.x+this.width&&n>=this.y&&n<this.y+this.height&&r>=this.x&&r<this.x+this.width&&s>=this.y&&s<this.y+this.height}set(e,t,n,r){return this.x=e,this.y=t,this.width=n,this.height=r,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const F3={default:-1};function Mi(i="default"){return F3[i]===void 0&&(F3[i]=-1),++F3[i]}const oE=new Set,wi="8.0.0",sZ="8.3.4",If={quiet:!1,noColor:!1},Tn=(i,e,t=3)=>{if(If.quiet||oE.has(e))return;let n=new Error().stack;const r=`${e}
Deprecated since v${i}`,s=typeof console.groupCollapsed=="function"&&!If.noColor;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",r):(n=n.split(`
`).splice(t).join(`
`),s?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",r),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",r),console.warn(n))),oE.add(e)};Object.defineProperties(Tn,{quiet:{get:()=>If.quiet,set:i=>{If.quiet=i},enumerable:!0,configurable:!1},noColor:{get:()=>If.noColor,set:i=>{If.noColor=i},enumerable:!0,configurable:!1}});const az=()=>{};function Zf(i){return i+=i===0?1:0,--i,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i+1}function lE(i){return!(i&i-1)&&!!i}function oz(i){const e={};for(const t in i)i[t]!==void 0&&(e[t]=i[t]);return e}const cE=Object.create(null);function aZ(i){const e=cE[i];return e===void 0&&(cE[i]=Mi("resource")),e}const lz=class cz extends ll{constructor(e={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,e={...cz.defaultOptions,...e},this.addressMode=e.addressMode,this.addressModeU=e.addressModeU??this.addressModeU,this.addressModeV=e.addressModeV??this.addressModeV,this.addressModeW=e.addressModeW??this.addressModeW,this.scaleMode=e.scaleMode,this.magFilter=e.magFilter??this.magFilter,this.minFilter=e.minFilter??this.minFilter,this.mipmapFilter=e.mipmapFilter??this.mipmapFilter,this.lodMinClamp=e.lodMinClamp,this.lodMaxClamp=e.lodMaxClamp,this.compare=e.compare,this.maxAnisotropy=e.maxAnisotropy??1}set addressMode(e){this.addressModeU=e,this.addressModeV=e,this.addressModeW=e}get addressMode(){return this.addressModeU}set wrapMode(e){Tn(wi,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=e}get wrapMode(){return this.addressMode}set scaleMode(e){this.magFilter=e,this.minFilter=e,this.mipmapFilter=e}get scaleMode(){return this.magFilter}set maxAnisotropy(e){this._maxAnisotropy=Math.min(e,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const e=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=aZ(e),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};lz.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let Yy=lz;const uz=class hz extends ll{constructor(e={}){super(),this.options=e,this.uid=Mi("textureSource"),this._resourceType="textureSource",this._resourceId=Mi("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,e={...hz.defaultOptions,...e},this.label=e.label??"",this.resource=e.resource,this.autoGarbageCollect=e.autoGarbageCollect,this._resolution=e.resolution,e.width?this.pixelWidth=e.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,e.height?this.pixelHeight=e.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=e.format,this.dimension=e.dimensions,this.mipLevelCount=e.mipLevelCount,this.autoGenerateMipmaps=e.autoGenerateMipmaps,this.sampleCount=e.sampleCount,this.antialias=e.antialias,this.alphaMode=e.alphaMode,this.style=new Yy(oz(e)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(e){this.style!==e&&(this._style?.off("change",this._onStyleChange,this),this._style=e,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}set maxAnisotropy(e){this._style.maxAnisotropy=e}get maxAnisotropy(){return this._style.maxAnisotropy}get addressMode(){return this._style.addressMode}set addressMode(e){this._style.addressMode=e}get repeatMode(){return this._style.addressMode}set repeatMode(e){this._style.addressMode=e}get magFilter(){return this._style.magFilter}set magFilter(e){this._style.magFilter=e}get minFilter(){return this._style.minFilter}set minFilter(e){this._style.minFilter=e}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(e){this._style.mipmapFilter=e}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(e){this._style.lodMinClamp=e}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(e){this._style.lodMaxClamp=e}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const e=this._resolution;if(this.resize(this.resourceWidth/e,this.resourceHeight/e))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=Mi("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:e}=this;return e.naturalWidth||e.videoWidth||e.displayWidth||e.width}get resourceHeight(){const{resource:e}=this;return e.naturalHeight||e.videoHeight||e.displayHeight||e.height}get resolution(){return this._resolution}set resolution(e){this._resolution!==e&&(this._resolution=e,this.width=this.pixelWidth/e,this.height=this.pixelHeight/e)}resize(e,t,n){n||(n=this._resolution),e||(e=this.width),t||(t=this.height);const r=Math.round(e*n),s=Math.round(t*n);return this.width=r/n,this.height=s/n,this._resolution=n,this.pixelWidth===r&&this.pixelHeight===s?!1:(this._refreshPOT(),this.pixelWidth=r,this.pixelHeight=s,this.emit("resize",this),this._resourceId=Mi("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(e){this._style.wrapMode=e}get wrapMode(){return this._style.wrapMode}set scaleMode(e){this._style.scaleMode=e}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=lE(this.pixelWidth)&&lE(this.pixelHeight)}static test(e){throw new Error("Unimplemented")}};uz.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let yo=uz;class fT extends yo{constructor(e){const t=e.resource||new Float32Array(e.width*e.height*4);let n=e.format;n||(t instanceof Float32Array?n="rgba32float":t instanceof Int32Array||t instanceof Uint32Array?n="rgba32uint":t instanceof Int16Array||t instanceof Uint16Array?n="rgba16uint":(t instanceof Int8Array,n="bgra8unorm")),super({...e,resource:t,format:n}),this.uploadMethodId="buffer"}static test(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}fT.extension=In.TextureSource;const uE=new hn;class oZ{constructor(e,t){this.mapCoord=new hn,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof t>"u"?this.clampMargin=e.width<10?0:.5:this.clampMargin=t,this.isSimple=!1,this.texture=e}get texture(){return this._texture}set texture(e){this.texture!==e&&(this._texture?.removeListener("update",this.update,this),this._texture=e,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(e,t){t===void 0&&(t=e);const n=this.mapCoord;for(let r=0;r<e.length;r+=2){const s=e[r],a=e[r+1];t[r]=s*n.a+a*n.c+n.tx,t[r+1]=s*n.b+a*n.d+n.ty}return t}update(){const e=this._texture;this._updateID++;const t=e.uvs;this.mapCoord.set(t.x1-t.x0,t.y1-t.y0,t.x3-t.x0,t.y3-t.y0,t.x0,t.y0);const n=e.orig,r=e.trim;r&&(uE.set(n.width/r.width,0,0,n.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(uE));const s=e.source,a=this.uClampFrame,o=this.clampMargin/s._resolution,l=this.clampOffset/s._resolution;return a[0]=(e.frame.x+o+l)/s.width,a[1]=(e.frame.y+o+l)/s.height,a[2]=(e.frame.x+e.frame.width-o+l)/s.width,a[3]=(e.frame.y+e.frame.height-o+l)/s.height,this.uClampOffset[0]=this.clampOffset/s.pixelWidth,this.uClampOffset[1]=this.clampOffset/s.pixelHeight,this.isSimple=e.frame.width===s.width&&e.frame.height===s.height&&e.rotate===0,!0}}let cn=class extends ll{constructor({source:e,label:t,frame:n,orig:r,trim:s,defaultAnchor:a,defaultBorders:o,rotate:l,dynamic:c}={}){if(super(),this.uid=Mi("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new Qn,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=t,this.source=e?.source??new yo,this.noFrame=!n,n)this.frame.copyFrom(n);else{const{width:u,height:d}=this._source;this.frame.width=u,this.frame.height=d}this.orig=r||this.frame,this.trim=s,this.rotate=l??0,this.defaultAnchor=a,this.defaultBorders=o,this.destroyed=!1,this.dynamic=c||!1,this.updateUvs()}set source(e){this._source&&this._source.off("resize",this.update,this),this._source=e,e.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new oZ(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:e,frame:t}=this,{width:n,height:r}=this._source,s=t.x/n,a=t.y/r,o=t.width/n,l=t.height/r;let c=this.rotate;if(c){const u=o/2,d=l/2,p=s+u,m=a+d;c=Fn.add(c,Fn.NW),e.x0=p+u*Fn.uX(c),e.y0=m+d*Fn.uY(c),c=Fn.add(c,2),e.x1=p+u*Fn.uX(c),e.y1=m+d*Fn.uY(c),c=Fn.add(c,2),e.x2=p+u*Fn.uX(c),e.y2=m+d*Fn.uY(c),c=Fn.add(c,2),e.x3=p+u*Fn.uX(c),e.y3=m+d*Fn.uY(c)}else e.x0=s,e.y0=a,e.x1=s+o,e.y1=a,e.x2=s+o,e.y2=a+l,e.x3=s,e.y3=a+l}destroy(e=!1){this._source&&(this._source.off("resize",this.update,this),e&&(this._source.destroy(),this._source=null)),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return Tn(wi,"Texture.baseTexture is now Texture.source"),this._source}};cn.EMPTY=new cn({label:"EMPTY",source:new yo({label:"EMPTY"})});cn.EMPTY.destroy=az;cn.WHITE=new cn({source:new fT({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});cn.WHITE.destroy=az;function lZ(i,e,t){const{width:n,height:r}=t.orig,s=t.trim;if(s){const a=s.width,o=s.height;i.minX=s.x-e._x*n,i.maxX=i.minX+a,i.minY=s.y-e._y*r,i.maxY=i.minY+o}else i.minX=-e._x*n,i.maxX=i.minX+n,i.minY=-e._y*r,i.maxY=i.minY+r}const hE=new hn;class mo{constructor(e=1/0,t=1/0,n=-1/0,r=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=hE,this.minX=e,this.minY=t,this.maxX=n,this.maxY=r}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new Qn);const e=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(e.x=0,e.y=0,e.width=0,e.height=0):e.copyFromBounds(this),e}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=hE,this}set(e,t,n,r){this.minX=e,this.minY=t,this.maxX=n,this.maxY=r}addFrame(e,t,n,r,s){s||(s=this.matrix);const a=s.a,o=s.b,l=s.c,c=s.d,u=s.tx,d=s.ty;let p=this.minX,m=this.minY,g=this.maxX,y=this.maxY,x=a*e+l*t+u,_=o*e+c*t+d;x<p&&(p=x),_<m&&(m=_),x>g&&(g=x),_>y&&(y=_),x=a*n+l*t+u,_=o*n+c*t+d,x<p&&(p=x),_<m&&(m=_),x>g&&(g=x),_>y&&(y=_),x=a*e+l*r+u,_=o*e+c*r+d,x<p&&(p=x),_<m&&(m=_),x>g&&(g=x),_>y&&(y=_),x=a*n+l*r+u,_=o*n+c*r+d,x<p&&(p=x),_<m&&(m=_),x>g&&(g=x),_>y&&(y=_),this.minX=p,this.minY=m,this.maxX=g,this.maxY=y}addRect(e,t){this.addFrame(e.x,e.y,e.x+e.width,e.y+e.height,t)}addBounds(e,t){this.addFrame(e.minX,e.minY,e.maxX,e.maxY,t)}addBoundsMask(e){this.minX=this.minX>e.minX?this.minX:e.minX,this.minY=this.minY>e.minY?this.minY:e.minY,this.maxX=this.maxX<e.maxX?this.maxX:e.maxX,this.maxY=this.maxY<e.maxY?this.maxY:e.maxY}applyMatrix(e){const t=this.minX,n=this.minY,r=this.maxX,s=this.maxY,{a,b:o,c:l,d:c,tx:u,ty:d}=e;let p=a*t+l*n+u,m=o*t+c*n+d;this.minX=p,this.minY=m,this.maxX=p,this.maxY=m,p=a*r+l*n+u,m=o*r+c*n+d,this.minX=p<this.minX?p:this.minX,this.minY=m<this.minY?m:this.minY,this.maxX=p>this.maxX?p:this.maxX,this.maxY=m>this.maxY?m:this.maxY,p=a*t+l*s+u,m=o*t+c*s+d,this.minX=p<this.minX?p:this.minX,this.minY=m<this.minY?m:this.minY,this.maxX=p>this.maxX?p:this.maxX,this.maxY=m>this.maxY?m:this.maxY,p=a*r+l*s+u,m=o*r+c*s+d,this.minX=p<this.minX?p:this.minX,this.minY=m<this.minY?m:this.minY,this.maxX=p>this.maxX?p:this.maxX,this.maxY=m>this.maxY?m:this.maxY}fit(e){return this.minX<e.left&&(this.minX=e.left),this.maxX>e.right&&(this.maxX=e.right),this.minY<e.top&&(this.minY=e.top),this.maxY>e.bottom&&(this.maxY=e.bottom),this}fitBounds(e,t,n,r){return this.minX<e&&(this.minX=e),this.maxX>t&&(this.maxX=t),this.minY<n&&(this.minY=n),this.maxY>r&&(this.maxY=r),this}pad(e,t=e){return this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new mo(this.minX,this.minY,this.maxX,this.maxY)}scale(e,t=e){return this.minX*=e,this.minY*=t,this.maxX*=e,this.maxY*=t,this}get x(){return this.minX}set x(e){const t=this.maxX-this.minX;this.minX=e,this.maxX=e+t}get y(){return this.minY}set y(e){const t=this.maxY-this.minY;this.minY=e,this.maxY=e+t}get width(){return this.maxX-this.minX}set width(e){this.maxX=this.minX+e}get height(){return this.maxY-this.minY}set height(e){this.maxY=this.minY+e}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(e,t,n,r){let s=this.minX,a=this.minY,o=this.maxX,l=this.maxY;r||(r=this.matrix);const c=r.a,u=r.b,d=r.c,p=r.d,m=r.tx,g=r.ty;for(let y=t;y<n;y+=2){const x=e[y],_=e[y+1],S=c*x+d*_+m,w=u*x+p*_+g;s=S<s?S:s,a=w<a?w:a,o=S>o?S:o,l=w>l?w:l}this.minX=s,this.minY=a,this.maxX=o,this.maxY=l}containsPoint(e,t){return this.minX<=e&&this.minY<=t&&this.maxX>=e&&this.maxY>=t}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(e){return this.minX=e.minX,this.minY=e.minY,this.maxX=e.maxX,this.maxY=e.maxY,this}}var cZ={grad:.9,turn:360,rad:360/(2*Math.PI)},El=function(i){return typeof i=="string"?i.length>0:typeof i=="number"},ar=function(i,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*i)/t+0},Ra=function(i,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),i>t?t:i>e?i:e},dz=function(i){return(i=isFinite(i)?i%360:0)>0?i:i+360},dE=function(i){return{r:Ra(i.r,0,255),g:Ra(i.g,0,255),b:Ra(i.b,0,255),a:Ra(i.a)}},B3=function(i){return{r:ar(i.r),g:ar(i.g),b:ar(i.b),a:ar(i.a,3)}},uZ=/^#([0-9a-f]{3,8})$/i,Zx=function(i){var e=i.toString(16);return e.length<2?"0"+e:e},fz=function(i){var e=i.r,t=i.g,n=i.b,r=i.a,s=Math.max(e,t,n),a=s-Math.min(e,t,n),o=a?s===e?(t-n)/a:s===t?2+(n-e)/a:4+(e-t)/a:0;return{h:60*(o<0?o+6:o),s:s?a/s*100:0,v:s/255*100,a:r}},pz=function(i){var e=i.h,t=i.s,n=i.v,r=i.a;e=e/360*6,t/=100,n/=100;var s=Math.floor(e),a=n*(1-t),o=n*(1-(e-s)*t),l=n*(1-(1-e+s)*t),c=s%6;return{r:255*[n,o,a,a,l,n][c],g:255*[l,n,n,o,a,a][c],b:255*[a,a,l,n,n,o][c],a:r}},fE=function(i){return{h:dz(i.h),s:Ra(i.s,0,100),l:Ra(i.l,0,100),a:Ra(i.a)}},pE=function(i){return{h:ar(i.h),s:ar(i.s),l:ar(i.l),a:ar(i.a,3)}},mE=function(i){return pz((t=(e=i).s,{h:e.h,s:(t*=((n=e.l)<50?n:100-n)/100)>0?2*t/(n+t)*100:0,v:n+t,a:e.a}));var e,t,n},om=function(i){return{h:(e=fz(i)).h,s:(r=(200-(t=e.s))*(n=e.v)/100)>0&&r<200?t*n/100/(r<=100?r:200-r)*100:0,l:r/2,a:e.a};var e,t,n,r},hZ=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,dZ=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,fZ=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,pZ=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,NM={string:[[function(i){var e=uZ.exec(i);return e?(i=e[1]).length<=4?{r:parseInt(i[0]+i[0],16),g:parseInt(i[1]+i[1],16),b:parseInt(i[2]+i[2],16),a:i.length===4?ar(parseInt(i[3]+i[3],16)/255,2):1}:i.length===6||i.length===8?{r:parseInt(i.substr(0,2),16),g:parseInt(i.substr(2,2),16),b:parseInt(i.substr(4,2),16),a:i.length===8?ar(parseInt(i.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(i){var e=fZ.exec(i)||pZ.exec(i);return e?e[2]!==e[4]||e[4]!==e[6]?null:dE({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(i){var e=hZ.exec(i)||dZ.exec(i);if(!e)return null;var t,n,r=fE({h:(t=e[1],n=e[2],n===void 0&&(n="deg"),Number(t)*(cZ[n]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return mE(r)},"hsl"]],object:[[function(i){var e=i.r,t=i.g,n=i.b,r=i.a,s=r===void 0?1:r;return El(e)&&El(t)&&El(n)?dE({r:Number(e),g:Number(t),b:Number(n),a:Number(s)}):null},"rgb"],[function(i){var e=i.h,t=i.s,n=i.l,r=i.a,s=r===void 0?1:r;if(!El(e)||!El(t)||!El(n))return null;var a=fE({h:Number(e),s:Number(t),l:Number(n),a:Number(s)});return mE(a)},"hsl"],[function(i){var e=i.h,t=i.s,n=i.v,r=i.a,s=r===void 0?1:r;if(!El(e)||!El(t)||!El(n))return null;var a=(function(o){return{h:dz(o.h),s:Ra(o.s,0,100),v:Ra(o.v,0,100),a:Ra(o.a)}})({h:Number(e),s:Number(t),v:Number(n),a:Number(s)});return pz(a)},"hsv"]]},gE=function(i,e){for(var t=0;t<e.length;t++){var n=e[t][0](i);if(n)return[n,e[t][1]]}return[null,void 0]},mZ=function(i){return typeof i=="string"?gE(i.trim(),NM.string):typeof i=="object"&&i!==null?gE(i,NM.object):[null,void 0]},H3=function(i,e){var t=om(i);return{h:t.h,s:Ra(t.s+100*e,0,100),l:t.l,a:t.a}},j3=function(i){return(299*i.r+587*i.g+114*i.b)/1e3/255},xE=function(i,e){var t=om(i);return{h:t.h,s:t.s,l:Ra(t.l+100*e,0,100),a:t.a}},LM=(function(){function i(e){this.parsed=mZ(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return i.prototype.isValid=function(){return this.parsed!==null},i.prototype.brightness=function(){return ar(j3(this.rgba),2)},i.prototype.isDark=function(){return j3(this.rgba)<.5},i.prototype.isLight=function(){return j3(this.rgba)>=.5},i.prototype.toHex=function(){return e=B3(this.rgba),t=e.r,n=e.g,r=e.b,a=(s=e.a)<1?Zx(ar(255*s)):"","#"+Zx(t)+Zx(n)+Zx(r)+a;var e,t,n,r,s,a},i.prototype.toRgb=function(){return B3(this.rgba)},i.prototype.toRgbString=function(){return e=B3(this.rgba),t=e.r,n=e.g,r=e.b,(s=e.a)<1?"rgba("+t+", "+n+", "+r+", "+s+")":"rgb("+t+", "+n+", "+r+")";var e,t,n,r,s},i.prototype.toHsl=function(){return pE(om(this.rgba))},i.prototype.toHslString=function(){return e=pE(om(this.rgba)),t=e.h,n=e.s,r=e.l,(s=e.a)<1?"hsla("+t+", "+n+"%, "+r+"%, "+s+")":"hsl("+t+", "+n+"%, "+r+"%)";var e,t,n,r,s},i.prototype.toHsv=function(){return e=fz(this.rgba),{h:ar(e.h),s:ar(e.s),v:ar(e.v),a:ar(e.a,3)};var e},i.prototype.invert=function(){return Po({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},i.prototype.saturate=function(e){return e===void 0&&(e=.1),Po(H3(this.rgba,e))},i.prototype.desaturate=function(e){return e===void 0&&(e=.1),Po(H3(this.rgba,-e))},i.prototype.grayscale=function(){return Po(H3(this.rgba,-1))},i.prototype.lighten=function(e){return e===void 0&&(e=.1),Po(xE(this.rgba,e))},i.prototype.darken=function(e){return e===void 0&&(e=.1),Po(xE(this.rgba,-e))},i.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},i.prototype.alpha=function(e){return typeof e=="number"?Po({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):ar(this.rgba.a,3);var t},i.prototype.hue=function(e){var t=om(this.rgba);return typeof e=="number"?Po({h:e,s:t.s,l:t.l,a:t.a}):ar(t.h)},i.prototype.isEqual=function(e){return this.toHex()===Po(e).toHex()},i})(),Po=function(i){return i instanceof LM?i:new LM(i)},yE=[],gZ=function(i){i.forEach(function(e){yE.indexOf(e)<0&&(e(LM,NM),yE.push(e))})};function xZ(i,e){var t={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var r in t)n[t[r]]=r;var s={};i.prototype.toName=function(a){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var o,l,c=n[this.toHex()];if(c)return c;if(a?.closest){var u=this.toRgb(),d=1/0,p="black";if(!s.length)for(var m in t)s[m]=new i(t[m]).toRgb();for(var g in t){var y=(o=u,l=s[g],Math.pow(o.r-l.r,2)+Math.pow(o.g-l.g,2)+Math.pow(o.b-l.b,2));y<d&&(d=y,p=g)}return p}},e.string.push([function(a){var o=a.toLowerCase(),l=o==="transparent"?"#0000":t[o];return l?new i(l).toRgb():null},"name"])}gZ([xZ]);const Qf=class Wp{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Wp)this._value=this._cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,e))&&(this._value=this._cloneSource(e),this._normalize(this._value))}}get value(){return this._value}_cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}_isSourceEqual(e,t){const n=typeof e;if(n!==typeof t)return!1;if(n==="number"||n==="string"||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length!==t.length?!1:e.every((s,a)=>s===t[a]);if(e!==null&&t!==null){const s=Object.keys(e),a=Object.keys(t);return s.length!==a.length?!1:s.every(o=>e[o]===t[o])}return e===t}toRgba(){const[e,t,n,r]=this._components;return{r:e,g:t,b:n,a:r}}toRgb(){const[e,t,n]=this._components;return{r:e,g:t,b:n}}toRgbaString(){const[e,t,n]=this.toUint8RgbArray();return`rgba(${e},${t},${n},${this.alpha})`}toUint8RgbArray(e){const[t,n,r]=this._components;return this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb),e[0]=Math.round(t*255),e[1]=Math.round(n*255),e[2]=Math.round(r*255),e}toArray(e){this._arrayRgba||(this._arrayRgba=[]),e||(e=this._arrayRgba);const[t,n,r,s]=this._components;return e[0]=t,e[1]=n,e[2]=r,e[3]=s,e}toRgbArray(e){this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb);const[t,n,r]=this._components;return e[0]=t,e[1]=n,e[2]=r,e}toNumber(){return this._int}toBgrNumber(){const[e,t,n]=this.toUint8RgbArray();return(n<<16)+(t<<8)+e}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[t,n,r,s]=Wp._temp.setValue(e)._components;return this._components[0]*=t,this._components[1]*=n,this._components[2]*=r,this._components[3]*=s,this._refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this._refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(e===1)return(255<<24)+this._int;if(e===0)return t?0:this._int;let n=this._int>>16&255,r=this._int>>8&255,s=this._int&255;return t&&(n=n*e+.5|0,r=r*e+.5|0,s=s*e+.5|0),(e*255<<24)+(n<<16)+(r<<8)+s}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(e){return this._components[3]=this._clamp(e),this}_normalize(e){let t,n,r,s;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const a=e;t=(a>>16&255)/255,n=(a>>8&255)/255,r=(a&255)/255,s=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[t,n,r,s=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[t,n,r,s=255]=e,t/=255,n/=255,r/=255,s/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const o=Wp.HEX_PATTERN.exec(e);o&&(e=`#${o[2]}`)}const a=Po(e);a.isValid()&&({r:t,g:n,b:r,a:s}=a.rgba,t/=255,n/=255,r/=255)}if(t!==void 0)this._components[0]=t,this._components[1]=n,this._components[2]=r,this._components[3]=s,this._refreshInt();else throw new Error(`Unable to convert color ${e}`)}_refreshInt(){this._clamp(this._components);const[e,t,n]=this._components;this._int=(e*255<<16)+(t*255<<8)+(n*255|0)}_clamp(e,t=0,n=1){return typeof e=="number"?Math.min(Math.max(e,t),n):(e.forEach((r,s)=>{e[s]=Math.min(Math.max(r,t),n)}),e)}static isColorLike(e){return typeof e=="number"||typeof e=="string"||e instanceof Number||e instanceof Wp||Array.isArray(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e.r!==void 0&&e.g!==void 0&&e.b!==void 0||e.r!==void 0&&e.g!==void 0&&e.b!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0&&e.a!==void 0}};Qf.shared=new Qf;Qf._temp=new Qf;Qf.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Wi=Qf;const yZ={cullArea:null,cullable:!1,cullableChildren:!0};let V3=0;const vE=500;function Hr(...i){V3!==vE&&(V3++,V3===vE?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...i))}const Bg={_registeredResources:new Set,register(i){this._registeredResources.add(i)},unregister(i){this._registeredResources.delete(i)},release(){this._registeredResources.forEach(i=>i.clear())},get registeredCount(){return this._registeredResources.size},isRegistered(i){return this._registeredResources.has(i)},reset(){this._registeredResources.clear()}};class vZ{constructor(e,t){this._pool=[],this._count=0,this._index=0,this._classType=e,t&&this.prepopulate(t)}prepopulate(e){for(let t=0;t<e;t++)this._pool[this._index++]=new this._classType;this._count+=e}get(e){let t;return this._index>0?t=this._pool[--this._index]:(t=new this._classType,this._count++),t.init?.(e),t}return(e){e.reset?.(),this._pool[this._index++]=e}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){if(this._pool.length>0&&this._pool[0].destroy)for(let e=0;e<this._index;e++)this._pool[e].destroy();this._pool.length=0,this._count=0,this._index=0}}class bZ{constructor(){this._poolsByClass=new Map}prepopulate(e,t){this.getPool(e).prepopulate(t)}get(e,t){return this.getPool(e).get(t)}return(e){this.getPool(e.constructor).return(e)}getPool(e){return this._poolsByClass.has(e)||this._poolsByClass.set(e,new vZ(e)),this._poolsByClass.get(e)}stats(){const e={};return this._poolsByClass.forEach(t=>{const n=e[t._classType.name]?t._classType.name+t._classType.ID:t._classType.name;e[n]={free:t.totalFree,used:t.totalUsed,size:t.totalSize}}),e}clear(){this._poolsByClass.forEach(e=>e.clear()),this._poolsByClass.clear()}}const ka=new bZ;Bg.register(ka);const _Z={get isCachedAsTexture(){return!!this.renderGroup?.isCachedAsTexture},cacheAsTexture(i){typeof i=="boolean"&&i===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(i===!0?{}:i))},updateCacheTexture(){this.renderGroup?.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(i){Tn("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(i)}};function SZ(i,e,t){const n=i.length;let r;if(e>=n||t===0)return;t=e+t>n?n-e:t;const s=n-t;for(r=e;r<s;++r)i[r]=i[r+t];i.length=s}const wZ={allowChildren:!0,removeChildren(i=0,e){const t=e??this.children.length,n=t-i,r=[];if(n>0&&n<=t){for(let a=t-1;a>=i;a--){const o=this.children[a];o&&(r.push(o),o.parent=null)}SZ(this.children,i,t);const s=this.renderGroup||this.parentRenderGroup;s&&s.removeChildren(r);for(let a=0;a<r.length;++a){const o=r[a];o.parentRenderLayer?.detach(o),this.emit("childRemoved",o,this,a),r[a].emit("removed",this)}return r.length>0&&this._didViewChangeTick++,r}else if(n===0&&this.children.length===0)return r;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(i){const e=this.getChildAt(i);return this.removeChild(e)},getChildAt(i){if(i<0||i>=this.children.length)throw new Error(`getChildAt: Index (${i}) does not exist.`);return this.children[i]},setChildIndex(i,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);this.getChildIndex(i),this.addChildAt(i,e)},getChildIndex(i){const e=this.children.indexOf(i);if(e===-1)throw new Error("The supplied Container must be a child of the caller");return e},addChildAt(i,e){this.allowChildren||Tn(wi,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:t}=this;if(e<0||e>t.length)throw new Error(`${i}addChildAt: The index ${e} supplied is out of bounds ${t.length}`);if(i.parent){const r=i.parent.children.indexOf(i);if(i.parent===this&&r===e)return i;r!==-1&&i.parent.children.splice(r,1)}e===t.length?t.push(i):t.splice(e,0,i),i.parent=this,i.didChange=!0,i._updateFlags=15;const n=this.renderGroup||this.parentRenderGroup;return n&&n.addChild(i),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",i,this,e),i.emit("added",this),i},swapChildren(i,e){if(i===e)return;const t=this.getChildIndex(i),n=this.getChildIndex(e);this.children[t]=e,this.children[n]=i;const r=this.renderGroup||this.parentRenderGroup;r&&(r.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...i){return i.length===1?this.reparentChildAt(i[0],this.children.length):(i.forEach(e=>this.reparentChildAt(e,this.children.length)),i[0])},reparentChildAt(i,e){if(i.parent===this)return this.setChildIndex(i,e),i;const t=i.worldTransform.clone();i.removeFromParent(),this.addChildAt(i,e);const n=this.worldTransform.clone();return n.invert(),t.prepend(n),i.setFromMatrix(t),i},replaceChild(i,e){i.updateLocalTransform(),this.addChildAt(e,this.getChildIndex(i)),e.setFromMatrix(i.localTransform),e.updateLocalTransform(),this.removeChild(i)}},MZ={collectRenderables(i,e,t){this.parentRenderLayer&&this.parentRenderLayer!==t||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(i,e,t):this.renderGroup?e.renderPipes.renderGroup.addRenderGroup(this.renderGroup,i):this.collectRenderablesWithEffects(i,e,t))},collectRenderablesSimple(i,e,t){const n=this.children,r=n.length;for(let s=0;s<r;s++)n[s].collectRenderables(i,e,t)},collectRenderablesWithEffects(i,e,t){const{renderPipes:n}=e;for(let r=0;r<this.effects.length;r++){const s=this.effects[r];n[s.pipe].push(s,this,i)}this.collectRenderablesSimple(i,e,t);for(let r=this.effects.length-1;r>=0;r--){const s=this.effects[r];n[s.pipe].pop(s,this,i)}}};class bE{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let e=0;e<this.filters.length;e++)this.filters[e].destroy();this.filters=null,this.filterArea=null}}class TZ{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(e=>{this.add({test:e.test,maskClass:e})}))}add(e){this._tests.push(e)}getMaskEffect(e){this._initialized||this.init();for(let t=0;t<this._tests.length;t++){const n=this._tests[t];if(n.test(e))return ka.get(n.maskClass,e)}return e}returnMaskEffect(e){ka.return(e)}}const kM=new TZ;Es.handleByList(In.MaskEffect,kM._effectClasses);const AZ={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const i=this.renderGroup||this.parentRenderGroup;i&&(i.structureDidChange=!0)},addEffect(i){this.effects.indexOf(i)===-1&&(this.effects.push(i),this.effects.sort((t,n)=>t.priority-n.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(i){const e=this.effects.indexOf(i);e!==-1&&(this.effects.splice(e,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(i){const e=this._maskEffect;e?.mask!==i&&(e&&(this.removeEffect(e),kM.returnMaskEffect(e),this._maskEffect=null),i!=null&&(this._maskEffect=kM.getMaskEffect(i),this.addEffect(this._maskEffect)))},get mask(){return this._maskEffect?.mask},setMask(i){this._maskOptions={...this._maskOptions,...i},i.mask&&(this.mask=i.mask),this._markStructureAsChanged()},set filters(i){!Array.isArray(i)&&i&&(i=[i]);const e=this._filterEffect||(this._filterEffect=new bE);i=i;const t=i?.length>0,n=e.filters?.length>0,r=t!==n;i=Array.isArray(i)?i.slice(0):i,e.filters=Object.freeze(i),r&&(t?this.addEffect(e):(this.removeEffect(e),e.filters=i??null))},get filters(){return this._filterEffect?.filters},set filterArea(i){this._filterEffect||(this._filterEffect=new bE),this._filterEffect.filterArea=i},get filterArea(){return this._filterEffect?.filterArea}},CZ={label:null,get name(){return Tn(wi,"Container.name property has been removed, use Container.label instead"),this.label},set name(i){Tn(wi,"Container.name property has been removed, use Container.label instead"),this.label=i},getChildByName(i,e=!1){return this.getChildByLabel(i,e)},getChildByLabel(i,e=!1){const t=this.children;for(let n=0;n<t.length;n++){const r=t[n];if(r.label===i||i instanceof RegExp&&i.test(r.label))return r}if(e)for(let n=0;n<t.length;n++){const s=t[n].getChildByLabel(i,!0);if(s)return s}return null},getChildrenByLabel(i,e=!1,t=[]){const n=this.children;for(let r=0;r<n.length;r++){const s=n[r];(s.label===i||i instanceof RegExp&&i.test(s.label))&&t.push(s)}if(e)for(let r=0;r<n.length;r++)n[r].getChildrenByLabel(i,!0,t);return t}},ts=ka.getPool(hn),tc=ka.getPool(mo),EZ=new hn,RZ={getFastGlobalBounds(i,e){e||(e=new mo),e.clear(),this._getGlobalBoundsRecursive(!!i,e,this.parentRenderLayer),e.isValid||e.set(0,0,0,0);const t=this.renderGroup||this.parentRenderGroup;return e.applyMatrix(t.worldTransform),e},_getGlobalBoundsRecursive(i,e,t){let n=e;if(i&&this.parentRenderLayer&&this.parentRenderLayer!==t||this.localDisplayStatus!==7||!this.measurable)return;const r=!!this.effects.length;if((this.renderGroup||r)&&(n=tc.get().clear()),this.boundsArea)e.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const a=this.bounds;n.addFrame(a.minX,a.minY,a.maxX,a.maxY,this.groupTransform)}const s=this.children;for(let a=0;a<s.length;a++)s[a]._getGlobalBoundsRecursive(i,n,t)}if(r){let s=!1;const a=this.renderGroup||this.parentRenderGroup;for(let o=0;o<this.effects.length;o++)this.effects[o].addBounds&&(s||(s=!0,n.applyMatrix(a.worldTransform)),this.effects[o].addBounds(n,!0));s&&n.applyMatrix(a.worldTransform.copyTo(EZ).invert()),e.addBounds(n),tc.return(n)}else this.renderGroup&&(e.addBounds(n,this.relativeGroupTransform),tc.return(n))}};function mz(i,e,t){t.clear();let n,r;return i.parent?e?n=i.parent.worldTransform:(r=ts.get().identity(),n=pT(i,r)):n=hn.IDENTITY,gz(i,t,n,e),r&&ts.return(r),t.isValid||t.set(0,0,0,0),t}function gz(i,e,t,n){if(!i.visible||!i.measurable)return;let r;n?r=i.worldTransform:(i.updateLocalTransform(),r=ts.get(),r.appendFrom(i.localTransform,t));const s=e,a=!!i.effects.length;if(a&&(e=tc.get().clear()),i.boundsArea)e.addRect(i.boundsArea,r);else{const o=i.bounds;o&&!o.isEmpty()&&(e.matrix=r,e.addBounds(o));for(let l=0;l<i.children.length;l++)gz(i.children[l],e,r,n)}if(a){for(let o=0;o<i.effects.length;o++)i.effects[o].addBounds?.(e);s.addBounds(e,hn.IDENTITY),tc.return(e)}n||ts.return(r)}function pT(i,e){const t=i.parent;return t&&(pT(t,e),t.updateLocalTransform(),e.append(t.localTransform)),e}function xz(i,e){if(i===16777215||!e)return e;if(e===16777215||!i)return i;const t=i>>16&255,n=i>>8&255,r=i&255,s=e>>16&255,a=e>>8&255,o=e&255,l=t*s/255|0,c=n*a/255|0,u=r*o/255|0;return(l<<16)+(c<<8)+u}const _E=16777215;function SE(i,e){return i===_E?e:e===_E?i:xz(i,e)}function Ey(i){return((i&255)<<16)+(i&65280)+(i>>16&255)}const PZ={getGlobalAlpha(i){if(i)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let e=this.alpha,t=this.parent;for(;t;)e*=t.alpha,t=t.parent;return e},getGlobalTransform(i=new hn,e){if(e)return i.copyFrom(this.worldTransform);this.updateLocalTransform();const t=pT(this,ts.get().identity());return i.appendFrom(this.localTransform,t),ts.return(t),i},getGlobalTint(i){if(i)return this.renderGroup?Ey(this.renderGroup.worldColor):this.parentRenderGroup?Ey(SE(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let e=this.localColor,t=this.parent;for(;t;)e=SE(e,t.localColor),t=t.parent;return Ey(e)}};function yz(i,e,t){return e.clear(),t||(t=hn.IDENTITY),vz(i,e,t,i,!0),e.isValid||e.set(0,0,0,0),e}function vz(i,e,t,n,r){let s;if(r)s=ts.get(),s=t.copyTo(s);else{if(!i.visible||!i.measurable)return;i.updateLocalTransform();const l=i.localTransform;s=ts.get(),s.appendFrom(l,t)}const a=e,o=!!i.effects.length;if(o&&(e=tc.get().clear()),i.boundsArea)e.addRect(i.boundsArea,s);else{i.renderPipeId&&(e.matrix=s,e.addBounds(i.bounds));const l=i.children;for(let c=0;c<l.length;c++)vz(l[c],e,s,n,!1)}if(o){for(let l=0;l<i.effects.length;l++)i.effects[l].addLocalBounds?.(e,n);a.addBounds(e,hn.IDENTITY),tc.return(e)}ts.return(s)}function bz(i,e){const t=i.children;for(let n=0;n<t.length;n++){const r=t[n],s=r.uid,a=(r._didViewChangeTick&65535)<<16|r._didContainerChangeTick&65535,o=e.index;(e.data[o]!==s||e.data[o+1]!==a)&&(e.data[e.index]=s,e.data[e.index+1]=a,e.didChange=!0),e.index=o+2,r.children.length&&bz(r,e)}return e.didChange}const IZ=new hn,DZ={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(i,e){const t=Math.sign(this.scale.x)||1;e!==0?this.scale.x=i/e*t:this.scale.x=t},_setHeight(i,e){const t=Math.sign(this.scale.y)||1;e!==0?this.scale.y=i/e*t:this.scale.y=t},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new mo});const i=this._localBoundsCacheData;return i.index=1,i.didChange=!1,i.data[0]!==this._didViewChangeTick&&(i.didChange=!0,i.data[0]=this._didViewChangeTick),bz(this,i),i.didChange&&yz(this,i.localBounds,IZ),i.localBounds},getBounds(i,e){return mz(this,i,e||new mo)}},NZ={_onRender:null,set onRender(i){const e=this.renderGroup||this.parentRenderGroup;if(!i){this._onRender&&e?.removeOnRender(this),this._onRender=null;return}this._onRender||e?.addOnRender(this),this._onRender=i},get onRender(){return this._onRender}},LZ={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(i){this._zIndex!==i&&(this._zIndex=i,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(kZ))}};function kZ(i,e){return i._zIndex-e._zIndex}const OZ={getGlobalPosition(i=new Sn,e=!1){return this.parent?this.parent.toGlobal(this._position,i,e):(i.x=this._position.x,i.y=this._position.y),i},toGlobal(i,e,t=!1){const n=this.getGlobalTransform(ts.get(),t);return e=n.apply(i,e),ts.return(n),e},toLocal(i,e,t,n){e&&(i=e.toGlobal(i,t,n));const r=this.getGlobalTransform(ts.get(),n);return t=r.applyInverse(i,t),ts.return(r),t}};class _z{constructor(){this.uid=Mi("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}destroy(){this.instructions.length=0,this.renderables.length=0,this.renderPipes=null,this.gcTick=0}add(e){this.instructions[this.instructionSize++]=e}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let zZ=0;class UZ{constructor(e){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this.textureStyle=new Yy(this.textureOptions)}createTexture(e,t,n){const r=new yo({...this.textureOptions,width:e,height:t,resolution:1,antialias:n,autoGarbageCollect:!1});return new cn({source:r,label:`texturePool_${zZ++}`})}getOptimalTexture(e,t,n=1,r){let s=Math.ceil(e*n-1e-6),a=Math.ceil(t*n-1e-6);s=Zf(s),a=Zf(a);const o=(s<<17)+(a<<1)+(r?1:0);this._texturePool[o]||(this._texturePool[o]=[]);let l=this._texturePool[o].pop();return l||(l=this.createTexture(s,a,r)),l.source._resolution=n,l.source.width=s/n,l.source.height=a/n,l.source.pixelWidth=s,l.source.pixelHeight=a,l.frame.x=0,l.frame.y=0,l.frame.width=e,l.frame.height=t,l.updateUvs(),this._poolKeyHash[l.uid]=o,l}getSameSizeTexture(e,t=!1){const n=e.source;return this.getOptimalTexture(e.width,e.height,n._resolution,t)}returnTexture(e,t=!1){const n=this._poolKeyHash[e.uid];t&&(e.source.style=this.textureStyle),this._texturePool[n].push(e)}clear(e){if(e=e!==!1,e)for(const t in this._texturePool){const n=this._texturePool[t];if(n)for(let r=0;r<n.length;r++)n[r].destroy(!0)}this._texturePool={}}}const Sz=new UZ;Bg.register(Sz);class FZ{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new hn,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new _z,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(e){this.root=e,e._onRender&&this.addOnRender(e),e.didChange=!0;const t=e.children;for(let n=0;n<t.length;n++){const r=t[n];r._updateFlags=15,this.addChild(r)}}enableCacheAsTexture(e={}){this.textureOptions=e,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(Sz.returnTexture(this.texture,!0),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0;const e=this._parentCacheAsTextureRenderGroup;e&&!e.textureNeedsUpdate&&e.updateCacheTexture()}reset(){this.renderGroupChildren.length=0;for(const e in this.childrenToUpdate){const t=this.childrenToUpdate[e];t.list.fill(null),t.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(e){e.renderGroupParent&&e.renderGroupParent._removeRenderGroupChild(e),e.renderGroupParent=this,this.renderGroupChildren.push(e)}_removeRenderGroupChild(e){const t=this.renderGroupChildren.indexOf(e);t>-1&&this.renderGroupChildren.splice(t,1),e.renderGroupParent=null}addChild(e){if(this.structureDidChange=!0,e.parentRenderGroup=this,e.updateTick=-1,e.parent===this.root?e.relativeRenderGroupDepth=1:e.relativeRenderGroupDepth=e.parent.relativeRenderGroupDepth+1,e.didChange=!0,this.onChildUpdate(e),e.renderGroup){this.addRenderGroupChild(e.renderGroup);return}e._onRender&&this.addOnRender(e);const t=e.children;for(let n=0;n<t.length;n++)this.addChild(t[n])}removeChild(e){if(this.structureDidChange=!0,e._onRender&&(e.renderGroup||this.removeOnRender(e)),e.parentRenderGroup=null,e.renderGroup){this._removeRenderGroupChild(e.renderGroup);return}const t=e.children;for(let n=0;n<t.length;n++)this.removeChild(t[n])}removeChildren(e){for(let t=0;t<e.length;t++)this.removeChild(e[t])}onChildUpdate(e){let t=this.childrenToUpdate[e.relativeRenderGroupDepth];t||(t=this.childrenToUpdate[e.relativeRenderGroupDepth]={index:0,list:[]}),t.list[t.index++]=e}updateRenderable(e){e.globalDisplayStatus<7||(this.instructionSet.renderPipes[e.renderPipeId].updateRenderable(e),e.didViewUpdate=!1)}onChildViewUpdate(e){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=e}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(e){this._onRenderContainers.push(e)}removeOnRender(e){this._onRenderContainers.splice(this._onRenderContainers.indexOf(e),1)}runOnRender(e){for(let t=0;t<this._onRenderContainers.length;t++)this._onRenderContainers[t]._onRender(e)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(e=[]){const t=this.root.children;for(let n=0;n<t.length;n++)this._getChildren(t[n],e);return e}_getChildren(e,t=[]){if(t.push(e),e.renderGroup)return t;const n=e.children;for(let r=0;r<n.length;r++)this._getChildren(n[r],t);return t}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new hn),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new hn),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const e=this._parentCacheAsTextureRenderGroup;return e?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new hn),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(e.inverseWorldTransform).translate(-e._textureBounds.x,-e._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this.isCachedAsTexture?this.textureOffsetInverseTransform:this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function BZ(i,e,t={}){for(const n in e)!t[n]&&e[n]!==void 0&&(i[n]=e[n])}const G3=new wr(null),Qx=new wr(null),W3=new wr(null,1,1),Jx=new wr(null),wE=1,HZ=2,q3=4;class Fi extends ll{constructor(e={}){super(),this.uid=Mi("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.parentRenderLayer=null,this.updateTick=-1,this.localTransform=new hn,this.relativeGroupTransform=new hn,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new wr(this,0,0),this._scale=W3,this._pivot=Qx,this._origin=Jx,this._skew=G3,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],BZ(this,e,{children:!0,parent:!0,effects:!0}),e.children?.forEach(t=>this.addChild(t)),e.parent?.addChild(this)}static mixin(e){Tn("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),Es.mixin(Fi,e)}set _didChangeId(e){this._didViewChangeTick=e>>12&4095,this._didContainerChangeTick=e&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...e){if(this.allowChildren||Tn(wi,"addChild: Only Containers will be allowed to add children in v8.0.0"),e.length>1){for(let r=0;r<e.length;r++)this.addChild(e[r]);return e[0]}const t=e[0],n=this.renderGroup||this.parentRenderGroup;return t.parent===this?(this.children.splice(this.children.indexOf(t),1),this.children.push(t),n&&(n.structureDidChange=!0),t):(t.parent&&t.parent.removeChild(t),this.children.push(t),this.sortableChildren&&(this.sortDirty=!0),t.parent=this,t.didChange=!0,t._updateFlags=15,n&&n.addChild(t),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this),this._didViewChangeTick++,t._zIndex!==0&&t.depthOfChildModified(),t)}removeChild(...e){if(e.length>1){for(let r=0;r<e.length;r++)this.removeChild(e[r]);return e[0]}const t=e[0],n=this.children.indexOf(t);return n>-1&&(this._didViewChangeTick++,this.children.splice(n,1),this.renderGroup?this.renderGroup.removeChild(t):this.parentRenderGroup&&this.parentRenderGroup.removeChild(t),t.parentRenderLayer&&t.parentRenderLayer.detach(t),t.parent=null,this.emit("childRemoved",t,this,n),t.emit("removed",this)),t}_onUpdate(e){e&&e===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(e){!!this.renderGroup!==e&&(e?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),this.renderGroup=ka.get(FZ,this),this.groupTransform=hn.IDENTITY,e?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),ka.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,e?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new hn),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(e){this._position.x=e}get y(){return this._position.y}set y(e){this._position.y=e}get position(){return this._position}set position(e){this._position.copyFrom(e)}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this._skew))}get angle(){return this.rotation*eZ}set angle(e){this.rotation=e*tZ}get pivot(){return this._pivot===Qx&&(this._pivot=new wr(this,0,0)),this._pivot}set pivot(e){this._pivot===Qx&&(this._pivot=new wr(this,0,0),this._origin!==Jx&&Hr("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof e=="number"?this._pivot.set(e):this._pivot.copyFrom(e)}get skew(){return this._skew===G3&&(this._skew=new wr(this,0,0)),this._skew}set skew(e){this._skew===G3&&(this._skew=new wr(this,0,0)),this._skew.copyFrom(e)}get scale(){return this._scale===W3&&(this._scale=new wr(this,1,1)),this._scale}set scale(e){this._scale===W3&&(this._scale=new wr(this,0,0)),typeof e=="string"&&(e=parseFloat(e)),typeof e=="number"?this._scale.set(e):this._scale.copyFrom(e)}get origin(){return this._origin===Jx&&(this._origin=new wr(this,0,0)),this._origin}set origin(e){this._origin===Jx&&(this._origin=new wr(this,0,0),this._pivot!==Qx&&Hr("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof e=="number"?this._origin.set(e):this._origin.copyFrom(e)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(e){const t=this.getLocalBounds().width;this._setWidth(e,t)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(e){const t=this.getLocalBounds().height;this._setHeight(e,t)}getSize(e){e||(e={});const t=this.getLocalBounds();return e.width=Math.abs(this.scale.x*t.width),e.height=Math.abs(this.scale.y*t.height),e}setSize(e,t){const n=this.getLocalBounds();typeof e=="object"?(t=e.height??e.width,e=e.width):t??(t=e),e!==void 0&&this._setWidth(e,n.width),t!==void 0&&this._setHeight(t,n.height)}_updateSkew(){const e=this._rotation,t=this._skew;this._cx=Math.cos(e+t._y),this._sx=Math.sin(e+t._y),this._cy=-Math.sin(e-t._x),this._sy=Math.cos(e-t._x)}updateTransform(e){return this.position.set(typeof e.x=="number"?e.x:this.position.x,typeof e.y=="number"?e.y:this.position.y),this.scale.set(typeof e.scaleX=="number"?e.scaleX||1:this.scale.x,typeof e.scaleY=="number"?e.scaleY||1:this.scale.y),this.rotation=typeof e.rotation=="number"?e.rotation:this.rotation,this.skew.set(typeof e.skewX=="number"?e.skewX:this.skew.x,typeof e.skewY=="number"?e.skewY:this.skew.y),this.pivot.set(typeof e.pivotX=="number"?e.pivotX:this.pivot.x,typeof e.pivotY=="number"?e.pivotY:this.pivot.y),this.origin.set(typeof e.originX=="number"?e.originX:this.origin.x,typeof e.originY=="number"?e.originY:this.origin.y),this}setFromMatrix(e){e.decompose(this)}updateLocalTransform(){const e=this._didContainerChangeTick;if(this._didLocalTransformChangeId===e)return;this._didLocalTransformChangeId=e;const t=this.localTransform,n=this._scale,r=this._pivot,s=this._origin,a=this._position,o=n._x,l=n._y,c=r._x,u=r._y,d=-s._x,p=-s._y;t.a=this._cx*o,t.b=this._sx*o,t.c=this._cy*l,t.d=this._sy*l,t.tx=a._x-(c*t.a+u*t.c)+(d*t.a+p*t.c)-d,t.ty=a._y-(c*t.b+u*t.d)+(d*t.b+p*t.d)-p}set alpha(e){e!==this.localAlpha&&(this.localAlpha=e,this._updateFlags|=wE,this._onUpdate())}get alpha(){return this.localAlpha}set tint(e){const n=Wi.shared.setValue(e??16777215).toBgrNumber();n!==this.localColor&&(this.localColor=n,this._updateFlags|=wE,this._onUpdate())}get tint(){return Ey(this.localColor)}set blendMode(e){this.localBlendMode!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=HZ,this.localBlendMode=e,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(e){const t=e?2:0;(this.localDisplayStatus&2)!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=q3,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(e){const t=e?0:4;(this.localDisplayStatus&4)!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=q3,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(e){const t=e?1:0;(this.localDisplayStatus&1)!==t&&(this._updateFlags|=q3,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(e=!1){if(this.destroyed)return;this.destroyed=!0;let t;if(this.children.length&&(t=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._origin=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof e=="boolean"?e:e?.children)&&t)for(let r=0;r<t.length;++r)t[r].destroy(e);this.renderGroup?.destroy(),this.renderGroup=null}}Es.mixin(Fi,wZ,RZ,OZ,NZ,DZ,AZ,CZ,LZ,yZ,_Z,PZ,MZ);class mT extends Fi{constructor(e){super(e),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this._bounds=new mo(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}containsPoint(e){const t=this.bounds,{x:n,y:r}=e;return n>=t.minX&&n<=t.maxX&&r>=t.minY&&r<=t.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}destroy(e){super.destroy(e),this._bounds=null;for(const t in this._gpuData)this._gpuData[t].destroy?.();this._gpuData=null}collectRenderablesSimple(e,t,n){const{renderPipes:r}=t;r.blendMode.pushBlendMode(this,this.groupBlendMode,e),r[this.renderPipeId].addRenderable(this,e),this.didViewUpdate=!1;const a=this.children,o=a.length;for(let l=0;l<o;l++)a[l].collectRenderables(e,t,n);r.blendMode.popBlendMode(e)}}let $y=class OM extends mT{constructor(e=cn.EMPTY){e instanceof cn&&(e={texture:e});const{texture:t=cn.EMPTY,anchor:n,roundPixels:r,width:s,height:a,...o}=e;super({label:"Sprite",...o}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new wr({_onUpdate:()=>{this.onViewUpdate()}}),n?this.anchor=n:t.defaultAnchor&&(this.anchor=t.defaultAnchor),this.texture=t,this.allowChildren=!1,this.roundPixels=r??!1,s!==void 0&&(this.width=s),a!==void 0&&(this.height=a)}static from(e,t=!1){return e instanceof cn?new OM(e):new OM(cn.from(e,t))}set texture(e){e||(e=cn.EMPTY);const t=this._texture;t!==e&&(t&&t.dynamic&&t.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return lZ(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return Tn("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const e=this._anchor,t=this._texture,n=this._bounds,{width:r,height:s}=t.orig;n.minX=-e._x*r,n.maxX=n.minX+r,n.minY=-e._y*s,n.maxY=n.minY+s}destroy(e=!1){if(super.destroy(e),typeof e=="boolean"?e:e?.texture){const n=typeof e=="boolean"?e:e?.textureSource;this._texture.destroy(n)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null,this._gpuData=null}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this._setWidth(e,this._texture.orig.width),this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this._setHeight(e,this._texture.orig.height),this._height=e}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this._texture.orig.width,e.height=Math.abs(this.scale.y)*this._texture.orig.height,e}setSize(e,t){typeof e=="object"?(t=e.height??e.width,e=e.width):t??(t=e),e!==void 0&&this._setWidth(e,this._texture.orig.width),t!==void 0&&this._setHeight(t,this._texture.orig.height)}};const jZ=new mo;function wz(i,e,t){const n=jZ;i.measurable=!0,mz(i,t,n),e.addBoundsMask(n),i.measurable=!1}function Mz(i,e,t){const n=tc.get();i.measurable=!0;const r=ts.get().identity(),s=Tz(i,t,r);yz(i,n,s),i.measurable=!1,e.addBoundsMask(n),ts.return(r),tc.return(n)}function Tz(i,e,t){return i?(i!==e&&(Tz(i.parent,e,t),i.updateLocalTransform(),t.append(i.localTransform)),t):(Hr("Mask bounds, renderable is not inside the root container"),t)}class Az{constructor(e){this.priority=0,this.inverse=!1,this.pipe="alphaMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.renderMaskToTexture=!(e instanceof $y),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask=null)}addBounds(e,t){this.inverse||wz(this.mask,e,t)}addLocalBounds(e,t){Mz(this.mask,e,t)}containsPoint(e,t){const n=this.mask;return t(n,e)}destroy(){this.reset()}static test(e){return e instanceof $y}}Az.extension=In.MaskEffect;class Cz{constructor(e){this.priority=0,this.pipe="colorMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e}destroy(){}static test(e){return typeof e=="number"}}Cz.extension=In.MaskEffect;class Ez{constructor(e){this.priority=0,this.pipe="stencilMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null)}addBounds(e,t){wz(this.mask,e,t)}addLocalBounds(e,t){Mz(this.mask,e,t)}containsPoint(e,t){const n=this.mask;return t(n,e)}destroy(){this.reset()}static test(e){return e instanceof Fi}}Ez.extension=In.MaskEffect;const VZ={createCanvas:(i,e)=>{const t=document.createElement("canvas");return t.width=i,t.height=e,t},createImage:()=>new Image,getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(i,e)=>fetch(i,e),parseXML:i=>new DOMParser().parseFromString(i,"text/xml")};let ME=VZ;const ta={get(){return ME},set(i){ME=i}};class Rz extends yo{constructor(e){e.resource||(e.resource=ta.get().createCanvas()),e.width||(e.width=e.resource.width,e.autoDensity||(e.width/=e.resolution)),e.height||(e.height=e.resource.height,e.autoDensity||(e.height/=e.resolution)),super(e),this.uploadMethodId="image",this.autoDensity=e.autoDensity,this.resizeCanvas(),this.transparent=!!e.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(e=this.width,t=this.height,n=this._resolution){const r=super.resize(e,t,n);return r&&this.resizeCanvas(),r}static test(e){return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&e instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}Rz.extension=In.TextureSource;class Ky extends yo{constructor(e){super(e),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(e){return globalThis.HTMLImageElement&&e instanceof HTMLImageElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||globalThis.VideoFrame&&e instanceof VideoFrame}}Ky.extension=In.TextureSource;var zM=(i=>(i[i.INTERACTION=50]="INTERACTION",i[i.HIGH=25]="HIGH",i[i.NORMAL=0]="NORMAL",i[i.LOW=-25]="LOW",i[i.UTILITY=-50]="UTILITY",i))(zM||{});class X3{constructor(e,t=null,n=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=e,this._context=t,this.priority=n,this._once=r}match(e,t=null){return this._fn===e&&this._context===t}emit(e){this._fn&&(this._context?this._fn.call(this._context,e):this._fn(e));const t=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),t}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const t=this.next;return this.next=e?null:t,this.previous=null,t}}const Pz=class Xs{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new X3(null,null,1/0),this.deltaMS=1/Xs.targetFPMS,this.elapsedMS=1/Xs.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,n=zM.NORMAL){return this._addListener(new X3(e,t,n))}addOnce(e,t,n=zM.NORMAL){return this._addListener(new X3(e,t,n,!0))}_addListener(e){let t=this._head.next,n=this._head;if(!t)e.connect(n);else{for(;t;){if(e.priority>t.priority){e.connect(n);break}n=t,t=t.next}e.previous||e.connect(n)}return this._startIfPossible(),this}remove(e,t){let n=this._head.next;for(;n;)n.match(e,t)?n=n.destroy():n=n.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const s=e-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=e-s%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*Xs.targetFPMS;const n=this._head;let r=n.next;for(;r;)r=r.emit(this);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const t=Math.min(this.maxFPS,e),n=Math.min(Math.max(0,t)/1e3,Xs.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!Xs._shared){const e=Xs._shared=new Xs;e.autoStart=!0,e._protected=!0}return Xs._shared}static get system(){if(!Xs._system){const e=Xs._system=new Xs;e.autoStart=!0,e._protected=!0}return Xs._system}};Pz.targetFPMS=.06;let qp=Pz,Y3;async function GZ(){return Y3??(Y3=(async()=>{const e=ta.get().createCanvas(1,1).getContext("webgl");if(!e)return"premultiply-alpha-on-upload";const t=await new Promise(a=>{const o=document.createElement("video");o.onloadeddata=()=>a(o),o.onerror=()=>a(null),o.autoplay=!1,o.crossOrigin="anonymous",o.preload="auto",o.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",o.load()});if(!t)return"premultiply-alpha-on-upload";const n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);const r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t);const s=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,s),e.deleteFramebuffer(r),e.deleteTexture(n),e.getExtension("WEBGL_lose_context")?.loseContext(),s[0]<=s[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),Y3}const Xb=class Iz extends yo{constructor(e){super(e),this.isReady=!1,this.uploadMethodId="video",e={...Iz.defaultOptions,...e},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this.alphaMode=e.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const e=qp.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const e=this.resource,t=this.options;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(t.preload||e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlayThrough),e.addEventListener("error",this._onError,!0)),this.alphaMode=await GZ(),this._load=new Promise((n,r)=>{this.isValid?n(this):(this._resolve=n,this._reject=r,t.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${t.preloadTimeoutMs}ms`))})),e.load())}),this._load}_onError(e){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.resource;return!e.paused&&!e.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const e=this.resource;this.isValid&&(this.isReady=!0,this.resize(e.videoWidth,e.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const e=this.resource;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlayThrough),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(qp.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(qp.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(qp.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement}};Xb.extension=In.TextureSource;Xb.defaultOptions={...yo.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};Xb.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let WZ=Xb;const Cf=(i,e,t=!1)=>(Array.isArray(i)||(i=[i]),e?i.map(n=>typeof n=="string"||t?e(n):n):i);class qZ{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const t=this._cache.get(e);return t||Hr(`[Assets] Asset id ${e} was not found in the Cache`),t}set(e,t){const n=Cf(e);let r;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.test(t)){r=c.getCacheableAssets(n,t);break}}const s=new Map(Object.entries(r||{}));r||n.forEach(l=>{s.set(l,t)});const a=[...s.keys()],o={cacheKeys:a,keys:n};n.forEach(l=>{this._cacheMap.set(l,o)}),a.forEach(l=>{const c=r?r[l]:t;this._cache.has(l)&&this._cache.get(l)!==c&&Hr("[Cache] already has key:",l),this._cache.set(l,s.get(l))})}remove(e){if(!this._cacheMap.has(e)){Hr(`[Assets] Asset id ${e} was not found in the Cache`);return}const t=this._cacheMap.get(e);t.cacheKeys.forEach(r=>{this._cache.delete(r)}),t.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const Ef=new qZ,UM=[];Es.handleByList(In.TextureSource,UM);function Dz(i={}){const e=i&&i.resource,t=e?i.resource:i,n=e?i:{resource:i};for(let r=0;r<UM.length;r++){const s=UM[r];if(s.test(t))return new s(n)}throw new Error(`Could not find a source type for resource: ${n.resource}`)}function XZ(i={},e=!1){const t=i&&i.resource,n=t?i.resource:i,r=t?i:{resource:i};if(!e&&Ef.has(n))return Ef.get(n);const s=new cn({source:Dz(r)});return s.on("destroy",()=>{Ef.has(n)&&Ef.remove(n)}),e||Ef.set(n,s),s}function YZ(i,e=!1){return typeof i=="string"?Ef.get(i):i instanceof yo?new cn({source:i}):XZ(i,e)}cn.from=YZ;yo.from=Dz;Es.add(Az,Cz,Ez,WZ,Ky,Rz,fT);var Nz=(i=>(i[i.Low=0]="Low",i[i.Normal=1]="Normal",i[i.High=2]="High",i))(Nz||{});function Za(i){if(typeof i!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(i)}`)}function yp(i){return i.split("?")[0].split("#")[0]}function $Z(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function KZ(i,e,t){return i.replace(new RegExp($Z(e),"g"),t)}function ZZ(i,e){let t="",n=0,r=-1,s=0,a=-1;for(let o=0;o<=i.length;++o){if(o<i.length)a=i.charCodeAt(o);else{if(a===47)break;a=47}if(a===47){if(!(r===o-1||s===1))if(r!==o-1&&s===2){if(t.length<2||n!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){const l=t.lastIndexOf("/");if(l!==t.length-1){l===-1?(t="",n=0):(t=t.slice(0,l),n=t.length-1-t.lastIndexOf("/")),r=o,s=0;continue}}else if(t.length===2||t.length===1){t="",n=0,r=o,s=0;continue}}}else t.length>0?t+=`/${i.slice(r+1,o)}`:t=i.slice(r+1,o),n=o-r-1;r=o,s=0}else a===46&&s!==-1?++s:s=-1}return t}const Nm={toPosix(i){return KZ(i,"\\","/")},isUrl(i){return/^https?:/.test(this.toPosix(i))},isDataUrl(i){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(i)},isBlobUrl(i){return i.startsWith("blob:")},hasProtocol(i){return/^[^/:]+:/.test(this.toPosix(i))},getProtocol(i){Za(i),i=this.toPosix(i);const e=/^file:\/\/\//.exec(i);if(e)return e[0];const t=/^[^/:]+:\/{0,2}/.exec(i);return t?t[0]:""},toAbsolute(i,e,t){if(Za(i),this.isDataUrl(i)||this.isBlobUrl(i))return i;const n=yp(this.toPosix(e??ta.get().getBaseUrl())),r=yp(this.toPosix(t??this.rootname(n)));return i=this.toPosix(i),i.startsWith("/")?Nm.join(r,i.slice(1)):this.isAbsolute(i)?i:this.join(n,i)},normalize(i){if(Za(i),i.length===0)return".";if(this.isDataUrl(i)||this.isBlobUrl(i))return i;i=this.toPosix(i);let e="";const t=i.startsWith("/");this.hasProtocol(i)&&(e=this.rootname(i),i=i.slice(e.length));const n=i.endsWith("/");return i=ZZ(i),i.length>0&&n&&(i+="/"),t?`/${i}`:e+i},isAbsolute(i){return Za(i),i=this.toPosix(i),this.hasProtocol(i)?!0:i.startsWith("/")},join(...i){if(i.length===0)return".";let e;for(let t=0;t<i.length;++t){const n=i[t];if(Za(n),n.length>0)if(e===void 0)e=n;else{const r=i[t-1]??"";this.joinExtensions.includes(this.extname(r).toLowerCase())?e+=`/../${n}`:e+=`/${n}`}}return e===void 0?".":this.normalize(e)},dirname(i){if(Za(i),i.length===0)return".";i=this.toPosix(i);let e=i.charCodeAt(0);const t=e===47;let n=-1,r=!0;const s=this.getProtocol(i),a=i;i=i.slice(s.length);for(let o=i.length-1;o>=1;--o)if(e=i.charCodeAt(o),e===47){if(!r){n=o;break}}else r=!1;return n===-1?t?"/":this.isUrl(a)?s+i:s:t&&n===1?"//":s+i.slice(0,n)},rootname(i){Za(i),i=this.toPosix(i);let e="";if(i.startsWith("/")?e="/":e=this.getProtocol(i),this.isUrl(i)){const t=i.indexOf("/",e.length);t!==-1?e=i.slice(0,t):e=i,e.endsWith("/")||(e+="/")}return e},basename(i,e){Za(i),e&&Za(e),i=yp(this.toPosix(i));let t=0,n=-1,r=!0,s;if(e!==void 0&&e.length>0&&e.length<=i.length){if(e.length===i.length&&e===i)return"";let a=e.length-1,o=-1;for(s=i.length-1;s>=0;--s){const l=i.charCodeAt(s);if(l===47){if(!r){t=s+1;break}}else o===-1&&(r=!1,o=s+1),a>=0&&(l===e.charCodeAt(a)?--a===-1&&(n=s):(a=-1,n=o))}return t===n?n=o:n===-1&&(n=i.length),i.slice(t,n)}for(s=i.length-1;s>=0;--s)if(i.charCodeAt(s)===47){if(!r){t=s+1;break}}else n===-1&&(r=!1,n=s+1);return n===-1?"":i.slice(t,n)},extname(i){Za(i),i=yp(this.toPosix(i));let e=-1,t=0,n=-1,r=!0,s=0;for(let a=i.length-1;a>=0;--a){const o=i.charCodeAt(a);if(o===47){if(!r){t=a+1;break}continue}n===-1&&(r=!1,n=a+1),o===46?e===-1?e=a:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||n===-1||s===0||s===1&&e===n-1&&e===t+1?"":i.slice(e,n)},parse(i){Za(i);const e={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return e;i=yp(this.toPosix(i));let t=i.charCodeAt(0);const n=this.isAbsolute(i);let r;e.root=this.rootname(i),n||this.hasProtocol(i)?r=1:r=0;let s=-1,a=0,o=-1,l=!0,c=i.length-1,u=0;for(;c>=r;--c){if(t=i.charCodeAt(c),t===47){if(!l){a=c+1;break}continue}o===-1&&(l=!1,o=c+1),t===46?s===-1?s=c:u!==1&&(u=1):s!==-1&&(u=-1)}return s===-1||o===-1||u===0||u===1&&s===o-1&&s===a+1?o!==-1&&(a===0&&n?e.base=e.name=i.slice(1,o):e.base=e.name=i.slice(a,o)):(a===0&&n?(e.name=i.slice(1,s),e.base=i.slice(1,o)):(e.name=i.slice(a,s),e.base=i.slice(a,o)),e.ext=i.slice(s,o)),e.dir=this.dirname(i),e},sep:"/",delimiter:":",joinExtensions:[".html"]};function Lz(i,e,t,n,r){const s=e[t];for(let a=0;a<s.length;a++){const o=s[a];t<e.length-1?Lz(i.replace(n[t],o),e,t+1,n,r):r.push(i.replace(n[t],o))}}function QZ(i){const e=/\{(.*?)\}/g,t=i.match(e),n=[];if(t){const r=[];t.forEach(s=>{const a=s.substring(1,s.length-1).split(",");r.push(a)}),Lz(i,r,0,t,n)}else n.push(i);return n}const TE=i=>!Array.isArray(i);class kz{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,t)=>`${e}${this._bundleIdConnector}${t}`,extractAssetIdFromBundle:(e,t)=>t.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const t=e;this._defaultSearchParams=Object.keys(t).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(t[n])}`).join("&")}}getAlias(e){const{alias:t,src:n}=e;return Cf(t||n,s=>typeof s=="string"?s:Array.isArray(s)?s.map(a=>a?.src??a):s?.src?s.src:s,!0)}addManifest(e){this._manifest&&Hr("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(t=>{this.addBundle(t.name,t.assets)})}addBundle(e,t){const n=[];let r=t;Array.isArray(t)||(r=Object.entries(t).map(([s,a])=>typeof a=="string"||Array.isArray(a)?{alias:s,src:a}:{alias:s,...a})),r.forEach(s=>{const a=s.src,o=s.alias;let l;if(typeof o=="string"){const c=this._createBundleAssetId(e,o);n.push(c),l=[o,c]}else{const c=o.map(u=>this._createBundleAssetId(e,u));n.push(...c),l=[...o,...c]}this.add({...s,alias:l,src:a})}),this._bundles[e]=n}add(e){const t=[];Array.isArray(e)?t.push(...e):t.push(e);let n;n=s=>{this.hasKey(s)&&Hr(`[Resolver] already has key: ${s} overwriting`)},Cf(t).forEach(s=>{const{src:a}=s;let{data:o,format:l,loadParser:c,parser:u}=s;const d=Cf(a).map(y=>typeof y=="string"?QZ(y):Array.isArray(y)?y:[y]),p=this.getAlias(s);Array.isArray(p)?p.forEach(n):n(p);const m=[],g=y=>({...this._parsers.find(_=>_.test(y))?.parse(y),src:y});d.forEach(y=>{y.forEach(x=>{let _={};if(typeof x!="object"?_=g(x):(o=x.data??o,l=x.format??l,(x.loadParser||x.parser)&&(c=x.loadParser??c,u=x.parser??u),_={...g(x.src),...x}),!p)throw new Error(`[Resolver] alias is undefined for this asset: ${_.src}`);_=this._buildResolvedAsset(_,{aliases:p,data:o,format:l,loadParser:c,parser:u,progressSize:s.progressSize}),m.push(_)})}),p.forEach(y=>{this._assetMap[y]=m})})}resolveBundle(e){const t=TE(e);e=Cf(e);const n={};return e.forEach(r=>{const s=this._bundles[r];if(s){const a=this.resolve(s),o={};for(const l in a){const c=a[l];o[this._extractAssetIdFromBundle(r,l)]=c}n[r]=o}}),t?n[e[0]]:n}resolveUrl(e){const t=this.resolve(e);if(typeof e!="string"){const n={};for(const r in t)n[r]=t[r].src;return n}return t.src}resolve(e){const t=TE(e);e=Cf(e);const n={};return e.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let s=this._assetMap[r];const a=this._getPreferredOrder(s);a?.priority.forEach(o=>{a.params[o].forEach(l=>{const c=s.filter(u=>u[o]?u[o]===l:!1);c.length&&(s=c)})}),this._resolverHash[r]=s[0]}else this._resolverHash[r]=this._buildResolvedAsset({alias:[r],src:r},{});n[r]=this._resolverHash[r]}),t?n[e[0]]:n}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let t=0;t<e.length;t++){const n=e[t],r=this._preferredOrder.find(s=>s.params.format.includes(n.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const t=/\?/.test(e)?"&":"?";return`${e}${t}${this._defaultSearchParams}`}_buildResolvedAsset(e,t){const{aliases:n,data:r,loadParser:s,parser:a,format:o,progressSize:l}=t;return(this._basePath||this._rootPath)&&(e.src=Nm.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=n??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...r||{},...e.data},e.loadParser=s??e.loadParser,e.parser=a??e.parser,e.format=o??e.format??JZ(e.src),l!==void 0&&(e.progressSize=l),e}}kz.RETINA_PREFIX=/@([0-9\.]+)x/;function JZ(i){return i.split(".").pop().split("?").shift().split("#").shift()}const AE=(i,e)=>{const t=e.split("?")[1];return t&&(i+=`?${t}`),i},Oz=class Xp{constructor(e,t){this.linkedSheets=[];let n=e;e?.source instanceof yo&&(n={texture:e,data:t});const{texture:r,data:s,cachePrefix:a=""}=n;this.cachePrefix=a,this._texture=r instanceof cn?r:null,this.textureSource=r.source,this.textures={},this.animations={},this.data=s;const o=parseFloat(s.meta.scale);o?(this.resolution=o,r.source.resolution=this.resolution):this.resolution=r.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=Xp.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e;const n=Xp.BATCH_SIZE;for(;t-e<n&&t<this._frameKeys.length;){const r=this._frameKeys[t],s=this._frames[r],a=s.frame;if(a){let o=null,l=null;const c=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,u=new Qn(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);s.rotated?o=new Qn(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):o=new Qn(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(l=new Qn(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[r]=new cn({source:this.textureSource,frame:o,orig:u,trim:l,rotate:s.rotated?2:0,defaultAnchor:s.anchor,defaultBorders:s.borders,label:r.toString()})}t++}}_processAnimations(){const e=this.data.animations||{};for(const t in e){this.animations[t]=[];for(let n=0;n<e[t].length;n++){const r=e[t][n];this.animations[t].push(this.textures[r])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Xp.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Xp.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(const t in this.textures)this.textures[t].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};Oz.BATCH_SIZE=1e3;let CE=Oz;const eQ=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function zz(i,e,t){const n={};if(i.forEach(r=>{n[r]=e}),Object.keys(e.textures).forEach(r=>{n[`${e.cachePrefix}${r}`]=e.textures[r]}),!t){const r=Nm.dirname(i[0]);e.linkedSheets.forEach((s,a)=>{const o=zz([`${r}/${e.data.meta.related_multi_packs[a]}`],s,!0);Object.assign(n,o)})}return n}const tQ={extension:In.Asset,cache:{test:i=>i instanceof CE,getCacheableAssets:(i,e)=>zz(i,e,!1)},resolver:{extension:{type:In.ResolveParser,name:"resolveSpritesheet"},test:i=>{const t=i.split("?")[0].split("."),n=t.pop(),r=t.pop();return n==="json"&&eQ.includes(r)},parse:i=>{const e=i.split(".");return{resolution:parseFloat(kz.RETINA_PREFIX.exec(i)?.[1]??"1"),format:e[e.length-2],src:i}}},loader:{name:"spritesheetLoader",id:"spritesheet",extension:{type:In.LoadParser,priority:Nz.Normal,name:"spritesheetLoader"},async testParse(i,e){return Nm.extname(e.src).toLowerCase()===".json"&&!!i.frames},async parse(i,e,t){const{texture:n,imageFilename:r,textureOptions:s,cachePrefix:a}=e?.data??{};let o=Nm.dirname(e.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let l;if(n instanceof cn)l=n;else{const d=AE(o+(r??i.meta.image),e.src);l=(await t.load([{src:d,data:s}]))[d]}const c=new CE({texture:l.source,data:i,cachePrefix:a});await c.parse();const u=i?.meta?.related_multi_packs;if(Array.isArray(u)){const d=[];for(const m of u){if(typeof m!="string")continue;let g=o+m;e.data?.ignoreMultiPack||(g=AE(g,e.src),d.push(t.load({src:g,data:{textureOptions:s,ignoreMultiPack:!0}})))}const p=await Promise.all(d);c.linkedSheets=p,p.forEach(m=>{m.linkedSheets=[c].concat(c.linkedSheets.filter(g=>g!==m))})}return c},async unload(i,e,t){await t.unload(i.textureSource._sourceOrigin),i.destroy(!1)}}};Es.add(tQ);const $3=Object.create(null),EE=Object.create(null);function gT(i,e){let t=EE[i];return t===void 0&&($3[e]===void 0&&($3[e]=1),EE[i]=t=$3[e]++),t}let e1;function Uz(){return(!e1||e1?.isContextLost())&&(e1=ta.get().createCanvas().getContext("webgl",{})),e1}let t1;function nQ(){if(!t1){t1="mediump";const i=Uz();i&&i.getShaderPrecisionFormat&&(t1=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision?"highp":"mediump")}return t1}function iQ(i,e,t){return e?i:t?(i=i.replace("out vec4 finalColor;",""),`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${i}
        `):`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${i}
        `}function rQ(i,e,t){const n=t?e.maxSupportedFragmentPrecision:e.maxSupportedVertexPrecision;if(i.substring(0,9)!=="precision"){let r=t?e.requestedFragmentPrecision:e.requestedVertexPrecision;return r==="highp"&&n!=="highp"&&(r="mediump"),`precision ${r} float;
${i}`}else if(n!=="highp"&&i.substring(0,15)==="precision highp")return i.replace("precision highp","precision mediump");return i}function sQ(i,e){return e?`#version 300 es
${i}`:i}const aQ={},oQ={};function lQ(i,{name:e="pixi-program"},t=!0){e=e.replace(/\s+/g,"-"),e+=t?"-fragment":"-vertex";const n=t?aQ:oQ;return n[e]?(n[e]++,e+=`-${n[e]}`):n[e]=1,i.indexOf("#define SHADER_NAME")!==-1?i:`${`#define SHADER_NAME ${e}`}
${i}`}function cQ(i,e){return e?i.replace("#version 300 es",""):i}const K3={stripVersion:cQ,ensurePrecision:rQ,addProgramDefines:iQ,setProgramName:lQ,insertVersion:sQ},vp=Object.create(null),Fz=class FM{constructor(e){e={...FM.defaultOptions,...e};const t=e.fragment.indexOf("#version 300 es")!==-1,n={stripVersion:t,ensurePrecision:{requestedFragmentPrecision:e.preferredFragmentPrecision,requestedVertexPrecision:e.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:nQ()},setProgramName:{name:e.name},addProgramDefines:t,insertVersion:t};let r=e.fragment,s=e.vertex;Object.keys(K3).forEach(a=>{const o=n[a];r=K3[a](r,o,!0),s=K3[a](s,o,!1)}),this.fragment=r,this.vertex=s,this.transformFeedbackVaryings=e.transformFeedbackVaryings,this._key=gT(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null,vp[this._cacheKey]=null}static from(e){const t=`${e.vertex}:${e.fragment}`;return vp[t]||(vp[t]=new FM(e),vp[t]._cacheKey=t),vp[t]}};Fz.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let xT=Fz;const RE={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function uQ(i){return RE[i]??RE.float32}const hQ={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function dQ({source:i,entryPoint:e}){const t={},n=i.indexOf(`fn ${e}`);if(n!==-1){const r=i.indexOf("->",n);if(r!==-1){const s=i.substring(n,r),a=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let o;for(;(o=a.exec(s))!==null;){const l=hQ[o[3]]??"float32";t[o[2]]={location:parseInt(o[1],10),format:l,stride:uQ(l).stride,offset:0,instance:!1,start:0}}}}return t}function Z3(i){const e=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,t=/@group\((\d+)\)/,n=/@binding\((\d+)\)/,r=/var(<[^>]+>)? (\w+)/,s=/:\s*(\w+)/,a=/struct\s+(\w+)\s*{([^}]+)}/g,o=/(\w+)\s*:\s*([\w\<\>]+)/g,l=/struct\s+(\w+)/,c=i.match(e)?.map(d=>({group:parseInt(d.match(t)[1],10),binding:parseInt(d.match(n)[1],10),name:d.match(r)[2],isUniform:d.match(r)[1]==="<uniform>",type:d.match(s)[1]}));if(!c)return{groups:[],structs:[]};const u=i.match(a)?.map(d=>{const p=d.match(l)[1],m=d.match(o).reduce((g,y)=>{const[x,_]=y.split(":");return g[x.trim()]=_.trim(),g},{});return m?{name:p,members:m}:null}).filter(({name:d})=>c.some(p=>p.type===d))??[];return{groups:c,structs:u}}var Yp=(i=>(i[i.VERTEX=1]="VERTEX",i[i.FRAGMENT=2]="FRAGMENT",i[i.COMPUTE=4]="COMPUTE",i))(Yp||{});function fQ({groups:i}){const e=[];for(let t=0;t<i.length;t++){const n=i[t];e[n.group]||(e[n.group]=[]),n.isUniform?e[n.group].push({binding:n.binding,visibility:Yp.VERTEX|Yp.FRAGMENT,buffer:{type:"uniform"}}):n.type==="sampler"?e[n.group].push({binding:n.binding,visibility:Yp.FRAGMENT,sampler:{type:"filtering"}}):n.type==="texture_2d"&&e[n.group].push({binding:n.binding,visibility:Yp.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return e}function pQ({groups:i}){const e=[];for(let t=0;t<i.length;t++){const n=i[t];e[n.group]||(e[n.group]={}),e[n.group][n.name]=n.binding}return e}function mQ(i,e){const t=new Set,n=new Set,r=[...i.structs,...e.structs].filter(a=>t.has(a.name)?!1:(t.add(a.name),!0)),s=[...i.groups,...e.groups].filter(a=>{const o=`${a.name}-${a.binding}`;return n.has(o)?!1:(n.add(o),!0)});return{structs:r,groups:s}}const bp=Object.create(null);class Hg{constructor(e){this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:t,vertex:n,layout:r,gpuLayout:s,name:a}=e;if(this.name=a,this.fragment=t,this.vertex=n,t.source===n.source){const o=Z3(t.source);this.structsAndGroups=o}else{const o=Z3(n.source),l=Z3(t.source);this.structsAndGroups=mQ(o,l)}this.layout=r??pQ(this.structsAndGroups),this.gpuLayout=s??fQ(this.structsAndGroups),this.autoAssignGlobalUniforms=this.layout[0]?.globalUniforms!==void 0,this.autoAssignLocalUniforms=this.layout[1]?.localUniforms!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:e,fragment:t}=this,n=e.source+t.source+e.entryPoint+t.entryPoint;this._layoutKey=gT(n,"program")}get attributeData(){return this._attributeData??(this._attributeData=dQ(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null,bp[this._cacheKey]=null}static from(e){const t=`${e.vertex.source}:${e.fragment.source}:${e.fragment.entryPoint}:${e.vertex.entryPoint}`;return bp[t]||(bp[t]=new Hg(e),bp[t]._cacheKey=t),bp[t]}}const Bz=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],gQ=Bz.reduce((i,e)=>(i[e]=!0,i),{});function xQ(i,e){switch(i){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*e);case"vec3<f32>":return new Float32Array(3*e);case"vec4<f32>":return new Float32Array(4*e);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Hz=class jz{constructor(e,t){this._touched=0,this.uid=Mi("uniform"),this._resourceType="uniformGroup",this._resourceId=Mi("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,t={...jz.defaultOptions,...t},this.uniformStructures=e;const n={};for(const r in e){const s=e[r];if(s.name=r,s.size=s.size??1,!gQ[s.type]){const a=s.type.match(/^array<(\w+(?:<\w+>)?),\s*(\d+)>$/);if(a){const[,o,l]=a;throw new Error(`Uniform type ${s.type} is not supported. Use type: '${o}', size: ${l} instead.`)}throw new Error(`Uniform type ${s.type} is not supported. Supported uniform types are: ${Bz.join(", ")}`)}s.value??(s.value=xQ(s.type,s.size)),n[r]=s.value}this.uniforms=n,this._dirtyId=1,this.ubo=t.ubo,this.isStatic=t.isStatic,this._signature=gT(Object.keys(n).map(r=>`${r}-${e[r].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};Hz.defaultOptions={ubo:!1,isStatic:!1};let Vz=Hz;class Ry{constructor(e){this.resources=Object.create(null),this._dirty=!0;let t=0;for(const n in e){const r=e[n];this.setResource(r,t++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const e=[];let t=0;for(const n in this.resources)e[t++]=this.resources[n]._resourceId;this._key=e.join("|")}setResource(e,t){const n=this.resources[t];e!==n&&(n&&e.off?.("change",this.onResourceChange,this),e.on?.("change",this.onResourceChange,this),this.resources[t]=e,this._dirty=!0)}getResource(e){return this.resources[e]}_touch(e){const t=this.resources;for(const n in t)t[n]._touched=e}destroy(){const e=this.resources;for(const t in e)e[t]?.off?.("change",this.onResourceChange,this);this.resources=null}onResourceChange(e){if(this._dirty=!0,e.destroyed){const t=this.resources;for(const n in t)t[n]===e&&(t[n]=null)}else this._updateKey()}}var BM=(i=>(i[i.WEBGL=1]="WEBGL",i[i.WEBGPU=2]="WEBGPU",i[i.BOTH=3]="BOTH",i))(BM||{});class Yb extends ll{constructor(e){super(),this.uid=Mi("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[],this._destroyed=!1;let{gpuProgram:t,glProgram:n,groups:r,resources:s,compatibleRenderers:a,groupMap:o}=e;this.gpuProgram=t,this.glProgram=n,a===void 0&&(a=0,t&&(a|=BM.WEBGPU),n&&(a|=BM.WEBGL)),this.compatibleRenderers=a;const l={};if(!s&&!r&&(s={}),s&&r)throw new Error("[Shader] Cannot have both resources and groups");if(!t&&r&&!o)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!t&&r&&o)for(const c in o)for(const u in o[c]){const d=o[c][u];l[d]={group:c,binding:u,name:d}}else if(t&&r&&!o){const c=t.structsAndGroups.groups;o={},c.forEach(u=>{o[u.group]=o[u.group]||{},o[u.group][u.binding]=u.name,l[u.name]=u})}else if(s){r={},o={},t&&t.structsAndGroups.groups.forEach(d=>{o[d.group]=o[d.group]||{},o[d.group][d.binding]=d.name,l[d.name]=d});let c=0;for(const u in s)l[u]||(r[99]||(r[99]=new Ry,this._ownedBindGroups.push(r[99])),l[u]={group:99,binding:c,name:u},o[99]=o[99]||{},o[99][c]=u,c++);for(const u in s){const d=u;let p=s[u];!p.source&&!p._resourceType&&(p=new Vz(p));const m=l[d];m&&(r[m.group]||(r[m.group]=new Ry,this._ownedBindGroups.push(r[m.group])),r[m.group].setResource(p,m.binding))}}this.groups=r,this._uniformBindMap=o,this.resources=this._buildResourceAccessor(r,l)}addResource(e,t,n){var r,s;(r=this._uniformBindMap)[t]||(r[t]={}),(s=this._uniformBindMap[t])[n]||(s[n]=e),this.groups[t]||(this.groups[t]=new Ry,this._ownedBindGroups.push(this.groups[t]))}_buildResourceAccessor(e,t){const n={};for(const r in t){const s=t[r];Object.defineProperty(n,s.name,{get(){return e[s.group].getResource(s.binding)},set(a){e[s.group].setResource(a,s.binding)}})}return n}destroy(e=!1){this._destroyed||(this._destroyed=!0,this.emit("destroy",this),e&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(t=>{t.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null)}static from(e){const{gpu:t,gl:n,...r}=e;let s,a;return t&&(s=Hg.from(t)),n&&(a=xT.from(n)),new Yb({gpuProgram:s,glProgram:a,...r})}}const yQ={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},Q3=0,J3=1,eS=2,tS=3,nS=4,iS=5,HM=class Gz{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Q3)}set blend(e){!!(this.data&1<<Q3)!==e&&(this.data^=1<<Q3)}get offsets(){return!!(this.data&1<<J3)}set offsets(e){!!(this.data&1<<J3)!==e&&(this.data^=1<<J3)}set cullMode(e){if(e==="none"){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace=e==="front"}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(this.data&1<<eS)}set culling(e){!!(this.data&1<<eS)!==e&&(this.data^=1<<eS)}get depthTest(){return!!(this.data&1<<tS)}set depthTest(e){!!(this.data&1<<tS)!==e&&(this.data^=1<<tS)}get depthMask(){return!!(this.data&1<<iS)}set depthMask(e){!!(this.data&1<<iS)!==e&&(this.data^=1<<iS)}get clockwiseFrontFace(){return!!(this.data&1<<nS)}set clockwiseFrontFace(e){!!(this.data&1<<nS)!==e&&(this.data^=1<<nS)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!=="none",this._blendMode=e,this._blendModeId=yQ[e]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const e=new Gz;return e.depthTest=!1,e.blend=!0,e}};HM.default2d=HM.for2d();let vQ=HM;const Wz=class jM extends Yb{constructor(e){e={...jM.defaultOptions,...e},super(e),this.enabled=!0,this._state=vQ.for2d(),this.blendMode=e.blendMode,this.padding=e.padding,typeof e.antialias=="boolean"?this.antialias=e.antialias?"on":"off":this.antialias=e.antialias,this.resolution=e.resolution,this.blendRequired=e.blendRequired,this.clipToViewport=e.clipToViewport,this.addResource("uTexture",0,1),e.blendRequired&&this.addResource("uBackTexture",0,3)}apply(e,t,n,r){e.applyFilter(this,t,n,r)}get blendMode(){return this._state.blendMode}set blendMode(e){this._state.blendMode=e}static from(e){const{gpu:t,gl:n,...r}=e;let s,a;return t&&(s=Hg.from(t)),n&&(a=xT.from(n)),new jM({gpuProgram:s,glProgram:a,...r})}};Wz.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1,clipToViewport:!0};let hd=Wz;const VM=[];Es.handleByNamedList(In.Environment,VM);async function bQ(i){if(!i)for(let e=0;e<VM.length;e++){const t=VM[e];if(t.value.test()){await t.value.load();return}}}let _p;function _Q(){if(typeof _p=="boolean")return _p;try{_p=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{_p=!1}return _p}function PE(i,e,t=2){const n=e&&e.length,r=n?e[0]*t:i.length;let s=qz(i,0,r,t,!0);const a=[];if(!s||s.next===s.prev)return a;let o,l,c;if(n&&(s=AQ(i,e,s,t)),i.length>80*t){o=i[0],l=i[1];let u=o,d=l;for(let p=t;p<r;p+=t){const m=i[p],g=i[p+1];m<o&&(o=m),g<l&&(l=g),m>u&&(u=m),g>d&&(d=g)}c=Math.max(u-o,d-l),c=c!==0?32767/c:0}return Lm(s,a,t,o,l,c,0),a}function qz(i,e,t,n,r){let s;if(r===zQ(i,e,t,n)>0)for(let a=e;a<t;a+=n)s=IE(a/n|0,i[a],i[a+1],s);else for(let a=t-n;a>=e;a-=n)s=IE(a/n|0,i[a],i[a+1],s);return s&&Jf(s,s.next)&&(Om(s),s=s.next),s}function Zh(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(Jf(t,t.next)||di(t.prev,t,t.next)===0)){if(Om(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function Lm(i,e,t,n,r,s,a){if(!i)return;!a&&s&&IQ(i,n,r,s);let o=i;for(;i.prev!==i.next;){const l=i.prev,c=i.next;if(s?wQ(i,n,r,s):SQ(i)){e.push(l.i,i.i,c.i),Om(i),i=c.next,o=c.next;continue}if(i=c,i===o){a?a===1?(i=MQ(Zh(i),e),Lm(i,e,t,n,r,s,2)):a===2&&TQ(i,e,t,n,r,s):Lm(Zh(i),e,t,n,r,s,1);break}}}function SQ(i){const e=i.prev,t=i,n=i.next;if(di(e,t,n)>=0)return!1;const r=e.x,s=t.x,a=n.x,o=e.y,l=t.y,c=n.y,u=Math.min(r,s,a),d=Math.min(o,l,c),p=Math.max(r,s,a),m=Math.max(o,l,c);let g=n.next;for(;g!==e;){if(g.x>=u&&g.x<=p&&g.y>=d&&g.y<=m&&$p(r,o,s,l,a,c,g.x,g.y)&&di(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function wQ(i,e,t,n){const r=i.prev,s=i,a=i.next;if(di(r,s,a)>=0)return!1;const o=r.x,l=s.x,c=a.x,u=r.y,d=s.y,p=a.y,m=Math.min(o,l,c),g=Math.min(u,d,p),y=Math.max(o,l,c),x=Math.max(u,d,p),_=GM(m,g,e,t,n),S=GM(y,x,e,t,n);let w=i.prevZ,T=i.nextZ;for(;w&&w.z>=_&&T&&T.z<=S;){if(w.x>=m&&w.x<=y&&w.y>=g&&w.y<=x&&w!==r&&w!==a&&$p(o,u,l,d,c,p,w.x,w.y)&&di(w.prev,w,w.next)>=0||(w=w.prevZ,T.x>=m&&T.x<=y&&T.y>=g&&T.y<=x&&T!==r&&T!==a&&$p(o,u,l,d,c,p,T.x,T.y)&&di(T.prev,T,T.next)>=0))return!1;T=T.nextZ}for(;w&&w.z>=_;){if(w.x>=m&&w.x<=y&&w.y>=g&&w.y<=x&&w!==r&&w!==a&&$p(o,u,l,d,c,p,w.x,w.y)&&di(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;T&&T.z<=S;){if(T.x>=m&&T.x<=y&&T.y>=g&&T.y<=x&&T!==r&&T!==a&&$p(o,u,l,d,c,p,T.x,T.y)&&di(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}function MQ(i,e){let t=i;do{const n=t.prev,r=t.next.next;!Jf(n,r)&&Yz(n,t,t.next,r)&&km(n,r)&&km(r,n)&&(e.push(n.i,t.i,r.i),Om(t),Om(t.next),t=i=r),t=t.next}while(t!==i);return Zh(t)}function TQ(i,e,t,n,r,s){let a=i;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&LQ(a,o)){let l=$z(a,o);a=Zh(a,a.next),l=Zh(l,l.next),Lm(a,e,t,n,r,s,0),Lm(l,e,t,n,r,s,0);return}o=o.next}a=a.next}while(a!==i)}function AQ(i,e,t,n){const r=[];for(let s=0,a=e.length;s<a;s++){const o=e[s]*n,l=s<a-1?e[s+1]*n:i.length,c=qz(i,o,l,n,!1);c===c.next&&(c.steiner=!0),r.push(NQ(c))}r.sort(CQ);for(let s=0;s<r.length;s++)t=EQ(r[s],t);return t}function CQ(i,e){let t=i.x-e.x;if(t===0&&(t=i.y-e.y,t===0)){const n=(i.next.y-i.y)/(i.next.x-i.x),r=(e.next.y-e.y)/(e.next.x-e.x);t=n-r}return t}function EQ(i,e){const t=RQ(i,e);if(!t)return e;const n=$z(t,i);return Zh(n,n.next),Zh(t,t.next)}function RQ(i,e){let t=e;const n=i.x,r=i.y;let s=-1/0,a;if(Jf(i,t))return t;do{if(Jf(i,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const d=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=n&&d>s&&(s=d,a=t.x<t.next.x?t:t.next,d===n))return a}t=t.next}while(t!==e);if(!a)return null;const o=a,l=a.x,c=a.y;let u=1/0;t=a;do{if(n>=t.x&&t.x>=l&&n!==t.x&&Xz(r<c?n:s,r,l,c,r<c?s:n,r,t.x,t.y)){const d=Math.abs(r-t.y)/(n-t.x);km(t,i)&&(d<u||d===u&&(t.x>a.x||t.x===a.x&&PQ(a,t)))&&(a=t,u=d)}t=t.next}while(t!==o);return a}function PQ(i,e){return di(i.prev,i,e.prev)<0&&di(e.next,i,i.next)<0}function IQ(i,e,t,n){let r=i;do r.z===0&&(r.z=GM(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,DQ(r)}function DQ(i){let e,t=1;do{let n=i,r;i=null;let s=null;for(e=0;n;){e++;let a=n,o=0;for(let c=0;c<t&&(o++,a=a.nextZ,!!a);c++);let l=t;for(;o>0||l>0&&a;)o!==0&&(l===0||!a||n.z<=a.z)?(r=n,n=n.nextZ,o--):(r=a,a=a.nextZ,l--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;n=a}s.nextZ=null,t*=2}while(e>1);return i}function GM(i,e,t,n,r){return i=(i-t)*r|0,e=(e-n)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function NQ(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function Xz(i,e,t,n,r,s,a,o){return(r-a)*(e-o)>=(i-a)*(s-o)&&(i-a)*(n-o)>=(t-a)*(e-o)&&(t-a)*(s-o)>=(r-a)*(n-o)}function $p(i,e,t,n,r,s,a,o){return!(i===a&&e===o)&&Xz(i,e,t,n,r,s,a,o)}function LQ(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!kQ(i,e)&&(km(i,e)&&km(e,i)&&OQ(i,e)&&(di(i.prev,i,e.prev)||di(i,e.prev,e))||Jf(i,e)&&di(i.prev,i,i.next)>0&&di(e.prev,e,e.next)>0)}function di(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function Jf(i,e){return i.x===e.x&&i.y===e.y}function Yz(i,e,t,n){const r=i1(di(i,e,t)),s=i1(di(i,e,n)),a=i1(di(t,n,i)),o=i1(di(t,n,e));return!!(r!==s&&a!==o||r===0&&n1(i,t,e)||s===0&&n1(i,n,e)||a===0&&n1(t,i,n)||o===0&&n1(t,e,n))}function n1(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function i1(i){return i>0?1:i<0?-1:0}function kQ(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&Yz(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function km(i,e){return di(i.prev,i,i.next)<0?di(i,e,i.next)>=0&&di(i,i.prev,e)>=0:di(i,e,i.prev)<0||di(i,i.next,e)<0}function OQ(i,e){let t=i,n=!1;const r=(i.x+e.x)/2,s=(i.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function $z(i,e){const t=WM(i.i,i.x,i.y),n=WM(e.i,e.x,e.y),r=i.next,s=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function IE(i,e,t,n){const r=WM(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function Om(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function WM(i,e,t){return{i,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function zQ(i,e,t,n){let r=0;for(let s=e,a=t-n;s<t;s+=n)r+=(i[a]-i[s])*(i[s+1]+i[a+1]),a=s;return r}const UQ=PE.default||PE;var Kz=(i=>(i[i.NONE=0]="NONE",i[i.COLOR=16384]="COLOR",i[i.STENCIL=1024]="STENCIL",i[i.DEPTH=256]="DEPTH",i[i.COLOR_DEPTH=16640]="COLOR_DEPTH",i[i.COLOR_STENCIL=17408]="COLOR_STENCIL",i[i.DEPTH_STENCIL=1280]="DEPTH_STENCIL",i[i.ALL=17664]="ALL",i))(Kz||{});class FQ{constructor(e){this.items=[],this._name=e}emit(e,t,n,r,s,a,o,l){const{name:c,items:u}=this;for(let d=0,p=u.length;d<p;d++)u[d][c](e,t,n,r,s,a,o,l);return this}add(e){return e[this._name]&&(this.remove(e),this.items.push(e)),this}remove(e){const t=this.items.indexOf(e);return t!==-1&&this.items.splice(t,1),this}contains(e){return this.items.indexOf(e)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const BQ=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],Zz=class Qz extends ll{constructor(e){super(),this.uid=Mi("renderer"),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=e.type,this.name=e.name,this.config=e;const t=[...BQ,...this.config.runners??[]];this._addRunners(...t),this._unsafeEvalCheck()}async init(e={}){const t=e.skipExtensionImports===!0?!0:e.manageImports===!1;await bQ(t),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const n in this._systemsHash)e={...this._systemsHash[n].constructor.defaultOptions,...e};e={...Qz.defaultOptions,...e},this._roundPixels=e.roundPixels?1:0;for(let n=0;n<this.runners.init.items.length;n++)await this.runners.init.items[n].init(e);this._initOptions=e}render(e,t){let n=e;if(n instanceof Fi&&(n={container:n},t&&(Tn(wi,"passing a second argument is deprecated, please use render options instead"),n.target=t.renderTexture)),n.target||(n.target=this.view.renderTarget),n.target===this.view.renderTarget&&(this._lastObjectRendered=n.container,n.clearColor??(n.clearColor=this.background.colorRgba),n.clear??(n.clear=this.background.clearBeforeRender)),n.clearColor){const r=Array.isArray(n.clearColor)&&n.clearColor.length===4;n.clearColor=r?n.clearColor:Wi.shared.setValue(n.clearColor).toArray()}n.transform||(n.container.updateLocalTransform(),n.transform=n.container.localTransform),n.container.visible&&(n.container.enableRenderGroup(),this.runners.prerender.emit(n),this.runners.renderStart.emit(n),this.runners.render.emit(n),this.runners.renderEnd.emit(n),this.runners.postrender.emit(n))}resize(e,t,n){const r=this.view.resolution;this.view.resize(e,t,n),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),n!==void 0&&n!==r&&this.runners.resolutionChange.emit(n)}clear(e={}){const t=this;e.target||(e.target=t.renderTarget.renderTarget),e.clearColor||(e.clearColor=this.background.colorRgba),e.clear??(e.clear=Kz.ALL);const{clear:n,clearColor:r,target:s}=e;Wi.shared.setValue(r??this.background.colorRgba),t.renderTarget.clear(s,n,Wi.shared.toArray())}get resolution(){return this.view.resolution}set resolution(e){this.view.resolution=e,this.runners.resolutionChange.emit(e)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...e){e.forEach(t=>{this.runners[t]=new FQ(t)})}_addSystems(e){let t;for(t in e){const n=e[t];this._addSystem(n.value,n.name)}}_addSystem(e,t){const n=new e(this);if(this[t])throw new Error(`Whoops! The name "${t}" is already in use`);this[t]=n,this._systemsHash[t]=n;for(const r in this.runners)this.runners[r].add(n);return this}_addPipes(e,t){const n=t.reduce((r,s)=>(r[s.name]=s.value,r),{});e.forEach(r=>{const s=r.value,a=r.name,o=n[a];this.renderPipes[a]=new s(this,o?new o:null),this.runners.destroy.add(this.renderPipes[a])})}destroy(e=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(e),(e===!0||typeof e=="object"&&e.releaseGlobalResources)&&Bg.release(),Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(e){return this.textureGenerator.generateTexture(e)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!_Q())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};Zz.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let Jz=Zz,r1;function HQ(i){return r1!==void 0||(r1=(()=>{const e={stencil:!0,failIfMajorPerformanceCaveat:i??Jz.defaultOptions.failIfMajorPerformanceCaveat};try{if(!ta.get().getWebGLRenderingContext())return!1;let n=ta.get().createCanvas().getContext("webgl",e);const r=!!n?.getContextAttributes()?.stencil;if(n){const s=n.getExtension("WEBGL_lose_context");s&&s.loseContext()}return n=null,r}catch{return!1}})()),r1}let s1;async function jQ(i={}){return s1!==void 0||(s1=await(async()=>{const e=ta.get().getNavigator().gpu;if(!e)return!1;try{return await(await e.requestAdapter(i)).requestDevice(),!0}catch{return!1}})()),s1}const DE=["webgl","webgpu","canvas"];async function VQ(i){let e=[];i.preference?(e.push(i.preference),DE.forEach(s=>{s!==i.preference&&e.push(s)})):e=DE.slice();let t,n={};for(let s=0;s<e.length;s++){const a=e[s];if(a==="webgpu"&&await jQ()){const{WebGPURenderer:o}=await Vy(async()=>{const{WebGPURenderer:l}=await import("./WebGPURenderer-CxIYIZZX.js");return{WebGPURenderer:l}},__vite__mapDeps([11,2,12,3,4,5,6,7,8,9,10]));t=o,n={...i,...i.webgpu};break}else if(a==="webgl"&&HQ(i.failIfMajorPerformanceCaveat??Jz.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:o}=await Vy(async()=>{const{WebGLRenderer:l}=await import("./WebGLRenderer-mIPkJi7I.js");return{WebGLRenderer:l}},__vite__mapDeps([13,2,12,3,4,5,6,7,8,9,10]));t=o,n={...i,...i.webgl};break}else if(a==="canvas")throw n={...i},new Error("CanvasRenderer is not yet implemented")}if(delete n.webgpu,delete n.webgl,!t)throw new Error("No available renderer for the current environment");const r=new t;return await r.init(n),r}const eU="8.14.3";class tU{static init(){globalThis.__PIXI_APP_INIT__?.(this,eU)}static destroy(){}}tU.extension=In.Application;class GQ{constructor(e){this._renderer=e}init(){globalThis.__PIXI_RENDERER_INIT__?.(this._renderer,eU)}destroy(){this._renderer=null}}GQ.extension={type:[In.WebGLSystem,In.WebGPUSystem],name:"initHook",priority:-10};const nU=class qM{constructor(...e){this.stage=new Fi,e[0]!==void 0&&Tn(wi,"Application constructor options are deprecated, please use Application.init() instead.")}async init(e){e={...e},this.stage||(this.stage=new Fi),this.renderer=await VQ(e),qM._plugins.forEach(t=>{t.init.call(this,e)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return Tn(wi,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(e=!1,t=!1){const n=qM._plugins.slice(0);n.reverse(),n.forEach(r=>{r.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}};nU._plugins=[];let yT=nU;Es.handleByList(In.Application,yT._plugins);Es.add(tU);class WQ{constructor(e=0,t=0,n=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=e,this.resetTtl=n,this.size=0,this.ttl=t}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(e){if(this.has(e)){const t=this.items[e];delete this.items[e],this.size--,t.prev!==null&&(t.prev.next=t.next),t.next!==null&&(t.next.prev=t.prev),this.first===t&&(this.first=t.next),this.last===t&&(this.last=t.prev)}return this}entries(e=this.keys()){return e.map(t=>[t,this.get(t)])}evict(e=!1){if(e||this.size>0){const t=this.first;delete this.items[t.key],--this.size===0?(this.first=null,this.last=null):(this.first=t.next,this.first.prev=null)}return this}expiresAt(e){let t;return this.has(e)&&(t=this.items[e].expiry),t}get(e){const t=this.items[e];if(t!==void 0){if(this.ttl>0&&t.expiry<=Date.now()){this.delete(e);return}return this.moveToEnd(t),t.value}}has(e){return e in this.items}moveToEnd(e){this.last!==e&&(e.prev!==null&&(e.prev.next=e.next),e.next!==null&&(e.next.prev=e.prev),this.first===e&&(this.first=e.next),e.prev=this.last,e.next=null,this.last!==null&&(this.last.next=e),this.last=e,this.first===null&&(this.first=e))}keys(){const e=[];let t=this.first;for(;t!==null;)e.push(t.key),t=t.next;return e}setWithEvicted(e,t,n=this.resetTtl){let r=null;if(this.has(e))this.set(e,t,!0,n);else{this.max>0&&this.size===this.max&&(r={...this.first},this.evict(!0));let s=this.items[e]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:t};++this.size===1?this.first=s:this.last.next=s,this.last=s}return r}set(e,t,n=!1,r=this.resetTtl){let s=this.items[e];return n||s!==void 0?(s.value=t,n===!1&&r&&(s.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.moveToEnd(s)):(this.max>0&&this.size===this.max&&this.evict(!0),s=this.items[e]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:t},++this.size===1?this.first=s:this.last.next=s,this.last=s),this}values(e=this.keys()){return e.map(t=>this.get(t))}}function qQ(i=1e3,e=0,t=!1){if(isNaN(i)||i<0)throw new TypeError("Invalid max value");if(isNaN(e)||e<0)throw new TypeError("Invalid ttl value");if(typeof t!="boolean")throw new TypeError("Invalid resetTtl value");return new WQ(i,e,t)}const XQ=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function iU(i){const e=typeof i.fontSize=="number"?`${i.fontSize}px`:i.fontSize;let t=i.fontFamily;Array.isArray(i.fontFamily)||(t=i.fontFamily.split(","));for(let n=t.length-1;n>=0;n--){let r=t[n].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!XQ.includes(r)&&(r=`"${r}"`),t[n]=r}return`${i.fontStyle} ${i.fontVariant} ${i.fontWeight} ${e} ${t.join(",")}`}const rS={willReadFrequently:!0},vo=class Et{static get experimentalLetterSpacingSupported(){let e=Et._experimentalLetterSpacingSupported;if(e===void 0){const t=ta.get().getCanvasRenderingContext2D().prototype;e=Et._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,n,r,s,a,o,l,c){this.text=e,this.style=t,this.width=n,this.height=r,this.lines=s,this.lineWidths=a,this.lineHeight=o,this.maxLineWidth=l,this.fontProperties=c}static measureText(e=" ",t,n=Et._canvas,r=t.wordWrap){const s=`${e}-${t.styleKey}-wordWrap-${r}`;if(Et._measurementCache.has(s))return Et._measurementCache.get(s);const a=iU(t),o=Et.measureFont(a);o.fontSize===0&&(o.fontSize=t.fontSize,o.ascent=t.fontSize);const l=Et.__context;l.font=a;const u=(r?Et._wordWrap(e,t,n):e).split(/(?:\r\n|\r|\n)/),d=new Array(u.length);let p=0;for(let S=0;S<u.length;S++){const w=Et._measureText(u[S],t.letterSpacing,l);d[S]=w,p=Math.max(p,w)}const m=t._stroke?.width||0;let g=p+m;t.dropShadow&&(g+=t.dropShadow.distance);const y=t.lineHeight||o.fontSize;let x=Math.max(y,o.fontSize+m)+(u.length-1)*(y+t.leading);t.dropShadow&&(x+=t.dropShadow.distance);const _=new Et(e,t,g,x,u,d,y+t.leading,p,o);return Et._measurementCache.set(s,_),_}static _measureText(e,t,n){let r=!1;Et.experimentalLetterSpacingSupported&&(Et.experimentalLetterSpacing?(n.letterSpacing=`${t}px`,n.textLetterSpacing=`${t}px`,r=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));const s=n.measureText(e);let a=s.width;const o=-s.actualBoundingBoxLeft;let c=s.actualBoundingBoxRight-o;if(a>0)if(r)a-=t,c-=t;else{const u=(Et.graphemeSegmenter(e).length-1)*t;a+=u,c+=u}return Math.max(a,c)}static _wordWrap(e,t,n=Et._canvas){const r=n.getContext("2d",rS);let s=0,a="",o="";const l=Object.create(null),{letterSpacing:c,whiteSpace:u}=t,d=Et._collapseSpaces(u),p=Et._collapseNewlines(u);let m=!d;const g=t.wordWrapWidth+c,y=Et._tokenize(e);for(let x=0;x<y.length;x++){let _=y[x];if(Et._isNewline(_)){if(!p){o+=Et._addLine(a),m=!d,a="",s=0;continue}_=" "}if(d){const w=Et.isBreakingSpace(_),T=Et.isBreakingSpace(a[a.length-1]);if(w&&T)continue}const S=Et._getFromCache(_,c,l,r);if(S>g)if(a!==""&&(o+=Et._addLine(a),a="",s=0),Et.canBreakWords(_,t.breakWords)){const w=Et.wordWrapSplit(_);for(let T=0;T<w.length;T++){let C=w[T],E=C,D=1;for(;w[T+D];){const R=w[T+D];if(!Et.canBreakChars(E,R,_,T,t.breakWords))C+=R;else break;E=R,D++}T+=D-1;const O=Et._getFromCache(C,c,l,r);O+s>g&&(o+=Et._addLine(a),m=!1,a="",s=0),a+=C,s+=O}}else{a.length>0&&(o+=Et._addLine(a),a="",s=0);const w=x===y.length-1;o+=Et._addLine(_,!w),m=!1,a="",s=0}else S+s>g&&(m=!1,o+=Et._addLine(a),a="",s=0),(a.length>0||!Et.isBreakingSpace(_)||m)&&(a+=_,s+=S)}return o+=Et._addLine(a,!1),o}static _addLine(e,t=!0){return e=Et._trimRight(e),e=t?`${e}
`:e,e}static _getFromCache(e,t,n,r){let s=n[e];return typeof s!="number"&&(s=Et._measureText(e,t,r)+t,n[e]=s),s}static _collapseSpaces(e){return e==="normal"||e==="pre-line"}static _collapseNewlines(e){return e==="normal"}static _trimRight(e){if(typeof e!="string")return"";for(let t=e.length-1;t>=0;t--){const n=e[t];if(!Et.isBreakingSpace(n))break;e=e.slice(0,-1)}return e}static _isNewline(e){return typeof e!="string"?!1:Et._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return typeof e!="string"?!1:Et._breakingSpaces.includes(e.charCodeAt(0))}static _tokenize(e){const t=[];let n="";if(typeof e!="string")return t;for(let r=0;r<e.length;r++){const s=e[r],a=e[r+1];if(Et.isBreakingSpace(s,a)||Et._isNewline(s)){n!==""&&(t.push(n),n=""),s==="\r"&&a===`
`?(t.push(`\r
`),r++):t.push(s);continue}n+=s}return n!==""&&t.push(n),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,n,r,s){return!0}static wordWrapSplit(e){return Et.graphemeSegmenter(e)}static measureFont(e){if(Et._fonts[e])return Et._fonts[e];const t=Et._context;t.font=e;const n=t.measureText(Et.METRICS_STRING+Et.BASELINE_SYMBOL),r={ascent:n.actualBoundingBoxAscent,descent:n.actualBoundingBoxDescent,fontSize:n.actualBoundingBoxAscent+n.actualBoundingBoxDescent};return Et._fonts[e]=r,r}static clearMetrics(e=""){e?delete Et._fonts[e]:Et._fonts={}}static get _canvas(){if(!Et.__canvas){let e;try{const t=new OffscreenCanvas(0,0);if(t.getContext("2d",rS)?.measureText)return Et.__canvas=t,t;e=ta.get().createCanvas()}catch{e=ta.get().createCanvas()}e.width=e.height=10,Et.__canvas=e}return Et.__canvas}static get _context(){return Et.__context||(Et.__context=Et._canvas.getContext("2d",rS)),Et.__context}};vo.METRICS_STRING="|q";vo.BASELINE_SYMBOL="M";vo.BASELINE_MULTIPLIER=1.4;vo.HEIGHT_MULTIPLIER=2;vo.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){const i=new Intl.Segmenter;return e=>{const t=i.segment(e),n=[];let r=0;for(const s of t)n[r++]=s.segment;return n}}return i=>[...i]})();vo.experimentalLetterSpacing=!1;vo._fonts={};vo._newlines=[10,13];vo._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];vo._measurementCache=qQ(1e3);let Rf=vo;const NE=[{offset:0,color:"white"},{offset:1,color:"black"}],vT=class XM{constructor(...e){this.uid=Mi("fillGradient"),this._tick=0,this.type="linear",this.colorStops=[];let t=YQ(e);t={...t.type==="radial"?XM.defaultRadialOptions:XM.defaultLinearOptions,...oz(t)},this._textureSize=t.textureSize,this._wrapMode=t.wrapMode,t.type==="radial"?(this.center=t.center,this.outerCenter=t.outerCenter??this.center,this.innerRadius=t.innerRadius,this.outerRadius=t.outerRadius,this.scale=t.scale,this.rotation=t.rotation):(this.start=t.start,this.end=t.end),this.textureSpace=t.textureSpace,this.type=t.type,t.colorStops.forEach(r=>{this.addColorStop(r.offset,r.color)})}addColorStop(e,t){return this.colorStops.push({offset:e,color:Wi.shared.setValue(t).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:e,y:t}=this.start,{x:n,y:r}=this.end,s=n-e,a=r-t;const o=s<0||a<0;if(this._wrapMode==="clamp-to-edge"){if(s<0){const x=e;e=n,n=x,s*=-1}if(a<0){const x=t;t=r,r=x,a*=-1}}const l=this.colorStops.length?this.colorStops:NE,c=this._textureSize,{canvas:u,context:d}=kE(c,1),p=o?d.createLinearGradient(this._textureSize,0,0,0):d.createLinearGradient(0,0,this._textureSize,0);LE(p,l),d.fillStyle=p,d.fillRect(0,0,c,1),this.texture=new cn({source:new Ky({resource:u,addressMode:this._wrapMode})});const m=Math.sqrt(s*s+a*a),g=Math.atan2(a,s),y=new hn;y.scale(m/c,1),y.rotate(g),y.translate(e,t),this.textureSpace==="local"&&y.scale(c,c),this.transform=y}buildGradient(){this.texture||this._tick++,this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const e=this.colorStops.length?this.colorStops:NE,t=this._textureSize,{canvas:n,context:r}=kE(t,t),{x:s,y:a}=this.center,{x:o,y:l}=this.outerCenter,c=this.innerRadius,u=this.outerRadius,d=o-u,p=l-u,m=t/(u*2),g=(s-d)*m,y=(a-p)*m,x=r.createRadialGradient(g,y,c*m,(o-d)*m,(l-p)*m,u*m);LE(x,e),r.fillStyle=e[e.length-1].color,r.fillRect(0,0,t,t),r.fillStyle=x,r.translate(g,y),r.rotate(this.rotation),r.scale(1,this.scale),r.translate(-g,-y),r.fillRect(0,0,t,t),this.texture=new cn({source:new Ky({resource:n,addressMode:this._wrapMode})});const _=new hn;_.scale(1/m,1/m),_.translate(d,p),this.textureSpace==="local"&&_.scale(t,t),this.transform=_}destroy(){this.texture?.destroy(!0),this.texture=null,this.transform=null,this.colorStops=[],this.start=null,this.end=null,this.center=null,this.outerCenter=null}get styleKey(){return`fill-gradient-${this.uid}-${this._tick}`}};vT.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"};vT.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let lc=vT;function LE(i,e){for(let t=0;t<e.length;t++){const n=e[t];i.addColorStop(n.offset,n.color)}}function kE(i,e){const t=ta.get().createCanvas(i,e),n=t.getContext("2d");return{canvas:t,context:n}}function YQ(i){let e=i[0]??{};return(typeof e=="number"||i[1])&&(Tn("8.5.2","use options object instead"),e={type:"linear",start:{x:i[0],y:i[1]},end:{x:i[2],y:i[3]},textureSpace:i[4],textureSize:i[5]??lc.defaultLinearOptions.textureSize}),e}const OE={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class $b{constructor(e,t){this.uid=Mi("fillPattern"),this._tick=0,this.transform=new hn,this.texture=e,this.transform.scale(1/e.frame.width,1/e.frame.height),t&&(e.source.style.addressModeU=OE[t].addressModeU,e.source.style.addressModeV=OE[t].addressModeV)}setTransform(e){const t=this.texture;this.transform.copyFrom(e),this.transform.invert(),this.transform.scale(1/t.frame.width,1/t.frame.height),this._tick++}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture=e,this._tick++)}get styleKey(){return`fill-pattern-${this.uid}-${this._tick}`}destroy(){this.texture.destroy(!0),this.texture=null}}var sS,zE;function $Q(){if(zE)return sS;zE=1,sS=t;var i={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},e=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function t(s){var a=[];return s.replace(e,function(o,l,c){var u=l.toLowerCase();for(c=r(c),u=="m"&&c.length>2&&(a.push([l].concat(c.splice(0,2))),u="l",l=l=="m"?"l":"L");;){if(c.length==i[u])return c.unshift(l),a.push(c);if(c.length<i[u])throw new Error("malformed path data");a.push([l].concat(c.splice(0,i[u])))}}),a}var n=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function r(s){var a=s.match(n);return a?a.map(Number):[]}return sS}var KQ=$Q();const ZQ=od(KQ);function QQ(i,e){const t=ZQ(i),n=[];let r=null,s=0,a=0;for(let o=0;o<t.length;o++){const l=t[o],c=l[0],u=l;switch(c){case"M":s=u[1],a=u[2],e.moveTo(s,a);break;case"m":s+=u[1],a+=u[2],e.moveTo(s,a);break;case"H":s=u[1],e.lineTo(s,a);break;case"h":s+=u[1],e.lineTo(s,a);break;case"V":a=u[1],e.lineTo(s,a);break;case"v":a+=u[1],e.lineTo(s,a);break;case"L":s=u[1],a=u[2],e.lineTo(s,a);break;case"l":s+=u[1],a+=u[2],e.lineTo(s,a);break;case"C":s=u[5],a=u[6],e.bezierCurveTo(u[1],u[2],u[3],u[4],s,a);break;case"c":e.bezierCurveTo(s+u[1],a+u[2],s+u[3],a+u[4],s+u[5],a+u[6]),s+=u[5],a+=u[6];break;case"S":s=u[3],a=u[4],e.bezierCurveToShort(u[1],u[2],s,a);break;case"s":e.bezierCurveToShort(s+u[1],a+u[2],s+u[3],a+u[4]),s+=u[3],a+=u[4];break;case"Q":s=u[3],a=u[4],e.quadraticCurveTo(u[1],u[2],s,a);break;case"q":e.quadraticCurveTo(s+u[1],a+u[2],s+u[3],a+u[4]),s+=u[3],a+=u[4];break;case"T":s=u[1],a=u[2],e.quadraticCurveToShort(s,a);break;case"t":s+=u[1],a+=u[2],e.quadraticCurveToShort(s,a);break;case"A":s=u[6],a=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],s,a);break;case"a":s+=u[6],a+=u[7],e.arcToSvg(u[1],u[2],u[3],u[4],u[5],s,a);break;case"Z":case"z":e.closePath(),n.length>0&&(r=n.pop(),r?(s=r.startX,a=r.startY):(s=0,a=0)),r=null;break;default:Hr(`Unknown SVG path command: ${c}`)}c!=="Z"&&c!=="z"&&r===null&&(r={startX:s,startY:a},n.push(r))}return e}let JQ=class rU{constructor(e=0,t=0,n=0){this.type="circle",this.x=e,this.y=t,this.radius=n}clone(){return new rU(this.x,this.y,this.radius)}contains(e,t){if(this.radius<=0)return!1;const n=this.radius*this.radius;let r=this.x-e,s=this.y-t;return r*=r,s*=s,r+s<=n}strokeContains(e,t,n,r=.5){if(this.radius===0)return!1;const s=this.x-e,a=this.y-t,o=this.radius,l=(1-r)*n,c=Math.sqrt(s*s+a*a);return c<=o+l&&c>o-(n-l)}getBounds(e){return e||(e=new Qn),e.x=this.x-this.radius,e.y=this.y-this.radius,e.width=this.radius*2,e.height=this.radius*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.radius=e.radius,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}};class bT{constructor(e=0,t=0,n=0,r=0){this.type="ellipse",this.x=e,this.y=t,this.halfWidth=n,this.halfHeight=r}clone(){return new bT(this.x,this.y,this.halfWidth,this.halfHeight)}contains(e,t){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let n=(e-this.x)/this.halfWidth,r=(t-this.y)/this.halfHeight;return n*=n,r*=r,n+r<=1}strokeContains(e,t,n,r=.5){const{halfWidth:s,halfHeight:a}=this;if(s<=0||a<=0)return!1;const o=n*(1-r),l=n-o,c=s-l,u=a-l,d=s+o,p=a+o,m=e-this.x,g=t-this.y,y=m*m/(c*c)+g*g/(u*u),x=m*m/(d*d)+g*g/(p*p);return y>1&&x<=1}getBounds(e){return e||(e=new Qn),e.x=this.x-this.halfWidth,e.y=this.y-this.halfHeight,e.width=this.halfWidth*2,e.height=this.halfHeight*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.halfWidth=e.halfWidth,this.halfHeight=e.halfHeight,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function eJ(i,e,t,n,r,s){const a=i-t,o=e-n,l=r-t,c=s-n,u=a*l+o*c,d=l*l+c*c;let p=-1;d!==0&&(p=u/d);let m,g;p<0?(m=t,g=n):p>1?(m=r,g=s):(m=t+p*l,g=n+p*c);const y=i-m,x=e-g;return y*y+x*x}let tJ,nJ;class Bf{constructor(...e){this.type="polygon";let t=Array.isArray(e[0])?e[0]:e;if(typeof t[0]!="number"){const n=[];for(let r=0,s=t.length;r<s;r++)n.push(t[r].x,t[r].y);t=n}this.points=t,this.closePath=!0}isClockwise(){let e=0;const t=this.points,n=t.length;for(let r=0;r<n;r+=2){const s=t[r],a=t[r+1],o=t[(r+2)%n],l=t[(r+3)%n];e+=(o-s)*(l+a)}return e<0}containsPolygon(e){const t=this.getBounds(tJ),n=e.getBounds(nJ);if(!t.containsRect(n))return!1;const r=e.points;for(let s=0;s<r.length;s+=2){const a=r[s],o=r[s+1];if(!this.contains(a,o))return!1}return!0}clone(){const e=this.points.slice(),t=new Bf(e);return t.closePath=this.closePath,t}contains(e,t){let n=!1;const r=this.points.length/2;for(let s=0,a=r-1;s<r;a=s++){const o=this.points[s*2],l=this.points[s*2+1],c=this.points[a*2],u=this.points[a*2+1];l>t!=u>t&&e<(c-o)*((t-l)/(u-l))+o&&(n=!n)}return n}strokeContains(e,t,n,r=.5){const s=n*n,a=s*(1-r),o=s-a,{points:l}=this,c=l.length-(this.closePath?0:2);for(let u=0;u<c;u+=2){const d=l[u],p=l[u+1],m=l[(u+2)%l.length],g=l[(u+3)%l.length],y=eJ(e,t,d,p,m,g),x=Math.sign((m-d)*(t-p)-(g-p)*(e-d));if(y<=(x<0?o:a))return!0}return!1}getBounds(e){e||(e=new Qn);const t=this.points;let n=1/0,r=-1/0,s=1/0,a=-1/0;for(let o=0,l=t.length;o<l;o+=2){const c=t[o],u=t[o+1];n=c<n?c:n,r=c>r?c:r,s=u<s?u:s,a=u>a?u:a}return e.x=n,e.width=r-n,e.y=s,e.height=a-s,e}copyFrom(e){return this.points=e.points.slice(),this.closePath=e.closePath,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((e,t)=>`${e}, ${t}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return Tn("8.11.0","Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return Tn("8.11.0","Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}const a1=(i,e,t,n,r,s,a)=>{const o=i-t,l=e-n,c=Math.sqrt(o*o+l*l);return c>=r-s&&c<=r+a};class _T{constructor(e=0,t=0,n=0,r=0,s=20){this.type="roundedRectangle",this.x=e,this.y=t,this.width=n,this.height=r,this.radius=s}getBounds(e){return e||(e=new Qn),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}clone(){return new _T(this.x,this.y,this.width,this.height,this.radius)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+n&&t<=this.y+this.height-n||e>=this.x+n&&e<=this.x+this.width-n)return!0;let r=e-(this.x+n),s=t-(this.y+n);const a=n*n;if(r*r+s*s<=a||(r=e-(this.x+this.width-n),r*r+s*s<=a)||(s=t-(this.y+this.height-n),r*r+s*s<=a)||(r=e-(this.x+n),r*r+s*s<=a))return!0}return!1}strokeContains(e,t,n,r=.5){const{x:s,y:a,width:o,height:l,radius:c}=this,u=n*(1-r),d=n-u,p=s+c,m=a+c,g=o-c*2,y=l-c*2,x=s+o,_=a+l;return(e>=s-u&&e<=s+d||e>=x-d&&e<=x+u)&&t>=m&&t<=m+y||(t>=a-u&&t<=a+d||t>=_-d&&t<=_+u)&&e>=p&&e<=p+g?!0:e<p&&t<m&&a1(e,t,p,m,c,d,u)||e>x-c&&t<m&&a1(e,t,x-c,m,c,d,u)||e>x-c&&t>_-c&&a1(e,t,x-c,_-c,c,d,u)||e<p&&t>_-c&&a1(e,t,p,_-c,c,d,u)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const sU={};function iJ(i,e,t){let n=2166136261;for(let r=0;r<e;r++)n^=i[r].uid,n=Math.imul(n,16777619),n>>>=0;return sU[n]||rJ(i,e,n,t)}function rJ(i,e,t,n){const r={};let s=0;for(let o=0;o<n;o++){const l=o<e?i[o]:cn.EMPTY.source;r[s++]=l.source,r[s++]=l.style}const a=new Ry(r);return sU[t]=a,a}class UE{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this.uint32View=null,this.float32View=null,this.uint16View=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._int32View=null,this._float64Array=null,this._bigUint64Array=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}function FE(i,e){const t=i.byteLength/8|0,n=new Float64Array(i,0,t);new Float64Array(e,0,t).set(n);const s=i.byteLength-t*8;if(s>0){const a=new Uint8Array(i,t*8,s);new Uint8Array(e,t*8,s).set(a)}}const sJ={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var aJ=(i=>(i[i.DISABLED=0]="DISABLED",i[i.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",i[i.MASK_ACTIVE=2]="MASK_ACTIVE",i[i.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",i[i.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",i[i.NONE=5]="NONE",i))(aJ||{});function BE(i,e){return e.alphaMode==="no-premultiply-alpha"&&sJ[i]||i}const oJ=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function lJ(i){let e="";for(let t=0;t<i;++t)t>0&&(e+=`
else `),t<i-1&&(e+=`if(test == ${t}.0){}`);return e}function cJ(i,e){if(i===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const t=e.createShader(e.FRAGMENT_SHADER);try{for(;;){const n=oJ.replace(/%forloop%/gi,lJ(i));if(e.shaderSource(t,n),e.compileShader(t),!e.getShaderParameter(t,e.COMPILE_STATUS))i=i/2|0;else break}}finally{e.deleteShader(t)}return i}let Kd=null;function uJ(){if(Kd)return Kd;const i=Uz();return Kd=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),Kd=cJ(Kd,i),i.getExtension("WEBGL_lose_context")?.loseContext(),Kd}class hJ{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let e=0;e<this.count;e++){const t=this.textures[e];this.textures[e]=null,this.ids[t.uid]=null}this.count=0}}class dJ{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new hJ,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const lm=[];let Zy=0;Bg.register({clear:()=>{if(lm.length>0)for(const i of lm)i&&i.destroy();lm.length=0,Zy=0}});function HE(){return Zy>0?lm[--Zy]:new dJ}function jE(i){lm[Zy++]=i}let Sp=0;const aU=class oU{constructor(e){this.uid=Mi("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],e={...oU.defaultOptions,...e},e.maxTextures||(Tn("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),e.maxTextures=uJ());const{maxTextures:t,attributesInitialSize:n,indicesInitialSize:r}=e;this.attributeBuffer=new UE(n*4),this.indexBuffer=new Uint16Array(r),this.maxTextures=t}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let e=0;e<this.batchIndex;e++)jE(this.batches[e]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(e){this._elements[this.elementSize++]=e,e._indexStart=this.indexSize,e._attributeStart=this.attributeSize,e._batcher=this,this.indexSize+=e.indexSize,this.attributeSize+=e.attributeSize*this.vertexSize}checkAndUpdateTexture(e,t){const n=e._batch.textures.ids[t._source.uid];return!n&&n!==0?!1:(e._textureId=n,e.texture=t,!0)}updateElement(e){this.dirty=!0;const t=this.attributeBuffer;e.packAsQuad?this.packQuadAttributes(e,t.float32View,t.uint32View,e._attributeStart,e._textureId):this.packAttributes(e,t.float32View,t.uint32View,e._attributeStart,e._textureId)}break(e){const t=this._elements;if(!t[this.elementStart])return;let n=HE(),r=n.textures;r.clear();const s=t[this.elementStart];let a=BE(s.blendMode,s.texture._source),o=s.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const l=this.attributeBuffer.float32View,c=this.attributeBuffer.uint32View,u=this.indexBuffer;let d=this._batchIndexSize,p=this._batchIndexStart,m="startBatch";const g=this.maxTextures;for(let y=this.elementStart;y<this.elementSize;++y){const x=t[y];t[y]=null;const S=x.texture._source,w=BE(x.blendMode,S),T=a!==w||o!==x.topology;if(S._batchTick===Sp&&!T){x._textureId=S._textureBindLocation,d+=x.indexSize,x.packAsQuad?(this.packQuadAttributes(x,l,c,x._attributeStart,x._textureId),this.packQuadIndex(u,x._indexStart,x._attributeStart/this.vertexSize)):(this.packAttributes(x,l,c,x._attributeStart,x._textureId),this.packIndex(x,u,x._indexStart,x._attributeStart/this.vertexSize)),x._batch=n;continue}S._batchTick=Sp,(r.count>=g||T)&&(this._finishBatch(n,p,d-p,r,a,o,e,m),m="renderBatch",p=d,a=w,o=x.topology,n=HE(),r=n.textures,r.clear(),++Sp),x._textureId=S._textureBindLocation=r.count,r.ids[S.uid]=r.count,r.textures[r.count++]=S,x._batch=n,d+=x.indexSize,x.packAsQuad?(this.packQuadAttributes(x,l,c,x._attributeStart,x._textureId),this.packQuadIndex(u,x._indexStart,x._attributeStart/this.vertexSize)):(this.packAttributes(x,l,c,x._attributeStart,x._textureId),this.packIndex(x,u,x._indexStart,x._attributeStart/this.vertexSize))}r.count>0&&(this._finishBatch(n,p,d-p,r,a,o,e,m),p=d,++Sp),this.elementStart=this.elementSize,this._batchIndexStart=p,this._batchIndexSize=d}_finishBatch(e,t,n,r,s,a,o,l){e.gpuBindGroup=null,e.bindGroup=null,e.action=l,e.batcher=this,e.textures=r,e.blendMode=s,e.topology=a,e.start=t,e.size=n,++Sp,this.batches[this.batchIndex++]=e,o.add(e)}finish(e){this.break(e)}ensureAttributeBuffer(e){e*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(e*4)}ensureIndexBuffer(e){e<=this.indexBuffer.length||this._resizeIndexBuffer(e)}_resizeAttributeBuffer(e){const t=Math.max(e,this.attributeBuffer.size*2),n=new UE(t);FE(this.attributeBuffer.rawBinaryData,n.rawBinaryData),this.attributeBuffer=n}_resizeIndexBuffer(e){const t=this.indexBuffer;let n=Math.max(e,t.length*1.5);n+=n%2;const r=n>65535?new Uint32Array(n):new Uint16Array(n);if(r.BYTES_PER_ELEMENT!==t.BYTES_PER_ELEMENT)for(let s=0;s<t.length;s++)r[s]=t[s];else FE(t.buffer,r.buffer);this.indexBuffer=r}packQuadIndex(e,t,n){e[t]=n+0,e[t+1]=n+1,e[t+2]=n+2,e[t+3]=n+0,e[t+4]=n+2,e[t+5]=n+3}packIndex(e,t,n,r){const s=e.indices,a=e.indexSize,o=e.indexOffset,l=e.attributeOffset;for(let c=0;c<a;c++)t[n++]=r+s[c+o]-l}destroy(e={}){if(this.batches!==null){for(let t=0;t<this.batches.length;t++)jE(this.batches[t]);this.batches=null,this.geometry.destroy(!0),this.geometry=null,e.shader&&(this.shader?.destroy(),this.shader=null);for(let t=0;t<this._elements.length;t++)this._elements[t]&&(this._elements[t]._batch=null);this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}}};aU.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let fJ=aU;var _s=(i=>(i[i.MAP_READ=1]="MAP_READ",i[i.MAP_WRITE=2]="MAP_WRITE",i[i.COPY_SRC=4]="COPY_SRC",i[i.COPY_DST=8]="COPY_DST",i[i.INDEX=16]="INDEX",i[i.VERTEX=32]="VERTEX",i[i.UNIFORM=64]="UNIFORM",i[i.STORAGE=128]="STORAGE",i[i.INDIRECT=256]="INDIRECT",i[i.QUERY_RESOLVE=512]="QUERY_RESOLVE",i[i.STATIC=1024]="STATIC",i))(_s||{});class zm extends ll{constructor(e){let{data:t,size:n}=e;const{usage:r,label:s,shrinkToFit:a}=e;super(),this.uid=Mi("buffer"),this._resourceType="buffer",this._resourceId=Mi("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,t instanceof Array&&(t=new Float32Array(t)),this._data=t,n??(n=t?.byteLength);const o=!!t;this.descriptor={size:n,usage:r,mappedAtCreation:o,label:s},this.shrinkToFit=a??!0}get data(){return this._data}set data(e){this.setDataWithSize(e,e.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&_s.STATIC)}set static(e){e?this.descriptor.usage|=_s.STATIC:this.descriptor.usage&=~_s.STATIC}setDataWithSize(e,t,n){if(this._updateID++,this._updateSize=t*e.BYTES_PER_ELEMENT,this._data===e){n&&this.emit("update",this);return}const r=this._data;if(this._data=e,this._dataInt32=null,!r||r.length!==e.length){!this.shrinkToFit&&r&&e.byteLength<r.byteLength?n&&this.emit("update",this):(this.descriptor.size=e.byteLength,this._resourceId=Mi("resource"),this.emit("change",this));return}n&&this.emit("update",this)}update(e){this._updateSize=e??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function lU(i,e){if(!(i instanceof zm)){let t=e?_s.INDEX:_s.VERTEX;i instanceof Array&&(e?(i=new Uint32Array(i),t=_s.INDEX|_s.COPY_DST):(i=new Float32Array(i),t=_s.VERTEX|_s.COPY_DST)),i=new zm({data:i,label:e?"index-mesh-buffer":"vertex-mesh-buffer",usage:t})}return i}function pJ(i,e,t){const n=i.getAttribute(e);if(!n)return t.minX=0,t.minY=0,t.maxX=0,t.maxY=0,t;const r=n.buffer.data;let s=1/0,a=1/0,o=-1/0,l=-1/0;const c=r.BYTES_PER_ELEMENT,u=(n.offset||0)/c,d=(n.stride||8)/c;for(let p=u;p<r.length;p+=d){const m=r[p],g=r[p+1];m>o&&(o=m),g>l&&(l=g),m<s&&(s=m),g<a&&(a=g)}return t.minX=s,t.minY=a,t.maxX=o,t.maxY=l,t}function mJ(i){return(i instanceof zm||Array.isArray(i)||i.BYTES_PER_ELEMENT)&&(i={buffer:i}),i.buffer=lU(i.buffer,!1),i}class gJ extends ll{constructor(e={}){super(),this.uid=Mi("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new mo,this._boundsDirty=!0;const{attributes:t,indexBuffer:n,topology:r}=e;if(this.buffers=[],this.attributes={},t)for(const s in t)this.addAttribute(s,t[s]);this.instanceCount=e.instanceCount??1,n&&this.addIndex(n),this.topology=r||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(e){return this.attributes[e]}getIndex(){return this.indexBuffer}getBuffer(e){return this.getAttribute(e).buffer}getSize(){for(const e in this.attributes){const t=this.attributes[e];return t.buffer.data.length/(t.stride/4||t.size)}return 0}addAttribute(e,t){const n=mJ(t);this.buffers.indexOf(n.buffer)===-1&&(this.buffers.push(n.buffer),n.buffer.on("update",this.onBufferUpdate,this),n.buffer.on("change",this.onBufferUpdate,this)),this.attributes[e]=n}addIndex(e){this.indexBuffer=lU(e,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,pJ(this,"aPosition",this._bounds)):this._bounds}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners(),e&&this.buffers.forEach(t=>t.destroy()),this.indexBuffer?.destroy(),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const xJ=new Float32Array(1),yJ=new Uint32Array(1);class vJ extends gJ{constructor(){const t=new zm({data:xJ,label:"attribute-batch-buffer",usage:_s.VERTEX|_s.COPY_DST,shrinkToFit:!1}),n=new zm({data:yJ,label:"index-batch-buffer",usage:_s.INDEX|_s.COPY_DST,shrinkToFit:!1}),r=24;super({attributes:{aPosition:{buffer:t,format:"float32x2",stride:r,offset:0},aUV:{buffer:t,format:"float32x2",stride:r,offset:8},aColor:{buffer:t,format:"unorm8x4",stride:r,offset:16},aTextureIdAndRound:{buffer:t,format:"uint16x2",stride:r,offset:20}},indexBuffer:n})}}function VE(i,e,t){if(i)for(const n in i){const r=n.toLocaleLowerCase(),s=e[r];if(s){let a=i[n];n==="header"&&(a=a.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),t&&s.push(`//----${t}----//`),s.push(a)}else Hr(`${n} placement hook does not exist in shader`)}}const bJ=/\{\{(.*?)\}\}/g;function GE(i){const e={};return(i.match(bJ)?.map(n=>n.replace(/[{()}]/g,""))??[]).forEach(n=>{e[n]=[]}),e}function WE(i,e){let t;const n=/@in\s+([^;]+);/g;for(;(t=n.exec(i))!==null;)e.push(t[1])}function qE(i,e,t=!1){const n=[];WE(e,n),i.forEach(o=>{o.header&&WE(o.header,n)});const r=n;t&&r.sort();const s=r.map((o,l)=>`       @location(${l}) ${o},`).join(`
`);let a=e.replace(/@in\s+[^;]+;\s*/g,"");return a=a.replace("{{in}}",`
${s}
`),a}function XE(i,e){let t;const n=/@out\s+([^;]+);/g;for(;(t=n.exec(i))!==null;)e.push(t[1])}function _J(i){const t=/\b(\w+)\s*:/g.exec(i);return t?t[1]:""}function SJ(i){const e=/@.*?\s+/g;return i.replace(e,"")}function wJ(i,e){const t=[];XE(e,t),i.forEach(l=>{l.header&&XE(l.header,t)});let n=0;const r=t.sort().map(l=>l.indexOf("builtin")>-1?l:`@location(${n++}) ${l}`).join(`,
`),s=t.sort().map(l=>`       var ${SJ(l)};`).join(`
`),a=`return VSOutput(
            ${t.sort().map(l=>` ${_J(l)}`).join(`,
`)});`;let o=e.replace(/@out\s+[^;]+;\s*/g,"");return o=o.replace("{{struct}}",`
${r}
`),o=o.replace("{{start}}",`
${s}
`),o=o.replace("{{return}}",`
${a}
`),o}function YE(i,e){let t=i;for(const n in e){const r=e[n];r.join(`
`).length?t=t.replace(`{{${n}}}`,`//-----${n} START-----//
${r.join(`
`)}
//----${n} FINISH----//`):t=t.replace(`{{${n}}}`,"")}return t}const Qc=Object.create(null),aS=new Map;let MJ=0;function TJ({template:i,bits:e}){const t=cU(i,e);if(Qc[t])return Qc[t];const{vertex:n,fragment:r}=CJ(i,e);return Qc[t]=uU(n,r,e),Qc[t]}function AJ({template:i,bits:e}){const t=cU(i,e);return Qc[t]||(Qc[t]=uU(i.vertex,i.fragment,e)),Qc[t]}function CJ(i,e){const t=e.map(a=>a.vertex).filter(a=>!!a),n=e.map(a=>a.fragment).filter(a=>!!a);let r=qE(t,i.vertex,!0);r=wJ(t,r);const s=qE(n,i.fragment,!0);return{vertex:r,fragment:s}}function cU(i,e){return e.map(t=>(aS.has(t)||aS.set(t,MJ++),aS.get(t))).sort((t,n)=>t-n).join("-")+i.vertex+i.fragment}function uU(i,e,t){const n=GE(i),r=GE(e);return t.forEach(s=>{VE(s.vertex,n,s.name),VE(s.fragment,r,s.name)}),{vertex:YE(i,n),fragment:YE(e,r)}}const EJ=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,RJ=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,PJ=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,IJ=`

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`,DJ={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},NJ={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function LJ({bits:i,name:e}){const t=TJ({template:{fragment:RJ,vertex:EJ},bits:[DJ,...i]});return Hg.from({name:e,vertex:{source:t.vertex,entryPoint:"main"},fragment:{source:t.fragment,entryPoint:"main"}})}function kJ({bits:i,name:e}){return new xT({name:e,...AJ({template:{vertex:PJ,fragment:IJ},bits:[NJ,...i]})})}const OJ={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},zJ={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},oS={};function UJ(i){const e=[];if(i===1)e.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),e.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let t=0;for(let n=0;n<i;n++)e.push(`@group(1) @binding(${t++}) var textureSource${n+1}: texture_2d<f32>;`),e.push(`@group(1) @binding(${t++}) var textureSampler${n+1}: sampler;`)}return e.join(`
`)}function FJ(i){const e=[];if(i===1)e.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{e.push("switch vTextureId {");for(let t=0;t<i;t++)t===i-1?e.push("  default:{"):e.push(`  case ${t}:{`),e.push(`      outColor = textureSampleGrad(textureSource${t+1}, textureSampler${t+1}, vUV, uvDx, uvDy);`),e.push("      break;}");e.push("}")}return e.join(`
`)}function BJ(i){return oS[i]||(oS[i]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${UJ(i)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${FJ(i)}
            `}}),oS[i]}const lS={};function HJ(i){const e=[];for(let t=0;t<i;t++)t>0&&e.push("else"),t<i-1&&e.push(`if(vTextureId < ${t}.5)`),e.push("{"),e.push(`	outColor = texture(uTextures[${t}], vUV);`),e.push("}");return e.join(`
`)}function jJ(i){return lS[i]||(lS[i]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${i}];

            `,main:`

                ${HJ(i)}
            `}}),lS[i]}const VJ={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},GJ={name:"round-pixels-bit",vertex:{header:`
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},$E={};function WJ(i){let e=$E[i];if(e)return e;const t=new Int32Array(i);for(let n=0;n<i;n++)t[n]=n;return e=$E[i]=new Vz({uTextures:{value:t,type:"i32",size:i}},{isStatic:!0}),e}class KE extends Yb{constructor(e){const t=kJ({name:"batch",bits:[zJ,jJ(e),GJ]}),n=LJ({name:"batch",bits:[OJ,BJ(e),VJ]});super({glProgram:t,gpuProgram:n,resources:{batchSamplers:WJ(e)}}),this.maxTextures=e}}let wp=null;const hU=class dU extends fJ{constructor(e){super(e),this.geometry=new vJ,this.name=dU.extension.name,this.vertexSize=6,wp??(wp=new KE(e.maxTextures)),this.shader=wp}packAttributes(e,t,n,r,s){const a=s<<16|e.roundPixels&65535,o=e.transform,l=o.a,c=o.b,u=o.c,d=o.d,p=o.tx,m=o.ty,{positions:g,uvs:y}=e,x=e.color,_=e.attributeOffset,S=_+e.attributeSize;for(let w=_;w<S;w++){const T=w*2,C=g[T],E=g[T+1];t[r++]=l*C+u*E+p,t[r++]=d*E+c*C+m,t[r++]=y[T],t[r++]=y[T+1],n[r++]=x,n[r++]=a}}packQuadAttributes(e,t,n,r,s){const a=e.texture,o=e.transform,l=o.a,c=o.b,u=o.c,d=o.d,p=o.tx,m=o.ty,g=e.bounds,y=g.maxX,x=g.minX,_=g.maxY,S=g.minY,w=a.uvs,T=e.color,C=s<<16|e.roundPixels&65535;t[r+0]=l*x+u*S+p,t[r+1]=d*S+c*x+m,t[r+2]=w.x0,t[r+3]=w.y0,n[r+4]=T,n[r+5]=C,t[r+6]=l*y+u*S+p,t[r+7]=d*S+c*y+m,t[r+8]=w.x1,t[r+9]=w.y1,n[r+10]=T,n[r+11]=C,t[r+12]=l*y+u*_+p,t[r+13]=d*_+c*y+m,t[r+14]=w.x2,t[r+15]=w.y2,n[r+16]=T,n[r+17]=C,t[r+18]=l*x+u*_+p,t[r+19]=d*_+c*x+m,t[r+20]=w.x3,t[r+21]=w.y3,n[r+22]=T,n[r+23]=C}_updateMaxTextures(e){this.shader.maxTextures!==e&&(wp=new KE(e),this.shader=wp)}destroy(){this.shader=null,super.destroy()}};hU.extension={type:[In.Batcher],name:"default"};let qJ=hU;function XJ(i,e,t,n,r,s,a,o=null){let l=0;t*=e,r*=s;const c=o.a,u=o.b,d=o.c,p=o.d,m=o.tx,g=o.ty;for(;l<a;){const y=i[t],x=i[t+1];n[r]=c*y+d*x+m,n[r+1]=u*y+p*x+g,r+=s,t+=e,l++}}function YJ(i,e,t,n){let r=0;for(e*=t;r<n;)i[e]=0,i[e+1]=0,e+=t,r++}function fU(i,e,t,n,r){const s=e.a,a=e.b,o=e.c,l=e.d,c=e.tx,u=e.ty;t||(t=0),n||(n=2),r||(r=i.length/n-t);let d=t*n;for(let p=0;p<r;p++){const m=i[d],g=i[d+1];i[d]=s*m+o*g+c,i[d+1]=a*m+l*g+u,d+=n}}const $J=new hn;class pU{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const e=this.baseColor,t=e>>16|e&65280|(e&255)<<16,n=this.renderable;return n?xz(t,n.groupColor)+(this.alpha*n.groupAlpha*255<<24):t+(this.alpha*255<<24)}get transform(){return this.renderable?.groupTransform||$J}copyTo(e){e.indexOffset=this.indexOffset,e.indexSize=this.indexSize,e.attributeOffset=this.attributeOffset,e.attributeSize=this.attributeSize,e.baseColor=this.baseColor,e.alpha=this.alpha,e.texture=this.texture,e.geometryData=this.geometryData,e.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}destroy(){this.renderable=null,this.texture=null,this.geometryData=null,this._batcher=null,this._batch=null}}const Um={extension:{type:In.ShapeBuilder,name:"circle"},build(i,e){let t,n,r,s,a,o;if(i.type==="circle"){const T=i;if(a=o=T.radius,a<=0)return!1;t=T.x,n=T.y,r=s=0}else if(i.type==="ellipse"){const T=i;if(a=T.halfWidth,o=T.halfHeight,a<=0||o<=0)return!1;t=T.x,n=T.y,r=s=0}else{const T=i,C=T.width/2,E=T.height/2;t=T.x+C,n=T.y+E,a=o=Math.max(0,Math.min(T.radius,Math.min(C,E))),r=C-a,s=E-o}if(r<0||s<0)return!1;const l=Math.ceil(2.3*Math.sqrt(a+o)),c=l*8+(r?4:0)+(s?4:0);if(c===0)return!1;if(l===0)return e[0]=e[6]=t+r,e[1]=e[3]=n+s,e[2]=e[4]=t-r,e[5]=e[7]=n-s,!0;let u=0,d=l*4+(r?2:0)+2,p=d,m=c,g=r+a,y=s,x=t+g,_=t-g,S=n+y;if(e[u++]=x,e[u++]=S,e[--d]=S,e[--d]=_,s){const T=n-y;e[p++]=_,e[p++]=T,e[--m]=T,e[--m]=x}for(let T=1;T<l;T++){const C=Math.PI/2*(T/l),E=r+Math.cos(C)*a,D=s+Math.sin(C)*o,O=t+E,R=t-E,P=n+D,L=n-D;e[u++]=O,e[u++]=P,e[--d]=P,e[--d]=R,e[p++]=R,e[p++]=L,e[--m]=L,e[--m]=O}g=r,y=s+o,x=t+g,_=t-g,S=n+y;const w=n-y;return e[u++]=x,e[u++]=S,e[--m]=w,e[--m]=x,r&&(e[u++]=_,e[u++]=S,e[--m]=w,e[--m]=_),!0},triangulate(i,e,t,n,r,s){if(i.length===0)return;let a=0,o=0;for(let u=0;u<i.length;u+=2)a+=i[u],o+=i[u+1];a/=i.length/2,o/=i.length/2;let l=n;e[l*t]=a,e[l*t+1]=o;const c=l++;for(let u=0;u<i.length;u+=2)e[l*t]=i[u],e[l*t+1]=i[u+1],u>0&&(r[s++]=l,r[s++]=c,r[s++]=l-1),l++;r[s++]=c+1,r[s++]=c,r[s++]=l-1}},KJ={...Um,extension:{...Um.extension,name:"ellipse"}},ZJ={...Um,extension:{...Um.extension,name:"roundedRectangle"}},mU=1e-4,ZE=1e-4;function QJ(i){const e=i.length;if(e<6)return 1;let t=0;for(let n=0,r=i[e-2],s=i[e-1];n<e;n+=2){const a=i[n],o=i[n+1];t+=(a-r)*(o+s),r=a,s=o}return t<0?-1:1}function QE(i,e,t,n,r,s,a,o){const l=i-t*r,c=e-n*r,u=i+t*s,d=e+n*s;let p,m;a?(p=n,m=-t):(p=-n,m=t);const g=l+p,y=c+m,x=u+p,_=d+m;return o.push(g,y),o.push(x,_),2}function ih(i,e,t,n,r,s,a,o){const l=t-i,c=n-e;let u=Math.atan2(l,c),d=Math.atan2(r-i,s-e);o&&u<d?u+=Math.PI*2:!o&&u>d&&(d+=Math.PI*2);let p=u;const m=d-u,g=Math.abs(m),y=Math.sqrt(l*l+c*c),x=(15*g*Math.sqrt(y)/Math.PI>>0)+1,_=m/x;if(p+=_,o){a.push(i,e),a.push(t,n);for(let S=1,w=p;S<x;S++,w+=_)a.push(i,e),a.push(i+Math.sin(w)*y,e+Math.cos(w)*y);a.push(i,e),a.push(r,s)}else{a.push(t,n),a.push(i,e);for(let S=1,w=p;S<x;S++,w+=_)a.push(i+Math.sin(w)*y,e+Math.cos(w)*y),a.push(i,e);a.push(r,s),a.push(i,e)}return x*2}function JJ(i,e,t,n,r,s){const a=mU;if(i.length===0)return;const o=e;let l=o.alignment;if(e.alignment!==.5){let Q=QJ(i);l=(l-.5)*Q+.5}const c=new Sn(i[0],i[1]),u=new Sn(i[i.length-2],i[i.length-1]),d=n,p=Math.abs(c.x-u.x)<a&&Math.abs(c.y-u.y)<a;if(d){i=i.slice(),p&&(i.pop(),i.pop(),u.set(i[i.length-2],i[i.length-1]));const Q=(c.x+u.x)*.5,se=(u.y+c.y)*.5;i.unshift(Q,se),i.push(Q,se)}const m=r,g=i.length/2;let y=i.length;const x=m.length/2,_=o.width/2,S=_*_,w=o.miterLimit*o.miterLimit;let T=i[0],C=i[1],E=i[2],D=i[3],O=0,R=0,P=-(C-D),L=T-E,V=0,j=0,B=Math.sqrt(P*P+L*L);P/=B,L/=B,P*=_,L*=_;const J=l,U=(1-J)*2,X=J*2;d||(o.cap==="round"?y+=ih(T-P*(U-X)*.5,C-L*(U-X)*.5,T-P*U,C-L*U,T+P*X,C+L*X,m,!0)+2:o.cap==="square"&&(y+=QE(T,C,P,L,U,X,!0,m))),m.push(T-P*U,C-L*U),m.push(T+P*X,C+L*X);for(let Q=1;Q<g-1;++Q){T=i[(Q-1)*2],C=i[(Q-1)*2+1],E=i[Q*2],D=i[Q*2+1],O=i[(Q+1)*2],R=i[(Q+1)*2+1],P=-(C-D),L=T-E,B=Math.sqrt(P*P+L*L),P/=B,L/=B,P*=_,L*=_,V=-(D-R),j=E-O,B=Math.sqrt(V*V+j*j),V/=B,j/=B,V*=_,j*=_;const se=E-T,ye=C-D,we=E-O,He=R-D,De=se*we+ye*He,Oe=ye*we-He*se,fe=Oe<0;if(Math.abs(Oe)<.001*Math.abs(De)){m.push(E-P*U,D-L*U),m.push(E+P*X,D+L*X),De>=0&&(o.join==="round"?y+=ih(E,D,E-P*U,D-L*U,E-V*U,D-j*U,m,!1)+4:y+=2,m.push(E-V*X,D-j*X),m.push(E+V*U,D+j*U));continue}const ge=(-P+T)*(-L+D)-(-P+E)*(-L+C),Ne=(-V+O)*(-j+D)-(-V+E)*(-j+R),Qe=(se*Ne-we*ge)/Oe,et=(He*ge-ye*Ne)/Oe,Nt=(Qe-E)*(Qe-E)+(et-D)*(et-D),Gt=E+(Qe-E)*U,vt=D+(et-D)*U,Te=E-(Qe-E)*X,Y=D-(et-D)*X,Ee=Math.min(se*se+ye*ye,we*we+He*He),Ie=fe?U:X,Ge=Ee+Ie*Ie*S;Nt<=Ge?o.join==="bevel"||Nt/S>w?(fe?(m.push(Gt,vt),m.push(E+P*X,D+L*X),m.push(Gt,vt),m.push(E+V*X,D+j*X)):(m.push(E-P*U,D-L*U),m.push(Te,Y),m.push(E-V*U,D-j*U),m.push(Te,Y)),y+=2):o.join==="round"?fe?(m.push(Gt,vt),m.push(E+P*X,D+L*X),y+=ih(E,D,E+P*X,D+L*X,E+V*X,D+j*X,m,!0)+4,m.push(Gt,vt),m.push(E+V*X,D+j*X)):(m.push(E-P*U,D-L*U),m.push(Te,Y),y+=ih(E,D,E-P*U,D-L*U,E-V*U,D-j*U,m,!1)+4,m.push(E-V*U,D-j*U),m.push(Te,Y)):(m.push(Gt,vt),m.push(Te,Y)):(m.push(E-P*U,D-L*U),m.push(E+P*X,D+L*X),o.join==="round"?fe?y+=ih(E,D,E+P*X,D+L*X,E+V*X,D+j*X,m,!0)+2:y+=ih(E,D,E-P*U,D-L*U,E-V*U,D-j*U,m,!1)+2:o.join==="miter"&&Nt/S<=w&&(fe?(m.push(Te,Y),m.push(Te,Y)):(m.push(Gt,vt),m.push(Gt,vt)),y+=2),m.push(E-V*U,D-j*U),m.push(E+V*X,D+j*X),y+=2)}T=i[(g-2)*2],C=i[(g-2)*2+1],E=i[(g-1)*2],D=i[(g-1)*2+1],P=-(C-D),L=T-E,B=Math.sqrt(P*P+L*L),P/=B,L/=B,P*=_,L*=_,m.push(E-P*U,D-L*U),m.push(E+P*X,D+L*X),d||(o.cap==="round"?y+=ih(E-P*(U-X)*.5,D-L*(U-X)*.5,E-P*U,D-L*U,E+P*X,D+L*X,m,!1)+2:o.cap==="square"&&(y+=QE(E,D,P,L,U,X,!1,m)));const $=ZE*ZE;for(let Q=x;Q<y+x-2;++Q)T=m[Q*2],C=m[Q*2+1],E=m[(Q+1)*2],D=m[(Q+1)*2+1],O=m[(Q+2)*2],R=m[(Q+2)*2+1],!(Math.abs(T*(D-R)+E*(R-C)+O*(C-D))<$)&&s.push(Q,Q+1,Q+2)}function eee(i,e,t,n){const r=mU;if(i.length===0)return;const s=i[0],a=i[1],o=i[i.length-2],l=i[i.length-1],c=e||Math.abs(s-o)<r&&Math.abs(a-l)<r,u=t,d=i.length/2,p=u.length/2;for(let m=0;m<d;m++)u.push(i[m*2]),u.push(i[m*2+1]);for(let m=0;m<d-1;m++)n.push(p+m,p+m+1);c&&n.push(p+d-1,p)}function gU(i,e,t,n,r,s,a){const o=UQ(i,e,2);if(!o)return;for(let c=0;c<o.length;c+=3)s[a++]=o[c]+r,s[a++]=o[c+1]+r,s[a++]=o[c+2]+r;let l=r*n;for(let c=0;c<i.length;c+=2)t[l]=i[c],t[l+1]=i[c+1],l+=n}const tee=[],nee={extension:{type:In.ShapeBuilder,name:"polygon"},build(i,e){for(let t=0;t<i.points.length;t++)e[t]=i.points[t];return!0},triangulate(i,e,t,n,r,s){gU(i,tee,e,t,n,r,s)}},iee={extension:{type:In.ShapeBuilder,name:"rectangle"},build(i,e){const t=i,n=t.x,r=t.y,s=t.width,a=t.height;return s>0&&a>0?(e[0]=n,e[1]=r,e[2]=n+s,e[3]=r,e[4]=n+s,e[5]=r+a,e[6]=n,e[7]=r+a,!0):!1},triangulate(i,e,t,n,r,s){let a=0;n*=t,e[n+a]=i[0],e[n+a+1]=i[1],a+=t,e[n+a]=i[2],e[n+a+1]=i[3],a+=t,e[n+a]=i[6],e[n+a+1]=i[7],a+=t,e[n+a]=i[4],e[n+a+1]=i[5],a+=t;const o=n/t;r[s++]=o,r[s++]=o+1,r[s++]=o+2,r[s++]=o+1,r[s++]=o+3,r[s++]=o+2}},ree={extension:{type:In.ShapeBuilder,name:"triangle"},build(i,e){return e[0]=i.x,e[1]=i.y,e[2]=i.x2,e[3]=i.y2,e[4]=i.x3,e[5]=i.y3,!0},triangulate(i,e,t,n,r,s){let a=0;n*=t,e[n+a]=i[0],e[n+a+1]=i[1],a+=t,e[n+a]=i[2],e[n+a+1]=i[3],a+=t,e[n+a]=i[4],e[n+a+1]=i[5];const o=n/t;r[s++]=o,r[s++]=o+1,r[s++]=o+2}},see=new hn,aee=new Qn;function oee(i,e,t,n){const r=e.matrix?i.copyFrom(e.matrix).invert():i.identity();if(e.textureSpace==="local"){const a=t.getBounds(aee);e.width&&a.pad(e.width);const{x:o,y:l}=a,c=1/a.width,u=1/a.height,d=-o*c,p=-l*u,m=r.a,g=r.b,y=r.c,x=r.d;r.a*=c,r.b*=c,r.c*=u,r.d*=u,r.tx=d*m+p*y+r.tx,r.ty=d*g+p*x+r.ty}else r.translate(e.texture.frame.x,e.texture.frame.y),r.scale(1/e.texture.source.width,1/e.texture.source.height);const s=e.texture.source.style;return!(e.fill instanceof lc)&&s.addressMode==="clamp-to-edge"&&(s.addressMode="repeat",s.update()),n&&r.append(see.copyFrom(n).invert()),r}const Kb={};Es.handleByMap(In.ShapeBuilder,Kb);Es.add(iee,nee,ree,Um,KJ,ZJ);const lee=new Qn,cee=new hn;function uee(i,e){const{geometryData:t,batches:n}=e;n.length=0,t.indices.length=0,t.vertices.length=0,t.uvs.length=0;for(let r=0;r<i.instructions.length;r++){const s=i.instructions[r];if(s.action==="texture")hee(s.data,n,t);else if(s.action==="fill"||s.action==="stroke"){const a=s.action==="stroke",o=s.data.path.shapePath,l=s.data.style,c=s.data.hole;a&&c&&JE(c.shapePath,l,!0,n,t),c&&(o.shapePrimitives[o.shapePrimitives.length-1].holes=c.shapePath.shapePrimitives),JE(o,l,a,n,t)}}}function hee(i,e,t){const n=[],r=Kb.rectangle,s=lee;s.x=i.dx,s.y=i.dy,s.width=i.dw,s.height=i.dh;const a=i.transform;if(!r.build(s,n))return;const{vertices:o,uvs:l,indices:c}=t,u=c.length,d=o.length/2;a&&fU(n,a),r.triangulate(n,o,2,d,c,u);const p=i.image,m=p.uvs;l.push(m.x0,m.y0,m.x1,m.y1,m.x3,m.y3,m.x2,m.y2);const g=ka.get(pU);g.indexOffset=u,g.indexSize=c.length-u,g.attributeOffset=d,g.attributeSize=o.length/2-d,g.baseColor=i.style,g.alpha=i.alpha,g.texture=p,g.geometryData=t,e.push(g)}function JE(i,e,t,n,r){const{vertices:s,uvs:a,indices:o}=r;i.shapePrimitives.forEach(({shape:l,transform:c,holes:u})=>{const d=[],p=Kb[l.type];if(!p.build(l,d))return;const m=o.length,g=s.length/2;let y="triangle-list";if(c&&fU(d,c),t){const w=l.closePath??!0,T=e;T.pixelLine?(eee(d,w,s,o),y="line-list"):JJ(d,T,!1,w,s,o)}else if(u){const w=[],T=d.slice();dee(u).forEach(E=>{w.push(T.length/2),T.push(...E)}),gU(T,w,s,2,g,o,m)}else p.triangulate(d,s,2,g,o,m);const x=a.length/2,_=e.texture;if(_!==cn.WHITE){const w=oee(cee,e,l,c);XJ(s,2,g,a,x,2,s.length/2-g,w)}else YJ(a,x,2,s.length/2-g);const S=ka.get(pU);S.indexOffset=m,S.indexSize=o.length-m,S.attributeOffset=g,S.attributeSize=s.length/2-g,S.baseColor=e.color,S.alpha=e.alpha,S.texture=_,S.geometryData=r,S.topology=y,n.push(S)})}function dee(i){const e=[];for(let t=0;t<i.length;t++){const n=i[t].shape,r=[];Kb[n.type].build(n,r)&&e.push(r)}return e}class fee{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class pee{constructor(){this.instructions=new _z}init(e){const t=e.maxTextures;this.batcher?this.batcher._updateMaxTextures(t):this.batcher=new qJ({maxTextures:t}),this.instructions.reset()}get geometry(){return Tn(sZ,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}destroy(){this.batcher.destroy(),this.instructions.destroy(),this.batcher=null,this.instructions=null}}const ST=class YM{constructor(e){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._renderer=e,e.renderableGC.addManagedHash(this,"_gpuContextHash"),e.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(e){YM.defaultOptions.bezierSmoothness=e?.bezierSmoothness??YM.defaultOptions.bezierSmoothness}getContextRenderData(e){return this._graphicsDataContextHash[e.uid]||this._initContextRenderData(e)}updateGpuContext(e){let t=this._gpuContextHash[e.uid]||this._initContext(e);if(e.dirty){t?this._cleanGraphicsContextData(e):t=this._initContext(e),uee(e,t);const n=e.batchMode;e.customShader||n==="no-batch"?t.isBatchable=!1:n==="auto"?t.isBatchable=t.geometryData.vertices.length<400:t.isBatchable=!0,e.dirty=!1}return t}getGpuContext(e){return this._gpuContextHash[e.uid]||this._initContext(e)}_initContextRenderData(e){const t=ka.get(pee,{maxTextures:this._renderer.limits.maxBatchableTextures}),{batches:n,geometryData:r}=this._gpuContextHash[e.uid],s=r.vertices.length,a=r.indices.length;for(let u=0;u<n.length;u++)n[u].applyTransform=!1;const o=t.batcher;o.ensureAttributeBuffer(s),o.ensureIndexBuffer(a),o.begin();for(let u=0;u<n.length;u++){const d=n[u];o.add(d)}o.finish(t.instructions);const l=o.geometry;l.indexBuffer.setDataWithSize(o.indexBuffer,o.indexSize,!0),l.buffers[0].setDataWithSize(o.attributeBuffer.float32View,o.attributeSize,!0);const c=o.batches;for(let u=0;u<c.length;u++){const d=c[u];d.bindGroup=iJ(d.textures.textures,d.textures.count,this._renderer.limits.maxBatchableTextures)}return this._graphicsDataContextHash[e.uid]=t,t}_initContext(e){const t=new fee;return t.context=e,this._gpuContextHash[e.uid]=t,e.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]}onGraphicsContextDestroy(e){this._cleanGraphicsContextData(e),e.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]=null}_cleanGraphicsContextData(e){const t=this._gpuContextHash[e.uid];t.isBatchable||this._graphicsDataContextHash[e.uid]&&(ka.return(this.getContextRenderData(e)),this._graphicsDataContextHash[e.uid]=null),t.batches&&t.batches.forEach(n=>{ka.return(n)})}destroy(){for(const e in this._gpuContextHash)this._gpuContextHash[e]&&this.onGraphicsContextDestroy(this._gpuContextHash[e].context);this._gpuContextHash={},this._graphicsDataContextHash={},this._renderer=null}};ST.extension={type:[In.WebGLSystem,In.WebGPUSystem,In.CanvasSystem],name:"graphicsContext"};ST.defaultOptions={bezierSmoothness:.5};let xU=ST;const mee=8,o1=11920929e-14,gee=1;function yU(i,e,t,n,r,s,a,o,l,c){const d=Math.min(.99,Math.max(0,c??xU.defaultOptions.bezierSmoothness));let p=(gee-d)/1;return p*=p,xee(e,t,n,r,s,a,o,l,i,p),i}function xee(i,e,t,n,r,s,a,o,l,c){$M(i,e,t,n,r,s,a,o,l,c,0),l.push(a,o)}function $M(i,e,t,n,r,s,a,o,l,c,u){if(u>mee)return;const d=(i+t)/2,p=(e+n)/2,m=(t+r)/2,g=(n+s)/2,y=(r+a)/2,x=(s+o)/2,_=(d+m)/2,S=(p+g)/2,w=(m+y)/2,T=(g+x)/2,C=(_+w)/2,E=(S+T)/2;if(u>0){let D=a-i,O=o-e;const R=Math.abs((t-a)*O-(n-o)*D),P=Math.abs((r-a)*O-(s-o)*D);if(R>o1&&P>o1){if((R+P)*(R+P)<=c*(D*D+O*O)){l.push(C,E);return}}else if(R>o1){if(R*R<=c*(D*D+O*O)){l.push(C,E);return}}else if(P>o1){if(P*P<=c*(D*D+O*O)){l.push(C,E);return}}else if(D=C-(i+a)/2,O=E-(e+o)/2,D*D+O*O<=c){l.push(C,E);return}}$M(i,e,d,p,_,S,C,E,l,c,u+1),$M(C,E,w,T,y,x,a,o,l,c,u+1)}const yee=8,vee=11920929e-14,bee=1;function _ee(i,e,t,n,r,s,a,o){const c=Math.min(.99,Math.max(0,o??xU.defaultOptions.bezierSmoothness));let u=(bee-c)/1;return u*=u,See(e,t,n,r,s,a,i,u),i}function See(i,e,t,n,r,s,a,o){KM(a,i,e,t,n,r,s,o,0),a.push(r,s)}function KM(i,e,t,n,r,s,a,o,l){if(l>yee)return;const c=(e+n)/2,u=(t+r)/2,d=(n+s)/2,p=(r+a)/2,m=(c+d)/2,g=(u+p)/2;let y=s-e,x=a-t;const _=Math.abs((n-s)*x-(r-a)*y);if(_>vee){if(_*_<=o*(y*y+x*x)){i.push(m,g);return}}else if(y=m-(e+s)/2,x=g-(t+a)/2,y*y+x*x<=o){i.push(m,g);return}KM(i,e,t,c,u,m,g,o,l+1),KM(i,m,g,d,p,s,a,o,l+1)}function vU(i,e,t,n,r,s,a,o){let l=Math.abs(r-s);(!a&&r>s||a&&s>r)&&(l=2*Math.PI-l),o||(o=Math.max(6,Math.floor(6*Math.pow(n,1/3)*(l/Math.PI)))),o=Math.max(o,3);let c=l/o,u=r;c*=a?-1:1;for(let d=0;d<o+1;d++){const p=Math.cos(u),m=Math.sin(u),g=e+p*n,y=t+m*n;i.push(g,y),u+=c}}function wee(i,e,t,n,r,s){const a=i[i.length-2],l=i[i.length-1]-t,c=a-e,u=r-t,d=n-e,p=Math.abs(l*d-c*u);if(p<1e-8||s===0){(i[i.length-2]!==e||i[i.length-1]!==t)&&i.push(e,t);return}const m=l*l+c*c,g=u*u+d*d,y=l*u+c*d,x=s*Math.sqrt(m)/p,_=s*Math.sqrt(g)/p,S=x*y/m,w=_*y/g,T=x*d+_*c,C=x*u+_*l,E=c*(_+S),D=l*(_+S),O=d*(x+w),R=u*(x+w),P=Math.atan2(D-C,E-T),L=Math.atan2(R-C,O-T);vU(i,T+e,C+t,s,P,L,c*u>d*l)}const cm=Math.PI*2,cS={centerX:0,centerY:0,ang1:0,ang2:0},uS=({x:i,y:e},t,n,r,s,a,o,l)=>{i*=t,e*=n;const c=r*i-s*e,u=s*i+r*e;return l.x=c+a,l.y=u+o,l};function Mee(i,e){const t=e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),n=e===1.5707963267948966?.551915024494:t,r=Math.cos(i),s=Math.sin(i),a=Math.cos(i+e),o=Math.sin(i+e);return[{x:r-s*n,y:s+r*n},{x:a+o*n,y:o-a*n},{x:a,y:o}]}const eR=(i,e,t,n)=>{const r=i*n-e*t<0?-1:1;let s=i*t+e*n;return s>1&&(s=1),s<-1&&(s=-1),r*Math.acos(s)},Tee=(i,e,t,n,r,s,a,o,l,c,u,d,p)=>{const m=Math.pow(r,2),g=Math.pow(s,2),y=Math.pow(u,2),x=Math.pow(d,2);let _=m*g-m*x-g*y;_<0&&(_=0),_/=m*x+g*y,_=Math.sqrt(_)*(a===o?-1:1);const S=_*r/s*d,w=_*-s/r*u,T=c*S-l*w+(i+t)/2,C=l*S+c*w+(e+n)/2,E=(u-S)/r,D=(d-w)/s,O=(-u-S)/r,R=(-d-w)/s,P=eR(1,0,E,D);let L=eR(E,D,O,R);o===0&&L>0&&(L-=cm),o===1&&L<0&&(L+=cm),p.centerX=T,p.centerY=C,p.ang1=P,p.ang2=L};function Aee(i,e,t,n,r,s,a,o=0,l=0,c=0){if(s===0||a===0)return;const u=Math.sin(o*cm/360),d=Math.cos(o*cm/360),p=d*(e-n)/2+u*(t-r)/2,m=-u*(e-n)/2+d*(t-r)/2;if(p===0&&m===0)return;s=Math.abs(s),a=Math.abs(a);const g=Math.pow(p,2)/Math.pow(s,2)+Math.pow(m,2)/Math.pow(a,2);g>1&&(s*=Math.sqrt(g),a*=Math.sqrt(g)),Tee(e,t,n,r,s,a,l,c,u,d,p,m,cS);let{ang1:y,ang2:x}=cS;const{centerX:_,centerY:S}=cS;let w=Math.abs(x)/(cm/4);Math.abs(1-w)<1e-7&&(w=1);const T=Math.max(Math.ceil(w),1);x/=T;let C=i[i.length-2],E=i[i.length-1];const D={x:0,y:0};for(let O=0;O<T;O++){const R=Mee(y,x),{x:P,y:L}=uS(R[0],s,a,d,u,_,S,D),{x:V,y:j}=uS(R[1],s,a,d,u,_,S,D),{x:B,y:J}=uS(R[2],s,a,d,u,_,S,D);yU(i,C,E,P,L,V,j,B,J),C=B,E=J,y+=x}}function Cee(i,e,t){const n=(a,o)=>{const l=o.x-a.x,c=o.y-a.y,u=Math.sqrt(l*l+c*c),d=l/u,p=c/u;return{len:u,nx:d,ny:p}},r=(a,o)=>{a===0?i.moveTo(o.x,o.y):i.lineTo(o.x,o.y)};let s=e[e.length-1];for(let a=0;a<e.length;a++){const o=e[a%e.length],l=o.radius??t;if(l<=0){r(a,o),s=o;continue}const c=e[(a+1)%e.length],u=n(o,s),d=n(o,c);if(u.len<1e-4||d.len<1e-4){r(a,o),s=o;continue}let p=Math.asin(u.nx*d.ny-u.ny*d.nx),m=1,g=!1;u.nx*d.nx-u.ny*-d.ny<0?p<0?p=Math.PI+p:(p=Math.PI-p,m=-1,g=!0):p>0&&(m=-1,g=!0);const y=p/2;let x,_=Math.abs(Math.cos(y)*l/Math.sin(y));_>Math.min(u.len/2,d.len/2)?(_=Math.min(u.len/2,d.len/2),x=Math.abs(_*Math.sin(y)/Math.cos(y))):x=l;const S=o.x+d.nx*_+-d.ny*x*m,w=o.y+d.ny*_+d.nx*x*m,T=Math.atan2(u.ny,u.nx)+Math.PI/2*m,C=Math.atan2(d.ny,d.nx)-Math.PI/2*m;a===0&&i.moveTo(S+Math.cos(T)*x,w+Math.sin(T)*x),i.arc(S,w,x,T,C,g),s=o}}function Eee(i,e,t,n){const r=(o,l)=>Math.sqrt((o.x-l.x)**2+(o.y-l.y)**2),s=(o,l,c)=>({x:o.x+(l.x-o.x)*c,y:o.y+(l.y-o.y)*c}),a=e.length;for(let o=0;o<a;o++){const l=e[(o+1)%a],c=l.radius??t;if(c<=0){o===0?i.moveTo(l.x,l.y):i.lineTo(l.x,l.y);continue}const u=e[o],d=e[(o+2)%a],p=r(u,l);let m;if(p<1e-4)m=l;else{const x=Math.min(p/2,c);m=s(l,u,x/p)}const g=r(d,l);let y;if(g<1e-4)y=l;else{const x=Math.min(g/2,c);y=s(l,d,x/g)}o===0?i.moveTo(m.x,m.y):i.lineTo(m.x,m.y),i.quadraticCurveTo(l.x,l.y,y.x,y.y,n)}}const Ree=new Qn;let Pee=class{constructor(e){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new mo,this._graphicsPath2D=e,this.signed=e.checkForHoles}moveTo(e,t){return this.startPoly(e,t),this}lineTo(e,t){this._ensurePoly();const n=this._currentPoly.points,r=n[n.length-2],s=n[n.length-1];return(r!==e||s!==t)&&n.push(e,t),this}arc(e,t,n,r,s,a){this._ensurePoly(!1);const o=this._currentPoly.points;return vU(o,e,t,n,r,s,a),this}arcTo(e,t,n,r,s){this._ensurePoly();const a=this._currentPoly.points;return wee(a,e,t,n,r,s),this}arcToSvg(e,t,n,r,s,a,o){const l=this._currentPoly.points;return Aee(l,this._currentPoly.lastX,this._currentPoly.lastY,a,o,e,t,n,r,s),this}bezierCurveTo(e,t,n,r,s,a,o){this._ensurePoly();const l=this._currentPoly;return yU(this._currentPoly.points,l.lastX,l.lastY,e,t,n,r,s,a,o),this}quadraticCurveTo(e,t,n,r,s){this._ensurePoly();const a=this._currentPoly;return _ee(this._currentPoly.points,a.lastX,a.lastY,e,t,n,r,s),this}closePath(){return this.endPoly(!0),this}addPath(e,t){this.endPoly(),t&&!t.isIdentity()&&(e=e.clone(!0),e.transform(t));const n=this.shapePrimitives,r=n.length;for(let s=0;s<e.instructions.length;s++){const a=e.instructions[s];this[a.action](...a.data)}if(e.checkForHoles&&n.length-r>1){let s=null;for(let a=r;a<n.length;a++){const o=n[a];if(o.shape.type==="polygon"){const l=o.shape,c=s?.shape;c&&c.containsPolygon(l)?(s.holes||(s.holes=[]),s.holes.push(o),n.copyWithin(a,a+1),n.length--,a--):s=o}}}return this}finish(e=!1){this.endPoly(e)}rect(e,t,n,r,s){return this.drawShape(new Qn(e,t,n,r),s),this}circle(e,t,n,r){return this.drawShape(new JQ(e,t,n),r),this}poly(e,t,n){const r=new Bf(e);return r.closePath=t,this.drawShape(r,n),this}regularPoly(e,t,n,r,s=0,a){r=Math.max(r|0,3);const o=-1*Math.PI/2+s,l=Math.PI*2/r,c=[];for(let u=0;u<r;u++){const d=o-u*l;c.push(e+n*Math.cos(d),t+n*Math.sin(d))}return this.poly(c,!0,a),this}roundPoly(e,t,n,r,s,a=0,o){if(r=Math.max(r|0,3),s<=0)return this.regularPoly(e,t,n,r,a);const l=n*Math.sin(Math.PI/r)-.001;s=Math.min(s,l);const c=-1*Math.PI/2+a,u=Math.PI*2/r,d=(r-2)*Math.PI/r/2;for(let p=0;p<r;p++){const m=p*u+c,g=e+n*Math.cos(m),y=t+n*Math.sin(m),x=m+Math.PI+d,_=m-Math.PI-d,S=g+s*Math.cos(x),w=y+s*Math.sin(x),T=g+s*Math.cos(_),C=y+s*Math.sin(_);p===0?this.moveTo(S,w):this.lineTo(S,w),this.quadraticCurveTo(g,y,T,C,o)}return this.closePath()}roundShape(e,t,n=!1,r){return e.length<3?this:(n?Eee(this,e,t,r):Cee(this,e,t),this.closePath())}filletRect(e,t,n,r,s){if(s===0)return this.rect(e,t,n,r);const a=Math.min(n,r)/2,o=Math.min(a,Math.max(-a,s)),l=e+n,c=t+r,u=o<0?-o:0,d=Math.abs(o);return this.moveTo(e,t+d).arcTo(e+u,t+u,e+d,t,d).lineTo(l-d,t).arcTo(l-u,t+u,l,t+d,d).lineTo(l,c-d).arcTo(l-u,c-u,e+n-d,c,d).lineTo(e+d,c).arcTo(e+u,c-u,e,c-d,d).closePath()}chamferRect(e,t,n,r,s,a){if(s<=0)return this.rect(e,t,n,r);const o=Math.min(s,Math.min(n,r)/2),l=e+n,c=t+r,u=[e+o,t,l-o,t,l,t+o,l,c-o,l-o,c,e+o,c,e,c-o,e,t+o];for(let d=u.length-1;d>=2;d-=2)u[d]===u[d-2]&&u[d-1]===u[d-3]&&u.splice(d-1,2);return this.poly(u,!0,a)}ellipse(e,t,n,r,s){return this.drawShape(new bT(e,t,n,r),s),this}roundRect(e,t,n,r,s,a){return this.drawShape(new _T(e,t,n,r,s),a),this}drawShape(e,t){return this.endPoly(),this.shapePrimitives.push({shape:e,transform:t}),this}startPoly(e,t){let n=this._currentPoly;return n&&this.endPoly(),n=new Bf,n.points.push(e,t),this._currentPoly=n,this}endPoly(e=!1){const t=this._currentPoly;return t&&t.points.length>2&&(t.closePath=e,this.shapePrimitives.push({shape:t})),this._currentPoly=null,this}_ensurePoly(e=!0){if(!this._currentPoly&&(this._currentPoly=new Bf,e)){const t=this.shapePrimitives[this.shapePrimitives.length-1];if(t){let n=t.shape.x,r=t.shape.y;if(t.transform&&!t.transform.isIdentity()){const s=t.transform,a=n;n=s.a*n+s.c*r+s.tx,r=s.b*a+s.d*r+s.ty}this._currentPoly.points.push(n,r)}else this._currentPoly.points.push(0,0)}}buildPath(){const e=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let t=0;t<e.instructions.length;t++){const n=e.instructions[t];this[n.action](...n.data)}this.finish()}get bounds(){const e=this._bounds;e.clear();const t=this.shapePrimitives;for(let n=0;n<t.length;n++){const r=t[n],s=r.shape.getBounds(Ree);r.transform?e.addRect(s,r.transform):e.addRect(s)}return e}};class nc{constructor(e,t=!1){this.instructions=[],this.uid=Mi("graphicsPath"),this._dirty=!0,this.checkForHoles=t,typeof e=="string"?QQ(e,this):this.instructions=e?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new Pee(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(e,t){return e=e.clone(),this.instructions.push({action:"addPath",data:[e,t]}),this._dirty=!0,this}arc(...e){return this.instructions.push({action:"arc",data:e}),this._dirty=!0,this}arcTo(...e){return this.instructions.push({action:"arcTo",data:e}),this._dirty=!0,this}arcToSvg(...e){return this.instructions.push({action:"arcToSvg",data:e}),this._dirty=!0,this}bezierCurveTo(...e){return this.instructions.push({action:"bezierCurveTo",data:e}),this._dirty=!0,this}bezierCurveToShort(e,t,n,r,s){const a=this.instructions[this.instructions.length-1],o=this.getLastPoint(Sn.shared);let l=0,c=0;if(!a||a.action!=="bezierCurveTo")l=o.x,c=o.y;else{l=a.data[2],c=a.data[3];const u=o.x,d=o.y;l=u+(u-l),c=d+(d-c)}return this.instructions.push({action:"bezierCurveTo",data:[l,c,e,t,n,r,s]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...e){return this.instructions.push({action:"ellipse",data:e}),this._dirty=!0,this}lineTo(...e){return this.instructions.push({action:"lineTo",data:e}),this._dirty=!0,this}moveTo(...e){return this.instructions.push({action:"moveTo",data:e}),this}quadraticCurveTo(...e){return this.instructions.push({action:"quadraticCurveTo",data:e}),this._dirty=!0,this}quadraticCurveToShort(e,t,n){const r=this.instructions[this.instructions.length-1],s=this.getLastPoint(Sn.shared);let a=0,o=0;if(!r||r.action!=="quadraticCurveTo")a=s.x,o=s.y;else{a=r.data[0],o=r.data[1];const l=s.x,c=s.y;a=l+(l-a),o=c+(c-o)}return this.instructions.push({action:"quadraticCurveTo",data:[a,o,e,t,n]}),this._dirty=!0,this}rect(e,t,n,r,s){return this.instructions.push({action:"rect",data:[e,t,n,r,s]}),this._dirty=!0,this}circle(e,t,n,r){return this.instructions.push({action:"circle",data:[e,t,n,r]}),this._dirty=!0,this}roundRect(...e){return this.instructions.push({action:"roundRect",data:e}),this._dirty=!0,this}poly(...e){return this.instructions.push({action:"poly",data:e}),this._dirty=!0,this}regularPoly(...e){return this.instructions.push({action:"regularPoly",data:e}),this._dirty=!0,this}roundPoly(...e){return this.instructions.push({action:"roundPoly",data:e}),this._dirty=!0,this}roundShape(...e){return this.instructions.push({action:"roundShape",data:e}),this._dirty=!0,this}filletRect(...e){return this.instructions.push({action:"filletRect",data:e}),this._dirty=!0,this}chamferRect(...e){return this.instructions.push({action:"chamferRect",data:e}),this._dirty=!0,this}star(e,t,n,r,s,a,o){s||(s=r/2);const l=-1*Math.PI/2+a,c=n*2,u=Math.PI*2/c,d=[];for(let p=0;p<c;p++){const m=p%2?s:r,g=p*u+l;d.push(e+m*Math.cos(g),t+m*Math.sin(g))}return this.poly(d,!0,o),this}clone(e=!1){const t=new nc;if(t.checkForHoles=this.checkForHoles,!e)t.instructions=this.instructions.slice();else for(let n=0;n<this.instructions.length;n++){const r=this.instructions[n];t.instructions.push({action:r.action,data:r.data.slice()})}return t}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(e){if(e.isIdentity())return this;const t=e.a,n=e.b,r=e.c,s=e.d,a=e.tx,o=e.ty;let l=0,c=0,u=0,d=0,p=0,m=0,g=0,y=0;for(let x=0;x<this.instructions.length;x++){const _=this.instructions[x],S=_.data;switch(_.action){case"moveTo":case"lineTo":l=S[0],c=S[1],S[0]=t*l+r*c+a,S[1]=n*l+s*c+o;break;case"bezierCurveTo":u=S[0],d=S[1],p=S[2],m=S[3],l=S[4],c=S[5],S[0]=t*u+r*d+a,S[1]=n*u+s*d+o,S[2]=t*p+r*m+a,S[3]=n*p+s*m+o,S[4]=t*l+r*c+a,S[5]=n*l+s*c+o;break;case"quadraticCurveTo":u=S[0],d=S[1],l=S[2],c=S[3],S[0]=t*u+r*d+a,S[1]=n*u+s*d+o,S[2]=t*l+r*c+a,S[3]=n*l+s*c+o;break;case"arcToSvg":l=S[5],c=S[6],g=S[0],y=S[1],S[0]=t*g+r*y,S[1]=n*g+s*y,S[5]=t*l+r*c+a,S[6]=n*l+s*c+o;break;case"circle":S[4]=Mp(S[3],e);break;case"rect":S[4]=Mp(S[4],e);break;case"ellipse":S[8]=Mp(S[8],e);break;case"roundRect":S[5]=Mp(S[5],e);break;case"addPath":S[0].transform(e);break;case"poly":S[2]=Mp(S[2],e);break;default:Hr("unknown transform action",_.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(e){let t=this.instructions.length-1,n=this.instructions[t];if(!n)return e.x=0,e.y=0,e;for(;n.action==="closePath";){if(t--,t<0)return e.x=0,e.y=0,e;n=this.instructions[t]}switch(n.action){case"moveTo":case"lineTo":e.x=n.data[0],e.y=n.data[1];break;case"quadraticCurveTo":e.x=n.data[2],e.y=n.data[3];break;case"bezierCurveTo":e.x=n.data[4],e.y=n.data[5];break;case"arc":case"arcToSvg":e.x=n.data[5],e.y=n.data[6];break;case"addPath":n.data[0].getLastPoint(e);break}return e}}function Mp(i,e){return i?i.prepend(e):e.clone()}function Si(i,e,t){const n=i.getAttribute(e);return n?Number(n):t}function Iee(i,e){const t=i.querySelectorAll("defs");for(let n=0;n<t.length;n++){const r=t[n];for(let s=0;s<r.children.length;s++){const a=r.children[s];switch(a.nodeName.toLowerCase()){case"lineargradient":e.defs[a.id]=Dee(a);break;case"radialgradient":e.defs[a.id]=Nee();break}}}}function Dee(i){const e=Si(i,"x1",0),t=Si(i,"y1",0),n=Si(i,"x2",1),r=Si(i,"y2",0),s=i.getAttribute("gradientUnits")||"objectBoundingBox",a=new lc(e,t,n,r,s==="objectBoundingBox"?"local":"global");for(let o=0;o<i.children.length;o++){const l=i.children[o],c=Si(l,"offset",0),u=Wi.shared.setValue(l.getAttribute("stop-color")).toNumber();a.addColorStop(c,u)}return a}function Nee(i){return Hr("[SVG Parser] Radial gradients are not yet supported"),new lc(0,0,1,0)}function tR(i){const e=i.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return e?e[1]:""}const nR={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function bU(i,e){const t=i.getAttribute("style"),n={},r={},s={strokeStyle:n,fillStyle:r,useFill:!1,useStroke:!1};for(const a in nR){const o=i.getAttribute(a);o&&iR(e,s,a,o.trim())}if(t){const a=t.split(";");for(let o=0;o<a.length;o++){const l=a[o].trim(),[c,u]=l.split(":");nR[c]&&iR(e,s,c,u.trim())}}return{strokeStyle:s.useStroke?n:null,fillStyle:s.useFill?r:null,useFill:s.useFill,useStroke:s.useStroke}}function iR(i,e,t,n){switch(t){case"stroke":if(n!=="none"){if(n.startsWith("url(")){const r=tR(n);e.strokeStyle.fill=i.defs[r]}else e.strokeStyle.color=Wi.shared.setValue(n).toNumber();e.useStroke=!0}break;case"stroke-width":e.strokeStyle.width=Number(n);break;case"fill":if(n!=="none"){if(n.startsWith("url(")){const r=tR(n);e.fillStyle.fill=i.defs[r]}else e.fillStyle.color=Wi.shared.setValue(n).toNumber();e.useFill=!0}break;case"fill-opacity":e.fillStyle.alpha=Number(n);break;case"stroke-opacity":e.strokeStyle.alpha=Number(n);break;case"opacity":e.fillStyle.alpha=Number(n),e.strokeStyle.alpha=Number(n);break}}function Lee(i){if(i.length<=2)return!0;const e=i.map(o=>o.area).sort((o,l)=>l-o),[t,n]=e,r=e[e.length-1],s=t/n,a=n/r;return!(s>3&&a<2)}function kee(i){return i.split(/(?=[Mm])/).filter(n=>n.trim().length>0)}function Oee(i){const e=i.match(/[-+]?[0-9]*\.?[0-9]+/g);if(!e||e.length<4)return 0;const t=e.map(Number),n=[],r=[];for(let u=0;u<t.length;u+=2)u+1<t.length&&(n.push(t[u]),r.push(t[u+1]));if(n.length===0||r.length===0)return 0;const s=Math.min(...n),a=Math.max(...n),o=Math.min(...r),l=Math.max(...r);return(a-s)*(l-o)}function rR(i,e){const t=new nc(i,!1);for(const n of t.instructions)e.instructions.push(n)}function zee(i,e){if(typeof i=="string"){const a=document.createElement("div");a.innerHTML=i.trim(),i=a.querySelector("svg")}const t={context:e,defs:{},path:new nc};Iee(i,t);const n=i.children,{fillStyle:r,strokeStyle:s}=bU(i,t);for(let a=0;a<n.length;a++){const o=n[a];o.nodeName.toLowerCase()!=="defs"&&_U(o,t,r,s)}return e}function _U(i,e,t,n){const r=i.children,{fillStyle:s,strokeStyle:a}=bU(i,e);s&&t?t={...t,...s}:s&&(t=s),a&&n?n={...n,...a}:a&&(n=a);const o=!t&&!n;o&&(t={color:0});let l,c,u,d,p,m,g,y,x,_,S,w,T,C,E,D,O;switch(i.nodeName.toLowerCase()){case"path":{C=i.getAttribute("d");const R=i.getAttribute("fill-rule"),P=kee(C),L=R==="evenodd",V=P.length>1;if(L&&V){const B=P.map(U=>({path:U,area:Oee(U)}));if(B.sort((U,X)=>X.area-U.area),P.length>3||!Lee(B))for(let U=0;U<B.length;U++){const X=B[U],$=U===0;e.context.beginPath();const Q=new nc(void 0,!0);rR(X.path,Q),e.context.path(Q),$?(t&&e.context.fill(t),n&&e.context.stroke(n)):e.context.cut()}else for(let U=0;U<B.length;U++){const X=B[U],$=U%2===1;e.context.beginPath();const Q=new nc(void 0,!0);rR(X.path,Q),e.context.path(Q),$?e.context.cut():(t&&e.context.fill(t),n&&e.context.stroke(n))}}else{const B=R?R==="evenodd":!0;E=new nc(C,B),e.context.path(E),t&&e.context.fill(t),n&&e.context.stroke(n)}break}case"circle":g=Si(i,"cx",0),y=Si(i,"cy",0),x=Si(i,"r",0),e.context.ellipse(g,y,x,x),t&&e.context.fill(t),n&&e.context.stroke(n);break;case"rect":l=Si(i,"x",0),c=Si(i,"y",0),D=Si(i,"width",0),O=Si(i,"height",0),_=Si(i,"rx",0),S=Si(i,"ry",0),_||S?e.context.roundRect(l,c,D,O,_||S):e.context.rect(l,c,D,O),t&&e.context.fill(t),n&&e.context.stroke(n);break;case"ellipse":g=Si(i,"cx",0),y=Si(i,"cy",0),_=Si(i,"rx",0),S=Si(i,"ry",0),e.context.beginPath(),e.context.ellipse(g,y,_,S),t&&e.context.fill(t),n&&e.context.stroke(n);break;case"line":u=Si(i,"x1",0),d=Si(i,"y1",0),p=Si(i,"x2",0),m=Si(i,"y2",0),e.context.beginPath(),e.context.moveTo(u,d),e.context.lineTo(p,m),n&&e.context.stroke(n);break;case"polygon":T=i.getAttribute("points"),w=T.match(/\d+/g).map(R=>parseInt(R,10)),e.context.poly(w,!0),t&&e.context.fill(t),n&&e.context.stroke(n);break;case"polyline":T=i.getAttribute("points"),w=T.match(/\d+/g).map(R=>parseInt(R,10)),e.context.poly(w,!1),n&&e.context.stroke(n);break;case"g":case"svg":break;default:{Hr(`[SVG parser] <${i.nodeName}> elements unsupported`);break}}o&&(t=null);for(let R=0;R<r.length;R++)_U(r[R],e,t,n)}function Uee(i){return Wi.isColorLike(i)}function sR(i){return i instanceof $b}function aR(i){return i instanceof lc}function Fee(i){return i instanceof cn}function Bee(i,e,t){const n=Wi.shared.setValue(e??0);return i.color=n.toNumber(),i.alpha=n.alpha===1?t.alpha:n.alpha,i.texture=cn.WHITE,{...t,...i}}function Hee(i,e,t){return i.texture=e,{...t,...i}}function oR(i,e,t){return i.fill=e,i.color=16777215,i.texture=e.texture,i.matrix=e.transform,{...t,...i}}function lR(i,e,t){return e.buildGradient(),i.fill=e,i.color=16777215,i.texture=e.texture,i.matrix=e.transform,i.textureSpace=e.textureSpace,{...t,...i}}function jee(i,e){const t={...e,...i},n=Wi.shared.setValue(t.color);return t.alpha*=n.alpha,t.color=n.toNumber(),t}function Nh(i,e){if(i==null)return null;const t={},n=i;return Uee(i)?Bee(t,i,e):Fee(i)?Hee(t,i,e):sR(i)?oR(t,i,e):aR(i)?lR(t,i,e):n.fill&&sR(n.fill)?oR(n,n.fill,e):n.fill&&aR(n.fill)?lR(n,n.fill,e):jee(n,e)}function Qy(i,e){const{width:t,alignment:n,miterLimit:r,cap:s,join:a,pixelLine:o,...l}=e,c=Nh(i,l);return c?{width:t,alignment:n,miterLimit:r,cap:s,join:a,pixelLine:o,...c}:null}const Vee=new Sn,cR=new hn,wT=class Io extends ll{constructor(){super(...arguments),this.uid=Mi("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new nc,this._transform=new hn,this._fillStyle={...Io.defaultFillStyle},this._strokeStyle={...Io.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new mo,this._boundsDirty=!0}clone(){const e=new Io;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle={...this._fillStyle},e._strokeStyle={...this._strokeStyle},e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle=Nh(e,Io.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(e){this._strokeStyle=Qy(e,Io.defaultStrokeStyle)}setFillStyle(e){return this._fillStyle=Nh(e,Io.defaultFillStyle),this}setStrokeStyle(e){return this._strokeStyle=Nh(e,Io.defaultStrokeStyle),this}texture(e,t,n,r,s,a){return this.instructions.push({action:"texture",data:{image:e,dx:n||0,dy:r||0,dw:s||e.frame.width,dh:a||e.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:t?Wi.shared.setValue(t).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new nc,this}fill(e,t){let n;const r=this.instructions[this.instructions.length-1];return this._tick===0&&r?.action==="stroke"?n=r.data.path:n=this._activePath.clone(),n?(e!=null&&(t!==void 0&&typeof e=="number"&&(Tn(wi,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:t}),this._fillStyle=Nh(e,Io.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:n}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:e,y:t}=this._activePath.getLastPoint(Sn.shared);this._activePath.clear(),this._activePath.moveTo(e,t)}stroke(e){let t;const n=this.instructions[this.instructions.length-1];return this._tick===0&&n?.action==="fill"?t=n.data.path:t=this._activePath.clone(),t?(e!=null&&(this._strokeStyle=Qy(e,Io.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:t}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let e=0;e<2;e++){const t=this.instructions[this.instructions.length-1-e],n=this._activePath.clone();if(t&&(t.action==="stroke"||t.action==="fill"))if(t.data.hole)t.data.hole.addPath(n);else{t.data.hole=n;break}}return this._initNextPathLocation(),this}arc(e,t,n,r,s,a){this._tick++;const o=this._transform;return this._activePath.arc(o.a*e+o.c*t+o.tx,o.b*e+o.d*t+o.ty,n,r,s,a),this}arcTo(e,t,n,r,s){this._tick++;const a=this._transform;return this._activePath.arcTo(a.a*e+a.c*t+a.tx,a.b*e+a.d*t+a.ty,a.a*n+a.c*r+a.tx,a.b*n+a.d*r+a.ty,s),this}arcToSvg(e,t,n,r,s,a,o){this._tick++;const l=this._transform;return this._activePath.arcToSvg(e,t,n,r,s,l.a*a+l.c*o+l.tx,l.b*a+l.d*o+l.ty),this}bezierCurveTo(e,t,n,r,s,a,o){this._tick++;const l=this._transform;return this._activePath.bezierCurveTo(l.a*e+l.c*t+l.tx,l.b*e+l.d*t+l.ty,l.a*n+l.c*r+l.tx,l.b*n+l.d*r+l.ty,l.a*s+l.c*a+l.tx,l.b*s+l.d*a+l.ty,o),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(e,t,n,r){return this._tick++,this._activePath.ellipse(e,t,n,r,this._transform.clone()),this}circle(e,t,n){return this._tick++,this._activePath.circle(e,t,n,this._transform.clone()),this}path(e){return this._tick++,this._activePath.addPath(e,this._transform.clone()),this}lineTo(e,t){this._tick++;const n=this._transform;return this._activePath.lineTo(n.a*e+n.c*t+n.tx,n.b*e+n.d*t+n.ty),this}moveTo(e,t){this._tick++;const n=this._transform,r=this._activePath.instructions,s=n.a*e+n.c*t+n.tx,a=n.b*e+n.d*t+n.ty;return r.length===1&&r[0].action==="moveTo"?(r[0].data[0]=s,r[0].data[1]=a,this):(this._activePath.moveTo(s,a),this)}quadraticCurveTo(e,t,n,r,s){this._tick++;const a=this._transform;return this._activePath.quadraticCurveTo(a.a*e+a.c*t+a.tx,a.b*e+a.d*t+a.ty,a.a*n+a.c*r+a.tx,a.b*n+a.d*r+a.ty,s),this}rect(e,t,n,r){return this._tick++,this._activePath.rect(e,t,n,r,this._transform.clone()),this}roundRect(e,t,n,r,s){return this._tick++,this._activePath.roundRect(e,t,n,r,s,this._transform.clone()),this}poly(e,t){return this._tick++,this._activePath.poly(e,t,this._transform.clone()),this}regularPoly(e,t,n,r,s=0,a){return this._tick++,this._activePath.regularPoly(e,t,n,r,s,a),this}roundPoly(e,t,n,r,s,a){return this._tick++,this._activePath.roundPoly(e,t,n,r,s,a),this}roundShape(e,t,n,r){return this._tick++,this._activePath.roundShape(e,t,n,r),this}filletRect(e,t,n,r,s){return this._tick++,this._activePath.filletRect(e,t,n,r,s),this}chamferRect(e,t,n,r,s,a){return this._tick++,this._activePath.chamferRect(e,t,n,r,s,a),this}star(e,t,n,r,s=0,a=0){return this._tick++,this._activePath.star(e,t,n,r,s,a,this._transform.clone()),this}svg(e){return this._tick++,zee(e,this),this}restore(){const e=this._stateStack.pop();return e&&(this._transform=e.transform,this._fillStyle=e.fillStyle,this._strokeStyle=e.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(e){return this._transform.rotate(e),this}scale(e,t=e){return this._transform.scale(e,t),this}setTransform(e,t,n,r,s,a){return e instanceof hn?(this._transform.set(e.a,e.b,e.c,e.d,e.tx,e.ty),this):(this._transform.set(e,t,n,r,s,a),this)}transform(e,t,n,r,s,a){return e instanceof hn?(this._transform.append(e),this):(cR.set(e,t,n,r,s,a),this._transform.append(cR),this)}translate(e,t=e){return this._transform.translate(e,t),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this._boundsDirty=!0,!this.dirty&&(this.emit("update",this,16),this.dirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;this._boundsDirty=!1;const e=this._bounds;e.clear();for(let t=0;t<this.instructions.length;t++){const n=this.instructions[t],r=n.action;if(r==="fill"){const s=n.data;e.addBounds(s.path.bounds)}else if(r==="texture"){const s=n.data;e.addFrame(s.dx,s.dy,s.dx+s.dw,s.dy+s.dh,s.transform)}if(r==="stroke"){const s=n.data,a=s.style.alignment,o=s.style.width*(1-a),l=s.path.bounds;e.addFrame(l.minX-o,l.minY-o,l.maxX+o,l.maxY+o)}}return e}containsPoint(e){if(!this.bounds.containsPoint(e.x,e.y))return!1;const t=this.instructions;let n=!1;for(let r=0;r<t.length;r++){const s=t[r],a=s.data,o=a.path;if(!s.action||!o)continue;const l=a.style,c=o.shapePath.shapePrimitives;for(let u=0;u<c.length;u++){const d=c[u].shape;if(!l||!d)continue;const p=c[u].transform,m=p?p.applyInverse(e,Vee):e;if(s.action==="fill")n=d.contains(m.x,m.y);else{const y=l;n=d.strokeContains(m.x,m.y,y.width,y.alignment)}const g=a.hole;if(g){const y=g.shapePath?.shapePrimitives;if(y)for(let x=0;x<y.length;x++)y[x].shape.contains(m.x,m.y)&&(n=!1)}if(n)return!0}}return n}destroy(e=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const n=typeof e=="boolean"?e:e?.textureSource;this._fillStyle.texture&&(this._fillStyle.fill&&"uid"in this._fillStyle.fill?this._fillStyle.fill.destroy():this._fillStyle.texture.destroy(n)),this._strokeStyle.texture&&(this._strokeStyle.fill&&"uid"in this._strokeStyle.fill?this._strokeStyle.fill.destroy():this._strokeStyle.texture.destroy(n))}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};wT.defaultFillStyle={color:16777215,alpha:1,texture:cn.WHITE,matrix:null,fill:null,textureSpace:"local"};wT.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:cn.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let so=wT;const MT=class Pf extends ll{constructor(e={}){super(),this.uid=Mi("textStyle"),this._tick=0,Gee(e);const t={...Pf.defaultTextStyle,...e};for(const n in t){const r=n;this[r]=t[n]}this.update(),this._tick=0}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.update())}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.update())}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(e!==null&&typeof e=="object"?this._dropShadow=this._createProxy({...Pf.defaultDropShadow,...e}):this._dropShadow=e?this._createProxy({...Pf.defaultDropShadow}):null,this.update())}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.update())}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(typeof e=="string"?this._fontSize=parseInt(e,10):this._fontSize=e,this.update())}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e.toLowerCase(),this.update())}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.update())}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.update())}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.update())}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.update())}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.update())}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.update())}get filters(){return this._filters}set filters(e){this._filters!==e&&(this._filters=Object.freeze(e),this.update())}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.update())}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.update())}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.update())}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.update())}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.update())}get fill(){return this._originalFill}set fill(e){e!==this._originalFill&&(this._originalFill=e,this._isFillStyle(e)&&(this._originalFill=this._createProxy({...so.defaultFillStyle,...e},()=>{this._fill=Nh({...this._originalFill},so.defaultFillStyle)})),this._fill=Nh(e===0?"black":e,so.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(e){e!==this._originalStroke&&(this._originalStroke=e,this._isFillStyle(e)&&(this._originalStroke=this._createProxy({...so.defaultStrokeStyle,...e},()=>{this._stroke=Qy({...this._originalStroke},so.defaultStrokeStyle)})),this._stroke=Qy(e,so.defaultStrokeStyle),this.update())}update(){this._tick++,this.emit("update",this)}reset(){const e=Pf.defaultTextStyle;for(const t in e)this[t]=e[t]}get styleKey(){return`${this.uid}-${this._tick}`}clone(){return new Pf({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this._filters?[...this._filters]:void 0})}_getFinalPadding(){let e=0;if(this._filters)for(let t=0;t<this._filters.length;t++)e+=this._filters[t].padding;return Math.max(this._padding,e)}destroy(e=!1){if(this.removeAllListeners(),typeof e=="boolean"?e:e?.texture){const n=typeof e=="boolean"?e:e?.textureSource;this._fill?.texture&&this._fill.texture.destroy(n),this._originalFill?.texture&&this._originalFill.texture.destroy(n),this._stroke?.texture&&this._stroke.texture.destroy(n),this._originalStroke?.texture&&this._originalStroke.texture.destroy(n)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(e,t){return new Proxy(e,{set:(n,r,s)=>(n[r]===s||(n[r]=s,t?.(r,s),this.update()),!0)})}_isFillStyle(e){return(e??null)!==null&&!(Wi.isColorLike(e)||e instanceof lc||e instanceof $b)}};MT.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};MT.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Fm=MT;function Gee(i){const e=i;if(typeof e.dropShadow=="boolean"&&e.dropShadow){const t=Fm.defaultDropShadow;i.dropShadow={alpha:e.dropShadowAlpha??t.alpha,angle:e.dropShadowAngle??t.angle,blur:e.dropShadowBlur??t.blur,color:e.dropShadowColor??t.color,distance:e.dropShadowDistance??t.distance}}if(e.strokeThickness!==void 0){Tn(wi,"strokeThickness is now a part of stroke");const t=e.stroke;let n={};if(Wi.isColorLike(t))n.color=t;else if(t instanceof lc||t instanceof $b)n.fill=t;else if(Object.hasOwnProperty.call(t,"color")||Object.hasOwnProperty.call(t,"fill"))n=t;else throw new Error("Invalid stroke value.");i.stroke={...n,width:e.strokeThickness}}if(Array.isArray(e.fillGradientStops)){if(Tn(wi,"gradient fill is now a fill pattern: `new FillGradient(...)`"),!Array.isArray(e.fill)||e.fill.length===0)throw new Error("Invalid fill value. Expected an array of colors for gradient fill.");e.fill.length!==e.fillGradientStops.length&&Hr("The number of fill colors must match the number of fill gradient stops.");const t=new lc({start:{x:0,y:0},end:{x:0,y:1},textureSpace:"local"}),n=e.fillGradientStops.slice(),r=e.fill.map(s=>Wi.shared.setValue(s).toNumber());n.forEach((s,a)=>{t.addColorStop(s,r[a])}),i.fill={fill:t}}}class Wee{constructor(e){this._canvasPool=Object.create(null),this.canvasOptions=e||{},this.enableFullScreen=!1}_createCanvasAndContext(e,t){const n=ta.get().createCanvas();n.width=e,n.height=t;const r=n.getContext("2d");return{canvas:n,context:r}}getOptimalCanvasAndContext(e,t,n=1){e=Math.ceil(e*n-1e-6),t=Math.ceil(t*n-1e-6),e=Zf(e),t=Zf(t);const r=(e<<17)+(t<<1);this._canvasPool[r]||(this._canvasPool[r]=[]);let s=this._canvasPool[r].pop();return s||(s=this._createCanvasAndContext(e,t)),s}returnCanvasAndContext(e){const t=e.canvas,{width:n,height:r}=t,s=(n<<17)+(r<<1);e.context.resetTransform(),e.context.clearRect(0,0,n,r),this._canvasPool[s].push(e)}clear(){this._canvasPool={}}}const ZM=new Wee;Bg.register(ZM);const uR=1e5;function hR(i,e,t,n=0){if(i.texture===cn.WHITE&&!i.fill)return Wi.shared.setValue(i.color).setAlpha(i.alpha??1).toHexa();if(i.fill){if(i.fill instanceof $b){const r=i.fill,s=e.createPattern(r.texture.source.resource,"repeat"),a=r.transform.copyTo(hn.shared);return a.scale(r.texture.frame.width,r.texture.frame.height),s.setTransform(a),s}else if(i.fill instanceof lc){const r=i.fill,s=r.type==="linear",a=r.textureSpace==="local";let o=1,l=1;a&&t&&(o=t.width+n,l=t.height+n);let c,u=!1;if(s){const{start:d,end:p}=r;c=e.createLinearGradient(d.x*o,d.y*l,p.x*o,p.y*l),u=Math.abs(p.x-d.x)<Math.abs((p.y-d.y)*.1)}else{const{center:d,innerRadius:p,outerCenter:m,outerRadius:g}=r;c=e.createRadialGradient(d.x*o,d.y*l,p*o,m.x*o,m.y*l,g*o)}if(u&&a&&t){const d=t.lineHeight/l;for(let p=0;p<t.lines.length;p++){const m=(p*t.lineHeight+n/2)/l;r.colorStops.forEach(g=>{const y=m+g.offset*d;c.addColorStop(Math.floor(y*uR)/uR,Wi.shared.setValue(g.color).toHex())})}}else r.colorStops.forEach(d=>{c.addColorStop(d.offset,Wi.shared.setValue(d.color).toHex())});return c}}else{const r=e.createPattern(i.texture.source.resource,"repeat"),s=i.matrix.copyTo(hn.shared);return s.scale(i.texture.frame.width,i.texture.frame.height),r.setTransform(s),r}return Hr("FillStyle not recognised",i),"red"}class Jo extends mT{constructor(e){e instanceof so&&(e={context:e});const{context:t,roundPixels:n,...r}=e||{};super({label:"Graphics",...r}),this.renderPipeId="graphics",t?this._context=t:this._context=this._ownedContext=new so,this._context.on("update",this.onViewUpdate,this),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=n??!1}set context(e){e!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=e,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(e){return this._context.containsPoint(e)}destroy(e){this._ownedContext&&!e?this._ownedContext.destroy(e):(e===!0||e?.context===!0)&&this._context.destroy(e),this._ownedContext=null,this._context=null,super.destroy(e)}_callContextMethod(e,t){return this.context[e](...t),this}setFillStyle(...e){return this._callContextMethod("setFillStyle",e)}setStrokeStyle(...e){return this._callContextMethod("setStrokeStyle",e)}fill(...e){return this._callContextMethod("fill",e)}stroke(...e){return this._callContextMethod("stroke",e)}texture(...e){return this._callContextMethod("texture",e)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...e){return this._callContextMethod("arc",e)}arcTo(...e){return this._callContextMethod("arcTo",e)}arcToSvg(...e){return this._callContextMethod("arcToSvg",e)}bezierCurveTo(...e){return this._callContextMethod("bezierCurveTo",e)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...e){return this._callContextMethod("ellipse",e)}circle(...e){return this._callContextMethod("circle",e)}path(...e){return this._callContextMethod("path",e)}lineTo(...e){return this._callContextMethod("lineTo",e)}moveTo(...e){return this._callContextMethod("moveTo",e)}quadraticCurveTo(...e){return this._callContextMethod("quadraticCurveTo",e)}rect(...e){return this._callContextMethod("rect",e)}roundRect(...e){return this._callContextMethod("roundRect",e)}poly(...e){return this._callContextMethod("poly",e)}regularPoly(...e){return this._callContextMethod("regularPoly",e)}roundPoly(...e){return this._callContextMethod("roundPoly",e)}roundShape(...e){return this._callContextMethod("roundShape",e)}filletRect(...e){return this._callContextMethod("filletRect",e)}chamferRect(...e){return this._callContextMethod("chamferRect",e)}star(...e){return this._callContextMethod("star",e)}svg(...e){return this._callContextMethod("svg",e)}restore(...e){return this._callContextMethod("restore",e)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...e){return this._callContextMethod("rotate",e)}scaleTransform(...e){return this._callContextMethod("scale",e)}setTransform(...e){return this._callContextMethod("setTransform",e)}transform(...e){return this._callContextMethod("transform",e)}translateTransform(...e){return this._callContextMethod("translate",e)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(e){this._context.fillStyle=e}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(e){this._context.strokeStyle=e}clone(e=!1){return e?new Jo(this._context.clone()):(this._ownedContext=null,new Jo(this._context))}lineStyle(e,t,n){Tn(wi,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const r={};return e&&(r.width=e),t&&(r.color=t),n&&(r.alpha=n),this.context.strokeStyle=r,this}beginFill(e,t){Tn(wi,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const n={};return e!==void 0&&(n.color=e),t!==void 0&&(n.alpha=t),this.context.fillStyle=n,this}endFill(){Tn(wi,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const e=this.context.strokeStyle;return(e.width!==so.defaultStrokeStyle.width||e.color!==so.defaultStrokeStyle.color||e.alpha!==so.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...e){return Tn(wi,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",e)}drawEllipse(...e){return Tn(wi,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",e)}drawPolygon(...e){return Tn(wi,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",e)}drawRect(...e){return Tn(wi,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",e)}drawRoundedRect(...e){return Tn(wi,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",e)}drawStar(...e){return Tn(wi,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",e)}}class qee extends mT{constructor(e,t){const{text:n,resolution:r,style:s,anchor:a,width:o,height:l,roundPixels:c,...u}=e;super({...u}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=t,this.text=n??"",this.style=s,this.resolution=r??null,this.allowChildren=!1,this._anchor=new wr({_onUpdate:()=>{this.onViewUpdate()}}),a&&(this.anchor=a),this.roundPixels=c??!1,o!==void 0&&(this.width=o),l!==void 0&&(this.height=l)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}set text(e){e=e.toString(),this._text!==e&&(this._text=e,this.onViewUpdate())}get text(){return this._text}set resolution(e){this._autoResolution=e===null,this._resolution=e,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(e){e||(e={}),this._style?.off("update",this.onViewUpdate,this),e instanceof this._styleClass?this._style=e:this._style=new this._styleClass(e),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(e){this._setWidth(e,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(e){this._setHeight(e,this.bounds.height)}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this.bounds.width,e.height=Math.abs(this.scale.y)*this.bounds.height,e}setSize(e,t){typeof e=="object"?(t=e.height??e.width,e=e.width):t??(t=e),e!==void 0&&this._setWidth(e,this.bounds.width),t!==void 0&&this._setHeight(t,this.bounds.height)}containsPoint(e){const t=this.bounds.width,n=this.bounds.height,r=-t*this.anchor.x;let s=0;return e.x>=r&&e.x<=r+t&&(s=-n*this.anchor.y,e.y>=s&&e.y<=s+n)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}destroy(e=!1){super.destroy(e),this.owner=null,this._bounds=null,this._anchor=null,(typeof e=="boolean"?e:e?.style)&&this._style.destroy(e),this._style=null,this._text=null}get styleKey(){return`${this._text}:${this._style.styleKey}:${this._resolution}`}}function Xee(i,e){let t=i[0]??{};return(typeof t=="string"||i[1])&&(Tn(wi,`use new ${e}({ text: "hi!", style }) instead`),t={text:t,style:i[1]}),t}let rh=null,Hl=null;function Yee(i,e){rh||(rh=ta.get().createCanvas(256,128),Hl=rh.getContext("2d",{willReadFrequently:!0}),Hl.globalCompositeOperation="copy",Hl.globalAlpha=1),(rh.width<i||rh.height<e)&&(rh.width=Zf(i),rh.height=Zf(e))}function dR(i,e,t){for(let n=0,r=4*t*e;n<e;++n,r+=4)if(i[r+3]!==0)return!1;return!0}function fR(i,e,t,n,r){const s=4*e;for(let a=n,o=n*s+4*t;a<=r;++a,o+=s)if(i[o+3]!==0)return!1;return!0}function $ee(...i){let e=i[0];e.canvas||(e={canvas:i[0],resolution:i[1]});const{canvas:t}=e,n=Math.min(e.resolution??1,1),r=e.width??t.width,s=e.height??t.height;let a=e.output;if(Yee(r,s),!Hl)throw new TypeError("Failed to get canvas 2D context");Hl.drawImage(t,0,0,r,s,0,0,r*n,s*n);const l=Hl.getImageData(0,0,r,s).data;let c=0,u=0,d=r-1,p=s-1;for(;u<s&&dR(l,r,u);)++u;if(u===s)return Qn.EMPTY;for(;dR(l,r,p);)--p;for(;fR(l,r,c,u,p);)++c;for(;fR(l,r,d,u,p);)--d;return++d,++p,Hl.globalCompositeOperation="source-over",Hl.strokeRect(c,u,d-c,p-u),Hl.globalCompositeOperation="copy",a??(a=new Qn),a.set(c/n,u/n,(d-c)/n,(p-u)/n),a}const pR=new Qn;class Kee{getCanvasAndContext(e){const{text:t,style:n,resolution:r=1}=e,s=n._getFinalPadding(),a=Rf.measureText(t||" ",n),o=Math.ceil(Math.ceil(Math.max(1,a.width)+s*2)*r),l=Math.ceil(Math.ceil(Math.max(1,a.height)+s*2)*r),c=ZM.getOptimalCanvasAndContext(o,l);this._renderTextToCanvas(t,n,s,r,c);const u=n.trim?$ee({canvas:c.canvas,width:o,height:l,resolution:1,output:pR}):pR.set(0,0,o,l);return{canvasAndContext:c,frame:u}}returnCanvasAndContext(e){ZM.returnCanvasAndContext(e)}_renderTextToCanvas(e,t,n,r,s){const{canvas:a,context:o}=s,l=iU(t),c=Rf.measureText(e||" ",t),u=c.lines,d=c.lineHeight,p=c.lineWidths,m=c.maxLineWidth,g=c.fontProperties,y=a.height;if(o.resetTransform(),o.scale(r,r),o.textBaseline=t.textBaseline,t._stroke?.width){const w=t._stroke;o.lineWidth=w.width,o.miterLimit=w.miterLimit,o.lineJoin=w.join,o.lineCap=w.cap}o.font=l;let x,_;const S=t.dropShadow?2:1;for(let w=0;w<S;++w){const T=t.dropShadow&&w===0,C=T?Math.ceil(Math.max(1,y)+n*2):0,E=C*r;if(T){o.fillStyle="black",o.strokeStyle="black";const R=t.dropShadow,P=R.color,L=R.alpha;o.shadowColor=Wi.shared.setValue(P).setAlpha(L).toRgbaString();const V=R.blur*r,j=R.distance*r;o.shadowBlur=V,o.shadowOffsetX=Math.cos(R.angle)*j,o.shadowOffsetY=Math.sin(R.angle)*j+E}else{if(o.fillStyle=t._fill?hR(t._fill,o,c,n*2):null,t._stroke?.width){const R=t._stroke.width*.5+n*2;o.strokeStyle=hR(t._stroke,o,c,R)}o.shadowColor="black"}let D=(d-g.fontSize)/2;d-g.fontSize<0&&(D=0);const O=t._stroke?.width??0;for(let R=0;R<u.length;R++)x=O/2,_=O/2+R*d+g.ascent+D,t.align==="right"?x+=m-p[R]:t.align==="center"&&(x+=(m-p[R])/2),t._stroke?.width&&this._drawLetterSpacing(u[R],t,s,x+n,_+n-C,!0),t._fill!==void 0&&this._drawLetterSpacing(u[R],t,s,x+n,_+n-C)}}_drawLetterSpacing(e,t,n,r,s,a=!1){const{context:o}=n,l=t.letterSpacing;let c=!1;if(Rf.experimentalLetterSpacingSupported&&(Rf.experimentalLetterSpacing?(o.letterSpacing=`${l}px`,o.textLetterSpacing=`${l}px`,c=!0):(o.letterSpacing="0px",o.textLetterSpacing="0px")),l===0||c){a?o.strokeText(e,r,s):o.fillText(e,r,s);return}let u=r;const d=Rf.graphemeSegmenter(e);let p=o.measureText(e).width,m=0;for(let g=0;g<d.length;++g){const y=d[g];a?o.strokeText(y,u,s):o.fillText(y,u,s);let x="";for(let _=g+1;_<d.length;++_)x+=d[_];m=o.measureText(x).width,u+=p-m+l,p=m}}}const mR=new Kee;let Zee=class extends qee{constructor(...e){const t=Xee(e,"Text");super(t,Fm),this.renderPipeId="text",t.textureStyle&&(this.textureStyle=t.textureStyle instanceof Yy?t.textureStyle:new Yy(t.textureStyle))}updateBounds(){const e=this._bounds,t=this._anchor;let n=0,r=0;if(this._style.trim){const{frame:s,canvasAndContext:a}=mR.getCanvasAndContext({text:this.text,style:this._style,resolution:1});mR.returnCanvasAndContext(a),n=s.width,r=s.height}else{const s=Rf.measureText(this._text,this._style);n=s.width,r=s.height}e.minX=-t._x*n,e.maxX=e.minX+n,e.minY=-t._y*r,e.maxY=e.minY+r}};const SU=class wU extends Fi{constructor(e={}){e={...wU.defaultOptions,...e},super(),this.renderLayerChildren=[],this.sortableChildren=e.sortableChildren,this.sortFunction=e.sortFunction}attach(...e){for(let t=0;t<e.length;t++){const n=e[t];if(n.parentRenderLayer){if(n.parentRenderLayer===this)continue;n.parentRenderLayer.detach(n)}this.renderLayerChildren.push(n),n.parentRenderLayer=this;const r=this.renderGroup||this.parentRenderGroup;r&&(r.structureDidChange=!0)}return e[0]}detach(...e){for(let t=0;t<e.length;t++){const n=e[t],r=this.renderLayerChildren.indexOf(n);r!==-1&&this.renderLayerChildren.splice(r,1),n.parentRenderLayer=null;const s=this.renderGroup||this.parentRenderGroup;s&&(s.structureDidChange=!0)}return e[0]}detachAll(){const e=this.renderLayerChildren;for(let t=0;t<e.length;t++)e[t].parentRenderLayer=null;this.renderLayerChildren.length=0}collectRenderables(e,t,n){const r=this.renderLayerChildren,s=r.length;this.sortableChildren&&this.sortRenderLayerChildren();for(let a=0;a<s;a++)r[a].parent||Hr("Container must be added to both layer and scene graph. Layers only handle render order - the scene graph is required for transforms (addChild)",r[a]),r[a].collectRenderables(e,t,this)}sortRenderLayerChildren(){this.renderLayerChildren.sort(this.sortFunction)}_getGlobalBoundsRecursive(e,t,n){if(!e)return;const r=this.renderLayerChildren;for(let s=0;s<r.length;s++)r[s]._getGlobalBoundsRecursive(!0,t,this)}getFastGlobalBounds(e,t){return super.getFastGlobalBounds(e,t)}addChild(...e){throw new Error("RenderLayer.addChild() is not available. Please use RenderLayer.attach()")}removeChild(...e){throw new Error("RenderLayer.removeChild() is not available. Please use RenderLayer.detach()")}removeChildren(e,t){throw new Error("RenderLayer.removeChildren() is not available. Please use RenderLayer.detach()")}removeChildAt(e){throw new Error("RenderLayer.removeChildAt() is not available")}getChildAt(e){throw new Error("RenderLayer.getChildAt() is not available")}setChildIndex(e,t){throw new Error("RenderLayer.setChildIndex() is not available")}getChildIndex(e){throw new Error("RenderLayer.getChildIndex() is not available")}addChildAt(e,t){throw new Error("RenderLayer.addChildAt() is not available")}swapChildren(e,t){throw new Error("RenderLayer.swapChildren() is not available")}reparentChild(...e){throw new Error("RenderLayer.reparentChild() is not available with the render layer")}reparentChildAt(e,t){throw new Error("RenderLayer.reparentChildAt() is not available with the render layer")}};SU.defaultOptions={sortableChildren:!1,sortFunction:(i,e)=>i.zIndex-e.zIndex};let MU=SU;Es.add($K,KK);var hS={exports:{}},Rl={};var gR;function Qee(){return gR||(gR=1,Rl.ConcurrentRoot=1,Rl.ContinuousEventPriority=8,Rl.DefaultEventPriority=32,Rl.DiscreteEventPriority=2,Rl.IdleEventPriority=268435456,Rl.LegacyRoot=0,Rl.NoEventPriority=0),Rl}var xR;function Jee(){return xR||(xR=1,hS.exports=Qee()),hS.exports}var Fo=Jee();const TT=z.createContext({}),ete=TT.Provider;TT.Consumer;function TU(i,e){const t=Object.getPrototypeOf(i),n=Object.getOwnPropertyDescriptor(t,e);return!(typeof n>"u"||n.writable||n.set)}const pu={currentUpdatePriority:Fo.DefaultEventPriority,unmountQueue:new Set};function yR(i,...e){}function AU(i,e={}){const t=i;return t.__pixireact=Object.assign({filters:[],parent:null,root:null,type:""},e),t}var tte="0.0.0-development",nte={version:tte};function ite(){}function CU(i,e,t){e instanceof hd&&(e.__pixireact.parent=i,typeof t=="number"?i.__pixireact.filters.splice(t,0,e):i.__pixireact.filters.push(e),i.filters=i.__pixireact.filters)}function dS(i,e){e&&(e instanceof Fi?i.addChild(e):e instanceof hd&&CU(i,e))}function rte(){}function ste(){return!1}const QM=Object.freeze({onclick:"onClick",onglobalmousemove:"onGlobalMouseMove",onglobalpointermove:"onGlobalPointerMove",onglobaltouchmove:"onGlobalTouchMove",onmousedown:"onMouseDown",onmouseenter:"onMouseEnter",onmouseleave:"onMouseLeave",onmousemove:"onMouseMove",onmouseout:"onMouseOut",onmouseover:"onMouseOver",onmouseup:"onMouseUp",onmouseupoutside:"onMouseUpOutside",onpointercancel:"onPointerCancel",onpointerdown:"onPointerDown",onpointerenter:"onPointerEnter",onpointerleave:"onPointerLeave",onpointermove:"onPointerMove",onpointerout:"onPointerOut",onpointerover:"onPointerOver",onpointertap:"onPointerTap",onpointerup:"onPointerUp",onpointerupoutside:"onPointerUpOutside",onrightclick:"onRightClick",onrightdown:"onRightDown",onrightup:"onRightUp",onrightupoutside:"onRightUpOutside",ontap:"onTap",ontouchcancel:"onTouchCancel",ontouchend:"onTouchEnd",ontouchendoutside:"onTouchEndOutside",ontouchmove:"onTouchMove",ontouchstart:"onTouchStart",onwheel:"onWheel"}),Jy=Object.freeze({onClick:"onclick",onGlobalMouseMove:"onglobalmousemove",onGlobalPointerMove:"onglobalpointermove",onGlobalTouchMove:"onglobaltouchmove",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseUpOutside:"onmouseupoutside",onPointerCancel:"onpointercancel",onPointerDown:"onpointerdown",onPointerEnter:"onpointerenter",onPointerLeave:"onpointerleave",onPointerMove:"onpointermove",onPointerOut:"onpointerout",onPointerOver:"onpointerover",onPointerTap:"onpointertap",onPointerUp:"onpointerup",onPointerUpOutside:"onpointerupoutside",onRightClick:"onrightclick",onRightDown:"onrightdown",onRightUp:"onrightup",onRightUpOutside:"onrightupoutside",onTap:"ontap",onTouchCancel:"ontouchcancel",onTouchEnd:"ontouchend",onTouchEndOutside:"ontouchendoutside",onTouchMove:"ontouchmove",onTouchStart:"ontouchstart",onWheel:"onwheel"});function EU(i){return Array.isArray(i)}function RU(i,e,t={arrays:"reference",objects:"reference",strict:!0}){const{arrays:n,objects:r,strict:s}=t;if(typeof i!=typeof e||!!i!=!!e)return!1;if(cte(i)||ote(i))return i===e;const a=lte(i);if(a&&r==="reference")return i===e;const o=EU(i);if(o&&n==="reference")return i===e;if((o||a)&&i===e)return!0;let l;for(l in i)if(!(l in e))return!1;let c=i;if(s&&(c=e),a&&n==="shallow"&&r==="shallow"){for(l in c)if(!RU(i[l],e[l],{strict:s,objects:"reference"}))return!1}else for(l in c)if(i[l]!==e[l])return!1;if(PU(l)){if(o&&i.length===0&&e.length===0||a&&Object.keys(i).length===0&&Object.keys(e).length===0)return!0;if(i!==e)return!1}return!0}function ate(i){return i===null}function ote(i){return typeof i=="number"}function lte(i){return!(i!==Object(i)||EU(i)||typeof i=="function")}function cte(i){return typeof i=="string"}function PU(i){return i===void 0}const ute=Object.freeze(["children","key","ref"]);function hte(i,e=[]){const t={};return Object.entries(i).reduce((n,[r,s])=>(e.includes(r)||(n[r]=s),n),t)}function JM(i,e=[]){return hte(i,ute.concat(e))}const dte="__default";function IU(i,e={},t=!1){const n=JM(i),r=JM(e),s=Object.entries(n),a=[];if(t){const o=Object.keys(r);let l=0;for(;l<o.length;){const c=o[l];!(c in n)&&s.unshift([c,`${dte}remove`]),l+=1}}return s.forEach(([o,l])=>{if(RU(l,r[o]))return;if(o in Jy){a.push([o,l,!0,[]]);return}let c=[];o.includes("-")&&(c=o.split("-")),a.push([o,l,!1,c]);for(const u in n){const d=n[u];u.startsWith(`${o}-`)&&a.push([u,d,!1,u.split("-")])}}),{changes:a}}function fte(i){const e=i;return!(!e||!e.changes)}const pte="__default",vR=new Map,bR={};function _R(i,e){if(i){const t=i[e];if(!PU(t)&&!ate(t))return t}return i}function DU(i,e){const{__pixireact:t={},...n}=i;let r;fte(e)?r=e:r=IU(e,n);const{changes:s}=r;let a=0;for(;a<s.length;){const o=s[a];let l=!1,c=o[0],u=o[1];const d=o[2],p=o[3];let m=i,g=m[c];if(c==="draw"&&typeof u=="function"&&(i instanceof Jo?u(i):(l=!0,yR("warn",`The \`draw\` prop was used on a \`${t.type}\` component, but it's only valid on \`graphics\` components.`))),c in QM){const y=c;l=!0,bR[c]||(bR[c]=!0,yR("warn",`Event names must be pascal case; instead of \`${c}\`, you probably want \`${QM[y]}\`.`))}if(!l){if(p.length&&(g=p.reduce(_R,m),!(g&&g.set))){const[y,...x]=p.reverse();m=x.reverse().reduce(_R,m),c=y}if(u===`${pte}remove`)if(m instanceof Fi){let y=vR.get(m.constructor);y||(y=m.constructor,y=new y,vR.set(m.constructor,y)),u=y[c]}else u=0;if(d&&t){const x=Jy[c];u?m[x]=u:delete m[x]}else TU(m,c)||(m[c]=u)}a+=1}return i}function mte(i,e,t,n){const{children:r,...s}=n,{children:a,...o}=t,l=IU(s,o,!0);return l.changes.length?l:null}function gte(i,e,t,n){const r=mte(i,e,t,n);r&&DU(i,r)}const xte=Object.freeze([...Object.keys(QM),"draw"]),e5={};function yte(i){const e=i.charAt(0),t=i.substring(1);return`${e.toUpperCase()}${t}`}function vte(i,e){return e.toLowerCase()}function bte(i){let e=i;return i.startsWith("pixi")&&(e=i.replace(/^pixi([A-Z])/,vte)),e}function _te(i,e,t){const n=bte(i),r=yte(n);if(!(r in e5))throw new Error(`${r} is not part of the PIXI namespace! Did you forget to extend?`);const s=e5[r],a=JM(e,xte);Object.entries(e).forEach(([l,c])=>{if(l in Jy){const u=Jy[l];a[u]=c}});const o=AU(new s(a),{root:t,type:n});return DU(o,e),o}var fS={exports:{}},pS={exports:{}},mS={exports:{}},gS={};var SR;function Ste(){return SR||(SR=1,(function(i){function e(U,X){var $=U.length;U.push(X);e:for(;0<$;){var Q=$-1>>>1,se=U[Q];if(0<r(se,X))U[Q]=X,U[$]=se,$=Q;else break e}}function t(U){return U.length===0?null:U[0]}function n(U){if(U.length===0)return null;var X=U[0],$=U.pop();if($!==X){U[0]=$;e:for(var Q=0,se=U.length,ye=se>>>1;Q<ye;){var we=2*(Q+1)-1,He=U[we],De=we+1,Oe=U[De];if(0>r(He,$))De<se&&0>r(Oe,He)?(U[Q]=Oe,U[De]=$,Q=De):(U[Q]=He,U[we]=$,Q=we);else if(De<se&&0>r(Oe,$))U[Q]=Oe,U[De]=$,Q=De;else break e}}return X}function r(U,X){var $=U.sortIndex-X.sortIndex;return $!==0?$:U.id-X.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();i.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,p=3,m=!1,g=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function w(U){for(var X=t(c);X!==null;){if(X.callback===null)n(c);else if(X.startTime<=U)n(c),X.sortIndex=X.expirationTime,e(l,X);else break;X=t(c)}}function T(U){if(y=!1,w(U),!g)if(t(l)!==null)g=!0,B();else{var X=t(c);X!==null&&J(T,X.startTime-U)}}var C=!1,E=-1,D=5,O=-1;function R(){return!(i.unstable_now()-O<D)}function P(){if(C){var U=i.unstable_now();O=U;var X=!0;try{e:{g=!1,y&&(y=!1,_(E),E=-1),m=!0;var $=p;try{t:{for(w(U),d=t(l);d!==null&&!(d.expirationTime>U&&R());){var Q=d.callback;if(typeof Q=="function"){d.callback=null,p=d.priorityLevel;var se=Q(d.expirationTime<=U);if(U=i.unstable_now(),typeof se=="function"){d.callback=se,w(U),X=!0;break t}d===t(l)&&n(l),w(U)}else n(l);d=t(l)}if(d!==null)X=!0;else{var ye=t(c);ye!==null&&J(T,ye.startTime-U),X=!1}}break e}finally{d=null,p=$,m=!1}X=void 0}}finally{X?L():C=!1}}}var L;if(typeof S=="function")L=function(){S(P)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,j=V.port2;V.port1.onmessage=P,L=function(){j.postMessage(null)}}else L=function(){x(P,0)};function B(){C||(C=!0,L())}function J(U,X){E=x(function(){U(i.unstable_now())},X)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(U){U.callback=null},i.unstable_continueExecution=function(){g||m||(g=!0,B())},i.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<U?Math.floor(1e3/U):5},i.unstable_getCurrentPriorityLevel=function(){return p},i.unstable_getFirstCallbackNode=function(){return t(l)},i.unstable_next=function(U){switch(p){case 1:case 2:case 3:var X=3;break;default:X=p}var $=p;p=X;try{return U()}finally{p=$}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(U,X){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var $=p;p=U;try{return X()}finally{p=$}},i.unstable_scheduleCallback=function(U,X,$){var Q=i.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?Q+$:Q):$=Q,U){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=$+se,U={id:u++,callback:X,priorityLevel:U,startTime:$,expirationTime:se,sortIndex:-1},$>Q?(U.sortIndex=$,e(c,U),t(l)===null&&U===t(c)&&(y?(_(E),E=-1):y=!0,J(T,$-Q))):(U.sortIndex=se,e(l,U),g||m||(g=!0,B())),U},i.unstable_shouldYield=R,i.unstable_wrapCallback=function(U){var X=p;return function(){var $=p;p=X;try{return U.apply(this,arguments)}finally{p=$}}}})(gS)),gS}var wR;function wte(){return wR||(wR=1,mS.exports=Ste()),mS.exports}var MR;function Mte(){return MR||(MR=1,(function(i){i.exports=function(e){function t(h,f,b,M){return new YW(h,f,b,M)}function n(){}function r(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)f+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(h){return h===null||typeof h!="object"?null:(h=v7&&h[v7]||h["@@iterator"],typeof h=="function"?h:null)}function a(h){if(h==null)return null;if(typeof h=="function")return h.$$typeof===eq?null:h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case Id:return"Fragment";case Pd:return"Portal";case r3:return"Profiler";case g7:return"StrictMode";case a3:return"Suspense";case o3:return"SuspenseList"}if(typeof h=="object")switch(h.$$typeof){case Rc:return(h.displayName||"Context")+".Provider";case x7:return(h._context.displayName||"Context")+".Consumer";case s3:var f=h.render;return h=h.displayName,h||(h=f.displayName||f.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case l3:return f=h.displayName||null,f!==null?f:a(h.type)||"Memo";case Pc:f=h._payload,h=h._init;try{return a(h(f))}catch{}}return null}function o(h){if(c3===void 0)try{throw Error()}catch(b){var f=b.stack.trim().match(/\n( *(at )?)/);c3=f&&f[1]||"",b7=-1<b.stack.indexOf(`
    at`)?" (<anonymous>)":-1<b.stack.indexOf("@")?"@unknown:0:0":""}return`
`+c3+h+b7}function l(h,f){if(!h||u3)return"";u3=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var M={DetermineComponentFrameRoot:function(){try{if(f){var ht=function(){throw Error()};if(Object.defineProperty(ht.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ht,[])}catch($t){var mt=$t}Reflect.construct(h,[],ht)}else{try{ht.call()}catch($t){mt=$t}h.call(ht.prototype)}}else{try{throw Error()}catch($t){mt=$t}(ht=h())&&typeof ht.catch=="function"&&ht.catch(function(){})}}catch($t){if($t&&mt&&typeof $t.stack=="string")return[$t.stack,mt.stack]}return[null,null]}};M.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var A=Object.getOwnPropertyDescriptor(M.DetermineComponentFrameRoot,"name");A&&A.configurable&&Object.defineProperty(M.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var N=M.DetermineComponentFrameRoot(),q=N[0],re=N[1];if(q&&re){var he=q.split(`
`),Ae=re.split(`
`);for(A=M=0;M<he.length&&!he[M].includes("DetermineComponentFrameRoot");)M++;for(;A<Ae.length&&!Ae[A].includes("DetermineComponentFrameRoot");)A++;if(M===he.length||A===Ae.length)for(M=he.length-1,A=Ae.length-1;1<=M&&0<=A&&he[M]!==Ae[A];)A--;for(;1<=M&&0<=A;M--,A--)if(he[M]!==Ae[A]){if(M!==1||A!==1)do if(M--,A--,0>A||he[M]!==Ae[A]){var nt=`
`+he[M].replace(" at new "," at ");return h.displayName&&nt.includes("<anonymous>")&&(nt=nt.replace("<anonymous>",h.displayName)),nt}while(1<=M&&0<=A);break}}}finally{u3=!1,Error.prepareStackTrace=b}return(b=h?h.displayName||h.name:"")?o(b):""}function c(h){switch(h.tag){case 26:case 27:case 5:return o(h.type);case 16:return o("Lazy");case 13:return o("Suspense");case 19:return o("SuspenseList");case 0:case 15:return h=l(h.type,!1),h;case 11:return h=l(h.type.render,!1),h;case 1:return h=l(h.type,!0),h;default:return""}}function u(h){try{var f="";do f+=c(h),h=h.return;while(h);return f}catch(b){return`
Error generating stack: `+b.message+`
`+b.stack}}function d(h){var f=h,b=h;if(h.alternate)for(;f.return;)f=f.return;else{h=f;do f=h,(f.flags&4098)!==0&&(b=f.return),h=f.return;while(h)}return f.tag===3?b:null}function p(h){if(d(h)!==h)throw Error(r(188))}function m(h){var f=h.alternate;if(!f){if(f=d(h),f===null)throw Error(r(188));return f!==h?null:h}for(var b=h,M=f;;){var A=b.return;if(A===null)break;var N=A.alternate;if(N===null){if(M=A.return,M!==null){b=M;continue}break}if(A.child===N.child){for(N=A.child;N;){if(N===b)return p(A),h;if(N===M)return p(A),f;N=N.sibling}throw Error(r(188))}if(b.return!==M.return)b=A,M=N;else{for(var q=!1,re=A.child;re;){if(re===b){q=!0,b=A,M=N;break}if(re===M){q=!0,M=A,b=N;break}re=re.sibling}if(!q){for(re=N.child;re;){if(re===b){q=!0,b=N,M=A;break}if(re===M){q=!0,M=N,b=A;break}re=re.sibling}if(!q)throw Error(r(189))}}if(b.alternate!==M)throw Error(r(190))}if(b.tag!==3)throw Error(r(188));return b.stateNode.current===b?h:f}function g(h){var f=h.tag;if(f===5||f===26||f===27||f===6)return h;for(h=h.child;h!==null;){if(f=g(h),f!==null)return f;h=h.sibling}return null}function y(h){var f=h.tag;if(f===5||f===26||f===27||f===6)return h;for(h=h.child;h!==null;){if(h.tag!==4&&(f=y(h),f!==null))return f;h=h.sibling}return null}function x(h){return{current:h}}function _(h){0>Nd||(h.current=g3[Nd],g3[Nd]=null,Nd--)}function S(h,f){Nd++,g3[Nd]=h.current,h.current=f}function w(h){return h>>>=0,h===0?32:31-(mX(h)/gX|0)|0}function T(h){var f=h&42;if(f!==0)return f;switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return h&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return h}}function C(h,f){var b=h.pendingLanes;if(b===0)return 0;var M=0,A=h.suspendedLanes,N=h.pingedLanes,q=h.warmLanes;h=h.finishedLanes!==0;var re=b&134217727;return re!==0?(b=re&~A,b!==0?M=T(b):(N&=re,N!==0?M=T(N):h||(q=re&~q,q!==0&&(M=T(q))))):(re=b&~A,re!==0?M=T(re):N!==0?M=T(N):h||(q=b&~q,q!==0&&(M=T(q)))),M===0?0:f!==0&&f!==M&&(f&A)===0&&(A=M&-M,q=f&-f,A>=q||A===32&&(q&4194176)!==0)?f:M}function E(h,f){return(h.pendingLanes&~(h.suspendedLanes&~h.pingedLanes)&f)===0}function D(h,f){switch(h){case 1:case 2:case 4:case 8:return f+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function O(){var h=Cx;return Cx<<=1,(Cx&4194176)===0&&(Cx=128),h}function R(){var h=Ex;return Ex<<=1,(Ex&62914560)===0&&(Ex=4194304),h}function P(h){for(var f=[],b=0;31>b;b++)f.push(h);return f}function L(h,f){h.pendingLanes|=f,f!==268435456&&(h.suspendedLanes=0,h.pingedLanes=0,h.warmLanes=0)}function V(h,f,b,M,A,N){var q=h.pendingLanes;h.pendingLanes=b,h.suspendedLanes=0,h.pingedLanes=0,h.warmLanes=0,h.expiredLanes&=b,h.entangledLanes&=b,h.errorRecoveryDisabledLanes&=b,h.shellSuspendCounter=0;var re=h.entanglements,he=h.expirationTimes,Ae=h.hiddenUpdates;for(b=q&~b;0<b;){var nt=31-Bs(b),ht=1<<nt;re[nt]=0,he[nt]=-1;var mt=Ae[nt];if(mt!==null)for(Ae[nt]=null,nt=0;nt<mt.length;nt++){var $t=mt[nt];$t!==null&&($t.lane&=-536870913)}b&=~ht}M!==0&&j(h,M,0),N!==0&&A===0&&h.tag!==0&&(h.suspendedLanes|=N&~(q&~f))}function j(h,f,b){h.pendingLanes|=f,h.suspendedLanes&=~f;var M=31-Bs(f);h.entangledLanes|=f,h.entanglements[M]=h.entanglements[M]|1073741824|b&4194218}function B(h,f){var b=h.entangledLanes|=f;for(h=h.entanglements;b;){var M=31-Bs(b),A=1<<M;A&f|h[M]&f&&(h[M]|=f),b&=~A}}function J(h){return h&=-h,2<h?8<h?(h&134217727)!==0?32:268435456:8:2}function U(h){if(Hs&&typeof Hs.onCommitFiberRoot=="function")try{Hs.onCommitFiberRoot(ap,h,void 0,(h.current.flags&128)===128)}catch{}}function X(h){if(typeof _X=="function"&&SX(h),Hs&&typeof Hs.setStrictMode=="function")try{Hs.setStrictMode(ap,h)}catch{}}function $(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}function Q(h,f){if(typeof h=="object"&&h!==null){var b=q7.get(h);return b!==void 0?b:(f={value:h,source:f,stack:u(f)},q7.set(h,f),f)}return{value:h,source:f,stack:u(f)}}function se(h,f){kd[Od++]=Ix,kd[Od++]=Px,Px=h,Ix=f}function ye(h,f,b){ya[va++]=Sl,ya[va++]=wl,ya[va++]=Xu,Xu=h;var M=Sl;h=wl;var A=32-Bs(M)-1;M&=~(1<<A),b+=1;var N=32-Bs(f)+A;if(30<N){var q=A-A%5;N=(M&(1<<q)-1).toString(32),M>>=q,A-=q,Sl=1<<32-Bs(f)+A|b<<A|M,wl=N+h}else Sl=1<<N|b<<A|M,wl=h}function we(h){h.return!==null&&(se(h,1),ye(h,1,0))}function He(h){for(;h===Px;)Px=kd[--Od],kd[Od]=null,Ix=kd[--Od],kd[Od]=null;for(;h===Xu;)Xu=ya[--va],ya[va]=null,wl=ya[--va],ya[va]=null,Sl=ya[--va],ya[va]=null}function De(h,f){S(Dc,f),S(op,h),S(vr,null),h=iq(f),_(vr),S(vr,h)}function Oe(){_(vr),_(op),_(Dc)}function fe(h){h.memoizedState!==null&&S(Dx,h);var f=vr.current,b=rq(f,h.type);f!==b&&(S(op,h),S(vr,b))}function ge(h){op.current===h&&(_(vr),_(op)),Dx.current===h&&(_(Dx),_l?qu._currentValue=Dd:qu._currentValue2=Dd)}function Ne(h){var f=Error(r(418,""));throw vt(Q(f,h)),v3}function Qe(h,f){if(!ga)throw Error(r(175));Zq(h.stateNode,h.type,h.memoizedProps,f,h)||Ne(h)}function et(h){for(Xr=h.return;Xr;)switch(Xr.tag){case 3:case 27:_o=!0;return;case 5:case 13:_o=!1;return;default:Xr=Xr.return}}function Nt(h){if(!ga||h!==Xr)return!1;if(!vn)return et(h),vn=!0,!1;var f=!1;if(Dr?h.tag!==3&&h.tag!==27&&(h.tag!==5||k7(h.type)&&!Ax(h.type,h.memoizedProps))&&(f=!0):h.tag!==3&&(h.tag!==5||k7(h.type)&&!Ax(h.type,h.memoizedProps))&&(f=!0),f&&Nr&&Ne(h),et(h),h.tag===13){if(!ga)throw Error(r(316));if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(r(317));Nr=eX(h)}else Nr=Xr?N7(h.stateNode):null;return!0}function Gt(){ga&&(Nr=Xr=null,vn=!1)}function vt(h){$a===null?$a=[h]:$a.push(h)}function Te(){for(var h=zd,f=b3=zd=0;f<h;){var b=ba[f];ba[f++]=null;var M=ba[f];ba[f++]=null;var A=ba[f];ba[f++]=null;var N=ba[f];if(ba[f++]=null,M!==null&&A!==null){var q=M.pending;q===null?A.next=A:(A.next=q.next,q.next=A),M.pending=A}N!==0&&Ge(b,A,N)}}function Y(h,f,b,M){ba[zd++]=h,ba[zd++]=f,ba[zd++]=b,ba[zd++]=M,b3|=M,h.lanes|=M,h=h.alternate,h!==null&&(h.lanes|=M)}function Ee(h,f,b,M){return Y(h,f,b,M),Le(h)}function Ie(h,f){return Y(h,null,null,f),Le(h)}function Ge(h,f,b){h.lanes|=b;var M=h.alternate;M!==null&&(M.lanes|=b);for(var A=!1,N=h.return;N!==null;)N.childLanes|=b,M=N.alternate,M!==null&&(M.childLanes|=b),N.tag===22&&(h=N.stateNode,h===null||h._visibility&1||(A=!0)),h=N,N=N.return;A&&f!==null&&h.tag===3&&(N=h.stateNode,A=31-Bs(b),N=N.hiddenUpdates,h=N[A],h===null?N[A]=[f]:h.push(f),f.lane=b|536870912)}function Le(h){if(50<gp)throw gp=0,O3=null,Error(r(185));for(var f=h.return;f!==null;)h=f,f=h.return;return h.tag===3?h.stateNode:null}function ot(h){h!==Ud&&h.next===null&&(Ud===null?Nx=Ud=h:Ud=Ud.next=h),Lx=!0,_3||(_3=!0,Se(ft))}function it(h,f){if(!S3&&Lx){S3=!0;do for(var b=!1,M=Nx;M!==null;){if(h!==0){var A=M.pendingLanes;if(A===0)var N=0;else{var q=M.suspendedLanes,re=M.pingedLanes;N=(1<<31-Bs(42|h)+1)-1,N&=A&~(q&~re),N=N&201326677?N&201326677|1:N?N|2:0}N!==0&&(b=!0,ue(M,N))}else N=mn,N=C(M,M===qn?N:0),(N&3)===0||E(M,N)||(b=!0,ue(M,N));M=M.next}while(b);S3=!1}}function ft(){Lx=_3=!1;var h=0;Fd!==0&&(dq()&&(h=Fd),Fd=0);for(var f=Ya(),b=null,M=Nx;M!==null;){var A=M.next,N=Z(M,f);N===0?(M.next=null,b===null?Nx=A:b.next=A,A===null&&(Ud=b)):(b=M,(h!==0||(N&3)!==0)&&(Lx=!0)),M=A}it(h)}function Z(h,f){for(var b=h.suspendedLanes,M=h.pingedLanes,A=h.expirationTimes,N=h.pendingLanes&-62914561;0<N;){var q=31-Bs(N),re=1<<q,he=A[q];he===-1?((re&b)===0||(re&M)!==0)&&(A[q]=D(re,f)):he<=f&&(h.expiredLanes|=re),N&=~re}if(f=qn,b=mn,b=C(h,h===f?b:0),M=h.callbackNode,b===0||h===f&&Xn===2||h.cancelPendingCommit!==null)return M!==null&&M!==null&&x3(M),h.callbackNode=null,h.callbackPriority=0;if((b&3)===0||E(h,b)){if(f=b&-b,f===h.callbackPriority)return f;switch(M!==null&&x3(M),J(b)){case 2:case 8:b=vX;break;case 32:b=y3;break;case 268435456:b=bX;break;default:b=y3}return M=H.bind(null,h),b=Rx(b,M),h.callbackPriority=f,h.callbackNode=b,f}return M!==null&&M!==null&&x3(M),h.callbackPriority=2,h.callbackNode=null,2}function H(h,f){var b=h.callbackNode;if(Vu()&&h.callbackNode!==b)return null;var M=mn;return M=C(h,h===qn?M:0),M===0?null:($8(h,M,f),Z(h,Ya()),h.callbackNode!=null&&h.callbackNode===b?H.bind(null,h):null)}function ue(h,f){if(Vu())return null;$8(h,f,!0)}function Se(h){yq?vq(function(){(Nn&6)!==0?Rx(W7,h):h()}):Rx(W7,h)}function Re(){return Fd===0&&(Fd=O()),Fd}function _e(h,f){if(lp===null){var b=lp=[];w3=0,Bd=Re(),Hd={status:"pending",value:void 0,then:function(M){b.push(M)}}}return w3++,f.then(Mt,Mt),f}function Mt(){if(--w3===0&&lp!==null){Hd!==null&&(Hd.status="fulfilled");var h=lp;lp=null,Bd=0,Hd=null;for(var f=0;f<h.length;f++)(0,h[f])()}}function st(h,f){var b=[],M={status:"pending",value:null,reason:null,then:function(A){b.push(A)}};return h.then(function(){M.status="fulfilled",M.value=f;for(var A=0;A<b.length;A++)(0,b[A])(f)},function(A){for(M.status="rejected",M.reason=A,A=0;A<b.length;A++)(0,b[A])(void 0)}),M}function At(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function bt(h,f){h=h.updateQueue,f.updateQueue===h&&(f.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,callbacks:null})}function Pe(h){return{lane:h,tag:0,payload:null,callback:null,next:null}}function Xe(h,f,b){var M=h.updateQueue;if(M===null)return null;if(M=M.shared,(Nn&2)!==0){var A=M.pending;return A===null?f.next=f:(f.next=A.next,A.next=f),M.pending=f,f=Le(h),Ge(h,null,b),f}return Y(h,M,f,b),Le(h)}function Rt(h,f,b){if(f=f.updateQueue,f!==null&&(f=f.shared,(b&4194176)!==0)){var M=f.lanes;M&=h.pendingLanes,b|=M,f.lanes=b,B(h,b)}}function ie(h,f){var b=h.updateQueue,M=h.alternate;if(M!==null&&(M=M.updateQueue,b===M)){var A=null,N=null;if(b=b.firstBaseUpdate,b!==null){do{var q={lane:b.lane,tag:b.tag,payload:b.payload,callback:null,next:null};N===null?A=N=q:N=N.next=q,b=b.next}while(b!==null);N===null?A=N=f:N=N.next=f}else A=N=f;b={baseState:M.baseState,firstBaseUpdate:A,lastBaseUpdate:N,shared:M.shared,callbacks:M.callbacks},h.updateQueue=b;return}h=b.lastBaseUpdate,h===null?b.firstBaseUpdate=f:h.next=f,b.lastBaseUpdate=f}function pe(){if(M3){var h=Hd;if(h!==null)throw h}}function Fe(h,f,b,M){M3=!1;var A=h.updateQueue;Nc=!1;var N=A.firstBaseUpdate,q=A.lastBaseUpdate,re=A.shared.pending;if(re!==null){A.shared.pending=null;var he=re,Ae=he.next;he.next=null,q===null?N=Ae:q.next=Ae,q=he;var nt=h.alternate;nt!==null&&(nt=nt.updateQueue,re=nt.lastBaseUpdate,re!==q&&(re===null?nt.firstBaseUpdate=Ae:re.next=Ae,nt.lastBaseUpdate=he))}if(N!==null){var ht=A.baseState;q=0,nt=Ae=he=null,re=N;do{var mt=re.lane&-536870913,$t=mt!==re.lane;if($t?(mn&mt)===mt:(M&mt)===mt){mt!==0&&mt===Bd&&(M3=!0),nt!==null&&(nt=nt.next={lane:0,tag:re.tag,payload:re.payload,callback:null,next:null});e:{var wa=h,xp=re;mt=f;var nh=b;switch(xp.tag){case 1:if(wa=xp.payload,typeof wa=="function"){ht=wa.call(nh,ht,mt);break e}ht=wa;break e;case 3:wa.flags=wa.flags&-65537|128;case 0:if(wa=xp.payload,mt=typeof wa=="function"?wa.call(nh,ht,mt):wa,mt==null)break e;ht=i3({},ht,mt);break e;case 2:Nc=!0}}mt=re.callback,mt!==null&&(h.flags|=64,$t&&(h.flags|=8192),$t=A.callbacks,$t===null?A.callbacks=[mt]:$t.push(mt))}else $t={lane:mt,tag:re.tag,payload:re.payload,callback:re.callback,next:null},nt===null?(Ae=nt=$t,he=ht):nt=nt.next=$t,q|=mt;if(re=re.next,re===null){if(re=A.shared.pending,re===null)break;$t=re,re=$t.next,$t.next=null,A.lastBaseUpdate=$t,A.shared.pending=null}}while(!0);nt===null&&(he=ht),A.baseState=he,A.firstBaseUpdate=Ae,A.lastBaseUpdate=nt,N===null&&(A.shared.lanes=0),Oc|=q,h.lanes=q,h.memoizedState=ht}}function te(h,f){if(typeof h!="function")throw Error(r(191,h));h.call(f)}function je(h,f){var b=h.callbacks;if(b!==null)for(h.callbacks=null,h=0;h<b.length;h++)te(b[h],f)}function We(h,f){if(js(h,f))return!0;if(typeof h!="object"||h===null||typeof f!="object"||f===null)return!1;var b=Object.keys(h),M=Object.keys(f);if(b.length!==M.length)return!1;for(M=0;M<b.length;M++){var A=b[M];if(!wX.call(f,A)||!js(h[A],f[A]))return!1}return!0}function Je(h){return h=h.status,h==="fulfilled"||h==="rejected"}function Be(){}function Ce(h,f,b){switch(b=h[b],b===void 0?h.push(f):b!==f&&(f.then(Be,Be),f=b),f.status){case"fulfilled":return f.value;case"rejected":throw h=f.reason,h===cp?Error(r(483)):h;default:if(typeof f.status=="string")f.then(Be,Be);else{if(h=qn,h!==null&&100<h.shellSuspendCounter)throw Error(r(482));h=f,h.status="pending",h.then(function(M){if(f.status==="pending"){var A=f;A.status="fulfilled",A.value=M}},function(M){if(f.status==="pending"){var A=f;A.status="rejected",A.reason=M}})}switch(f.status){case"fulfilled":return f.value;case"rejected":throw h=f.reason,h===cp?Error(r(483)):h}throw jd=f,cp}}function ct(){if(jd===null)throw Error(r(459));var h=jd;return jd=null,h}function Ct(h){var f=up;return up+=1,Vd===null&&(Vd=[]),Ce(Vd,h,f)}function an(h,f){f=f.props.ref,h.ref=f!==void 0?f:null}function tn(h,f){throw f.$$typeof===ZW?Error(r(525)):(h=Object.prototype.toString.call(f),Error(r(31,h==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":h)))}function ji(h){var f=h._init;return f(h._payload)}function Vi(h){function f(me,ce){if(h){var ve=me.deletions;ve===null?(me.deletions=[ce],me.flags|=16):ve.push(ce)}}function b(me,ce){if(!h)return null;for(;ce!==null;)f(me,ce),ce=ce.sibling;return null}function M(me){for(var ce=new Map;me!==null;)me.key!==null?ce.set(me.key,me):ce.set(me.index,me),me=me.sibling;return ce}function A(me,ce){return me=Ec(me,ce),me.index=0,me.sibling=null,me}function N(me,ce,ve){return me.index=ve,h?(ve=me.alternate,ve!==null?(ve=ve.index,ve<ce?(me.flags|=33554434,ce):ve):(me.flags|=33554434,ce)):(me.flags|=1048576,ce)}function q(me){return h&&me.alternate===null&&(me.flags|=33554434),me}function re(me,ce,ve,Ke){return ce===null||ce.tag!==6?(ce=e3(ve,me.mode,Ke),ce.return=me,ce):(ce=A(ce,ve),ce.return=me,ce)}function he(me,ce,ve,Ke){var It=ve.type;return It===Id?nt(me,ce,ve.props.children,Ke,ve.key):ce!==null&&(ce.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===Pc&&ji(It)===ce.type)?(ce=A(ce,ve.props),an(ce,ve),ce.return=me,ce):(ce=wx(ve.type,ve.key,ve.props,null,me.mode,Ke),an(ce,ve),ce.return=me,ce)}function Ae(me,ce,ve,Ke){return ce===null||ce.tag!==4||ce.stateNode.containerInfo!==ve.containerInfo||ce.stateNode.implementation!==ve.implementation?(ce=t3(ve,me.mode,Ke),ce.return=me,ce):(ce=A(ce,ve.children||[]),ce.return=me,ce)}function nt(me,ce,ve,Ke,It){return ce===null||ce.tag!==7?(ce=Gu(ve,me.mode,Ke,It),ce.return=me,ce):(ce=A(ce,ve),ce.return=me,ce)}function ht(me,ce,ve){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return ce=e3(""+ce,me.mode,ve),ce.return=me,ce;if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case Mx:return ve=wx(ce.type,ce.key,ce.props,null,me.mode,ve),an(ve,ce),ve.return=me,ve;case Pd:return ce=t3(ce,me.mode,ve),ce.return=me,ce;case Pc:var Ke=ce._init;return ce=Ke(ce._payload),ht(me,ce,ve)}if(Tx(ce)||s(ce))return ce=Gu(ce,me.mode,ve,null),ce.return=me,ce;if(typeof ce.then=="function")return ht(me,Ct(ce),ve);if(ce.$$typeof===Rc)return ht(me,xx(me,ce),ve);tn(me,ce)}return null}function mt(me,ce,ve,Ke){var It=ce!==null?ce.key:null;if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return It!==null?null:re(me,ce,""+ve,Ke);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case Mx:return ve.key===It?he(me,ce,ve,Ke):null;case Pd:return ve.key===It?Ae(me,ce,ve,Ke):null;case Pc:return It=ve._init,ve=It(ve._payload),mt(me,ce,ve,Ke)}if(Tx(ve)||s(ve))return It!==null?null:nt(me,ce,ve,Ke,null);if(typeof ve.then=="function")return mt(me,ce,Ct(ve),Ke);if(ve.$$typeof===Rc)return mt(me,ce,xx(me,ve),Ke);tn(me,ve)}return null}function $t(me,ce,ve,Ke,It){if(typeof Ke=="string"&&Ke!==""||typeof Ke=="number"||typeof Ke=="bigint")return me=me.get(ve)||null,re(ce,me,""+Ke,It);if(typeof Ke=="object"&&Ke!==null){switch(Ke.$$typeof){case Mx:return me=me.get(Ke.key===null?ve:Ke.key)||null,he(ce,me,Ke,It);case Pd:return me=me.get(Ke.key===null?ve:Ke.key)||null,Ae(ce,me,Ke,It);case Pc:var Kn=Ke._init;return Ke=Kn(Ke._payload),$t(me,ce,ve,Ke,It)}if(Tx(Ke)||s(Ke))return me=me.get(ve)||null,nt(ce,me,Ke,It,null);if(typeof Ke.then=="function")return $t(me,ce,ve,Ct(Ke),It);if(Ke.$$typeof===Rc)return $t(me,ce,ve,xx(ce,Ke),It);tn(ce,Ke)}return null}function wa(me,ce,ve,Ke){for(var It=null,Kn=null,jt=ce,bn=ce=0,tr=null;jt!==null&&bn<ve.length;bn++){jt.index>bn?(tr=jt,jt=null):tr=jt.sibling;var _n=mt(me,jt,ve[bn],Ke);if(_n===null){jt===null&&(jt=tr);break}h&&jt&&_n.alternate===null&&f(me,jt),ce=N(_n,ce,bn),Kn===null?It=_n:Kn.sibling=_n,Kn=_n,jt=tr}if(bn===ve.length)return b(me,jt),vn&&se(me,bn),It;if(jt===null){for(;bn<ve.length;bn++)jt=ht(me,ve[bn],Ke),jt!==null&&(ce=N(jt,ce,bn),Kn===null?It=jt:Kn.sibling=jt,Kn=jt);return vn&&se(me,bn),It}for(jt=M(jt);bn<ve.length;bn++)tr=$t(jt,me,bn,ve[bn],Ke),tr!==null&&(h&&tr.alternate!==null&&jt.delete(tr.key===null?bn:tr.key),ce=N(tr,ce,bn),Kn===null?It=tr:Kn.sibling=tr,Kn=tr);return h&&jt.forEach(function(Uc){return f(me,Uc)}),vn&&se(me,bn),It}function xp(me,ce,ve,Ke){if(ve==null)throw Error(r(151));for(var It=null,Kn=null,jt=ce,bn=ce=0,tr=null,_n=ve.next();jt!==null&&!_n.done;bn++,_n=ve.next()){jt.index>bn?(tr=jt,jt=null):tr=jt.sibling;var Uc=mt(me,jt,_n.value,Ke);if(Uc===null){jt===null&&(jt=tr);break}h&&jt&&Uc.alternate===null&&f(me,jt),ce=N(Uc,ce,bn),Kn===null?It=Uc:Kn.sibling=Uc,Kn=Uc,jt=tr}if(_n.done)return b(me,jt),vn&&se(me,bn),It;if(jt===null){for(;!_n.done;bn++,_n=ve.next())_n=ht(me,_n.value,Ke),_n!==null&&(ce=N(_n,ce,bn),Kn===null?It=_n:Kn.sibling=_n,Kn=_n);return vn&&se(me,bn),It}for(jt=M(jt);!_n.done;bn++,_n=ve.next())_n=$t(jt,me,bn,_n.value,Ke),_n!==null&&(h&&_n.alternate!==null&&jt.delete(_n.key===null?bn:_n.key),ce=N(_n,ce,bn),Kn===null?It=_n:Kn.sibling=_n,Kn=_n);return h&&jt.forEach(function(PX){return f(me,PX)}),vn&&se(me,bn),It}function nh(me,ce,ve,Ke){if(typeof ve=="object"&&ve!==null&&ve.type===Id&&ve.key===null&&(ve=ve.props.children),typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case Mx:e:{for(var It=ve.key;ce!==null;){if(ce.key===It){if(It=ve.type,It===Id){if(ce.tag===7){b(me,ce.sibling),Ke=A(ce,ve.props.children),Ke.return=me,me=Ke;break e}}else if(ce.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===Pc&&ji(It)===ce.type){b(me,ce.sibling),Ke=A(ce,ve.props),an(Ke,ve),Ke.return=me,me=Ke;break e}b(me,ce);break}else f(me,ce);ce=ce.sibling}ve.type===Id?(Ke=Gu(ve.props.children,me.mode,Ke,ve.key),Ke.return=me,me=Ke):(Ke=wx(ve.type,ve.key,ve.props,null,me.mode,Ke),an(Ke,ve),Ke.return=me,me=Ke)}return q(me);case Pd:e:{for(It=ve.key;ce!==null;){if(ce.key===It)if(ce.tag===4&&ce.stateNode.containerInfo===ve.containerInfo&&ce.stateNode.implementation===ve.implementation){b(me,ce.sibling),Ke=A(ce,ve.children||[]),Ke.return=me,me=Ke;break e}else{b(me,ce);break}else f(me,ce);ce=ce.sibling}Ke=t3(ve,me.mode,Ke),Ke.return=me,me=Ke}return q(me);case Pc:return It=ve._init,ve=It(ve._payload),nh(me,ce,ve,Ke)}if(Tx(ve))return wa(me,ce,ve,Ke);if(s(ve)){if(It=s(ve),typeof It!="function")throw Error(r(150));return ve=It.call(ve),xp(me,ce,ve,Ke)}if(typeof ve.then=="function")return nh(me,ce,Ct(ve),Ke);if(ve.$$typeof===Rc)return nh(me,ce,xx(me,ve),Ke);tn(me,ve)}return typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint"?(ve=""+ve,ce!==null&&ce.tag===6?(b(me,ce.sibling),Ke=A(ce,ve),Ke.return=me,me=Ke):(b(me,ce),Ke=e3(ve,me.mode,Ke),Ke.return=me,me=Ke),q(me)):b(me,ce)}return function(me,ce,ve,Ke){try{up=0;var It=nh(me,ce,ve,Ke);return Vd=null,It}catch(jt){if(jt===cp)throw jt;var Kn=t(29,jt,null,me.mode);return Kn.lanes=Ke,Kn.return=me,Kn}finally{}}}function hx(h,f){h=Cl,S(Ox,h),S(Gd,f),Cl=h|f.baseLanes}function _d(){S(Ox,Cl),S(Gd,Gd.current)}function Sd(){Cl=Ox.current,_(Gd),_(Ox)}function Cr(h){var f=h.alternate;S(Gi,Gi.current&1),S(_a,h),So===null&&(f===null||Gd.current!==null||f.memoizedState!==null)&&(So=h)}function wd(h){if(h.tag===22){if(S(Gi,Gi.current),S(_a,h),So===null){var f=h.alternate;f!==null&&f.memoizedState!==null&&(So=h)}}else qa()}function qa(){S(Gi,Gi.current),S(_a,_a.current)}function pa(h){_(_a),So===h&&(So=null),_(Gi)}function ml(h){for(var f=h;f!==null;){if(f.tag===13){var b=f.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||f3(b)||p3(b)))return f}else if(f.tag===19&&f.memoizedProps.revealOrder!==void 0){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===h)break;for(;f.sibling===null;){if(f.return===null||f.return===h)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}function ti(){throw Error(r(321))}function Sc(h,f){if(f===null)return!1;for(var b=0;b<f.length&&b<h.length;b++)if(!js(h[b],f[b]))return!1;return!0}function Md(h,f,b,M,A,N){return Lc=N,rn=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,Wt.H=h===null||h.memoizedState===null?Ku:kc,$u=!1,N=b(M,A),$u=!1,Wd&&(N=dx(f,b,M,A)),W0(h),N}function W0(h){Wt.H=wo;var f=Dn!==null&&Dn.next!==null;if(Lc=0,Di=Dn=rn=null,zx=!1,hp=0,qd=null,f)throw Error(r(300));h===null||Ji||(h=h.dependencies,h!==null&&gx(h)&&(Ji=!0))}function dx(h,f,b,M){rn=h;var A=0;do{if(Wd&&(qd=null),hp=0,Wd=!1,25<=A)throw Error(r(301));if(A+=1,Di=Dn=null,h.updateQueue!=null){var N=h.updateQueue;N.lastEffect=null,N.events=null,N.stores=null,N.memoCache!=null&&(N.memoCache.index=0)}Wt.H=Zu,N=f(b,M)}while(Wd);return N}function m_(){var h=Wt.H,f=h.useState()[0];return f=typeof f.then=="function"?oe(f):f,h=h.useState()[0],(Dn!==null?Dn.memoizedState:null)!==h&&(rn.flags|=1024),f}function q0(){var h=Ux!==0;return Ux=0,h}function X0(h,f,b){f.updateQueue=h.updateQueue,f.flags&=-2053,h.lanes&=~b}function Y0(h){if(zx){for(h=h.memoizedState;h!==null;){var f=h.queue;f!==null&&(f.pending=null),h=h.next}zx=!1}Lc=0,Di=Dn=rn=null,Wd=!1,hp=Ux=0,qd=null}function Er(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Di===null?rn.memoizedState=Di=h:Di=Di.next=h,Di}function G(){if(Dn===null){var h=rn.alternate;h=h!==null?h.memoizedState:null}else h=Dn.next;var f=Di===null?rn.memoizedState:Di.next;if(f!==null)Di=f,Dn=h;else{if(h===null)throw rn.alternate===null?Error(r(467)):Error(r(310));Dn=h,h={memoizedState:Dn.memoizedState,baseState:Dn.baseState,baseQueue:Dn.baseQueue,queue:Dn.queue,next:null},Di===null?rn.memoizedState=Di=h:Di=Di.next=h}return Di}function oe(h){var f=hp;return hp+=1,qd===null&&(qd=[]),h=Ce(qd,h,f),f=rn,(Di===null?f.memoizedState:Di.next)===null&&(f=f.alternate,Wt.H=f===null||f.memoizedState===null?Ku:kc),h}function xe(h){if(h!==null&&typeof h=="object"){if(typeof h.then=="function")return oe(h);if(h.$$typeof===Rc)return Pr(h)}throw Error(r(438,String(h)))}function be(h){var f=null,b=rn.updateQueue;if(b!==null&&(f=b.memoCache),f==null){var M=rn.alternate;M!==null&&(M=M.updateQueue,M!==null&&(M=M.memoCache,M!=null&&(f={data:M.data.map(function(A){return A.slice()}),index:0})))}if(f==null&&(f={data:[],index:0}),b===null&&(b=A3(),rn.updateQueue=b),b.memoCache=f,b=f.data[f.index],b===void 0)for(b=f.data[f.index]=Array(h),M=0;M<h;M++)b[M]=JW;return f.index++,b}function le(h,f){return typeof f=="function"?f(h):f}function tt(h){var f=G();return ut(f,Dn,h)}function ut(h,f,b){var M=h.queue;if(M===null)throw Error(r(311));M.lastRenderedReducer=b;var A=h.baseQueue,N=M.pending;if(N!==null){if(A!==null){var q=A.next;A.next=N.next,N.next=q}f.baseQueue=A=N,M.pending=null}if(N=h.baseState,A===null)h.memoizedState=N;else{f=A.next;var re=q=null,he=null,Ae=f,nt=!1;do{var ht=Ae.lane&-536870913;if(ht!==Ae.lane?(mn&ht)===ht:(Lc&ht)===ht){var mt=Ae.revertLane;if(mt===0)he!==null&&(he=he.next={lane:0,revertLane:0,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null}),ht===Bd&&(nt=!0);else if((Lc&mt)===mt){Ae=Ae.next,mt===Bd&&(nt=!0);continue}else ht={lane:0,revertLane:Ae.revertLane,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null},he===null?(re=he=ht,q=N):he=he.next=ht,rn.lanes|=mt,Oc|=mt;ht=Ae.action,$u&&b(N,ht),N=Ae.hasEagerState?Ae.eagerState:b(N,ht)}else mt={lane:ht,revertLane:Ae.revertLane,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null},he===null?(re=he=mt,q=N):he=he.next=mt,rn.lanes|=ht,Oc|=ht;Ae=Ae.next}while(Ae!==null&&Ae!==f);if(he===null?q=N:he.next=re,!js(N,h.memoizedState)&&(Ji=!0,nt&&(b=Hd,b!==null)))throw b;h.memoizedState=N,h.baseState=q,h.baseQueue=he,M.lastRenderedState=N}return A===null&&(M.lanes=0),[h.memoizedState,M.dispatch]}function St(h){var f=G(),b=f.queue;if(b===null)throw Error(r(311));b.lastRenderedReducer=h;var M=b.dispatch,A=b.pending,N=f.memoizedState;if(A!==null){b.pending=null;var q=A=A.next;do N=h(N,q.action),q=q.next;while(q!==A);js(N,f.memoizedState)||(Ji=!0),f.memoizedState=N,f.baseQueue===null&&(f.baseState=N),b.lastRenderedState=N}return[N,M]}function yt(h,f,b){var M=rn,A=G(),N=vn;if(N){if(b===void 0)throw Error(r(407));b=b()}else b=f();var q=!js((Dn||A).memoizedState,b);if(q&&(A.memoizedState=b,Ji=!0),A=A.queue,g_(Pt.bind(null,M,A,h),[h]),A.getSnapshot!==f||q||Di!==null&&Di.memoizedState.tag&1){if(M.flags|=2048,Ci(9,Ut.bind(null,M,A,b,f),{destroy:void 0},null),qn===null)throw Error(r(349));N||(Lc&60)!==0||Lt(M,f,b)}return b}function Lt(h,f,b){h.flags|=16384,h={getSnapshot:f,value:b},f=rn.updateQueue,f===null?(f=A3(),rn.updateQueue=f,f.stores=[h]):(b=f.stores,b===null?f.stores=[h]:b.push(h))}function Ut(h,f,b,M){f.value=b,f.getSnapshot=M,nn(f)&&Mn(h)}function Pt(h,f,b){return b(function(){nn(f)&&Mn(h)})}function nn(h){var f=h.getSnapshot;h=h.value;try{var b=f();return!js(h,b)}catch{return!0}}function Mn(h){var f=Ie(h,2);f!==null&&qr(f,h,2)}function Vn(h){var f=Er();if(typeof h=="function"){var b=h;if(h=b(),$u){X(!0);try{b()}finally{X(!1)}}}return f.memoizedState=f.baseState=h,f.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:le,lastRenderedState:h},f}function $n(h,f,b,M){return h.baseState=b,ut(h,Dn,typeof M=="function"?M:le)}function En(h,f,b,M,A){if(px(h))throw Error(r(485));if(h=f.action,h!==null){var N={payload:A,action:h,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){N.listeners.push(q)}};Wt.T!==null?b(!0):N.isTransition=!1,M(N),b=f.pending,b===null?(N.next=f.pending=N,Dt(f,N)):(N.next=b.next,f.pending=b.next=N)}}function Dt(h,f){var b=f.action,M=f.payload,A=h.state;if(f.isTransition){var N=Wt.T,q={};Wt.T=q;try{var re=b(A,M),he=Wt.S;he!==null&&he(q,re),Gn(h,f,re)}catch(Ae){gr(h,f,Ae)}finally{Wt.T=N}}else try{N=b(A,M),Gn(h,f,N)}catch(Ae){gr(h,f,Ae)}}function Gn(h,f,b){b!==null&&typeof b=="object"&&typeof b.then=="function"?b.then(function(M){dn(h,f,M)},function(M){return gr(h,f,M)}):dn(h,f,b)}function dn(h,f,b){f.status="fulfilled",f.value=b,gl(f),h.state=b,f=h.pending,f!==null&&(b=f.next,b===f?h.pending=null:(b=b.next,f.next=b,Dt(h,b)))}function gr(h,f,b){var M=h.pending;if(h.pending=null,M!==null){M=M.next;do f.status="rejected",f.reason=b,gl(f),f=f.next;while(f!==M)}h.action=null}function gl(h){h=h.listeners;for(var f=0;f<h.length;f++)(0,h[f])()}function Rr(h,f){return f}function wc(h,f){if(vn){var b=qn.formState;if(b!==null){e:{var M=rn;if(vn){if(Nr){var A=Gq(Nr,_o);if(A){Nr=N7(A),M=Wq(A);break e}}Ne(M)}M=!1}M&&(f=b[0])}}b=Er(),b.memoizedState=b.baseState=f,M={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rr,lastRenderedState:f},b.queue=M,b=r8.bind(null,rn,M),M.dispatch=b,M=Vn(!1);var N=b_.bind(null,rn,!1,M.queue);return M=Er(),A={state:f,dispatch:null,action:h,pending:null},M.queue=A,b=En.bind(null,rn,A,N,b),A.dispatch=b,M.memoizedState=h,[f,b,!1]}function Wn(h){var f=G();return xr(f,Dn,h)}function xr(h,f,b){f=ut(h,f,Rr)[0],h=tt(le)[0],f=typeof f=="object"&&f!==null&&typeof f.then=="function"?oe(f):f;var M=G(),A=M.queue,N=A.dispatch;return b!==M.memoizedState&&(rn.flags|=2048,Ci(9,cs.bind(null,A,b),{destroy:void 0},null)),[f,N,h]}function cs(h,f){h.action=f}function Qi(h){var f=G(),b=Dn;if(b!==null)return xr(f,b,h);G(),f=f.memoizedState,b=G();var M=b.queue.dispatch;return b.memoizedState=h,[f,M,!1]}function Ci(h,f,b,M){return h={tag:h,create:f,inst:b,deps:M,next:null},f=rn.updateQueue,f===null&&(f=A3(),rn.updateQueue=f),b=f.lastEffect,b===null?f.lastEffect=h.next=h:(M=b.next,b.next=h,h.next=M,f.lastEffect=h),h}function Td(){return G().memoizedState}function ma(h,f,b,M){var A=Er();rn.flags|=h,A.memoizedState=Ci(1|f,b,{destroy:void 0},M===void 0?null:M)}function fx(h,f,b,M){var A=G();M=M===void 0?null:M;var N=A.memoizedState.inst;Dn!==null&&M!==null&&Sc(M,Dn.memoizedState.deps)?A.memoizedState=Ci(f,b,N,M):(rn.flags|=h,A.memoizedState=Ci(1|f,b,N,M))}function qC(h,f){ma(8390656,8,h,f)}function g_(h,f){fx(2048,8,h,f)}function XC(h,f){return fx(4,2,h,f)}function YC(h,f){return fx(4,4,h,f)}function $C(h,f){if(typeof f=="function"){h=h();var b=f(h);return function(){typeof b=="function"?b():f(null)}}if(f!=null)return h=h(),f.current=h,function(){f.current=null}}function KC(h,f,b){b=b!=null?b.concat([h]):null,fx(4,4,$C.bind(null,f,h),b)}function x_(){}function ZC(h,f){var b=G();f=f===void 0?null:f;var M=b.memoizedState;return f!==null&&Sc(f,M[1])?M[0]:(b.memoizedState=[h,f],h)}function QC(h,f){var b=G();f=f===void 0?null:f;var M=b.memoizedState;if(f!==null&&Sc(f,M[1]))return M[0];if(M=h(),$u){X(!0);try{h()}finally{X(!1)}}return b.memoizedState=[M,f],M}function y_(h,f,b){return b===void 0||(Lc&1073741824)!==0?h.memoizedState=f:(h.memoizedState=b,h=Y8(),rn.lanes|=h,Oc|=h,b)}function JC(h,f,b,M){return js(b,f)?b:Gd.current!==null?(h=y_(h,b,M),js(h,f)||(Ji=!0),h):(Lc&42)===0?(Ji=!0,h.memoizedState=b):(h=Y8(),rn.lanes|=h,Oc|=h,f)}function e8(h,f,b,M,A){var N=Wu();hs(N!==0&&8>N?N:8);var q=Wt.T,re={};Wt.T=re,b_(h,!1,f,b);try{var he=A(),Ae=Wt.S;if(Ae!==null&&Ae(re,he),he!==null&&typeof he=="object"&&typeof he.then=="function"){var nt=st(he,M);$0(h,f,nt,Us(h))}else $0(h,f,M,Us(h))}catch(ht){$0(h,f,{then:function(){},status:"rejected",reason:ht},Us())}finally{hs(N),Wt.T=q}}function t8(h){var f=h.memoizedState;if(f!==null)return f;f={memoizedState:Dd,baseState:Dd,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:le,lastRenderedState:Dd},next:null};var b={};return f.next={memoizedState:b,baseState:b,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:le,lastRenderedState:b},next:null},h.memoizedState=f,h=h.alternate,h!==null&&(h.memoizedState=f),f}function v_(){return Pr(qu)}function n8(){return G().memoizedState}function i8(){return G().memoizedState}function IW(h){for(var f=h.return;f!==null;){switch(f.tag){case 24:case 3:var b=Us();h=Pe(b);var M=Xe(f,h,b);M!==null&&(qr(M,f,b),Rt(M,f,b)),f={cache:N_()},h.payload=f;return}f=f.return}}function DW(h,f,b){var M=Us();b={lane:M,revertLane:0,action:b,hasEagerState:!1,eagerState:null,next:null},px(h)?s8(f,b):(b=Ee(h,f,b,M),b!==null&&(qr(b,h,M),a8(b,f,M)))}function r8(h,f,b){var M=Us();$0(h,f,b,M)}function $0(h,f,b,M){var A={lane:M,revertLane:0,action:b,hasEagerState:!1,eagerState:null,next:null};if(px(h))s8(f,A);else{var N=h.alternate;if(h.lanes===0&&(N===null||N.lanes===0)&&(N=f.lastRenderedReducer,N!==null))try{var q=f.lastRenderedState,re=N(q,b);if(A.hasEagerState=!0,A.eagerState=re,js(re,q))return Y(h,f,A,0),qn===null&&Te(),!1}catch{}finally{}if(b=Ee(h,f,A,M),b!==null)return qr(b,h,M),a8(b,f,M),!0}return!1}function b_(h,f,b,M){if(M={lane:2,revertLane:Re(),action:M,hasEagerState:!1,eagerState:null,next:null},px(h)){if(f)throw Error(r(479))}else f=Ee(h,b,M,2),f!==null&&qr(f,h,2)}function px(h){var f=h.alternate;return h===rn||f!==null&&f===rn}function s8(h,f){Wd=zx=!0;var b=h.pending;b===null?f.next=f:(f.next=b.next,b.next=f),h.pending=f}function a8(h,f,b){if((b&4194176)!==0){var M=f.lanes;M&=h.pendingLanes,b|=M,f.lanes=b,B(h,b)}}function __(h,f,b,M){f=h.memoizedState,b=b(M,f),b=b==null?f:i3({},f,b),h.memoizedState=b,h.lanes===0&&(h.updateQueue.baseState=b)}function o8(h,f,b,M,A,N,q){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(M,N,q):f.prototype&&f.prototype.isPureReactComponent?!We(b,M)||!We(A,N):!0}function l8(h,f,b,M){h=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(b,M),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(b,M),f.state!==h&&C3.enqueueReplaceState(f,f.state,null)}function Fu(h,f){var b=f;if("ref"in f){b={};for(var M in f)M!=="ref"&&(b[M]=f[M])}if(h=h.defaultProps){b===f&&(b=i3({},b));for(var A in h)b[A]===void 0&&(b[A]=h[A])}return b}function mx(h,f){try{var b=h.onUncaughtError;b(f.value,{componentStack:f.stack})}catch(M){setTimeout(function(){throw M})}}function c8(h,f,b){try{var M=h.onCaughtError;M(b.value,{componentStack:b.stack,errorBoundary:f.tag===1?f.stateNode:null})}catch(A){setTimeout(function(){throw A})}}function S_(h,f,b){return b=Pe(b),b.tag=3,b.payload={element:null},b.callback=function(){mx(h,f)},b}function u8(h){return h=Pe(h),h.tag=3,h}function h8(h,f,b,M){var A=b.type.getDerivedStateFromError;if(typeof A=="function"){var N=M.value;h.payload=function(){return A(N)},h.callback=function(){c8(f,b,M)}}var q=b.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(h.callback=function(){c8(f,b,M),typeof A!="function"&&(zc===null?zc=new Set([this]):zc.add(this));var re=M.stack;this.componentDidCatch(M.value,{componentStack:re!==null?re:""})})}function NW(h,f,b,M,A){if(b.flags|=32768,M!==null&&typeof M=="object"&&typeof M.then=="function"){if(f=b.alternate,f!==null&&Z0(f,b,A,!0),b=_a.current,b!==null){switch(b.tag){case 13:return So===null?K_():b.alternate===null&&vi===0&&(vi=3),b.flags&=-257,b.flags|=65536,b.lanes=A,M===kx?b.flags|=16384:(f=b.updateQueue,f===null?b.updateQueue=new Set([M]):f.add(M),Q_(h,M,A)),!1;case 22:return b.flags|=65536,M===kx?b.flags|=16384:(f=b.updateQueue,f===null?(f={transitions:null,markerInstances:null,retryQueue:new Set([M])},b.updateQueue=f):(b=f.retryQueue,b===null?f.retryQueue=new Set([M]):b.add(M)),Q_(h,M,A)),!1}throw Error(r(435,b.tag))}return Q_(h,M,A),K_(),!1}if(vn)return f=_a.current,f!==null?((f.flags&65536)===0&&(f.flags|=256),f.flags|=65536,f.lanes=A,M!==v3&&(h=Error(r(422),{cause:M}),vt(Q(h,b)))):(M!==v3&&(f=Error(r(423),{cause:M}),vt(Q(f,b))),h=h.current.alternate,h.flags|=65536,A&=-A,h.lanes|=A,M=Q(M,b),A=S_(h.stateNode,M,A),ie(h,A),vi!==4&&(vi=2)),!1;var N=Error(r(520),{cause:M});if(N=Q(N,b),fp===null?fp=[N]:fp.push(N),vi!==4&&(vi=2),f===null)return!0;M=Q(M,b),b=f;do{switch(b.tag){case 3:return b.flags|=65536,h=A&-A,b.lanes|=h,h=S_(b.stateNode,M,h),ie(b,h),!1;case 1:if(f=b.type,N=b.stateNode,(b.flags&128)===0&&(typeof f.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(zc===null||!zc.has(N))))return b.flags|=65536,A&=-A,b.lanes|=A,A=u8(A),h8(A,h,b,M),ie(b,A),!1}b=b.return}while(b!==null);return!1}function yr(h,f,b,M){f.child=h===null?X7(f,null,b,M):Yu(f,h.child,b,M)}function d8(h,f,b,M,A){b=b.render;var N=f.ref;if("ref"in M){var q={};for(var re in M)re!=="ref"&&(q[re]=M[re])}else q=M;return Bu(f),M=Md(h,f,b,q,N,A),re=q0(),h!==null&&!Ji?(X0(h,f,A),xl(h,f,A)):(vn&&re&&we(f),f.flags|=1,yr(h,f,M,A),f.child)}function f8(h,f,b,M,A){if(h===null){var N=b.type;return typeof N=="function"&&!J_(N)&&N.defaultProps===void 0&&b.compare===null?(f.tag=15,f.type=N,p8(h,f,N,M,A)):(h=wx(b.type,null,M,f,f.mode,A),h.ref=f.ref,h.return=f,f.child=h)}if(N=h.child,!P_(h,A)){var q=N.memoizedProps;if(b=b.compare,b=b!==null?b:We,b(q,M)&&h.ref===f.ref)return xl(h,f,A)}return f.flags|=1,h=Ec(N,M),h.ref=f.ref,h.return=f,f.child=h}function p8(h,f,b,M,A){if(h!==null){var N=h.memoizedProps;if(We(N,M)&&h.ref===f.ref)if(Ji=!1,f.pendingProps=M=N,P_(h,A))(h.flags&131072)!==0&&(Ji=!0);else return f.lanes=h.lanes,xl(h,f,A)}return w_(h,f,b,M,A)}function m8(h,f,b){var M=f.pendingProps,A=M.children,N=(f.stateNode._pendingVisibility&2)!==0,q=h!==null?h.memoizedState:null;if(K0(h,f),M.mode==="hidden"||N){if((f.flags&128)!==0){if(M=q!==null?q.baseLanes|b:b,h!==null){for(A=f.child=h.child,N=0;A!==null;)N=N|A.lanes|A.childLanes,A=A.sibling;f.childLanes=N&~M}else f.childLanes=0,f.child=null;return g8(h,f,M,b)}if((b&536870912)!==0)f.memoizedState={baseLanes:0,cachePool:null},h!==null&&yx(f,q!==null?q.cachePool:null),q!==null?hx(f,q):_d(),wd(f);else return f.lanes=f.childLanes=536870912,g8(h,f,q!==null?q.baseLanes|b:b,b)}else q!==null?(yx(f,q.cachePool),hx(f,q),qa(),f.memoizedState=null):(h!==null&&yx(f,null),_d(),qa());return yr(h,f,A,b),f.child}function g8(h,f,b,M){var A=L_();return A=A===null?null:{parent:_l?xi._currentValue:xi._currentValue2,pool:A},f.memoizedState={baseLanes:b,cachePool:A},h!==null&&yx(f,null),_d(),wd(f),h!==null&&Z0(h,f,M,!0),null}function K0(h,f){var b=f.ref;if(b===null)h!==null&&h.ref!==null&&(f.flags|=2097664);else{if(typeof b!="function"&&typeof b!="object")throw Error(r(284));(h===null||h.ref!==b)&&(f.flags|=2097664)}}function w_(h,f,b,M,A){return Bu(f),b=Md(h,f,b,M,void 0,A),M=q0(),h!==null&&!Ji?(X0(h,f,A),xl(h,f,A)):(vn&&M&&we(f),f.flags|=1,yr(h,f,b,A),f.child)}function x8(h,f,b,M,A,N){return Bu(f),f.updateQueue=null,b=dx(f,M,b,A),W0(h),M=q0(),h!==null&&!Ji?(X0(h,f,N),xl(h,f,N)):(vn&&M&&we(f),f.flags|=1,yr(h,f,b,N),f.child)}function y8(h,f,b,M,A){if(Bu(f),f.stateNode===null){var N=Ld,q=b.contextType;typeof q=="object"&&q!==null&&(N=Pr(q)),N=new b(M,N),f.memoizedState=N.state!==null&&N.state!==void 0?N.state:null,N.updater=C3,f.stateNode=N,N._reactInternals=f,N=f.stateNode,N.props=M,N.state=f.memoizedState,N.refs={},At(f),q=b.contextType,N.context=typeof q=="object"&&q!==null?Pr(q):Ld,N.state=f.memoizedState,q=b.getDerivedStateFromProps,typeof q=="function"&&(__(f,b,q,M),N.state=f.memoizedState),typeof b.getDerivedStateFromProps=="function"||typeof N.getSnapshotBeforeUpdate=="function"||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(q=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),q!==N.state&&C3.enqueueReplaceState(N,N.state,null),Fe(f,M,N,A),pe(),N.state=f.memoizedState),typeof N.componentDidMount=="function"&&(f.flags|=4194308),M=!0}else if(h===null){N=f.stateNode;var re=f.memoizedProps,he=Fu(b,re);N.props=he;var Ae=N.context,nt=b.contextType;q=Ld,typeof nt=="object"&&nt!==null&&(q=Pr(nt));var ht=b.getDerivedStateFromProps;nt=typeof ht=="function"||typeof N.getSnapshotBeforeUpdate=="function",re=f.pendingProps!==re,nt||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(re||Ae!==q)&&l8(f,N,M,q),Nc=!1;var mt=f.memoizedState;N.state=mt,Fe(f,M,N,A),pe(),Ae=f.memoizedState,re||mt!==Ae||Nc?(typeof ht=="function"&&(__(f,b,ht,M),Ae=f.memoizedState),(he=Nc||o8(f,b,he,M,mt,Ae,q))?(nt||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount()),typeof N.componentDidMount=="function"&&(f.flags|=4194308)):(typeof N.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=M,f.memoizedState=Ae),N.props=M,N.state=Ae,N.context=q,M=he):(typeof N.componentDidMount=="function"&&(f.flags|=4194308),M=!1)}else{N=f.stateNode,bt(h,f),q=f.memoizedProps,nt=Fu(b,q),N.props=nt,ht=f.pendingProps,mt=N.context,Ae=b.contextType,he=Ld,typeof Ae=="object"&&Ae!==null&&(he=Pr(Ae)),re=b.getDerivedStateFromProps,(Ae=typeof re=="function"||typeof N.getSnapshotBeforeUpdate=="function")||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(q!==ht||mt!==he)&&l8(f,N,M,he),Nc=!1,mt=f.memoizedState,N.state=mt,Fe(f,M,N,A),pe();var $t=f.memoizedState;q!==ht||mt!==$t||Nc||h!==null&&h.dependencies!==null&&gx(h.dependencies)?(typeof re=="function"&&(__(f,b,re,M),$t=f.memoizedState),(nt=Nc||o8(f,b,nt,M,mt,$t,he)||h!==null&&h.dependencies!==null&&gx(h.dependencies))?(Ae||typeof N.UNSAFE_componentWillUpdate!="function"&&typeof N.componentWillUpdate!="function"||(typeof N.componentWillUpdate=="function"&&N.componentWillUpdate(M,$t,he),typeof N.UNSAFE_componentWillUpdate=="function"&&N.UNSAFE_componentWillUpdate(M,$t,he)),typeof N.componentDidUpdate=="function"&&(f.flags|=4),typeof N.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof N.componentDidUpdate!="function"||q===h.memoizedProps&&mt===h.memoizedState||(f.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||q===h.memoizedProps&&mt===h.memoizedState||(f.flags|=1024),f.memoizedProps=M,f.memoizedState=$t),N.props=M,N.state=$t,N.context=he,M=nt):(typeof N.componentDidUpdate!="function"||q===h.memoizedProps&&mt===h.memoizedState||(f.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||q===h.memoizedProps&&mt===h.memoizedState||(f.flags|=1024),M=!1)}return N=M,K0(h,f),M=(f.flags&128)!==0,N||M?(N=f.stateNode,b=M&&typeof b.getDerivedStateFromError!="function"?null:N.render(),f.flags|=1,h!==null&&M?(f.child=Yu(f,h.child,null,A),f.child=Yu(f,null,b,A)):yr(h,f,b,A),f.memoizedState=N.state,h=f.child):h=xl(h,f,A),h}function v8(h,f,b,M){return Gt(),f.flags|=256,yr(h,f,b,M),f.child}function M_(h){return{baseLanes:h,cachePool:T8()}}function T_(h,f,b){return h=h!==null?h.childLanes&~b:0,f&&(h|=Sa),h}function b8(h,f,b){var M=f.pendingProps,A=!1,N=(f.flags&128)!==0,q;if((q=N)||(q=h!==null&&h.memoizedState===null?!1:(Gi.current&2)!==0),q&&(A=!0,f.flags&=-129),q=(f.flags&32)!==0,f.flags&=-33,h===null){if(vn){if(A?Cr(f):qa(),vn){var re=Nr,he;(he=re)&&(re=Kq(re,_o),re!==null?(f.memoizedState={dehydrated:re,treeContext:Xu!==null?{id:Sl,overflow:wl}:null,retryLane:536870912},he=t(18,null,null,0),he.stateNode=re,he.return=f,f.child=he,Xr=f,Nr=null,he=!0):he=!1),he||Ne(f)}if(re=f.memoizedState,re!==null&&(re=re.dehydrated,re!==null))return p3(re)?f.lanes=16:f.lanes=536870912,null;pa(f)}return re=M.children,M=M.fallback,A?(qa(),A=f.mode,re=C_({mode:"hidden",children:re},A),M=Gu(M,A,b,null),re.return=f,M.return=f,re.sibling=M,f.child=re,A=f.child,A.memoizedState=M_(b),A.childLanes=T_(h,q,b),f.memoizedState=E3,M):(Cr(f),A_(f,re))}if(he=h.memoizedState,he!==null&&(re=he.dehydrated,re!==null)){if(N)f.flags&256?(Cr(f),f.flags&=-257,f=E_(h,f,b)):f.memoizedState!==null?(qa(),f.child=h.child,f.flags|=128,f=null):(qa(),A=M.fallback,re=f.mode,M=C_({mode:"visible",children:M.children},re),A=Gu(A,re,b,null),A.flags|=2,M.return=f,A.return=f,M.sibling=A,f.child=M,Yu(f,h.child,null,b),M=f.child,M.memoizedState=M_(b),M.childLanes=T_(h,q,b),f.memoizedState=E3,f=A);else if(Cr(f),p3(re))q=jq(re).digest,M=Error(r(419)),M.stack="",M.digest=q,vt({value:M,source:null,stack:null}),f=E_(h,f,b);else if(Ji||Z0(h,f,b,!1),q=(b&h.childLanes)!==0,Ji||q){if(q=qn,q!==null){if(M=b&-b,(M&42)!==0)M=1;else switch(M){case 2:M=1;break;case 8:M=4;break;case 32:M=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:M=64;break;case 268435456:M=134217728;break;default:M=0}if(M=(M&(q.suspendedLanes|b))!==0?0:M,M!==0&&M!==he.retryLane)throw he.retryLane=M,Ie(h,M),qr(q,h,M),$7}f3(re)||K_(),f=E_(h,f,b)}else f3(re)?(f.flags|=128,f.child=h.child,f=WW.bind(null,h),Vq(re,f),f=null):(h=he.treeContext,ga&&(Nr=Xq(re),Xr=f,vn=!0,$a=null,_o=!1,h!==null&&(ya[va++]=Sl,ya[va++]=wl,ya[va++]=Xu,Sl=h.id,wl=h.overflow,Xu=f)),f=A_(f,M.children),f.flags|=4096);return f}return A?(qa(),A=M.fallback,re=f.mode,he=h.child,N=he.sibling,M=Ec(he,{mode:"hidden",children:M.children}),M.subtreeFlags=he.subtreeFlags&31457280,N!==null?A=Ec(N,A):(A=Gu(A,re,b,null),A.flags|=2),A.return=f,M.return=f,M.sibling=A,f.child=M,M=A,A=f.child,re=h.child.memoizedState,re===null?re=M_(b):(he=re.cachePool,he!==null?(N=_l?xi._currentValue:xi._currentValue2,he=he.parent!==N?{parent:N,pool:N}:he):he=T8(),re={baseLanes:re.baseLanes|b,cachePool:he}),A.memoizedState=re,A.childLanes=T_(h,q,b),f.memoizedState=E3,M):(Cr(f),b=h.child,h=b.sibling,b=Ec(b,{mode:"visible",children:M.children}),b.return=f,b.sibling=null,h!==null&&(q=f.deletions,q===null?(f.deletions=[h],f.flags|=16):q.push(h)),f.child=b,f.memoizedState=null,b)}function A_(h,f){return f=C_({mode:"visible",children:f},h.mode),f.return=h,h.child=f}function C_(h,f){return u7(h,f,0,null)}function E_(h,f,b){return Yu(f,h.child,null,b),h=A_(f,f.pendingProps.children),h.flags|=2,f.memoizedState=null,h}function _8(h,f,b){h.lanes|=f;var M=h.alternate;M!==null&&(M.lanes|=f),I_(h.return,f,b)}function R_(h,f,b,M,A){var N=h.memoizedState;N===null?h.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:M,tail:b,tailMode:A}:(N.isBackwards=f,N.rendering=null,N.renderingStartTime=0,N.last=M,N.tail=b,N.tailMode=A)}function S8(h,f,b){var M=f.pendingProps,A=M.revealOrder,N=M.tail;if(yr(h,f,M.children,b),M=Gi.current,(M&2)!==0)M=M&1|2,f.flags|=128;else{if(h!==null&&(h.flags&128)!==0)e:for(h=f.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&_8(h,b,f);else if(h.tag===19)_8(h,b,f);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===f)break e;for(;h.sibling===null;){if(h.return===null||h.return===f)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}M&=1}switch(S(Gi,M),A){case"forwards":for(b=f.child,A=null;b!==null;)h=b.alternate,h!==null&&ml(h)===null&&(A=b),b=b.sibling;b=A,b===null?(A=f.child,f.child=null):(A=b.sibling,b.sibling=null),R_(f,!1,A,b,N);break;case"backwards":for(b=null,A=f.child,f.child=null;A!==null;){if(h=A.alternate,h!==null&&ml(h)===null){f.child=A;break}h=A.sibling,A.sibling=b,b=A,A=h}R_(f,!0,b,null,N);break;case"together":R_(f,!1,null,null,void 0);break;default:f.memoizedState=null}return f.child}function xl(h,f,b){if(h!==null&&(f.dependencies=h.dependencies),Oc|=f.lanes,(b&f.childLanes)===0)if(h!==null){if(Z0(h,f,b,!1),(b&f.childLanes)===0)return null}else return null;if(h!==null&&f.child!==h.child)throw Error(r(153));if(f.child!==null){for(h=f.child,b=Ec(h,h.pendingProps),f.child=b,b.return=f;h.sibling!==null;)h=h.sibling,b=b.sibling=Ec(h,h.pendingProps),b.return=f;b.sibling=null}return f.child}function P_(h,f){return(h.lanes&f)!==0?!0:(h=h.dependencies,!!(h!==null&&gx(h)))}function LW(h,f,b){switch(f.tag){case 3:De(f,f.stateNode.containerInfo),Mc(f,xi,h.memoizedState.cache),Gt();break;case 27:case 5:fe(f);break;case 4:De(f,f.stateNode.containerInfo);break;case 10:Mc(f,f.type,f.memoizedProps.value);break;case 13:var M=f.memoizedState;if(M!==null)return M.dehydrated!==null?(Cr(f),f.flags|=128,null):(b&f.child.childLanes)!==0?b8(h,f,b):(Cr(f),h=xl(h,f,b),h!==null?h.sibling:null);Cr(f);break;case 19:var A=(h.flags&128)!==0;if(M=(b&f.childLanes)!==0,M||(Z0(h,f,b,!1),M=(b&f.childLanes)!==0),A){if(M)return S8(h,f,b);f.flags|=128}if(A=f.memoizedState,A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),S(Gi,Gi.current),M)break;return null;case 22:case 23:return f.lanes=0,m8(h,f,b);case 24:Mc(f,xi,h.memoizedState.cache)}return xl(h,f,b)}function w8(h,f,b){if(h!==null)if(h.memoizedProps!==f.pendingProps)Ji=!0;else{if(!P_(h,b)&&(f.flags&128)===0)return Ji=!1,LW(h,f,b);Ji=(h.flags&131072)!==0}else Ji=!1,vn&&(f.flags&1048576)!==0&&ye(f,Ix,f.index);switch(f.lanes=0,f.tag){case 16:e:{h=f.pendingProps;var M=f.elementType,A=M._init;if(M=A(M._payload),f.type=M,typeof M=="function")J_(M)?(h=Fu(M,h),f.tag=1,f=y8(null,f,M,h,b)):(f.tag=0,f=w_(null,f,M,h,b));else{if(M!=null){if(A=M.$$typeof,A===s3){f.tag=11,f=d8(null,f,M,h,b);break e}else if(A===l3){f.tag=14,f=f8(null,f,M,h,b);break e}}throw f=a(M)||M,Error(r(306,f,""))}}return f;case 0:return w_(h,f,f.type,f.pendingProps,b);case 1:return M=f.type,A=Fu(M,f.pendingProps),y8(h,f,M,A,b);case 3:e:{if(De(f,f.stateNode.containerInfo),h===null)throw Error(r(387));var N=f.pendingProps;A=f.memoizedState,M=A.element,bt(h,f),Fe(f,N,null,b);var q=f.memoizedState;if(N=q.cache,Mc(f,xi,N),N!==A.cache&&D_(f,[xi],b,!0),pe(),N=q.element,ga&&A.isDehydrated)if(A={element:N,isDehydrated:!1,cache:q.cache},f.updateQueue.baseState=A,f.memoizedState=A,f.flags&256){f=v8(h,f,N,b);break e}else if(N!==M){M=Q(Error(r(424)),f),vt(M),f=v8(h,f,N,b);break e}else for(ga&&(Nr=qq(f.stateNode.containerInfo),Xr=f,vn=!0,$a=null,_o=!0),b=X7(f,null,N,b),f.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling;else{if(Gt(),N===M){f=xl(h,f,b);break e}yr(h,f,N,b)}f=f.child}return f;case 26:if(xa)return K0(h,f),h===null?(b=z7(f.type,null,f.pendingProps,null))?f.memoizedState=b:vn||(f.stateNode=lX(f.type,f.pendingProps,Dc.current,f)):f.memoizedState=z7(f.type,h.memoizedProps,f.pendingProps,h.memoizedState),null;case 27:if(Dr)return fe(f),h===null&&Dr&&vn&&(M=f.stateNode=V7(f.type,f.pendingProps,Dc.current,vr.current,!1),Xr=f,_o=!0,Nr=L7(M)),M=f.pendingProps.children,h!==null||vn?yr(h,f,M,b):f.child=Yu(f,null,M,b),K0(h,f),f.child;case 5:return h===null&&vn&&(sX(f.type,f.pendingProps,vr.current),(A=M=Nr)&&(M=Yq(M,f.type,f.pendingProps,_o),M!==null?(f.stateNode=M,Xr=f,Nr=L7(M),_o=!1,A=!0):A=!1),A||Ne(f)),fe(f),A=f.type,N=f.pendingProps,q=h!==null?h.memoizedProps:null,M=N.children,Ax(A,N)?M=null:q!==null&&Ax(A,q)&&(f.flags|=32),f.memoizedState!==null&&(A=Md(h,f,m_,null,null,b),_l?qu._currentValue=A:qu._currentValue2=A),K0(h,f),yr(h,f,M,b),f.child;case 6:return h===null&&vn&&(aX(f.pendingProps,vr.current),(h=b=Nr)&&(b=$q(b,f.pendingProps,_o),b!==null?(f.stateNode=b,Xr=f,Nr=null,h=!0):h=!1),h||Ne(f)),null;case 13:return b8(h,f,b);case 4:return De(f,f.stateNode.containerInfo),M=f.pendingProps,h===null?f.child=Yu(f,null,M,b):yr(h,f,M,b),f.child;case 11:return d8(h,f,f.type,f.pendingProps,b);case 7:return yr(h,f,f.pendingProps,b),f.child;case 8:return yr(h,f,f.pendingProps.children,b),f.child;case 12:return yr(h,f,f.pendingProps.children,b),f.child;case 10:return M=f.pendingProps,Mc(f,f.type,M.value),yr(h,f,M.children,b),f.child;case 9:return A=f.type._context,M=f.pendingProps.children,Bu(f),A=Pr(A),M=M(A),f.flags|=1,yr(h,f,M,b),f.child;case 14:return f8(h,f,f.type,f.pendingProps,b);case 15:return p8(h,f,f.type,f.pendingProps,b);case 19:return S8(h,f,b);case 22:return m8(h,f,b);case 24:return Bu(f),M=Pr(xi),h===null?(A=L_(),A===null&&(A=qn,N=N_(),A.pooledCache=N,N.refCount++,N!==null&&(A.pooledCacheLanes|=b),A=N),f.memoizedState={parent:M,cache:A},At(f),Mc(f,xi,A)):((h.lanes&b)!==0&&(bt(h,f),Fe(f,null,null,b),pe()),A=h.memoizedState,N=f.memoizedState,A.parent!==M?(A={parent:M,cache:M},f.memoizedState=A,f.lanes===0&&(f.memoizedState=f.updateQueue.baseState=A),Mc(f,xi,M)):(M=N.cache,Mc(f,xi,M),M!==A.cache&&D_(f,[xi],b,!0))),yr(h,f,f.pendingProps.children,b),f.child;case 29:throw f.pendingProps}throw Error(r(156,f.tag))}function Mc(h,f,b){_l?(S(Fx,f._currentValue),f._currentValue=b):(S(Fx,f._currentValue2),f._currentValue2=b)}function yl(h){var f=Fx.current;_l?h._currentValue=f:h._currentValue2=f,_(Fx)}function I_(h,f,b){for(;h!==null;){var M=h.alternate;if((h.childLanes&f)!==f?(h.childLanes|=f,M!==null&&(M.childLanes|=f)):M!==null&&(M.childLanes&f)!==f&&(M.childLanes|=f),h===b)break;h=h.return}}function D_(h,f,b,M){var A=h.child;for(A!==null&&(A.return=h);A!==null;){var N=A.dependencies;if(N!==null){var q=A.child;N=N.firstContext;e:for(;N!==null;){var re=N;N=A;for(var he=0;he<f.length;he++)if(re.context===f[he]){N.lanes|=b,re=N.alternate,re!==null&&(re.lanes|=b),I_(N.return,b,h),M||(q=null);break e}N=re.next}}else if(A.tag===18){if(q=A.return,q===null)throw Error(r(341));q.lanes|=b,N=q.alternate,N!==null&&(N.lanes|=b),I_(q,b,h),q=null}else q=A.child;if(q!==null)q.return=A;else for(q=A;q!==null;){if(q===h){q=null;break}if(A=q.sibling,A!==null){A.return=q.return,q=A;break}q=q.return}A=q}}function Z0(h,f,b,M){h=null;for(var A=f,N=!1;A!==null;){if(!N){if((A.flags&524288)!==0)N=!0;else if((A.flags&262144)!==0)break}if(A.tag===10){var q=A.alternate;if(q===null)throw Error(r(387));if(q=q.memoizedProps,q!==null){var re=A.type;js(A.pendingProps.value,q.value)||(h!==null?h.push(re):h=[re])}}else if(A===Dx.current){if(q=A.alternate,q===null)throw Error(r(387));q.memoizedState.memoizedState!==A.memoizedState.memoizedState&&(h!==null?h.push(qu):h=[qu])}A=A.return}h!==null&&D_(f,h,b,M),f.flags|=262144}function gx(h){for(h=h.firstContext;h!==null;){var f=h.context;if(!js(_l?f._currentValue:f._currentValue2,h.memoizedValue))return!0;h=h.next}return!1}function Bu(h){Qu=h,Ml=null,h=h.dependencies,h!==null&&(h.firstContext=null)}function Pr(h){return M8(Qu,h)}function xx(h,f){return Qu===null&&Bu(h),M8(h,f)}function M8(h,f){var b=_l?f._currentValue:f._currentValue2;if(f={context:f,memoizedValue:b,next:null},Ml===null){if(h===null)throw Error(r(308));Ml=f,h.dependencies={lanes:0,firstContext:f},h.flags|=524288}else Ml=Ml.next=f;return b}function N_(){return{controller:new TX,data:new Map,refCount:0}}function Q0(h){h.refCount--,h.refCount===0&&AX(CX,function(){h.controller.abort()})}function L_(){var h=Ju.current;return h!==null?h:qn.pooledCache}function yx(h,f){f===null?S(Ju,Ju.current):S(Ju,f.pool)}function T8(){var h=L_();return h===null?null:{parent:_l?xi._currentValue:xi._currentValue2,pool:h}}function ks(h){h.flags|=4}function A8(h,f){if(h!==null&&h.child===f.child)return!1;if((f.flags&16)!==0)return!0;for(h=f.child;h!==null;){if((h.flags&13878)!==0||(h.subtreeFlags&13878)!==0)return!0;h=h.sibling}return!1}function k_(h,f,b,M){if(Ir)for(b=f.child;b!==null;){if(b.tag===5||b.tag===6)h3(h,b.stateNode);else if(!(b.tag===4||Dr&&b.tag===27)&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===f)break;for(;b.sibling===null;){if(b.return===null||b.return===f)return;b=b.return}b.sibling.return=b.return,b=b.sibling}else if(Ic)for(var A=f.child;A!==null;){if(A.tag===5){var N=A.stateNode;b&&M&&(N=I7(N,A.type,A.memoizedProps)),h3(h,N)}else if(A.tag===6)N=A.stateNode,b&&M&&(N=D7(N,A.memoizedProps)),h3(h,N);else if(A.tag!==4){if(A.tag===22&&A.memoizedState!==null)N=A.child,N!==null&&(N.return=A),k_(h,A,!0,!0);else if(A.child!==null){A.child.return=A,A=A.child;continue}}if(A===f)break;for(;A.sibling===null;){if(A.return===null||A.return===f)return;A=A.return}A.sibling.return=A.return,A=A.sibling}}function C8(h,f,b,M){if(Ic)for(var A=f.child;A!==null;){if(A.tag===5){var N=A.stateNode;b&&M&&(N=I7(N,A.type,A.memoizedProps)),R7(h,N)}else if(A.tag===6)N=A.stateNode,b&&M&&(N=D7(N,A.memoizedProps)),R7(h,N);else if(A.tag!==4){if(A.tag===22&&A.memoizedState!==null)N=A.child,N!==null&&(N.return=A),C8(h,A,!(A.memoizedProps!==null&&A.memoizedProps.mode==="manual"),!0);else if(A.child!==null){A.child.return=A,A=A.child;continue}}if(A===f)break;for(;A.sibling===null;){if(A.return===null||A.return===f)return;A=A.return}A.sibling.return=A.return,A=A.sibling}}function E8(h,f){if(Ic&&A8(h,f)){h=f.stateNode;var b=h.containerInfo,M=E7();C8(M,f,!1,!1),h.pendingChildren=M,ks(f),Hq(b,M)}}function O_(h,f,b,M){if(Ir)h.memoizedProps!==M&&ks(f);else if(Ic){var A=h.stateNode,N=h.memoizedProps;if((h=A8(h,f))||N!==M){var q=vr.current;N=Bq(A,b,N,M,!h,null),N===A?f.stateNode=A:(S7(N,b,M,q)&&ks(f),f.stateNode=N,h?k_(N,f,!1,!1):ks(f))}else f.stateNode=A}}function z_(h,f,b){if(pq(f,b)){if(h.flags|=16777216,!T7(f,b))if(J8())h.flags|=8192;else throw jd=kx,T3}else h.flags&=-16777217}function R8(h,f){if(uX(f)){if(h.flags|=16777216,!j7(f))if(J8())h.flags|=8192;else throw jd=kx,T3}else h.flags&=-16777217}function vx(h,f){f!==null&&(h.flags|=4),h.flags&16384&&(f=h.tag!==22?R():536870912,h.lanes|=f,$d|=f)}function J0(h,f){if(!vn)switch(h.tailMode){case"hidden":f=h.tail;for(var b=null;f!==null;)f.alternate!==null&&(b=f),f=f.sibling;b===null?h.tail=null:b.sibling=null;break;case"collapsed":b=h.tail;for(var M=null;b!==null;)b.alternate!==null&&(M=b),b=b.sibling;M===null?f||h.tail===null?h.tail=null:h.tail.sibling=null:M.sibling=null}}function oi(h){var f=h.alternate!==null&&h.alternate.child===h.child,b=0,M=0;if(f)for(var A=h.child;A!==null;)b|=A.lanes|A.childLanes,M|=A.subtreeFlags&31457280,M|=A.flags&31457280,A.return=h,A=A.sibling;else for(A=h.child;A!==null;)b|=A.lanes|A.childLanes,M|=A.subtreeFlags,M|=A.flags,A.return=h,A=A.sibling;return h.subtreeFlags|=M,h.childLanes=b,f}function kW(h,f,b){var M=f.pendingProps;switch(He(f),f.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return oi(f),null;case 1:return oi(f),null;case 3:return b=f.stateNode,M=null,h!==null&&(M=h.memoizedState.cache),f.memoizedState.cache!==M&&(f.flags|=2048),yl(xi),Oe(),b.pendingContext&&(b.context=b.pendingContext,b.pendingContext=null),(h===null||h.child===null)&&(Nt(f)?ks(f):h===null||h.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,$a!==null&&(Y_($a),$a=null))),E8(h,f),oi(f),null;case 26:if(xa){b=f.type;var A=f.memoizedState;return h===null?(ks(f),A!==null?(oi(f),R8(f,A)):(oi(f),z_(f,b,M))):A?A!==h.memoizedState?(ks(f),oi(f),R8(f,A)):(oi(f),f.flags&=-16777217):(Ir?h.memoizedProps!==M&&ks(f):O_(h,f,b,M),oi(f),z_(f,b,M)),null}case 27:if(Dr){if(ge(f),b=Dc.current,A=f.type,h!==null&&f.stateNode!=null)Ir?h.memoizedProps!==M&&ks(f):O_(h,f,A,M);else{if(!M){if(f.stateNode===null)throw Error(r(166));return oi(f),null}h=vr.current,Nt(f)?Qe(f,h):(h=V7(A,M,b,h,!0),f.stateNode=h,ks(f))}return oi(f),null}case 5:if(ge(f),b=f.type,h!==null&&f.stateNode!=null)O_(h,f,b,M);else{if(!M){if(f.stateNode===null)throw Error(r(166));return oi(f),null}h=vr.current,Nt(f)?Qe(f,h):(A=oq(b,M,Dc.current,h,f),k_(A,f,!1,!1),f.stateNode=A,S7(A,b,M,h)&&ks(f))}return oi(f),z_(f,f.type,f.pendingProps),null;case 6:if(h&&f.stateNode!=null)b=h.memoizedProps,Ir?b!==M&&ks(f):Ic&&(b!==M?(f.stateNode=w7(M,Dc.current,vr.current,f),ks(f)):f.stateNode=h.stateNode);else{if(typeof M!="string"&&f.stateNode===null)throw Error(r(166));if(h=Dc.current,b=vr.current,Nt(f)){if(!ga)throw Error(r(176));if(h=f.stateNode,b=f.memoizedProps,M=null,A=Xr,A!==null)switch(A.tag){case 27:case 5:M=A.memoizedProps}Qq(h,b,f,M)||Ne(f)}else f.stateNode=w7(M,h,b,f)}return oi(f),null;case 13:if(M=f.memoizedState,h===null||h.memoizedState!==null&&h.memoizedState.dehydrated!==null){if(A=Nt(f),M!==null&&M.dehydrated!==null){if(h===null){if(!A)throw Error(r(318));if(!ga)throw Error(r(344));if(A=f.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(r(317));Jq(A,f)}else Gt(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;oi(f),A=!1}else $a!==null&&(Y_($a),$a=null),A=!0;if(!A)return f.flags&256?(pa(f),f):(pa(f),null)}if(pa(f),(f.flags&128)!==0)return f.lanes=b,f;if(b=M!==null,h=h!==null&&h.memoizedState!==null,b){M=f.child,A=null,M.alternate!==null&&M.alternate.memoizedState!==null&&M.alternate.memoizedState.cachePool!==null&&(A=M.alternate.memoizedState.cachePool.pool);var N=null;M.memoizedState!==null&&M.memoizedState.cachePool!==null&&(N=M.memoizedState.cachePool.pool),N!==A&&(M.flags|=2048)}return b!==h&&b&&(f.child.flags|=8192),vx(f,f.updateQueue),oi(f),null;case 4:return Oe(),E8(h,f),h===null&&uq(f.stateNode.containerInfo),oi(f),null;case 10:return yl(f.type),oi(f),null;case 19:if(_(Gi),A=f.memoizedState,A===null)return oi(f),null;if(M=(f.flags&128)!==0,N=A.rendering,N===null)if(M)J0(A,!1);else{if(vi!==0||h!==null&&(h.flags&128)!==0)for(h=f.child;h!==null;){if(N=ml(h),N!==null){for(f.flags|=128,J0(A,!1),h=N.updateQueue,f.updateQueue=h,vx(f,h),f.subtreeFlags=0,h=b,b=f.child;b!==null;)c7(b,h),b=b.sibling;return S(Gi,Gi.current&1|2),f.child}h=h.sibling}A.tail!==null&&Ya()>pp&&(f.flags|=128,M=!0,J0(A,!1),f.lanes=4194304)}else{if(!M)if(h=ml(N),h!==null){if(f.flags|=128,M=!0,h=h.updateQueue,f.updateQueue=h,vx(f,h),J0(A,!0),A.tail===null&&A.tailMode==="hidden"&&!N.alternate&&!vn)return oi(f),null}else 2*Ya()-A.renderingStartTime>pp&&b!==536870912&&(f.flags|=128,M=!0,J0(A,!1),f.lanes=4194304);A.isBackwards?(N.sibling=f.child,f.child=N):(h=A.last,h!==null?h.sibling=N:f.child=N,A.last=N)}return A.tail!==null?(f=A.tail,A.rendering=f,A.tail=f.sibling,A.renderingStartTime=Ya(),f.sibling=null,h=Gi.current,S(Gi,M?h&1|2:h&1),f):(oi(f),null);case 22:case 23:return pa(f),Sd(),M=f.memoizedState!==null,h!==null?h.memoizedState!==null!==M&&(f.flags|=8192):M&&(f.flags|=8192),M?(b&536870912)!==0&&(f.flags&128)===0&&(oi(f),f.subtreeFlags&6&&(f.flags|=8192)):oi(f),b=f.updateQueue,b!==null&&vx(f,b.retryQueue),b=null,h!==null&&h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(b=h.memoizedState.cachePool.pool),M=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(M=f.memoizedState.cachePool.pool),M!==b&&(f.flags|=2048),h!==null&&_(Ju),null;case 24:return b=null,h!==null&&(b=h.memoizedState.cache),f.memoizedState.cache!==b&&(f.flags|=2048),yl(xi),oi(f),null;case 25:return null}throw Error(r(156,f.tag))}function OW(h,f){switch(He(f),f.tag){case 1:return h=f.flags,h&65536?(f.flags=h&-65537|128,f):null;case 3:return yl(xi),Oe(),h=f.flags,(h&65536)!==0&&(h&128)===0?(f.flags=h&-65537|128,f):null;case 26:case 27:case 5:return ge(f),null;case 13:if(pa(f),h=f.memoizedState,h!==null&&h.dehydrated!==null){if(f.alternate===null)throw Error(r(340));Gt()}return h=f.flags,h&65536?(f.flags=h&-65537|128,f):null;case 19:return _(Gi),null;case 4:return Oe(),null;case 10:return yl(f.type),null;case 22:case 23:return pa(f),Sd(),h!==null&&_(Ju),h=f.flags,h&65536?(f.flags=h&-65537|128,f):null;case 24:return yl(xi),null;case 25:return null;default:return null}}function P8(h,f){switch(He(f),f.tag){case 3:yl(xi),Oe();break;case 26:case 27:case 5:ge(f);break;case 4:Oe();break;case 13:pa(f);break;case 19:_(Gi);break;case 10:yl(f.type);break;case 22:case 23:pa(f),Sd(),h!==null&&_(Ju);break;case 24:yl(xi)}}function ep(h,f){try{var b=f.updateQueue,M=b!==null?b.lastEffect:null;if(M!==null){var A=M.next;b=A;do{if((b.tag&h)===h){M=void 0;var N=b.create,q=b.inst;M=N(),q.destroy=M}b=b.next}while(b!==A)}}catch(re){Rn(f,f.return,re)}}function Tc(h,f,b){try{var M=f.updateQueue,A=M!==null?M.lastEffect:null;if(A!==null){var N=A.next;M=N;do{if((M.tag&h)===h){var q=M.inst,re=q.destroy;if(re!==void 0){q.destroy=void 0,A=f;var he=b;try{re()}catch(Ae){Rn(A,he,Ae)}}}M=M.next}while(M!==N)}}catch(Ae){Rn(f,f.return,Ae)}}function I8(h){var f=h.updateQueue;if(f!==null){var b=h.stateNode;try{je(f,b)}catch(M){Rn(h,h.return,M)}}}function D8(h,f,b){b.props=Fu(h.type,h.memoizedProps),b.state=h.memoizedState;try{b.componentWillUnmount()}catch(M){Rn(h,f,M)}}function Hu(h,f){try{var b=h.ref;if(b!==null){var M=h.stateNode;switch(h.tag){case 26:case 27:case 5:var A=ip(M);break;default:A=M}typeof b=="function"?h.refCleanup=b(A):b.current=A}}catch(N){Rn(h,f,N)}}function Os(h,f){var b=h.ref,M=h.refCleanup;if(b!==null)if(typeof M=="function")try{M()}catch(A){Rn(h,f,A)}finally{h.refCleanup=null,h=h.alternate,h!=null&&(h.refCleanup=null)}else if(typeof b=="function")try{b(null)}catch(A){Rn(h,f,A)}else b.current=null}function N8(h){var f=h.type,b=h.memoizedProps,M=h.stateNode;try{Rq(M,f,b,h)}catch(A){Rn(h,h.return,A)}}function L8(h,f,b){try{Pq(h.stateNode,h.type,b,f,h)}catch(M){Rn(h,h.return,M)}}function k8(h){return h.tag===5||h.tag===3||(xa?h.tag===26:!1)||(Dr?h.tag===27:!1)||h.tag===4}function U_(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||k8(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&(!Dr||h.tag!==27)&&h.tag!==18;){if(h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function F_(h,f,b){var M=h.tag;if(M===5||M===6)h=h.stateNode,f?Dq(b,h,f):Cq(b,h);else if(!(M===4||Dr&&M===27)&&(h=h.child,h!==null))for(F_(h,f,b),h=h.sibling;h!==null;)F_(h,f,b),h=h.sibling}function bx(h,f,b){var M=h.tag;if(M===5||M===6)h=h.stateNode,f?Iq(b,h,f):Aq(b,h);else if(!(M===4||Dr&&M===27)&&(h=h.child,h!==null))for(bx(h,f,b),h=h.sibling;h!==null;)bx(h,f,b),h=h.sibling}function O8(h,f,b){h=h.containerInfo;try{P7(h,b)}catch(M){Rn(f,f.return,M)}}function zW(h,f){for(sq(h.containerInfo),er=f;er!==null;)if(h=er,f=h.child,(h.subtreeFlags&1028)!==0&&f!==null)f.return=h,er=f;else for(;er!==null;){h=er;var b=h.alternate;switch(f=h.flags,h.tag){case 0:break;case 11:case 15:break;case 1:if((f&1024)!==0&&b!==null){f=void 0;var M=h,A=b.memoizedProps;b=b.memoizedState;var N=M.stateNode;try{var q=Fu(M.type,A,M.elementType===M.type);f=N.getSnapshotBeforeUpdate(q,b),N.__reactInternalSnapshotBeforeUpdate=f}catch(re){Rn(M,M.return,re)}}break;case 3:(f&1024)!==0&&Ir&&Fq(h.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((f&1024)!==0)throw Error(r(163))}if(f=h.sibling,f!==null){f.return=h.return,er=f;break}er=h.return}return q=Q7,Q7=!1,q}function z8(h,f,b){var M=b.flags;switch(b.tag){case 0:case 11:case 15:vl(h,b),M&4&&ep(5,b);break;case 1:if(vl(h,b),M&4)if(h=b.stateNode,f===null)try{h.componentDidMount()}catch(re){Rn(b,b.return,re)}else{var A=Fu(b.type,f.memoizedProps);f=f.memoizedState;try{h.componentDidUpdate(A,f,h.__reactInternalSnapshotBeforeUpdate)}catch(re){Rn(b,b.return,re)}}M&64&&I8(b),M&512&&Hu(b,b.return);break;case 3:if(vl(h,b),M&64&&(M=b.updateQueue,M!==null)){if(h=null,b.child!==null)switch(b.child.tag){case 27:case 5:h=ip(b.child.stateNode);break;case 1:h=b.child.stateNode}try{je(M,h)}catch(re){Rn(b,b.return,re)}}break;case 26:if(xa){vl(h,b),M&512&&Hu(b,b.return);break}case 27:case 5:vl(h,b),f===null&&M&4&&N8(b),M&512&&Hu(b,b.return);break;case 12:vl(h,b);break;case 13:vl(h,b),M&4&&F8(h,b);break;case 22:if(A=b.memoizedState!==null||Tl,!A){f=f!==null&&f.memoizedState!==null||yi;var N=Tl,q=yi;Tl=A,(yi=f)&&!q?Ac(h,b,(b.subtreeFlags&8772)!==0):vl(h,b),Tl=N,yi=q}M&512&&(b.memoizedProps.mode==="manual"?Hu(b,b.return):Os(b,b.return));break;default:vl(h,b)}}function U8(h){var f=h.alternate;f!==null&&(h.alternate=null,U8(f)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(f=h.stateNode,f!==null&&fq(f)),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}function Xa(h,f,b){for(b=b.child;b!==null;)B_(h,f,b),b=b.sibling}function B_(h,f,b){if(Hs&&typeof Hs.onCommitFiberUnmount=="function")try{Hs.onCommitFiberUnmount(ap,b)}catch{}switch(b.tag){case 26:if(xa){yi||Os(b,f),Xa(h,f,b),b.memoizedState?F7(b.memoizedState):b.stateNode&&H7(b.stateNode);break}case 27:if(Dr){yi||Os(b,f);var M=Ni,A=Vs;Ni=b.stateNode,Xa(h,f,b),pX(b.stateNode),Ni=M,Vs=A;break}case 5:yi||Os(b,f);case 6:if(Ir){if(M=Ni,A=Vs,Ni=null,Xa(h,f,b),Ni=M,Vs=A,Ni!==null)if(Vs)try{Lq(Ni,b.stateNode)}catch(N){Rn(b,f,N)}else try{Nq(Ni,b.stateNode)}catch(N){Rn(b,f,N)}}else Xa(h,f,b);break;case 18:Ir&&Ni!==null&&(Vs?rX(Ni,b.stateNode):iX(Ni,b.stateNode));break;case 4:Ir?(M=Ni,A=Vs,Ni=b.stateNode.containerInfo,Vs=!0,Xa(h,f,b),Ni=M,Vs=A):(Ic&&O8(b.stateNode,b,E7()),Xa(h,f,b));break;case 0:case 11:case 14:case 15:yi||Tc(2,b,f),yi||Tc(4,b,f),Xa(h,f,b);break;case 1:yi||(Os(b,f),M=b.stateNode,typeof M.componentWillUnmount=="function"&&D8(b,f,M)),Xa(h,f,b);break;case 21:Xa(h,f,b);break;case 22:yi||Os(b,f),yi=(M=yi)||b.memoizedState!==null,Xa(h,f,b),yi=M;break;default:Xa(h,f,b)}}function F8(h,f){if(ga&&f.memoizedState===null&&(h=f.alternate,h!==null&&(h=h.memoizedState,h!==null&&(h=h.dehydrated,h!==null))))try{nX(h)}catch(b){Rn(f,f.return,b)}}function UW(h){switch(h.tag){case 13:case 19:var f=h.stateNode;return f===null&&(f=h.stateNode=new Z7),f;case 22:return h=h.stateNode,f=h._retryCache,f===null&&(f=h._retryCache=new Z7),f;default:throw Error(r(435,h.tag))}}function H_(h,f){var b=UW(h);f.forEach(function(M){var A=qW.bind(null,h,M);b.has(M)||(b.add(M),M.then(A,A))})}function us(h,f){var b=f.deletions;if(b!==null)for(var M=0;M<b.length;M++){var A=b[M],N=h,q=f;if(Ir){var re=q;e:for(;re!==null;){switch(re.tag){case 27:case 5:Ni=re.stateNode,Vs=!1;break e;case 3:Ni=re.stateNode.containerInfo,Vs=!0;break e;case 4:Ni=re.stateNode.containerInfo,Vs=!0;break e}re=re.return}if(Ni===null)throw Error(r(160));B_(N,q,A),Ni=null,Vs=!1}else B_(N,q,A);N=A.alternate,N!==null&&(N.return=null),A.return=null}if(f.subtreeFlags&13878)for(f=f.child;f!==null;)B8(f,h),f=f.sibling}function B8(h,f){var b=h.alternate,M=h.flags;switch(h.tag){case 0:case 11:case 14:case 15:us(f,h),zs(h),M&4&&(Tc(3,h,h.return),ep(3,h),Tc(5,h,h.return));break;case 1:us(f,h),zs(h),M&512&&(yi||b===null||Os(b,b.return)),M&64&&Tl&&(h=h.updateQueue,h!==null&&(M=h.callbacks,M!==null&&(b=h.shared.hiddenCallbacks,h.shared.hiddenCallbacks=b===null?M:b.concat(M))));break;case 26:if(xa){var A=Ka;us(f,h),zs(h),M&512&&(yi||b===null||Os(b,b.return)),M&4&&(M=b!==null?b.memoizedState:null,f=h.memoizedState,b===null?f===null?h.stateNode===null?h.stateNode=oX(A,h.type,h.memoizedProps,h):B7(A,h.type,h.stateNode):h.stateNode=U7(A,f,h.memoizedProps):M!==f?(M===null?b.stateNode!==null&&H7(b.stateNode):F7(M),f===null?B7(A,h.type,h.stateNode):U7(A,f,h.memoizedProps)):f===null&&h.stateNode!==null&&L8(h,h.memoizedProps,b.memoizedProps));break}case 27:if(Dr&&M&4&&h.alternate===null){A=h.stateNode;var N=h.memoizedProps;try{dX(A),fX(h.type,N,A,h)}catch(nt){Rn(h,h.return,nt)}}case 5:if(us(f,h),zs(h),M&512&&(yi||b===null||Os(b,b.return)),Ir){if(h.flags&32){f=h.stateNode;try{C7(f)}catch(nt){Rn(h,h.return,nt)}}M&4&&h.stateNode!=null&&(f=h.memoizedProps,L8(h,f,b!==null?b.memoizedProps:f)),M&1024&&(R3=!0)}break;case 6:if(us(f,h),zs(h),M&4&&Ir){if(h.stateNode===null)throw Error(r(162));M=h.memoizedProps,b=b!==null?b.memoizedProps:M,f=h.stateNode;try{Eq(f,b,M)}catch(nt){Rn(h,h.return,nt)}}break;case 3:if(xa?(cX(),A=Ka,Ka=m3(f.containerInfo),us(f,h),Ka=A):us(f,h),zs(h),M&4){if(Ir&&ga&&b!==null&&b.memoizedState.isDehydrated)try{tX(f.containerInfo)}catch(nt){Rn(h,h.return,nt)}if(Ic){M=f.containerInfo,b=f.pendingChildren;try{P7(M,b)}catch(nt){Rn(h,h.return,nt)}}}R3&&(R3=!1,H8(h));break;case 4:xa?(b=Ka,Ka=m3(h.stateNode.containerInfo),us(f,h),zs(h),Ka=b):(us(f,h),zs(h)),M&4&&Ic&&O8(h.stateNode,h,h.stateNode.pendingChildren);break;case 12:us(f,h),zs(h);break;case 13:us(f,h),zs(h),h.child.flags&8192&&h.memoizedState!==null!=(b!==null&&b.memoizedState!==null)&&(N3=Ya()),M&4&&(M=h.updateQueue,M!==null&&(h.updateQueue=null,H_(h,M)));break;case 22:M&512&&(yi||b===null||Os(b,b.return)),A=h.memoizedState!==null;var q=b!==null&&b.memoizedState!==null,re=Tl,he=yi;if(Tl=re||A,yi=he||q,us(f,h),yi=he,Tl=re,zs(h),f=h.stateNode,f._current=h,f._visibility&=-3,f._visibility|=f._pendingVisibility&2,M&8192&&(f._visibility=A?f._visibility&-2:f._visibility|1,A&&(f=Tl||yi,b===null||q||f||Ad(h)),Ir&&(h.memoizedProps===null||h.memoizedProps.mode!=="manual"))){e:if(b=null,Ir)for(f=h;;){if(f.tag===5||xa&&f.tag===26||Dr&&f.tag===27){if(b===null){q=b=f;try{N=q.stateNode,A?kq(N):zq(q.stateNode,q.memoizedProps)}catch(nt){Rn(q,q.return,nt)}}}else if(f.tag===6){if(b===null){q=f;try{var Ae=q.stateNode;A?Oq(Ae):Uq(Ae,q.memoizedProps)}catch(nt){Rn(q,q.return,nt)}}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===h)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===h)break e;for(;f.sibling===null;){if(f.return===null||f.return===h)break e;b===f&&(b=null),f=f.return}b===f&&(b=null),f.sibling.return=f.return,f=f.sibling}}M&4&&(M=h.updateQueue,M!==null&&(b=M.retryQueue,b!==null&&(M.retryQueue=null,H_(h,b))));break;case 19:us(f,h),zs(h),M&4&&(M=h.updateQueue,M!==null&&(h.updateQueue=null,H_(h,M)));break;case 21:break;default:us(f,h),zs(h)}}function zs(h){var f=h.flags;if(f&2){try{if(Ir&&(!Dr||h.tag!==27)){e:{for(var b=h.return;b!==null;){if(k8(b)){var M=b;break e}b=b.return}throw Error(r(160))}switch(M.tag){case 27:if(Dr){var A=M.stateNode,N=U_(h);bx(h,N,A);break}case 5:var q=M.stateNode;M.flags&32&&(C7(q),M.flags&=-33);var re=U_(h);bx(h,re,q);break;case 3:case 4:var he=M.stateNode.containerInfo,Ae=U_(h);F_(h,Ae,he);break;default:throw Error(r(161))}}}catch(nt){Rn(h,h.return,nt)}h.flags&=-3}f&4096&&(h.flags&=-4097)}function H8(h){if(h.subtreeFlags&1024)for(h=h.child;h!==null;){var f=h;H8(f),f.tag===5&&f.flags&1024&&xq(f.stateNode),h=h.sibling}}function vl(h,f){if(f.subtreeFlags&8772)for(f=f.child;f!==null;)z8(h,f.alternate,f),f=f.sibling}function Ad(h){for(h=h.child;h!==null;){var f=h;switch(f.tag){case 0:case 11:case 14:case 15:Tc(4,f,f.return),Ad(f);break;case 1:Os(f,f.return);var b=f.stateNode;typeof b.componentWillUnmount=="function"&&D8(f,f.return,b),Ad(f);break;case 26:case 27:case 5:Os(f,f.return),Ad(f);break;case 22:Os(f,f.return),f.memoizedState===null&&Ad(f);break;default:Ad(f)}h=h.sibling}}function Ac(h,f,b){for(b=b&&(f.subtreeFlags&8772)!==0,f=f.child;f!==null;){var M=f.alternate,A=h,N=f,q=N.flags;switch(N.tag){case 0:case 11:case 15:Ac(A,N,b),ep(4,N);break;case 1:if(Ac(A,N,b),M=N,A=M.stateNode,typeof A.componentDidMount=="function")try{A.componentDidMount()}catch(Ae){Rn(M,M.return,Ae)}if(M=N,A=M.updateQueue,A!==null){var re=M.stateNode;try{var he=A.shared.hiddenCallbacks;if(he!==null)for(A.shared.hiddenCallbacks=null,A=0;A<he.length;A++)te(he[A],re)}catch(Ae){Rn(M,M.return,Ae)}}b&&q&64&&I8(N),Hu(N,N.return);break;case 26:case 27:case 5:Ac(A,N,b),b&&M===null&&q&4&&N8(N),Hu(N,N.return);break;case 12:Ac(A,N,b);break;case 13:Ac(A,N,b),b&&q&4&&F8(A,N);break;case 22:N.memoizedState===null&&Ac(A,N,b),Hu(N,N.return);break;default:Ac(A,N,b)}f=f.sibling}}function j_(h,f){var b=null;h!==null&&h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(b=h.memoizedState.cachePool.pool),h=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(h=f.memoizedState.cachePool.pool),h!==b&&(h!=null&&h.refCount++,b!=null&&Q0(b))}function V_(h,f){h=null,f.alternate!==null&&(h=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==h&&(f.refCount++,h!=null&&Q0(h))}function Cc(h,f,b,M){if(f.subtreeFlags&10256)for(f=f.child;f!==null;)j8(h,f,b,M),f=f.sibling}function j8(h,f,b,M){var A=f.flags;switch(f.tag){case 0:case 11:case 15:Cc(h,f,b,M),A&2048&&ep(9,f);break;case 3:Cc(h,f,b,M),A&2048&&(h=null,f.alternate!==null&&(h=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==h&&(f.refCount++,h!=null&&Q0(h)));break;case 12:if(A&2048){Cc(h,f,b,M),h=f.stateNode;try{var N=f.memoizedProps,q=N.id,re=N.onPostCommit;typeof re=="function"&&re(q,f.alternate===null?"mount":"update",h.passiveEffectDuration,-0)}catch(he){Rn(f,f.return,he)}}else Cc(h,f,b,M);break;case 23:break;case 22:N=f.stateNode,f.memoizedState!==null?N._visibility&4?Cc(h,f,b,M):tp(h,f):N._visibility&4?Cc(h,f,b,M):(N._visibility|=4,Cd(h,f,b,M,(f.subtreeFlags&10256)!==0)),A&2048&&j_(f.alternate,f);break;case 24:Cc(h,f,b,M),A&2048&&V_(f.alternate,f);break;default:Cc(h,f,b,M)}}function Cd(h,f,b,M,A){for(A=A&&(f.subtreeFlags&10256)!==0,f=f.child;f!==null;){var N=h,q=f,re=b,he=M,Ae=q.flags;switch(q.tag){case 0:case 11:case 15:Cd(N,q,re,he,A),ep(8,q);break;case 23:break;case 22:var nt=q.stateNode;q.memoizedState!==null?nt._visibility&4?Cd(N,q,re,he,A):tp(N,q):(nt._visibility|=4,Cd(N,q,re,he,A)),A&&Ae&2048&&j_(q.alternate,q);break;case 24:Cd(N,q,re,he,A),A&&Ae&2048&&V_(q.alternate,q);break;default:Cd(N,q,re,he,A)}f=f.sibling}}function tp(h,f){if(f.subtreeFlags&10256)for(f=f.child;f!==null;){var b=h,M=f,A=M.flags;switch(M.tag){case 22:tp(b,M),A&2048&&j_(M.alternate,M);break;case 24:tp(b,M),A&2048&&V_(M.alternate,M);break;default:tp(b,M)}f=f.sibling}}function ju(h){if(h.subtreeFlags&Xd)for(h=h.child;h!==null;)V8(h),h=h.sibling}function V8(h){switch(h.tag){case 26:ju(h),h.flags&Xd&&(h.memoizedState!==null?hX(Ka,h.memoizedState,h.memoizedProps):A7(h.type,h.memoizedProps));break;case 5:ju(h),h.flags&Xd&&A7(h.type,h.memoizedProps);break;case 3:case 4:if(xa){var f=Ka;Ka=m3(h.stateNode.containerInfo),ju(h),Ka=f}else ju(h);break;case 22:h.memoizedState===null&&(f=h.alternate,f!==null&&f.memoizedState!==null?(f=Xd,Xd=16777216,ju(h),Xd=f):ju(h));break;default:ju(h)}}function G8(h){var f=h.alternate;if(f!==null&&(h=f.child,h!==null)){f.child=null;do f=h.sibling,h.sibling=null,h=f;while(h!==null)}}function np(h){var f=h.deletions;if((h.flags&16)!==0){if(f!==null)for(var b=0;b<f.length;b++){var M=f[b];er=M,q8(M,h)}G8(h)}if(h.subtreeFlags&10256)for(h=h.child;h!==null;)W8(h),h=h.sibling}function W8(h){switch(h.tag){case 0:case 11:case 15:np(h),h.flags&2048&&Tc(9,h,h.return);break;case 3:np(h);break;case 12:np(h);break;case 22:var f=h.stateNode;h.memoizedState!==null&&f._visibility&4&&(h.return===null||h.return.tag!==13)?(f._visibility&=-5,_x(h)):np(h);break;default:np(h)}}function _x(h){var f=h.deletions;if((h.flags&16)!==0){if(f!==null)for(var b=0;b<f.length;b++){var M=f[b];er=M,q8(M,h)}G8(h)}for(h=h.child;h!==null;){switch(f=h,f.tag){case 0:case 11:case 15:Tc(8,f,f.return),_x(f);break;case 22:b=f.stateNode,b._visibility&4&&(b._visibility&=-5,_x(f));break;default:_x(f)}h=h.sibling}}function q8(h,f){for(;er!==null;){var b=er;switch(b.tag){case 0:case 11:case 15:Tc(8,b,f);break;case 23:case 22:if(b.memoizedState!==null&&b.memoizedState.cachePool!==null){var M=b.memoizedState.cachePool.pool;M!=null&&M.refCount++}break;case 24:Q0(b.memoizedState.cache)}if(M=b.child,M!==null)M.return=b,er=M;else e:for(b=h;er!==null;){M=er;var A=M.sibling,N=M.return;if(U8(M),M===b){er=null;break e}if(A!==null){A.return=N,er=A;break e}er=N}}}function G_(h){var f=M7(h);if(f!=null){if(typeof f.memoizedProps["data-testname"]!="string")throw Error(r(364));return f}if(h=bq(h),h===null)throw Error(r(362));return h.stateNode.current}function W_(h,f){var b=h.tag;switch(f.$$typeof){case Bx:if(h.type===f.value)return!0;break;case Hx:e:{for(f=f.value,h=[h,0],b=0;b<h.length;){var M=h[b++],A=M.tag,N=h[b++],q=f[N];if(A!==5&&A!==26&&A!==27||!sp(M)){for(;q!=null&&W_(M,q);)N++,q=f[N];if(N===f.length){f=!0;break e}else for(M=M.child;M!==null;)h.push(M,N),M=M.sibling}}f=!1}return f;case jx:if((b===5||b===26||b===27)&&wq(h.stateNode,f.value))return!0;break;case Gx:if((b===5||b===6||b===26||b===27)&&(h=Sq(h),h!==null&&0<=h.indexOf(f.value)))return!0;break;case Vx:if((b===5||b===26||b===27)&&(h=h.memoizedProps["data-testname"],typeof h=="string"&&h.toLowerCase()===f.value.toLowerCase()))return!0;break;default:throw Error(r(365))}return!1}function q_(h){switch(h.$$typeof){case Bx:return"<"+(a(h.value)||"Unknown")+">";case Hx:return":has("+(q_(h)||"")+")";case jx:return'[role="'+h.value+'"]';case Gx:return'"'+h.value+'"';case Vx:return'[data-testname="'+h.value+'"]';default:throw Error(r(365))}}function X8(h,f){var b=[];h=[h,0];for(var M=0;M<h.length;){var A=h[M++],N=A.tag,q=h[M++],re=f[q];if(N!==5&&N!==26&&N!==27||!sp(A)){for(;re!=null&&W_(A,re);)q++,re=f[q];if(q===f.length)b.push(A);else for(A=A.child;A!==null;)h.push(A,q),A=A.sibling}}return b}function X_(h,f){if(!rp)throw Error(r(363));h=G_(h),h=X8(h,f),f=[],h=Array.from(h);for(var b=0;b<h.length;){var M=h[b++],A=M.tag;if(A===5||A===26||A===27)sp(M)||f.push(M.stateNode);else for(M=M.child;M!==null;)h.push(M),M=M.sibling}return f}function Us(){if((Nn&2)!==0&&mn!==0)return mn&-mn;if(Wt.T!==null){var h=Bd;return h!==0?h:Re()}return hq()}function Y8(){Sa===0&&(Sa=(mn&536870912)===0||vn?O():536870912);var h=_a.current;return h!==null&&(h.flags|=32),Sa}function qr(h,f,b){(h===qn&&Xn===2||h.cancelPendingCommit!==null)&&(Ed(h,0),bl(h,mn,Sa,!1)),L(h,b),((Nn&2)===0||h!==qn)&&(h===qn&&((Nn&2)===0&&(eh|=b),vi===4&&bl(h,mn,Sa,!1)),ot(h))}function $8(h,f,b){if((Nn&6)!==0)throw Error(r(327));var M=!b&&(f&60)===0&&(f&h.expiredLanes)===0||E(h,f),A=M?HW(h,f):Z_(h,f,!0),N=M;do{if(A===0){Yd&&!M&&bl(h,f,0,!1);break}else if(A===6)bl(h,f,0,!Al);else{if(b=h.current.alternate,N&&!FW(b)){A=Z_(h,f,!1),N=!1;continue}if(A===2){if(N=f,h.errorRecoveryDisabledLanes&N)var q=0;else q=h.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){f=q;e:{var re=h;A=fp;var he=ga&&re.current.memoizedState.isDehydrated;if(he&&(Ed(re,q).flags|=256),q=Z_(re,q,!1),q!==2){if(P3&&!he){re.errorRecoveryDisabledLanes|=N,eh|=N,A=4;break e}N=Mo,Mo=A,N!==null&&Y_(N)}A=q}if(N=!1,A!==2)continue}}if(A===1){Ed(h,0),bl(h,f,0,!0);break}e:{switch(M=h,A){case 0:case 1:throw Error(r(345));case 4:if((f&4194176)===f){bl(M,f,Sa,!Al);break e}break;case 2:Mo=null;break;case 3:case 5:break;default:throw Error(r(329))}if(M.finishedWork=b,M.finishedLanes=f,(f&62914560)===f&&(N=N3+300-Ya(),10<N)){if(bl(M,f,Sa,!Al),C(M,0)!==0)break e;M.timeoutHandle=lq(K8.bind(null,M,b,Mo,Wx,D3,f,Sa,eh,$d,Al,2,-0,0),N);break e}K8(M,b,Mo,Wx,D3,f,Sa,eh,$d,Al,0,-0,0)}}break}while(!0);ot(h)}function Y_(h){Mo===null?Mo=h:Mo.push.apply(Mo,h)}function K8(h,f,b,M,A,N,q,re,he,Ae,nt,ht,mt){var $t=f.subtreeFlags;if(($t&8192||($t&16785408)===16785408)&&(mq(),V8(f),f=gq(),f!==null)){h.cancelPendingCommit=f(s7.bind(null,h,b,M,A,q,re,he,1,ht,mt)),bl(h,N,q,!Ae);return}s7(h,b,M,A,q,re,he,nt,ht,mt)}function FW(h){for(var f=h;;){var b=f.tag;if((b===0||b===11||b===15)&&f.flags&16384&&(b=f.updateQueue,b!==null&&(b=b.stores,b!==null)))for(var M=0;M<b.length;M++){var A=b[M],N=A.getSnapshot;A=A.value;try{if(!js(N(),A))return!1}catch{return!1}}if(b=f.child,f.subtreeFlags&16384&&b!==null)b.return=f,f=b;else{if(f===h)break;for(;f.sibling===null;){if(f.return===null||f.return===h)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function bl(h,f,b,M){f&=~I3,f&=~eh,h.suspendedLanes|=f,h.pingedLanes&=~f,M&&(h.warmLanes|=f),M=h.expirationTimes;for(var A=f;0<A;){var N=31-Bs(A),q=1<<N;M[N]=-1,A&=~q}b!==0&&j(h,b,f)}function Z8(){return(Nn&6)===0?(it(0),!1):!0}function $_(){if(ln!==null){if(Xn===0)var h=ln.return;else h=ln,Ml=Qu=null,Y0(h),Vd=null,up=0,h=ln;for(;h!==null;)P8(h.alternate,h),h=h.return;ln=null}}function Ed(h,f){h.finishedWork=null,h.finishedLanes=0;var b=h.timeoutHandle;b!==d3&&(h.timeoutHandle=d3,cq(b)),b=h.cancelPendingCommit,b!==null&&(h.cancelPendingCommit=null,b()),$_(),qn=h,ln=b=Ec(h.current,null),mn=f,Xn=0,Gs=null,Al=!1,Yd=E(h,f),P3=!1,$d=Sa=I3=eh=Oc=vi=0,Mo=fp=null,D3=!1,(f&8)!==0&&(f|=f&32);var M=h.entangledLanes;if(M!==0)for(h=h.entanglements,M&=f;0<M;){var A=31-Bs(M),N=1<<A;f|=h[A],M&=~N}return Cl=f,Te(),b}function Q8(h,f){rn=null,Wt.H=wo,f===cp?(f=ct(),Xn=3):f===T3?(f=ct(),Xn=4):Xn=f===$7?8:f!==null&&typeof f=="object"&&typeof f.then=="function"?6:1,Gs=f,ln===null&&(vi=1,mx(h,Q(f,h.current)))}function J8(){var h=_a.current;return h===null?!0:(mn&4194176)===mn?So===null:(mn&62914560)===mn||(mn&536870912)!==0?h===So:!1}function e7(){var h=Wt.H;return Wt.H=wo,h===null?wo:h}function t7(){var h=Wt.A;return Wt.A=EX,h}function K_(){vi=4,Al||(mn&4194176)!==mn&&_a.current!==null||(Yd=!0),(Oc&134217727)===0&&(eh&134217727)===0||qn===null||bl(qn,mn,Sa,!1)}function Z_(h,f,b){var M=Nn;Nn|=2;var A=e7(),N=t7();(qn!==h||mn!==f)&&(Wx=null,Ed(h,f)),f=!1;var q=vi;e:do try{if(Xn!==0&&ln!==null){var re=ln,he=Gs;switch(Xn){case 8:$_(),q=6;break e;case 3:case 2:case 6:_a.current===null&&(f=!0);var Ae=Xn;if(Xn=0,Gs=null,Rd(h,re,he,Ae),b&&Yd){q=0;break e}break;default:Ae=Xn,Xn=0,Gs=null,Rd(h,re,he,Ae)}}BW(),q=vi;break}catch(nt){Q8(h,nt)}while(!0);return f&&h.shellSuspendCounter++,Ml=Qu=null,Nn=M,Wt.H=A,Wt.A=N,ln===null&&(qn=null,mn=0,Te()),q}function BW(){for(;ln!==null;)n7(ln)}function HW(h,f){var b=Nn;Nn|=2;var M=e7(),A=t7();qn!==h||mn!==f?(Wx=null,pp=Ya()+500,Ed(h,f)):Yd=E(h,f);e:do try{if(Xn!==0&&ln!==null){f=ln;var N=Gs;t:switch(Xn){case 1:Xn=0,Gs=null,Rd(h,f,N,1);break;case 2:if(Je(N)){Xn=0,Gs=null,i7(f);break}f=function(){Xn===2&&qn===h&&(Xn=7),ot(h)},N.then(f,f);break e;case 3:Xn=7;break e;case 4:Xn=5;break e;case 7:Je(N)?(Xn=0,Gs=null,i7(f)):(Xn=0,Gs=null,Rd(h,f,N,7));break;case 5:var q=null;switch(ln.tag){case 26:q=ln.memoizedState;case 5:case 27:var re=ln,he=re.type,Ae=re.pendingProps;if(q?j7(q):T7(he,Ae)){Xn=0,Gs=null;var nt=re.sibling;if(nt!==null)ln=nt;else{var ht=re.return;ht!==null?(ln=ht,Sx(ht)):ln=null}break t}}Xn=0,Gs=null,Rd(h,f,N,5);break;case 6:Xn=0,Gs=null,Rd(h,f,N,6);break;case 8:$_(),vi=6;break e;default:throw Error(r(462))}}jW();break}catch(mt){Q8(h,mt)}while(!0);return Ml=Qu=null,Wt.H=M,Wt.A=A,Nn=b,ln!==null?0:(qn=null,mn=0,Te(),vi)}function jW(){for(;ln!==null&&!xX();)n7(ln)}function n7(h){var f=w8(h.alternate,h,Cl);h.memoizedProps=h.pendingProps,f===null?Sx(h):ln=f}function i7(h){var f=h,b=f.alternate;switch(f.tag){case 15:case 0:f=x8(b,f,f.pendingProps,f.type,void 0,mn);break;case 11:f=x8(b,f,f.pendingProps,f.type.render,f.ref,mn);break;case 5:Y0(f);default:P8(b,f),f=ln=c7(f,Cl),f=w8(b,f,Cl)}h.memoizedProps=h.pendingProps,f===null?Sx(h):ln=f}function Rd(h,f,b,M){Ml=Qu=null,Y0(f),Vd=null,up=0;var A=f.return;try{if(NW(h,A,f,b,mn)){vi=1,mx(h,Q(b,h.current)),ln=null;return}}catch(N){if(A!==null)throw ln=A,N;vi=1,mx(h,Q(b,h.current)),ln=null;return}f.flags&32768?(vn||M===1?h=!0:Yd||(mn&536870912)!==0?h=!1:(Al=h=!0,(M===2||M===3||M===6)&&(M=_a.current,M!==null&&M.tag===13&&(M.flags|=16384))),r7(f,h)):Sx(f)}function Sx(h){var f=h;do{if((f.flags&32768)!==0){r7(f,Al);return}h=f.return;var b=kW(f.alternate,f,Cl);if(b!==null){ln=b;return}if(f=f.sibling,f!==null){ln=f;return}ln=f=h}while(f!==null);vi===0&&(vi=5)}function r7(h,f){do{var b=OW(h.alternate,h);if(b!==null){b.flags&=32767,ln=b;return}if(b=h.return,b!==null&&(b.flags|=32768,b.subtreeFlags=0,b.deletions=null),!f&&(h=h.sibling,h!==null)){ln=h;return}ln=h=b}while(h!==null);vi=6,ln=null}function s7(h,f,b,M,A,N,q,re,he,Ae){var nt=Wt.T,ht=Wu();try{hs(2),Wt.T=null,VW(h,f,b,M,ht,A,N,q,re,he,Ae)}finally{Wt.T=nt,hs(ht)}}function VW(h,f,b,M,A,N,q,re){do Vu();while(th!==null);if((Nn&6)!==0)throw Error(r(327));var he=h.finishedWork;if(M=h.finishedLanes,he===null)return null;if(h.finishedWork=null,h.finishedLanes=0,he===h.current)throw Error(r(177));h.callbackNode=null,h.callbackPriority=0,h.cancelPendingCommit=null;var Ae=he.lanes|he.childLanes;if(Ae|=b3,V(h,M,Ae,N,q,re),h===qn&&(ln=qn=null,mn=0),(he.subtreeFlags&10256)===0&&(he.flags&10256)===0||qx||(qx=!0,L3=Ae,k3=b,XW(y3,function(){return Vu(),null})),b=(he.flags&15990)!==0,(he.subtreeFlags&15990)!==0||b?(b=Wt.T,Wt.T=null,N=Wu(),hs(2),q=Nn,Nn|=4,zW(h,he),B8(he,h),aq(h.containerInfo),h.current=he,z8(h,he.alternate,he),yX(),Nn=q,hs(N),Wt.T=b):h.current=he,qx?(qx=!1,th=h,mp=M):a7(h,Ae),Ae=h.pendingLanes,Ae===0&&(zc=null),U(he.stateNode),ot(h),f!==null)for(A=h.onRecoverableError,he=0;he<f.length;he++)Ae=f[he],A(Ae.value,{componentStack:Ae.stack});return(mp&3)!==0&&Vu(),Ae=h.pendingLanes,(M&4194218)!==0&&(Ae&42)!==0?h===O3?gp++:(gp=0,O3=h):gp=0,it(0),null}function a7(h,f){(h.pooledCacheLanes&=f)===0&&(f=h.pooledCache,f!=null&&(h.pooledCache=null,Q0(f)))}function Vu(){if(th!==null){var h=th,f=L3;L3=0;var b=J(mp),M=32>b?32:b;b=Wt.T;var A=Wu();try{if(hs(M),Wt.T=null,th===null)var N=!1;else{M=k3,k3=null;var q=th,re=mp;if(th=null,mp=0,(Nn&6)!==0)throw Error(r(331));var he=Nn;if(Nn|=4,W8(q.current),j8(q,q.current,re,M),Nn=he,it(0,!1),Hs&&typeof Hs.onPostCommitFiberRoot=="function")try{Hs.onPostCommitFiberRoot(ap,q)}catch{}N=!0}return N}finally{hs(A),Wt.T=b,a7(h,f)}}return!1}function o7(h,f,b){f=Q(b,f),f=S_(h.stateNode,f,2),h=Xe(h,f,2),h!==null&&(L(h,2),ot(h))}function Rn(h,f,b){if(h.tag===3)o7(h,h,b);else for(;f!==null;){if(f.tag===3){o7(f,h,b);break}else if(f.tag===1){var M=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof M.componentDidCatch=="function"&&(zc===null||!zc.has(M))){h=Q(b,h),b=u8(2),M=Xe(f,b,2),M!==null&&(h8(b,M,f,h),L(M,2),ot(M));break}}f=f.return}}function Q_(h,f,b){var M=h.pingCache;if(M===null){M=h.pingCache=new RX;var A=new Set;M.set(f,A)}else A=M.get(f),A===void 0&&(A=new Set,M.set(f,A));A.has(b)||(P3=!0,A.add(b),h=GW.bind(null,h,f,b),f.then(h,h))}function GW(h,f,b){var M=h.pingCache;M!==null&&M.delete(f),h.pingedLanes|=h.suspendedLanes&b,h.warmLanes&=~b,qn===h&&(mn&b)===b&&(vi===4||vi===3&&(mn&62914560)===mn&&300>Ya()-N3?(Nn&2)===0&&Ed(h,0):I3|=b,$d===mn&&($d=0)),ot(h)}function l7(h,f){f===0&&(f=R()),h=Ie(h,f),h!==null&&(L(h,f),ot(h))}function WW(h){var f=h.memoizedState,b=0;f!==null&&(b=f.retryLane),l7(h,b)}function qW(h,f){var b=0;switch(h.tag){case 13:var M=h.stateNode,A=h.memoizedState;A!==null&&(b=A.retryLane);break;case 19:M=h.stateNode;break;case 22:M=h.stateNode._retryCache;break;default:throw Error(r(314))}M!==null&&M.delete(f),l7(h,b)}function XW(h,f){return Rx(h,f)}function YW(h,f,b,M){this.tag=h,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=M,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function J_(h){return h=h.prototype,!(!h||!h.isReactComponent)}function Ec(h,f){var b=h.alternate;return b===null?(b=t(h.tag,f,h.key,h.mode),b.elementType=h.elementType,b.type=h.type,b.stateNode=h.stateNode,b.alternate=h,h.alternate=b):(b.pendingProps=f,b.type=h.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=h.flags&31457280,b.childLanes=h.childLanes,b.lanes=h.lanes,b.child=h.child,b.memoizedProps=h.memoizedProps,b.memoizedState=h.memoizedState,b.updateQueue=h.updateQueue,f=h.dependencies,b.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},b.sibling=h.sibling,b.index=h.index,b.ref=h.ref,b.refCleanup=h.refCleanup,b}function c7(h,f){h.flags&=31457282;var b=h.alternate;return b===null?(h.childLanes=0,h.lanes=f,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=b.childLanes,h.lanes=b.lanes,h.child=b.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=b.memoizedProps,h.memoizedState=b.memoizedState,h.updateQueue=b.updateQueue,h.type=b.type,f=b.dependencies,h.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),h}function wx(h,f,b,M,A,N){var q=0;if(M=h,typeof h=="function")J_(h)&&(q=1);else if(typeof h=="string")q=xa&&Dr?O7(h,b,vr.current)?26:G7(h)?27:5:xa?O7(h,b,vr.current)?26:5:Dr&&G7(h)?27:5;else e:switch(h){case Id:return Gu(b.children,A,N,f);case g7:q=8,A|=24;break;case r3:return h=t(12,b,f,A|2),h.elementType=r3,h.lanes=N,h;case a3:return h=t(13,b,f,A),h.elementType=a3,h.lanes=N,h;case o3:return h=t(19,b,f,A),h.elementType=o3,h.lanes=N,h;case y7:return u7(b,A,N,f);default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case QW:case Rc:q=10;break e;case x7:q=9;break e;case s3:q=11;break e;case l3:q=14;break e;case Pc:q=16,M=null;break e}q=29,b=Error(r(130,h===null?"null":typeof h,"")),M=null}return f=t(q,b,f,A),f.elementType=h,f.type=M,f.lanes=N,f}function Gu(h,f,b,M){return h=t(7,h,M,f),h.lanes=b,h}function u7(h,f,b,M){h=t(22,h,M,f),h.elementType=y7,h.lanes=b;var A={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var N=A._current;if(N===null)throw Error(r(456));if((A._pendingVisibility&2)===0){var q=Ie(N,2);q!==null&&(A._pendingVisibility|=2,qr(q,N,2))}},attach:function(){var N=A._current;if(N===null)throw Error(r(456));if((A._pendingVisibility&2)!==0){var q=Ie(N,2);q!==null&&(A._pendingVisibility&=-3,qr(q,N,2))}}};return h.stateNode=A,h}function e3(h,f,b){return h=t(6,h,null,f),h.lanes=b,h}function t3(h,f,b){return f=t(4,h.children!==null?h.children:[],h.key,f),f.lanes=b,f.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},f}function $W(h,f,b,M,A,N,q,re){this.tag=1,this.containerInfo=h,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=d3,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=P(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=P(0),this.hiddenUpdates=P(null),this.identifierPrefix=M,this.onUncaughtError=A,this.onCaughtError=N,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=re,this.incompleteTransitions=new Map}function h7(h,f,b,M,A,N,q,re,he,Ae,nt,ht){return h=new $W(h,f,b,q,re,he,Ae,ht),f=1,N===!0&&(f|=24),N=t(3,null,null,f),h.current=N,N.stateNode=h,f=N_(),f.refCount++,h.pooledCache=f,f.refCount++,N.memoizedState={element:M,isDehydrated:b,cache:f},At(N),h}function d7(h){return h?(h=Ld,h):Ld}function f7(h){var f=h._reactInternals;if(f===void 0)throw typeof h.render=="function"?Error(r(188)):(h=Object.keys(h).join(","),Error(r(268,h)));return h=m(f),h=h!==null?g(h):null,h===null?null:ip(h.stateNode)}function p7(h,f,b,M,A,N){A=d7(A),M.context===null?M.context=A:M.pendingContext=A,M=Pe(f),M.payload={element:b},N=N===void 0?null:N,N!==null&&(M.callback=N),b=Xe(h,M,f),b!==null&&(qr(b,h,f),Rt(b,h,f))}function m7(h,f){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var b=h.retryLane;h.retryLane=b!==0&&b<f?b:f}}function n3(h,f){m7(h,f),(h=h.alternate)&&m7(h,f)}var on={},KW=hY(),Fs=wte(),i3=Object.assign,ZW=Symbol.for("react.element"),Mx=Symbol.for("react.transitional.element"),Pd=Symbol.for("react.portal"),Id=Symbol.for("react.fragment"),g7=Symbol.for("react.strict_mode"),r3=Symbol.for("react.profiler"),QW=Symbol.for("react.provider"),x7=Symbol.for("react.consumer"),Rc=Symbol.for("react.context"),s3=Symbol.for("react.forward_ref"),a3=Symbol.for("react.suspense"),o3=Symbol.for("react.suspense_list"),l3=Symbol.for("react.memo"),Pc=Symbol.for("react.lazy"),y7=Symbol.for("react.offscreen"),JW=Symbol.for("react.memo_cache_sentinel"),v7=Symbol.iterator,eq=Symbol.for("react.client.reference"),Wt=KW.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,c3,b7,u3=!1,Tx=Array.isArray,tq=e.rendererVersion,nq=e.rendererPackageName,_7=e.extraDevToolsConfig,ip=e.getPublicInstance,iq=e.getRootHostContext,rq=e.getChildHostContext,sq=e.prepareForCommit,aq=e.resetAfterCommit,oq=e.createInstance,h3=e.appendInitialChild,S7=e.finalizeInitialChildren,Ax=e.shouldSetTextContent,w7=e.createTextInstance,lq=e.scheduleTimeout,cq=e.cancelTimeout,d3=e.noTimeout,_l=e.isPrimaryRenderer;e.warnsIfNotActing;var Ir=e.supportsMutation,Ic=e.supportsPersistence,ga=e.supportsHydration,M7=e.getInstanceFromNode;e.beforeActiveInstanceBlur,e.afterActiveInstanceBlur;var uq=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var hs=e.setCurrentUpdatePriority,Wu=e.getCurrentUpdatePriority,hq=e.resolveUpdatePriority;e.resolveEventType,e.resolveEventTimeStamp;var dq=e.shouldAttemptEagerTransition,fq=e.detachDeletedInstance;e.requestPostPaintCallback;var pq=e.maySuspendCommit,T7=e.preloadInstance,mq=e.startSuspendingCommit,A7=e.suspendInstance,gq=e.waitForCommitToBeReady,Dd=e.NotPendingTransition,qu=e.HostTransitionContext,xq=e.resetFormInstance;e.bindToConsole;var yq=e.supportsMicrotasks,vq=e.scheduleMicrotask,rp=e.supportsTestSelectors,bq=e.findFiberRoot,_q=e.getBoundingRect,Sq=e.getTextContent,sp=e.isHiddenSubtree,wq=e.matchAccessibilityRole,Mq=e.setFocusIfFocusable,Tq=e.setupIntersectionObserver,Aq=e.appendChild,Cq=e.appendChildToContainer,Eq=e.commitTextUpdate,Rq=e.commitMount,Pq=e.commitUpdate,Iq=e.insertBefore,Dq=e.insertInContainerBefore,Nq=e.removeChild,Lq=e.removeChildFromContainer,C7=e.resetTextContent,kq=e.hideInstance,Oq=e.hideTextInstance,zq=e.unhideInstance,Uq=e.unhideTextInstance,Fq=e.clearContainer,Bq=e.cloneInstance,E7=e.createContainerChildSet,R7=e.appendChildToContainerChildSet,Hq=e.finalizeContainerChildren,P7=e.replaceContainerChildren,I7=e.cloneHiddenInstance,D7=e.cloneHiddenTextInstance,f3=e.isSuspenseInstancePending,p3=e.isSuspenseInstanceFallback,jq=e.getSuspenseInstanceFallbackErrorDetails,Vq=e.registerSuspenseInstanceRetry,Gq=e.canHydrateFormStateMarker,Wq=e.isFormStateMarkerMatching,N7=e.getNextHydratableSibling,L7=e.getFirstHydratableChild,qq=e.getFirstHydratableChildWithinContainer,Xq=e.getFirstHydratableChildWithinSuspenseInstance,Yq=e.canHydrateInstance,$q=e.canHydrateTextInstance,Kq=e.canHydrateSuspenseInstance,Zq=e.hydrateInstance,Qq=e.hydrateTextInstance,Jq=e.hydrateSuspenseInstance,eX=e.getNextHydratableInstanceAfterSuspenseInstance,tX=e.commitHydratedContainer,nX=e.commitHydratedSuspenseInstance,iX=e.clearSuspenseBoundary,rX=e.clearSuspenseBoundaryFromContainer,k7=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var sX=e.validateHydratableInstance,aX=e.validateHydratableTextInstance,xa=e.supportsResources,O7=e.isHostHoistableType,m3=e.getHoistableRoot,z7=e.getResource,U7=e.acquireResource,F7=e.releaseResource,oX=e.hydrateHoistable,B7=e.mountHoistable,H7=e.unmountHoistable,lX=e.createHoistableInstance,cX=e.prepareToCommitHoistables,uX=e.mayResourceSuspendCommit,j7=e.preloadResource,hX=e.suspendResource,Dr=e.supportsSingletons,V7=e.resolveSingletonInstance,dX=e.clearSingleton,fX=e.acquireSingletonInstance,pX=e.releaseSingletonInstance,G7=e.isHostSingletonType,g3=[],Nd=-1,Ld={},Bs=Math.clz32?Math.clz32:w,mX=Math.log,gX=Math.LN2,Cx=128,Ex=4194304,Rx=Fs.unstable_scheduleCallback,x3=Fs.unstable_cancelCallback,xX=Fs.unstable_shouldYield,yX=Fs.unstable_requestPaint,Ya=Fs.unstable_now,W7=Fs.unstable_ImmediatePriority,vX=Fs.unstable_UserBlockingPriority,y3=Fs.unstable_NormalPriority,bX=Fs.unstable_IdlePriority,_X=Fs.log,SX=Fs.unstable_setDisableYieldValue,ap=null,Hs=null,js=typeof Object.is=="function"?Object.is:$,q7=new WeakMap,kd=[],Od=0,Px=null,Ix=0,ya=[],va=0,Xu=null,Sl=1,wl="",vr=x(null),op=x(null),Dc=x(null),Dx=x(null),Xr=null,Nr=null,vn=!1,$a=null,_o=!1,v3=Error(r(519)),ba=[],zd=0,b3=0,Nx=null,Ud=null,_3=!1,Lx=!1,S3=!1,Fd=0,lp=null,w3=0,Bd=0,Hd=null,Nc=!1,M3=!1,wX=Object.prototype.hasOwnProperty,cp=Error(r(460)),T3=Error(r(474)),kx={then:function(){}},jd=null,Vd=null,up=0,Yu=Vi(!0),X7=Vi(!1),Gd=x(null),Ox=x(0),_a=x(null),So=null,Gi=x(0),Lc=0,rn=null,Dn=null,Di=null,zx=!1,Wd=!1,$u=!1,Ux=0,hp=0,qd=null,MX=0,A3=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}},wo={readContext:Pr,use:xe,useCallback:ti,useContext:ti,useEffect:ti,useImperativeHandle:ti,useLayoutEffect:ti,useInsertionEffect:ti,useMemo:ti,useReducer:ti,useRef:ti,useState:ti,useDebugValue:ti,useDeferredValue:ti,useTransition:ti,useSyncExternalStore:ti,useId:ti};wo.useCacheRefresh=ti,wo.useMemoCache=ti,wo.useHostTransitionStatus=ti,wo.useFormState=ti,wo.useActionState=ti,wo.useOptimistic=ti;var Ku={readContext:Pr,use:xe,useCallback:function(h,f){return Er().memoizedState=[h,f===void 0?null:f],h},useContext:Pr,useEffect:qC,useImperativeHandle:function(h,f,b){b=b!=null?b.concat([h]):null,ma(4194308,4,$C.bind(null,f,h),b)},useLayoutEffect:function(h,f){return ma(4194308,4,h,f)},useInsertionEffect:function(h,f){ma(4,2,h,f)},useMemo:function(h,f){var b=Er();f=f===void 0?null:f;var M=h();if($u){X(!0);try{h()}finally{X(!1)}}return b.memoizedState=[M,f],M},useReducer:function(h,f,b){var M=Er();if(b!==void 0){var A=b(f);if($u){X(!0);try{b(f)}finally{X(!1)}}}else A=f;return M.memoizedState=M.baseState=A,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:A},M.queue=h,h=h.dispatch=DW.bind(null,rn,h),[M.memoizedState,h]},useRef:function(h){var f=Er();return h={current:h},f.memoizedState=h},useState:function(h){h=Vn(h);var f=h.queue,b=r8.bind(null,rn,f);return f.dispatch=b,[h.memoizedState,b]},useDebugValue:x_,useDeferredValue:function(h,f){var b=Er();return y_(b,h,f)},useTransition:function(){var h=Vn(!1);return h=e8.bind(null,rn,h.queue,!0,!1),Er().memoizedState=h,[!1,h]},useSyncExternalStore:function(h,f,b){var M=rn,A=Er();if(vn){if(b===void 0)throw Error(r(407));b=b()}else{if(b=f(),qn===null)throw Error(r(349));(mn&60)!==0||Lt(M,f,b)}A.memoizedState=b;var N={value:b,getSnapshot:f};return A.queue=N,qC(Pt.bind(null,M,N,h),[h]),M.flags|=2048,Ci(9,Ut.bind(null,M,N,b,f),{destroy:void 0},null),b},useId:function(){var h=Er(),f=qn.identifierPrefix;if(vn){var b=wl,M=Sl;b=(M&~(1<<32-Bs(M)-1)).toString(32)+b,f=":"+f+"R"+b,b=Ux++,0<b&&(f+="H"+b.toString(32)),f+=":"}else b=MX++,f=":"+f+"r"+b.toString(32)+":";return h.memoizedState=f},useCacheRefresh:function(){return Er().memoizedState=IW.bind(null,rn)}};Ku.useMemoCache=be,Ku.useHostTransitionStatus=v_,Ku.useFormState=wc,Ku.useActionState=wc,Ku.useOptimistic=function(h){var f=Er();f.memoizedState=f.baseState=h;var b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return f.queue=b,f=b_.bind(null,rn,!0,b),b.dispatch=f,[h,f]};var kc={readContext:Pr,use:xe,useCallback:ZC,useContext:Pr,useEffect:g_,useImperativeHandle:KC,useInsertionEffect:XC,useLayoutEffect:YC,useMemo:QC,useReducer:tt,useRef:Td,useState:function(){return tt(le)},useDebugValue:x_,useDeferredValue:function(h,f){var b=G();return JC(b,Dn.memoizedState,h,f)},useTransition:function(){var h=tt(le)[0],f=G().memoizedState;return[typeof h=="boolean"?h:oe(h),f]},useSyncExternalStore:yt,useId:n8};kc.useCacheRefresh=i8,kc.useMemoCache=be,kc.useHostTransitionStatus=v_,kc.useFormState=Wn,kc.useActionState=Wn,kc.useOptimistic=function(h,f){var b=G();return $n(b,Dn,h,f)};var Zu={readContext:Pr,use:xe,useCallback:ZC,useContext:Pr,useEffect:g_,useImperativeHandle:KC,useInsertionEffect:XC,useLayoutEffect:YC,useMemo:QC,useReducer:St,useRef:Td,useState:function(){return St(le)},useDebugValue:x_,useDeferredValue:function(h,f){var b=G();return Dn===null?y_(b,h,f):JC(b,Dn.memoizedState,h,f)},useTransition:function(){var h=St(le)[0],f=G().memoizedState;return[typeof h=="boolean"?h:oe(h),f]},useSyncExternalStore:yt,useId:n8};Zu.useCacheRefresh=i8,Zu.useMemoCache=be,Zu.useHostTransitionStatus=v_,Zu.useFormState=Qi,Zu.useActionState=Qi,Zu.useOptimistic=function(h,f){var b=G();return Dn!==null?$n(b,Dn,h,f):(b.baseState=h,[h,b.queue.dispatch])};var C3={isMounted:function(h){return(h=h._reactInternals)?d(h)===h:!1},enqueueSetState:function(h,f,b){h=h._reactInternals;var M=Us(),A=Pe(M);A.payload=f,b!=null&&(A.callback=b),f=Xe(h,A,M),f!==null&&(qr(f,h,M),Rt(f,h,M))},enqueueReplaceState:function(h,f,b){h=h._reactInternals;var M=Us(),A=Pe(M);A.tag=1,A.payload=f,b!=null&&(A.callback=b),f=Xe(h,A,M),f!==null&&(qr(f,h,M),Rt(f,h,M))},enqueueForceUpdate:function(h,f){h=h._reactInternals;var b=Us(),M=Pe(b);M.tag=2,f!=null&&(M.callback=f),f=Xe(h,M,b),f!==null&&(qr(f,h,b),Rt(f,h,b))}},Y7=typeof reportError=="function"?reportError:function(h){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var f=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof h=="object"&&h!==null&&typeof h.message=="string"?String(h.message):String(h),error:h});if(!window.dispatchEvent(f))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",h);return}console.error(h)},$7=Error(r(461)),Ji=!1,E3={dehydrated:null,treeContext:null,retryLane:0},Fx=x(null),Qu=null,Ml=null,TX=typeof AbortController<"u"?AbortController:function(){var h=[],f=this.signal={aborted:!1,addEventListener:function(b,M){h.push(M)}};this.abort=function(){f.aborted=!0,h.forEach(function(b){return b()})}},AX=Fs.unstable_scheduleCallback,CX=Fs.unstable_NormalPriority,xi={$$typeof:Rc,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},K7=Wt.S;Wt.S=function(h,f){typeof f=="object"&&f!==null&&typeof f.then=="function"&&_e(h,f),K7!==null&&K7(h,f)};var Ju=x(null),Tl=!1,yi=!1,R3=!1,Z7=typeof WeakSet=="function"?WeakSet:Set,er=null,Q7=!1,Ni=null,Vs=!1,Ka=null,Xd=8192,EX={getCacheForType:function(h){var f=Pr(xi),b=f.data.get(h);return b===void 0&&(b=h(),f.data.set(h,b)),b}},Bx=0,Hx=1,jx=2,Vx=3,Gx=4;if(typeof Symbol=="function"&&Symbol.for){var dp=Symbol.for;Bx=dp("selector.component"),Hx=dp("selector.has_pseudo_class"),jx=dp("selector.role"),Vx=dp("selector.test_id"),Gx=dp("selector.text")}var RX=typeof WeakMap=="function"?WeakMap:Map,Nn=0,qn=null,ln=null,mn=0,Xn=0,Gs=null,Al=!1,Yd=!1,P3=!1,Cl=0,vi=0,Oc=0,eh=0,I3=0,Sa=0,$d=0,fp=null,Mo=null,D3=!1,N3=0,pp=1/0,Wx=null,zc=null,qx=!1,th=null,mp=0,L3=0,k3=null,gp=0,O3=null;return on.attemptContinuousHydration=function(h){if(h.tag===13){var f=Ie(h,67108864);f!==null&&qr(f,h,67108864),n3(h,67108864)}},on.attemptHydrationAtCurrentPriority=function(h){if(h.tag===13){var f=Us(),b=Ie(h,f);b!==null&&qr(b,h,f),n3(h,f)}},on.attemptSynchronousHydration=function(h){switch(h.tag){case 3:if(h=h.stateNode,h.current.memoizedState.isDehydrated){var f=T(h.pendingLanes);if(f!==0){for(h.pendingLanes|=2,h.entangledLanes|=2;f;){var b=1<<31-Bs(f);h.entanglements[1]|=b,f&=~b}ot(h),(Nn&6)===0&&(pp=Ya()+500,it(0))}}break;case 13:f=Ie(h,2),f!==null&&qr(f,h,2),Z8(),n3(h,2)}},on.batchedUpdates=function(h,f){return h(f)},on.createComponentSelector=function(h){return{$$typeof:Bx,value:h}},on.createContainer=function(h,f,b,M,A,N,q,re,he,Ae){return h7(h,f,!1,null,b,M,N,q,re,he,Ae,null)},on.createHasPseudoClassSelector=function(h){return{$$typeof:Hx,value:h}},on.createHydrationContainer=function(h,f,b,M,A,N,q,re,he,Ae,nt,ht,mt){return h=h7(b,M,!0,h,A,N,re,he,Ae,nt,ht,mt),h.context=d7(null),b=h.current,M=Us(),A=Pe(M),A.callback=f??null,Xe(b,A,M),h.current.lanes=M,L(h,M),ot(h),h},on.createPortal=function(h,f,b){var M=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Pd,key:M==null?null:""+M,children:h,containerInfo:f,implementation:b}},on.createRoleSelector=function(h){return{$$typeof:jx,value:h}},on.createTestNameSelector=function(h){return{$$typeof:Vx,value:h}},on.createTextSelector=function(h){return{$$typeof:Gx,value:h}},on.defaultOnCaughtError=function(h){console.error(h)},on.defaultOnRecoverableError=function(h){Y7(h)},on.defaultOnUncaughtError=function(h){Y7(h)},on.deferredUpdates=function(h){var f=Wt.T,b=Wu();try{return hs(32),Wt.T=null,h()}finally{hs(b),Wt.T=f}},on.discreteUpdates=function(h,f,b,M,A){var N=Wt.T,q=Wu();try{return hs(2),Wt.T=null,h(f,b,M,A)}finally{hs(q),Wt.T=N,Nn===0&&(pp=Ya()+500)}},on.findAllNodes=X_,on.findBoundingRects=function(h,f){if(!rp)throw Error(r(363));f=X_(h,f),h=[];for(var b=0;b<f.length;b++)h.push(_q(f[b]));for(f=h.length-1;0<f;f--){b=h[f];for(var M=b.x,A=M+b.width,N=b.y,q=N+b.height,re=f-1;0<=re;re--)if(f!==re){var he=h[re],Ae=he.x,nt=Ae+he.width,ht=he.y,mt=ht+he.height;if(M>=Ae&&N>=ht&&A<=nt&&q<=mt){h.splice(f,1);break}else if(M!==Ae||b.width!==he.width||mt<N||ht>q){if(!(N!==ht||b.height!==he.height||nt<M||Ae>A)){Ae>M&&(he.width+=Ae-M,he.x=M),nt<A&&(he.width=A-Ae),h.splice(f,1);break}}else{ht>N&&(he.height+=ht-N,he.y=N),mt<q&&(he.height=q-ht),h.splice(f,1);break}}}return h},on.findHostInstance=f7,on.findHostInstanceWithNoPortals=function(h){return h=m(h),h=h!==null?y(h):null,h===null?null:ip(h.stateNode)},on.findHostInstanceWithWarning=function(h){return f7(h)},on.flushPassiveEffects=Vu,on.flushSyncFromReconciler=function(h){var f=Nn;Nn|=1;var b=Wt.T,M=Wu();try{if(hs(2),Wt.T=null,h)return h()}finally{hs(M),Wt.T=b,Nn=f,(Nn&6)===0&&it(0)}},on.flushSyncWork=Z8,on.focusWithin=function(h,f){if(!rp)throw Error(r(363));for(h=G_(h),f=X8(h,f),f=Array.from(f),h=0;h<f.length;){var b=f[h++],M=b.tag;if(!sp(b)){if((M===5||M===26||M===27)&&Mq(b.stateNode))return!0;for(b=b.child;b!==null;)f.push(b),b=b.sibling}}return!1},on.getFindAllNodesFailureDescription=function(h,f){if(!rp)throw Error(r(363));var b=0,M=[];h=[G_(h),0];for(var A=0;A<h.length;){var N=h[A++],q=N.tag,re=h[A++],he=f[re];if((q!==5&&q!==26&&q!==27||!sp(N))&&(W_(N,he)&&(M.push(q_(he)),re++,re>b&&(b=re)),re<f.length))for(N=N.child;N!==null;)h.push(N,re),N=N.sibling}if(b<f.length){for(h=[];b<f.length;b++)h.push(q_(f[b]));return`findAllNodes was able to match part of the selector:
  `+(M.join(" > ")+`

No matching component was found for:
  `)+h.join(" > ")}return null},on.getPublicRootInstance=function(h){if(h=h.current,!h.child)return null;switch(h.child.tag){case 27:case 5:return ip(h.child.stateNode);default:return h.child.stateNode}},on.injectIntoDevTools=function(){var h={bundleType:0,version:tq,rendererPackageName:nq,currentDispatcherRef:Wt,findFiberByHostInstance:M7,reconcilerVersion:"19.0.0"};if(_7!==null&&(h.rendererConfig=_7),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")h=!1;else{var f=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(f.isDisabled||!f.supportsFiber)h=!0;else{try{ap=f.inject(h),Hs=f}catch{}h=!!f.checkDCE}}return h},on.isAlreadyRendering=function(){return!1},on.observeVisibleRects=function(h,f,b,M){if(!rp)throw Error(r(363));h=X_(h,f);var A=Tq(h,b,M).disconnect;return{disconnect:function(){A()}}},on.shouldError=function(){return null},on.shouldSuspend=function(){return!1},on.startHostTransition=function(h,f,b,M){if(h.tag!==5)throw Error(r(476));var A=t8(h).queue;e8(h,A,f,Dd,b===null?n:function(){var N=t8(h).next.queue;return $0(h,N,{},Us()),b(M)})},on.updateContainer=function(h,f,b,M){var A=f.current,N=Us();return p7(A,N,h,f,b,M),N},on.updateContainerSync=function(h,f,b,M){return f.tag===0&&Vu(),p7(f.current,2,h,f,b,M),2},on},i.exports.default=i.exports,Object.defineProperty(i.exports,"__esModule",{value:!0})})(pS)),pS.exports}var TR;function Tte(){return TR||(TR=1,fS.exports=Mte()),fS.exports}var Ate=Tte();const NU=od(Ate),Cte=NU;function Ete(i,e,t,n){throw new Error("Text instances are not yet supported. Please use a `<text>` component.")}function Rte(){}function Pte(){return!1}const LU={};function Ite(i){return i??LU}function Dte(){return pu.currentUpdatePriority}function Nte(){return null}function Lte(i){throw new Error("Not yet implemented.")}function kte(i){return i}function Ote(){return LU}function zte(i){i instanceof Fi?i.visible=!1:i instanceof hd&&(i.enabled=!1)}function Ute(i){throw new Error("Text instances are not yet supported. Please use a `<text>` component.")}function kU(i){if(i instanceof hd){const e=i.__pixireact.parent;if(e){const t=e.__pixireact.filters.indexOf(i);e.__pixireact.filters.splice(t,1),e.filters=e.__pixireact.filters}i.__pixireact.parent=null}}function AT(i,e,...t){}function AR(i,e,t){if(AT(),e instanceof Fi){const n=e,r=e,s=t;n.parent===i&&i.removeChild(r);const a=i.getChildIndex(s);i.addChildAt(r,a)}else if(e instanceof hd){const s=e.__pixireact.filters.indexOf(t);kU(e),CU(i,e,s)}}function Fte(){return!1}function Bte(){return!0}function Hte(){return null}function jte(){}function Vte(){}function CR(i,e){e instanceof hd&&kU(e),e.destroy()}function Gte(i){}function Wte(){}function qte(){}function Xte(){return-1.1}function Yte(){return null}function $te(){if(pu.currentUpdatePriority)return pu.currentUpdatePriority;const i=typeof self<"u"&&self||typeof window<"u"&&window;if(!i)return Fo.DefaultEventPriority;switch(i.event?.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Fo.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Fo.ContinuousEventPriority;default:return Fo.DefaultEventPriority}}function Kte(i){pu.currentUpdatePriority=i}function Zte(){return!1}function Qte(){return!1}function Jte(){}function ene(){}function tne(){}function nne(i){i instanceof Fi?i.visible=!0:i instanceof hd&&(i.enabled=!0)}function ine(i){throw new Error("Text instances are not yet supported. Please use a `<text>` component.")}function rne(){return null}const sne={isPrimaryRenderer:!1,noTimeout:-1,NotPendingTransition:null,supportsHydration:!1,supportsMutation:!0,supportsPersistence:!1,warnsIfNotActing:!1,afterActiveInstanceBlur:ite,appendChild:dS,appendChildToContainer:dS,appendInitialChild:dS,beforeActiveInstanceBlur:rte,cancelTimeout:clearTimeout,clearContainer:ste,commitUpdate:gte,createInstance:_te,createTextInstance:Ete,hideTextInstance:Ute,unhideTextInstance:ine,detachDeletedInstance:Rte,finalizeInitialChildren:Pte,getChildHostContext:Ite,getCurrentUpdatePriority:Dte,getInstanceFromNode:Nte,getInstanceFromScope:Lte,getPublicInstance:kte,getRootHostContext:Ote,hideInstance:zte,insertBefore:AR,insertInContainerBefore:AR,maySuspendCommit:Fte,preloadInstance:Bte,prepareForCommit:Hte,preparePortalMount:jte,prepareScopeUpdate:Vte,removeChild:CR,removeChildFromContainer:CR,requestPostPaintCallback:Gte,resetAfterCommit:Wte,resetFormInstance:qte,resolveEventTimeStamp:Xte,resolveEventType:Yte,resolveUpdatePriority:$te,scheduleTimeout:setTimeout,shouldAttemptEagerTransition:Zte,setCurrentUpdatePriority:Kte,shouldSetTextContent:Qte,startSuspendingCommit:Jte,suspendInstance:ene,trackSchedulerEvent:tne,unhideInstance:nne,waitForCommitToBeReady:rne},ev=Cte(sne);ev.injectIntoDevTools({bundleType:0,rendererPackageName:"@pixi/react",version:nte.version});const e0=new Map;function ane(i,e={}){let t=e0.get(i),n=t?.applicationState??{isInitialised:!1,isInitialising:!1};const r=t?.internalState??{};t||(n.app=new yT,r.rootContainer=AU(n.app.stage));const s=t?.fiber??ev.createContainer(r.rootContainer,Fo.ConcurrentRoot,null,!1,null,"",console.error,console.error,console.error,null);if(!t){let a;i instanceof HTMLCanvasElement&&(a=i),a||(a=document.createElement("canvas"),i.innerHTML="",i.appendChild(a)),r.canvas=a,t={applicationState:n,fiber:s,internalState:r,render:async(l,c)=>(!n.app.renderer&&!n.isInitialised&&!n.isInitialising&&(n.isInitialising=!0,await n.app.init({...c,canvas:a}),n.isInitialising=!1,n.isInitialised=!0,n={...n},e.onInit?.(n.app)),Object.entries(c).forEach(([u,d])=>{const p=u;TU(c,p)||(n.app[p]=d)}),ev.updateContainer(v.jsx(ete,{value:n,children:l}),s,null,()=>{}),n.app)},e0.set(a,t)}return t}function OU(i){pu.unmountQueue.delete(i);const e=i.fiber;e&&ev.updateContainer(null,e,null,()=>{i.applicationState.app&&i.applicationState.app.destroy(),e0.delete(i.internalState.canvas)})}function one(){for(const i of pu.unmountQueue)OU(i)}function lne(i){const e=e0.get(i);e&&(e.applicationState.isInitialised?OU(e):pu.unmountQueue.add(e))}function cne(i){const e=e0.get(i);e&&pu.unmountQueue.delete(e)}const Kp=typeof window<"u"&&(window.document?.createElement||window.navigator?.product==="ReactNative")?z.useLayoutEffect:z.useEffect,une={...Fm.defaultTextStyle},hne=z.forwardRef(function(e,t){const{children:n,className:r,defaultTextStyle:s,extensions:a,onInit:o,resizeTo:l,...c}=e,u=iz(),d=z.useRef(null),p=z.useRef(null),m=z.useRef(new Set);z.useImperativeHandle(t,()=>({getApplication(){return d.current},getCanvas(){return p.current}}));const g=z.useCallback(()=>{const x=d.current;x&&(l?"current"in l?l.current instanceof HTMLElement&&(x.resizeTo=l.current):x.resizeTo=l:x.resizeTo=void 0)},[l]),y=z.useCallback(x=>{one(),d.current=x,g(),o?.(x)},[o]);return Kp(()=>{if(a){const x=[...a],_=m.current;for(const S of _.values()){const w=x.indexOf(S);w===-1&&(Es.remove(S),_.delete(S)),x.splice(w,1)}for(const S of x)Es.add(S),_.add(S)}},[a]),Kp(()=>{const x=p.current;if(x){let _=e0.get(x);_||(_=ane(x,{onInit:y})),_.render(v.jsx(u,{children:n}),c)}},[c,n,y,l]),Kp(()=>{g()},[l]),Kp(()=>{s?Object.assign(Fm.defaultTextStyle,s):Object.assign(Fm.defaultTextStyle,une)},[s]),z.useEffect(()=>{const x=p.current;if(x)return cne(x),()=>{lne(x)}},[]),v.jsx("canvas",{ref:p,className:r})}),zU=z.forwardRef(function(e,t){return v.jsx(dT,{children:v.jsx(hne,{ref:t,...e})})});function cl(i){Object.assign(e5,i)}function D0(){const i=z.useContext(TT);return AT(i.app instanceof yT,"No Context found with `%s`. Make sure to wrap component with `%s`","Application","AppProvider"),i}function Zb(i){const{app:e,isInitialised:t}=D0();let n,r,s=!0,a;typeof i=="function"?n=i:(n=i.callback,r=i.context,s=i.isEnabled??!0,a=i.priority),AT(),Kp(()=>{if(t){const o=e?.ticker,l=s,c=r,u=n;return s&&o&&o.add(n,r,a),()=>{l&&o?.remove(u,c)}}},[e?.ticker,n,r,s,t,a])}class dne extends Jo{renderFrame(e,t){const{centerX:n,centerY:r,initialRadius:s}=t,a=s*e.scale;this.clear(),this.circle(n,r,a).stroke({color:0,width:1})}}cl({GlobeBackgroundGraphics:dne});function fne({layerRef:i}){const e=Hn(r=>r.globeBackground),t=z.useRef(null);z.useEffect(()=>{const r=i.current,s=t.current;if(!(!r||!s))return r.attach(s),s.zIndex=0,()=>{r.detach(s)}},[i]);const n=z.useRef(Hn.getState().view);return z.useEffect(()=>Hn.subscribe(r=>{n.current=r.view}),[]),Zb(()=>{t.current&&t.current.renderFrame(n.current,e)}),v.jsx("pixiGlobeBackgroundGraphics",{ref:t})}const ER=2;class pne extends Jo{currentRAStep=-1;currentDecStep=-1;gridLines=[];getRAStep(e){return e<1.5?45:e<4?30:e<10?20:e<50?10:e<150?2:1}getDecStep(e){return e<1.5?30:e<4?15:e<10?10:e<50?5:e<150?1:.5}regenerateGridLines(e,t){this.gridLines=[];for(let n=0;n<360;n+=e){const r=[];for(let s=-90;s<=90;s+=ER)r.push({ra:n,dec:s});this.gridLines.push(r)}for(let n=-90;n<=90;n+=t){if(Math.abs(n)===90)continue;const r=[];for(let s=0;s<360;s+=ER)r.push({ra:s,dec:n});this.gridLines.push(r)}this.currentRAStep=e,this.currentDecStep=t}renderFrame(e,t){const{centerX:n,centerY:r,initialRadius:s}=t,a=this.getRAStep(e.scale),o=this.getDecStep(e.scale);(a!==this.currentRAStep||o!==this.currentDecStep)&&this.regenerateGridLines(a,o),this.clear();for(const l of this.gridLines){let c=!1;for(let u=0;u<l.length;u++){const d=l[u],p=ML(d.ra,d.dec,e.yawDeg,e.pitchDeg);if(!p.visible){c=!1;continue}const m=TL(p,n,r,e.scale,s);c?this.lineTo(m.x,m.y):(this.moveTo(m.x,m.y),c=!0)}}this.stroke({color:2236962,width:1,alpha:.5})}}cl({GraticuleGraphics:pne});function mne({layerRef:i}){const e=Hn(r=>r.globeBackground),t=z.useRef(null);z.useEffect(()=>{const r=i.current,s=t.current;if(!(!r||!s))return r.attach(s),s.zIndex=1,()=>{r.detach(s)}},[i]);const n=z.useRef(Hn.getState().view);return z.useEffect(()=>Hn.subscribe(r=>{n.current=r.view}),[]),Zb(()=>{t.current&&t.current.renderFrame(n.current,e)}),v.jsx("pixiGraticuleGraphics",{ref:t})}const RR=i=>Symbol.iterator in i,PR=i=>"entries"in i,IR=(i,e)=>{const t=i instanceof Map?i:new Map(i.entries()),n=e instanceof Map?e:new Map(e.entries());if(t.size!==n.size)return!1;for(const[r,s]of t)if(!n.has(r)||!Object.is(s,n.get(r)))return!1;return!0},gne=(i,e)=>{const t=i[Symbol.iterator](),n=e[Symbol.iterator]();let r=t.next(),s=n.next();for(;!r.done&&!s.done;){if(!Object.is(r.value,s.value))return!1;r=t.next(),s=n.next()}return!!r.done&&!!s.done};function xne(i,e){return Object.is(i,e)?!0:typeof i!="object"||i===null||typeof e!="object"||e===null||Object.getPrototypeOf(i)!==Object.getPrototypeOf(e)?!1:RR(i)&&RR(e)?PR(i)&&PR(e)?IR(i,e):gne(i,e):IR({entries:()=>Object.entries(i)},{entries:()=>Object.entries(e)})}function Tt(i){const e=sm.useRef(void 0);return t=>{const n=i(t);return xne(e.current,n)?e.current:e.current=n}}function Fl(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function UU(i,e){i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.__proto__=e}var na={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},t0={duration:.5,overwrite:!1,delay:0},CT,Tr,ii,Pa=1e8,Bn=1/Pa,t5=Math.PI*2,yne=t5/4,vne=0,FU=Math.sqrt,bne=Math.cos,_ne=Math.sin,dr=function(e){return typeof e=="string"},Ti=function(e){return typeof e=="function"},cc=function(e){return typeof e=="number"},ET=function(e){return typeof e>"u"},el=function(e){return typeof e=="object"},Ms=function(e){return e!==!1},RT=function(){return typeof window<"u"},l1=function(e){return Ti(e)||dr(e)},BU=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},jr=Array.isArray,n5=/(?:-?\.?\d|\.)+/gi,HU=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Df=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,xS=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,jU=/[+-]=-?[.\d]+/,VU=/[^,'"\[\]\s]+/gi,Sne=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,ui,No,i5,PT,aa={},tv={},GU,WU=function(e){return(tv=n0(e,aa))&&Rs},IT=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},Bm=function(e,t){return!t&&console.warn(e)},qU=function(e,t){return e&&(aa[e]=t)&&tv&&(tv[e]=t)||aa},Hm=function(){return 0},wne={suppressEvents:!0,isStart:!0,kill:!1},Py={suppressEvents:!0,kill:!1},Mne={suppressEvents:!0},DT={},lu=[],r5={},XU,$s={},yS={},DR=30,Iy=[],NT="",LT=function(e){var t=e[0],n,r;if(el(t)||Ti(t)||(e=[e]),!(n=(t._gsap||{}).harness)){for(r=Iy.length;r--&&!Iy[r].targetTest(t););n=Iy[r]}for(r=e.length;r--;)e[r]&&(e[r]._gsap||(e[r]._gsap=new xF(e[r],n)))||e.splice(r,1);return e},Bh=function(e){return e._gsap||LT(Ia(e))[0]._gsap},YU=function(e,t,n){return(n=e[t])&&Ti(n)?e[t]():ET(n)&&e.getAttribute&&e.getAttribute(t)||n},Ts=function(e,t){return(e=e.split(",")).forEach(t)||e},Ri=function(e){return Math.round(e*1e5)/1e5||0},zi=function(e){return Math.round(e*1e7)/1e7||0},Hf=function(e,t){var n=t.charAt(0),r=parseFloat(t.substr(2));return e=parseFloat(e),n==="+"?e+r:n==="-"?e-r:n==="*"?e*r:e/r},Tne=function(e,t){for(var n=t.length,r=0;e.indexOf(t[r])<0&&++r<n;);return r<n},nv=function(){var e=lu.length,t=lu.slice(0),n,r;for(r5={},lu.length=0,n=0;n<e;n++)r=t[n],r&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},kT=function(e){return!!(e._initted||e._startAt||e.add)},$U=function(e,t,n,r){lu.length&&!Tr&&nv(),e.render(t,n,!!(Tr&&t<0&&kT(e))),lu.length&&!Tr&&nv()},KU=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(VU).length<2?t:dr(e)?e.trim():e},ZU=function(e){return e},oa=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},Ane=function(e){return function(t,n){for(var r in n)r in t||r==="duration"&&e||r==="ease"||(t[r]=n[r])}},n0=function(e,t){for(var n in t)e[n]=t[n];return e},NR=function i(e,t){for(var n in t)n!=="__proto__"&&n!=="constructor"&&n!=="prototype"&&(e[n]=el(t[n])?i(e[n]||(e[n]={}),t[n]):t[n]);return e},iv=function(e,t){var n={},r;for(r in e)r in t||(n[r]=e[r]);return n},um=function(e){var t=e.parent||ui,n=e.keyframes?Ane(jr(e.keyframes)):oa;if(Ms(e.inherit))for(;t;)n(e,t.vars.defaults),t=t.parent||t._dp;return e},Cne=function(e,t){for(var n=e.length,r=n===t.length;r&&n--&&e[n]===t[n];);return n<0},QU=function(e,t,n,r,s){var a=e[r],o;if(s)for(o=t[s];a&&a[s]>o;)a=a._prev;return a?(t._next=a._next,a._next=t):(t._next=e[n],e[n]=t),t._next?t._next._prev=t:e[r]=t,t._prev=a,t.parent=t._dp=e,t},Qb=function(e,t,n,r){n===void 0&&(n="_first"),r===void 0&&(r="_last");var s=t._prev,a=t._next;s?s._next=a:e[n]===t&&(e[n]=a),a?a._prev=s:e[r]===t&&(e[r]=s),t._next=t._prev=t.parent=null},mu=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},Hh=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var n=e;n;)n._dirty=1,n=n.parent;return e},Ene=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},s5=function(e,t,n,r){return e._startAt&&(Tr?e._startAt.revert(Py):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,r))},Rne=function i(e){return!e||e._ts&&i(e.parent)},LR=function(e){return e._repeat?i0(e._tTime,e=e.duration()+e._rDelay)*e:0},i0=function(e,t){var n=Math.floor(e=zi(e/t));return e&&n===e?n-1:n},rv=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},Jb=function(e){return e._end=zi(e._start+(e._tDur/Math.abs(e._ts||e._rts||Bn)||0))},e2=function(e,t){var n=e._dp;return n&&n.smoothChildTiming&&e._ts&&(e._start=zi(n._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),Jb(e),n._dirty||Hh(n,e)),e},JU=function(e,t){var n;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(n=rv(e.rawTime(),t),(!t._dur||jg(0,t.totalDuration(),n)-t._tTime>Bn)&&t.render(n,!0)),Hh(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(n=e;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;e._zTime=-Bn}},zo=function(e,t,n,r){return t.parent&&mu(t),t._start=zi((cc(n)?n:n||e!==ui?Ta(e,n,t):e._time)+t._delay),t._end=zi(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),QU(e,t,"_first","_last",e._sort?"_start":0),a5(t)||(e._recent=t),r||JU(e,t),e._ts<0&&e2(e,e._tTime),e},eF=function(e,t){return(aa.ScrollTrigger||IT("scrollTrigger",t))&&aa.ScrollTrigger.create(t,e)},tF=function(e,t,n,r,s){if(zT(e,t,s),!e._initted)return 1;if(!n&&e._pt&&!Tr&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&XU!==Ks.frame)return lu.push(e),e._lazy=[s,r],1},Pne=function i(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||i(t))},a5=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},Ine=function(e,t,n,r){var s=e.ratio,a=t<0||!t&&(!e._start&&Pne(e)&&!(!e._initted&&a5(e))||(e._ts<0||e._dp._ts<0)&&!a5(e))?0:1,o=e._rDelay,l=0,c,u,d;if(o&&e._repeat&&(l=jg(0,e._tDur,t),u=i0(l,o),e._yoyo&&u&1&&(a=1-a),u!==i0(e._tTime,o)&&(s=1-a,e.vars.repeatRefresh&&e._initted&&e.invalidate())),a!==s||Tr||r||e._zTime===Bn||!t&&e._zTime){if(!e._initted&&tF(e,t,r,n,l))return;for(d=e._zTime,e._zTime=t||(n?Bn:0),n||(n=t&&!d),e.ratio=a,e._from&&(a=1-a),e._time=0,e._tTime=l,c=e._pt;c;)c.r(a,c.d),c=c._next;t<0&&s5(e,t,n,!0),e._onUpdate&&!n&&Qs(e,"onUpdate"),l&&e._repeat&&!n&&e.parent&&Qs(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===a&&(a&&mu(e,1),!n&&!Tr&&(Qs(e,a?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},Dne=function(e,t,n){var r;if(n>t)for(r=e._first;r&&r._start<=n;){if(r.data==="isPause"&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=n;){if(r.data==="isPause"&&r._start<t)return r;r=r._prev}},r0=function(e,t,n,r){var s=e._repeat,a=zi(t)||0,o=e._tTime/e._tDur;return o&&!r&&(e._time*=a/e._dur),e._dur=a,e._tDur=s?s<0?1e10:zi(a*(s+1)+e._rDelay*s):a,o>0&&!r&&e2(e,e._tTime=e._tDur*o),e.parent&&Jb(e),n||Hh(e.parent,e),e},kR=function(e){return e instanceof Jr?Hh(e):r0(e,e._dur)},Nne={_start:0,endTime:Hm,totalDuration:Hm},Ta=function i(e,t,n){var r=e.labels,s=e._recent||Nne,a=e.duration()>=Pa?s.endTime(!1):e._dur,o,l,c;return dr(t)&&(isNaN(t)||t in r)?(l=t.charAt(0),c=t.substr(-1)==="%",o=t.indexOf("="),l==="<"||l===">"?(o>=0&&(t=t.replace(/=/,"")),(l==="<"?s._start:s.endTime(s._repeat>=0))+(parseFloat(t.substr(1))||0)*(c?(o<0?s:n).totalDuration()/100:1)):o<0?(t in r||(r[t]=a),r[t]):(l=parseFloat(t.charAt(o-1)+t.substr(o+1)),c&&n&&(l=l/100*(jr(n)?n[0]:n).totalDuration()),o>1?i(e,t.substr(0,o-1),n)+l:a+l)):t==null?a:+t},hm=function(e,t,n){var r=cc(t[1]),s=(r?2:1)+(e<2?0:1),a=t[s],o,l;if(r&&(a.duration=t[1]),a.parent=n,e){for(o=a,l=n;l&&!("immediateRender"in o);)o=l.vars.defaults||{},l=Ms(l.vars.inherit)&&l.parent;a.immediateRender=Ms(o.immediateRender),e<2?a.runBackwards=1:a.startAt=t[s-1]}return new Oi(t[0],a,t[s+1])},Du=function(e,t){return e||e===0?t(e):t},jg=function(e,t,n){return n<e?e:n>t?t:n},zr=function(e,t){return!dr(e)||!(t=Sne.exec(e))?"":t[1]},Lne=function(e,t,n){return Du(n,function(r){return jg(e,t,r)})},o5=[].slice,nF=function(e,t){return e&&el(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&el(e[0]))&&!e.nodeType&&e!==No},kne=function(e,t,n){return n===void 0&&(n=[]),e.forEach(function(r){var s;return dr(r)&&!t||nF(r,1)?(s=n).push.apply(s,Ia(r)):n.push(r)})||n},Ia=function(e,t,n){return ii&&!t&&ii.selector?ii.selector(e):dr(e)&&!n&&(i5||!s0())?o5.call((t||PT).querySelectorAll(e),0):jr(e)?kne(e,n):nF(e)?o5.call(e,0):e?[e]:[]},l5=function(e){return e=Ia(e)[0]||Bm("Invalid scope")||{},function(t){var n=e.current||e.nativeElement||e;return Ia(t,n.querySelectorAll?n:n===e?Bm("Invalid scope")||PT.createElement("div"):e)}},iF=function(e){return e.sort(function(){return .5-Math.random()})},rF=function(e){if(Ti(e))return e;var t=el(e)?e:{each:e},n=jh(t.ease),r=t.from||0,s=parseFloat(t.base)||0,a={},o=r>0&&r<1,l=isNaN(r)||o,c=t.axis,u=r,d=r;return dr(r)?u=d={center:.5,edges:.5,end:1}[r]||0:!o&&l&&(u=r[0],d=r[1]),function(p,m,g){var y=(g||t).length,x=a[y],_,S,w,T,C,E,D,O,R;if(!x){if(R=t.grid==="auto"?0:(t.grid||[1,Pa])[1],!R){for(D=-Pa;D<(D=g[R++].getBoundingClientRect().left)&&R<y;);R<y&&R--}for(x=a[y]=[],_=l?Math.min(R,y)*u-.5:r%R,S=R===Pa?0:l?y*d/R-.5:r/R|0,D=0,O=Pa,E=0;E<y;E++)w=E%R-_,T=S-(E/R|0),x[E]=C=c?Math.abs(c==="y"?T:w):FU(w*w+T*T),C>D&&(D=C),C<O&&(O=C);r==="random"&&iF(x),x.max=D-O,x.min=O,x.v=y=(parseFloat(t.amount)||parseFloat(t.each)*(R>y?y-1:c?c==="y"?y/R:R:Math.max(R,y/R))||0)*(r==="edges"?-1:1),x.b=y<0?s-y:s,x.u=zr(t.amount||t.each)||0,n=n&&y<0?pF(n):n}return y=(x[p]-x.min)/x.max||0,zi(x.b+(n?n(y):y)*x.v)+x.u}},c5=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(n){var r=zi(Math.round(parseFloat(n)/e)*e*t);return(r-r%1)/t+(cc(n)?0:zr(n))}},sF=function(e,t){var n=jr(e),r,s;return!n&&el(e)&&(r=n=e.radius||Pa,e.values?(e=Ia(e.values),(s=!cc(e[0]))&&(r*=r)):e=c5(e.increment)),Du(t,n?Ti(e)?function(a){return s=e(a),Math.abs(s-a)<=r?s:a}:function(a){for(var o=parseFloat(s?a.x:a),l=parseFloat(s?a.y:0),c=Pa,u=0,d=e.length,p,m;d--;)s?(p=e[d].x-o,m=e[d].y-l,p=p*p+m*m):p=Math.abs(e[d]-o),p<c&&(c=p,u=d);return u=!r||c<=r?e[u]:a,s||u===a||cc(a)?u:u+zr(a)}:c5(e))},aF=function(e,t,n,r){return Du(jr(e)?!t:n===!0?!!(n=0):!r,function(){return jr(e)?e[~~(Math.random()*e.length)]:(n=n||1e-5)&&(r=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((e-n/2+Math.random()*(t-e+n*.99))/n)*n*r)/r})},One=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(r){return t.reduce(function(s,a){return a(s)},r)}},zne=function(e,t){return function(n){return e(parseFloat(n))+(t||zr(n))}},Une=function(e,t,n){return lF(e,t,0,1,n)},oF=function(e,t,n){return Du(n,function(r){return e[~~t(r)]})},Fne=function i(e,t,n){var r=t-e;return jr(e)?oF(e,i(0,e.length),t):Du(n,function(s){return(r+(s-e)%r)%r+e})},Bne=function i(e,t,n){var r=t-e,s=r*2;return jr(e)?oF(e,i(0,e.length-1),t):Du(n,function(a){return a=(s+(a-e)%s)%s||0,e+(a>r?s-a:a)})},jm=function(e){for(var t=0,n="",r,s,a,o;~(r=e.indexOf("random(",t));)a=e.indexOf(")",r),o=e.charAt(r+7)==="[",s=e.substr(r+7,a-r-7).match(o?VU:n5),n+=e.substr(t,r-t)+aF(o?s:+s[0],o?0:+s[1],+s[2]||1e-5),t=a+1;return n+e.substr(t,e.length-t)},lF=function(e,t,n,r,s){var a=t-e,o=r-n;return Du(s,function(l){return n+((l-e)/a*o||0)})},Hne=function i(e,t,n,r){var s=isNaN(e+t)?0:function(m){return(1-m)*e+m*t};if(!s){var a=dr(e),o={},l,c,u,d,p;if(n===!0&&(r=1)&&(n=null),a)e={p:e},t={p:t};else if(jr(e)&&!jr(t)){for(u=[],d=e.length,p=d-2,c=1;c<d;c++)u.push(i(e[c-1],e[c]));d--,s=function(g){g*=d;var y=Math.min(p,~~g);return u[y](g-y)},n=t}else r||(e=n0(jr(e)?[]:{},e));if(!u){for(l in t)OT.call(o,e,l,"get",t[l]);s=function(g){return BT(g,o)||(a?e.p:e)}}}return Du(n,s)},OR=function(e,t,n){var r=e.labels,s=Pa,a,o,l;for(a in r)o=r[a]-t,o<0==!!n&&o&&s>(o=Math.abs(o))&&(l=a,s=o);return l},Qs=function(e,t,n){var r=e.vars,s=r[t],a=ii,o=e._ctx,l,c,u;if(s)return l=r[t+"Params"],c=r.callbackScope||e,n&&lu.length&&nv(),o&&(ii=o),u=l?s.apply(c,l):s.call(c),ii=a,u},Zp=function(e){return mu(e),e.scrollTrigger&&e.scrollTrigger.kill(!!Tr),e.progress()<1&&Qs(e,"onInterrupt"),e},Nf,cF=[],uF=function(e){if(e)if(e=!e.name&&e.default||e,RT()||e.headless){var t=e.name,n=Ti(e),r=t&&!n&&e.init?function(){this._props=[]}:e,s={init:Hm,render:BT,add:OT,kill:iie,modifier:nie,rawVars:0},a={targetTest:0,get:0,getSetter:FT,aliases:{},register:0};if(s0(),e!==r){if($s[t])return;oa(r,oa(iv(e,s),a)),n0(r.prototype,n0(s,iv(e,a))),$s[r.prop=t]=r,e.targetTest&&(Iy.push(r),DT[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}qU(t,r),e.register&&e.register(Rs,r,As)}else cF.push(e)},Un=255,Qp={aqua:[0,Un,Un],lime:[0,Un,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Un],navy:[0,0,128],white:[Un,Un,Un],olive:[128,128,0],yellow:[Un,Un,0],orange:[Un,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Un,0,0],pink:[Un,192,203],cyan:[0,Un,Un],transparent:[Un,Un,Un,0]},vS=function(e,t,n){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(n-t)*e*6:e<.5?n:e*3<2?t+(n-t)*(2/3-e)*6:t)*Un+.5|0},hF=function(e,t,n){var r=e?cc(e)?[e>>16,e>>8&Un,e&Un]:0:Qp.black,s,a,o,l,c,u,d,p,m,g;if(!r){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),Qp[e])r=Qp[e];else if(e.charAt(0)==="#"){if(e.length<6&&(s=e.charAt(1),a=e.charAt(2),o=e.charAt(3),e="#"+s+s+a+a+o+o+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return r=parseInt(e.substr(1,6),16),[r>>16,r>>8&Un,r&Un,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),r=[e>>16,e>>8&Un,e&Un]}else if(e.substr(0,3)==="hsl"){if(r=g=e.match(n5),!t)l=+r[0]%360/360,c=+r[1]/100,u=+r[2]/100,a=u<=.5?u*(c+1):u+c-u*c,s=u*2-a,r.length>3&&(r[3]*=1),r[0]=vS(l+1/3,s,a),r[1]=vS(l,s,a),r[2]=vS(l-1/3,s,a);else if(~e.indexOf("="))return r=e.match(HU),n&&r.length<4&&(r[3]=1),r}else r=e.match(n5)||Qp.transparent;r=r.map(Number)}return t&&!g&&(s=r[0]/Un,a=r[1]/Un,o=r[2]/Un,d=Math.max(s,a,o),p=Math.min(s,a,o),u=(d+p)/2,d===p?l=c=0:(m=d-p,c=u>.5?m/(2-d-p):m/(d+p),l=d===s?(a-o)/m+(a<o?6:0):d===a?(o-s)/m+2:(s-a)/m+4,l*=60),r[0]=~~(l+.5),r[1]=~~(c*100+.5),r[2]=~~(u*100+.5)),n&&r.length<4&&(r[3]=1),r},dF=function(e){var t=[],n=[],r=-1;return e.split(cu).forEach(function(s){var a=s.match(Df)||[];t.push.apply(t,a),n.push(r+=a.length+1)}),t.c=n,t},zR=function(e,t,n){var r="",s=(e+r).match(cu),a=t?"hsla(":"rgba(",o=0,l,c,u,d;if(!s)return e;if(s=s.map(function(p){return(p=hF(p,t,1))&&a+(t?p[0]+","+p[1]+"%,"+p[2]+"%,"+p[3]:p.join(","))+")"}),n&&(u=dF(e),l=n.c,l.join(r)!==u.c.join(r)))for(c=e.replace(cu,"1").split(Df),d=c.length-1;o<d;o++)r+=c[o]+(~l.indexOf(o)?s.shift()||a+"0,0,0,0)":(u.length?u:s.length?s:n).shift());if(!c)for(c=e.split(cu),d=c.length-1;o<d;o++)r+=c[o]+s[o];return r+c[d]},cu=(function(){var i="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in Qp)i+="|"+e+"\\b";return new RegExp(i+")","gi")})(),jne=/hsl[a]?\(/,fF=function(e){var t=e.join(" "),n;if(cu.lastIndex=0,cu.test(t))return n=jne.test(t),e[1]=zR(e[1],n),e[0]=zR(e[0],n,dF(e[1])),!0},Vm,Ks=(function(){var i=Date.now,e=500,t=33,n=i(),r=n,s=1e3/240,a=s,o=[],l,c,u,d,p,m,g=function y(x){var _=i()-r,S=x===!0,w,T,C,E;if((_>e||_<0)&&(n+=_-t),r+=_,C=r-n,w=C-a,(w>0||S)&&(E=++d.frame,p=C-d.time*1e3,d.time=C=C/1e3,a+=w+(w>=s?4:s-w),T=1),S||(l=c(y)),T)for(m=0;m<o.length;m++)o[m](C,p,E,x)};return d={time:0,frame:0,tick:function(){g(!0)},deltaRatio:function(x){return p/(1e3/(x||60))},wake:function(){GU&&(!i5&&RT()&&(No=i5=window,PT=No.document||{},aa.gsap=Rs,(No.gsapVersions||(No.gsapVersions=[])).push(Rs.version),WU(tv||No.GreenSockGlobals||!No.gsap&&No||{}),cF.forEach(uF)),u=typeof requestAnimationFrame<"u"&&requestAnimationFrame,l&&d.sleep(),c=u||function(x){return setTimeout(x,a-d.time*1e3+1|0)},Vm=1,g(2))},sleep:function(){(u?cancelAnimationFrame:clearTimeout)(l),Vm=0,c=Hm},lagSmoothing:function(x,_){e=x||1/0,t=Math.min(_||33,e)},fps:function(x){s=1e3/(x||240),a=d.time*1e3+s},add:function(x,_,S){var w=_?function(T,C,E,D){x(T,C,E,D),d.remove(w)}:x;return d.remove(x),o[S?"unshift":"push"](w),s0(),w},remove:function(x,_){~(_=o.indexOf(x))&&o.splice(_,1)&&m>=_&&m--},_listeners:o},d})(),s0=function(){return!Vm&&Ks.wake()},pn={},Vne=/^[\d.\-M][\d.\-,\s]/,Gne=/["']/g,Wne=function(e){for(var t={},n=e.substr(1,e.length-3).split(":"),r=n[0],s=1,a=n.length,o,l,c;s<a;s++)l=n[s],o=s!==a-1?l.lastIndexOf(","):l.length,c=l.substr(0,o),t[r]=isNaN(c)?c.replace(Gne,"").trim():+c,r=l.substr(o+1).trim();return t},qne=function(e){var t=e.indexOf("(")+1,n=e.indexOf(")"),r=e.indexOf("(",t);return e.substring(t,~r&&r<n?e.indexOf(")",n+1):n)},Xne=function(e){var t=(e+"").split("("),n=pn[t[0]];return n&&t.length>1&&n.config?n.config.apply(null,~e.indexOf("{")?[Wne(t[1])]:qne(e).split(",").map(KU)):pn._CE&&Vne.test(e)?pn._CE("",e):n},pF=function(e){return function(t){return 1-e(1-t)}},mF=function i(e,t){for(var n=e._first,r;n;)n instanceof Jr?i(n,t):n.vars.yoyoEase&&(!n._yoyo||!n._repeat)&&n._yoyo!==t&&(n.timeline?i(n.timeline,t):(r=n._ease,n._ease=n._yEase,n._yEase=r,n._yoyo=t)),n=n._next},jh=function(e,t){return e&&(Ti(e)?e:pn[e]||Xne(e))||t},dd=function(e,t,n,r){n===void 0&&(n=function(l){return 1-t(1-l)}),r===void 0&&(r=function(l){return l<.5?t(l*2)/2:1-t((1-l)*2)/2});var s={easeIn:t,easeOut:n,easeInOut:r},a;return Ts(e,function(o){pn[o]=aa[o]=s,pn[a=o.toLowerCase()]=n;for(var l in s)pn[a+(l==="easeIn"?".in":l==="easeOut"?".out":".inOut")]=pn[o+"."+l]=s[l]}),s},gF=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},bS=function i(e,t,n){var r=t>=1?t:1,s=(n||(e?.3:.45))/(t<1?t:1),a=s/t5*(Math.asin(1/r)||0),o=function(u){return u===1?1:r*Math.pow(2,-10*u)*_ne((u-a)*s)+1},l=e==="out"?o:e==="in"?function(c){return 1-o(1-c)}:gF(o);return s=t5/s,l.config=function(c,u){return i(e,c,u)},l},_S=function i(e,t){t===void 0&&(t=1.70158);var n=function(a){return a?--a*a*((t+1)*a+t)+1:0},r=e==="out"?n:e==="in"?function(s){return 1-n(1-s)}:gF(n);return r.config=function(s){return i(e,s)},r};Ts("Linear,Quad,Cubic,Quart,Quint,Strong",function(i,e){var t=e<5?e+1:e;dd(i+",Power"+(t-1),e?function(n){return Math.pow(n,t)}:function(n){return n},function(n){return 1-Math.pow(1-n,t)},function(n){return n<.5?Math.pow(n*2,t)/2:1-Math.pow((1-n)*2,t)/2})});pn.Linear.easeNone=pn.none=pn.Linear.easeIn;dd("Elastic",bS("in"),bS("out"),bS());(function(i,e){var t=1/e,n=2*t,r=2.5*t,s=function(o){return o<t?i*o*o:o<n?i*Math.pow(o-1.5/e,2)+.75:o<r?i*(o-=2.25/e)*o+.9375:i*Math.pow(o-2.625/e,2)+.984375};dd("Bounce",function(a){return 1-s(1-a)},s)})(7.5625,2.75);dd("Expo",function(i){return Math.pow(2,10*(i-1))*i+i*i*i*i*i*i*(1-i)});dd("Circ",function(i){return-(FU(1-i*i)-1)});dd("Sine",function(i){return i===1?1:-bne(i*yne)+1});dd("Back",_S("in"),_S("out"),_S());pn.SteppedEase=pn.steps=aa.SteppedEase={config:function(e,t){e===void 0&&(e=1);var n=1/e,r=e+(t?0:1),s=t?1:0,a=1-Bn;return function(o){return((r*jg(0,a,o)|0)+s)*n}}};t0.ease=pn["quad.out"];Ts("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(i){return NT+=i+","+i+"Params,"});var xF=function(e,t){this.id=vne++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:YU,this.set=t?t.getSetter:FT},Gm=(function(){function i(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,r0(this,+t.duration,1,1),this.data=t.data,ii&&(this._ctx=ii,ii.data.push(this)),Vm||Ks.wake()}var e=i.prototype;return e.delay=function(n){return n||n===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+n-this._delay),this._delay=n,this):this._delay},e.duration=function(n){return arguments.length?this.totalDuration(this._repeat>0?n+(n+this._rDelay)*this._repeat:n):this.totalDuration()&&this._dur},e.totalDuration=function(n){return arguments.length?(this._dirty=0,r0(this,this._repeat<0?n:(n-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(n,r){if(s0(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(e2(this,n),!s._dp||s.parent||JU(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&n<this._tDur||this._ts<0&&n>0||!this._tDur&&!n)&&zo(this._dp,this,this._start-this._delay)}return(this._tTime!==n||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===Bn||!n&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=n),$U(this,n,r)),this},e.time=function(n,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),n+LR(this))%(this._dur+this._rDelay)||(n?this._dur:0),r):this._time},e.totalProgress=function(n,r){return arguments.length?this.totalTime(this.totalDuration()*n,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},e.progress=function(n,r){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-n:n)+LR(this),r):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(n,r){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(n-1)*s,r):this._repeat?i0(this._tTime,s)+1:1},e.timeScale=function(n,r){if(!arguments.length)return this._rts===-Bn?0:this._rts;if(this._rts===n)return this;var s=this.parent&&this._ts?rv(this.parent._time,this):this._tTime;return this._rts=+n||0,this._ts=this._ps||n===-Bn?0:this._rts,this.totalTime(jg(-Math.abs(this._delay),this.totalDuration(),s),r!==!1),Jb(this),Ene(this)},e.paused=function(n){return arguments.length?(this._ps!==n&&(this._ps=n,n?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(s0(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==Bn&&(this._tTime-=Bn)))),this):this._ps},e.startTime=function(n){if(arguments.length){this._start=n;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&zo(r,this,n-this._delay),this}return this._start},e.endTime=function(n){return this._start+(Ms(n)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(n){var r=this.parent||this._dp;return r?n&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?rv(r.rawTime(n),this):this._tTime:this._tTime},e.revert=function(n){n===void 0&&(n=Mne);var r=Tr;return Tr=n,kT(this)&&(this.timeline&&this.timeline.revert(n),this.totalTime(-.01,n.suppressEvents)),this.data!=="nested"&&n.kill!==!1&&this.kill(),Tr=r,this},e.globalTime=function(n){for(var r=this,s=arguments.length?n:r.rawTime();r;)s=r._start+s/(Math.abs(r._ts)||1),r=r._dp;return!this.parent&&this._sat?this._sat.globalTime(n):s},e.repeat=function(n){return arguments.length?(this._repeat=n===1/0?-2:n,kR(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(n){if(arguments.length){var r=this._time;return this._rDelay=n,kR(this),r?this.time(r):this}return this._rDelay},e.yoyo=function(n){return arguments.length?(this._yoyo=n,this):this._yoyo},e.seek=function(n,r){return this.totalTime(Ta(this,n),Ms(r))},e.restart=function(n,r){return this.play().totalTime(n?-this._delay:0,Ms(r)),this._dur||(this._zTime=-Bn),this},e.play=function(n,r){return n!=null&&this.seek(n,r),this.reversed(!1).paused(!1)},e.reverse=function(n,r){return n!=null&&this.seek(n||this.totalDuration(),r),this.reversed(!0).paused(!1)},e.pause=function(n,r){return n!=null&&this.seek(n,r),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(n){return arguments.length?(!!n!==this.reversed()&&this.timeScale(-this._rts||(n?-Bn:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-Bn,this},e.isActive=function(){var n=this.parent||this._dp,r=this._start,s;return!!(!n||this._ts&&this._initted&&n.isActive()&&(s=n.rawTime(!0))>=r&&s<this.endTime(!0)-Bn)},e.eventCallback=function(n,r,s){var a=this.vars;return arguments.length>1?(r?(a[n]=r,s&&(a[n+"Params"]=s),n==="onUpdate"&&(this._onUpdate=r)):delete a[n],this):a[n]},e.then=function(n){var r=this;return new Promise(function(s){var a=Ti(n)?n:ZU,o=function(){var c=r.then;r.then=null,Ti(a)&&(a=a(r))&&(a.then||a===r)&&(r.then=c),s(a),r.then=c};r._initted&&r.totalProgress()===1&&r._ts>=0||!r._tTime&&r._ts<0?o():r._prom=o})},e.kill=function(){Zp(this)},i})();oa(Gm.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Bn,_prom:0,_ps:!1,_rts:1});var Jr=(function(i){UU(e,i);function e(n,r){var s;return n===void 0&&(n={}),s=i.call(this,n)||this,s.labels={},s.smoothChildTiming=!!n.smoothChildTiming,s.autoRemoveChildren=!!n.autoRemoveChildren,s._sort=Ms(n.sortChildren),ui&&zo(n.parent||ui,Fl(s),r),n.reversed&&s.reverse(),n.paused&&s.paused(!0),n.scrollTrigger&&eF(Fl(s),n.scrollTrigger),s}var t=e.prototype;return t.to=function(r,s,a){return hm(0,arguments,this),this},t.from=function(r,s,a){return hm(1,arguments,this),this},t.fromTo=function(r,s,a,o){return hm(2,arguments,this),this},t.set=function(r,s,a){return s.duration=0,s.parent=this,um(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new Oi(r,s,Ta(this,a),1),this},t.call=function(r,s,a){return zo(this,Oi.delayedCall(0,r,s),a)},t.staggerTo=function(r,s,a,o,l,c,u){return a.duration=s,a.stagger=a.stagger||o,a.onComplete=c,a.onCompleteParams=u,a.parent=this,new Oi(r,a,Ta(this,l)),this},t.staggerFrom=function(r,s,a,o,l,c,u){return a.runBackwards=1,um(a).immediateRender=Ms(a.immediateRender),this.staggerTo(r,s,a,o,l,c,u)},t.staggerFromTo=function(r,s,a,o,l,c,u,d){return o.startAt=a,um(o).immediateRender=Ms(o.immediateRender),this.staggerTo(r,s,o,l,c,u,d)},t.render=function(r,s,a){var o=this._time,l=this._dirty?this.totalDuration():this._tDur,c=this._dur,u=r<=0?0:zi(r),d=this._zTime<0!=r<0&&(this._initted||!c),p,m,g,y,x,_,S,w,T,C,E,D;if(this!==ui&&u>l&&r>=0&&(u=l),u!==this._tTime||a||d){if(o!==this._time&&c&&(u+=this._time-o,r+=this._time-o),p=u,T=this._start,w=this._ts,_=!w,d&&(c||(o=this._zTime),(r||!s)&&(this._zTime=r)),this._repeat){if(E=this._yoyo,x=c+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(x*100+r,s,a);if(p=zi(u%x),u===l?(y=this._repeat,p=c):(C=zi(u/x),y=~~C,y&&y===C&&(p=c,y--),p>c&&(p=c)),C=i0(this._tTime,x),!o&&this._tTime&&C!==y&&this._tTime-C*x-this._dur<=0&&(C=y),E&&y&1&&(p=c-p,D=1),y!==C&&!this._lock){var O=E&&C&1,R=O===(E&&y&1);if(y<C&&(O=!O),o=O?0:u%c?c:u,this._lock=1,this.render(o||(D?0:zi(y*x)),s,!c)._lock=0,this._tTime=u,!s&&this.parent&&Qs(this,"onRepeat"),this.vars.repeatRefresh&&!D&&(this.invalidate()._lock=1),o&&o!==this._time||_!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(c=this._dur,l=this._tDur,R&&(this._lock=2,o=O?c:-1e-4,this.render(o,!0),this.vars.repeatRefresh&&!D&&this.invalidate()),this._lock=0,!this._ts&&!_)return this;mF(this,D)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(S=Dne(this,zi(o),zi(p)),S&&(u-=p-(p=S._start))),this._tTime=u,this._time=p,this._act=!w,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,o=0),!o&&u&&!s&&!C&&(Qs(this,"onStart"),this._tTime!==u))return this;if(p>=o&&r>=0)for(m=this._first;m;){if(g=m._next,(m._act||p>=m._start)&&m._ts&&S!==m){if(m.parent!==this)return this.render(r,s,a);if(m.render(m._ts>0?(p-m._start)*m._ts:(m._dirty?m.totalDuration():m._tDur)+(p-m._start)*m._ts,s,a),p!==this._time||!this._ts&&!_){S=0,g&&(u+=this._zTime=-Bn);break}}m=g}else{m=this._last;for(var P=r<0?r:p;m;){if(g=m._prev,(m._act||P<=m._end)&&m._ts&&S!==m){if(m.parent!==this)return this.render(r,s,a);if(m.render(m._ts>0?(P-m._start)*m._ts:(m._dirty?m.totalDuration():m._tDur)+(P-m._start)*m._ts,s,a||Tr&&kT(m)),p!==this._time||!this._ts&&!_){S=0,g&&(u+=this._zTime=P?-Bn:Bn);break}}m=g}}if(S&&!s&&(this.pause(),S.render(p>=o?0:-Bn)._zTime=p>=o?1:-1,this._ts))return this._start=T,Jb(this),this.render(r,s,a);this._onUpdate&&!s&&Qs(this,"onUpdate",!0),(u===l&&this._tTime>=this.totalDuration()||!u&&o)&&(T===this._start||Math.abs(w)!==Math.abs(this._ts))&&(this._lock||((r||!c)&&(u===l&&this._ts>0||!u&&this._ts<0)&&mu(this,1),!s&&!(r<0&&!o)&&(u||o||!l)&&(Qs(this,u===l&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<l&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(r,s){var a=this;if(cc(s)||(s=Ta(this,s,r)),!(r instanceof Gm)){if(jr(r))return r.forEach(function(o){return a.add(o,s)}),this;if(dr(r))return this.addLabel(r,s);if(Ti(r))r=Oi.delayedCall(0,r);else return this}return this!==r?zo(this,r,s):this},t.getChildren=function(r,s,a,o){r===void 0&&(r=!0),s===void 0&&(s=!0),a===void 0&&(a=!0),o===void 0&&(o=-Pa);for(var l=[],c=this._first;c;)c._start>=o&&(c instanceof Oi?s&&l.push(c):(a&&l.push(c),r&&l.push.apply(l,c.getChildren(!0,s,a)))),c=c._next;return l},t.getById=function(r){for(var s=this.getChildren(1,1,1),a=s.length;a--;)if(s[a].vars.id===r)return s[a]},t.remove=function(r){return dr(r)?this.removeLabel(r):Ti(r)?this.killTweensOf(r):(r.parent===this&&Qb(this,r),r===this._recent&&(this._recent=this._last),Hh(this))},t.totalTime=function(r,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=zi(Ks.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),i.prototype.totalTime.call(this,r,s),this._forcing=0,this):this._tTime},t.addLabel=function(r,s){return this.labels[r]=Ta(this,s),this},t.removeLabel=function(r){return delete this.labels[r],this},t.addPause=function(r,s,a){var o=Oi.delayedCall(0,s||Hm,a);return o.data="isPause",this._hasPause=1,zo(this,o,Ta(this,r))},t.removePause=function(r){var s=this._first;for(r=Ta(this,r);s;)s._start===r&&s.data==="isPause"&&mu(s),s=s._next},t.killTweensOf=function(r,s,a){for(var o=this.getTweensOf(r,a),l=o.length;l--;)Jc!==o[l]&&o[l].kill(r,s);return this},t.getTweensOf=function(r,s){for(var a=[],o=Ia(r),l=this._first,c=cc(s),u;l;)l instanceof Oi?Tne(l._targets,o)&&(c?(!Jc||l._initted&&l._ts)&&l.globalTime(0)<=s&&l.globalTime(l.totalDuration())>s:!s||l.isActive())&&a.push(l):(u=l.getTweensOf(o,s)).length&&a.push.apply(a,u),l=l._next;return a},t.tweenTo=function(r,s){s=s||{};var a=this,o=Ta(a,r),l=s,c=l.startAt,u=l.onStart,d=l.onStartParams,p=l.immediateRender,m,g=Oi.to(a,oa({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:o,overwrite:"auto",duration:s.duration||Math.abs((o-(c&&"time"in c?c.time:a._time))/a.timeScale())||Bn,onStart:function(){if(a.pause(),!m){var x=s.duration||Math.abs((o-(c&&"time"in c?c.time:a._time))/a.timeScale());g._dur!==x&&r0(g,x,0,1).render(g._time,!0,!0),m=1}u&&u.apply(g,d||[])}},s));return p?g.render(0):g},t.tweenFromTo=function(r,s,a){return this.tweenTo(s,oa({startAt:{time:Ta(this,r)}},a))},t.recent=function(){return this._recent},t.nextLabel=function(r){return r===void 0&&(r=this._time),OR(this,Ta(this,r))},t.previousLabel=function(r){return r===void 0&&(r=this._time),OR(this,Ta(this,r),1)},t.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+Bn)},t.shiftChildren=function(r,s,a){a===void 0&&(a=0);for(var o=this._first,l=this.labels,c;o;)o._start>=a&&(o._start+=r,o._end+=r),o=o._next;if(s)for(c in l)l[c]>=a&&(l[c]+=r);return Hh(this)},t.invalidate=function(r){var s=this._first;for(this._lock=0;s;)s.invalidate(r),s=s._next;return i.prototype.invalidate.call(this,r)},t.clear=function(r){r===void 0&&(r=!0);for(var s=this._first,a;s;)a=s._next,this.remove(s),s=a;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),Hh(this)},t.totalDuration=function(r){var s=0,a=this,o=a._last,l=Pa,c,u,d;if(arguments.length)return a.timeScale((a._repeat<0?a.duration():a.totalDuration())/(a.reversed()?-r:r));if(a._dirty){for(d=a.parent;o;)c=o._prev,o._dirty&&o.totalDuration(),u=o._start,u>l&&a._sort&&o._ts&&!a._lock?(a._lock=1,zo(a,o,u-o._delay,1)._lock=0):l=u,u<0&&o._ts&&(s-=u,(!d&&!a._dp||d&&d.smoothChildTiming)&&(a._start+=u/a._ts,a._time-=u,a._tTime-=u),a.shiftChildren(-u,!1,-1/0),l=0),o._end>s&&o._ts&&(s=o._end),o=c;r0(a,a===ui&&a._time>s?a._time:s,1,1),a._dirty=0}return a._tDur},e.updateRoot=function(r){if(ui._ts&&($U(ui,rv(r,ui)),XU=Ks.frame),Ks.frame>=DR){DR+=na.autoSleep||120;var s=ui._first;if((!s||!s._ts)&&na.autoSleep&&Ks._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||Ks.sleep()}}},e})(Gm);oa(Jr.prototype,{_lock:0,_hasPause:0,_forcing:0});var Yne=function(e,t,n,r,s,a,o){var l=new As(this._pt,e,t,0,1,wF,null,s),c=0,u=0,d,p,m,g,y,x,_,S;for(l.b=n,l.e=r,n+="",r+="",(_=~r.indexOf("random("))&&(r=jm(r)),a&&(S=[n,r],a(S,e,t),n=S[0],r=S[1]),p=n.match(xS)||[];d=xS.exec(r);)g=d[0],y=r.substring(c,d.index),m?m=(m+1)%5:y.substr(-5)==="rgba("&&(m=1),g!==p[u++]&&(x=parseFloat(p[u-1])||0,l._pt={_next:l._pt,p:y||u===1?y:",",s:x,c:g.charAt(1)==="="?Hf(x,g)-x:parseFloat(g)-x,m:m&&m<4?Math.round:0},c=xS.lastIndex);return l.c=c<r.length?r.substring(c,r.length):"",l.fp=o,(jU.test(r)||_)&&(l.e=0),this._pt=l,l},OT=function(e,t,n,r,s,a,o,l,c,u){Ti(r)&&(r=r(s||0,e,a));var d=e[t],p=n!=="get"?n:Ti(d)?c?e[t.indexOf("set")||!Ti(e["get"+t.substr(3)])?t:"get"+t.substr(3)](c):e[t]():d,m=Ti(d)?c?Jne:_F:UT,g;if(dr(r)&&(~r.indexOf("random(")&&(r=jm(r)),r.charAt(1)==="="&&(g=Hf(p,r)+(zr(p)||0),(g||g===0)&&(r=g))),!u||p!==r||u5)return!isNaN(p*r)&&r!==""?(g=new As(this._pt,e,t,+p||0,r-(p||0),typeof d=="boolean"?tie:SF,0,m),c&&(g.fp=c),o&&g.modifier(o,this,e),this._pt=g):(!d&&!(t in e)&&IT(t,r),Yne.call(this,e,t,p,r,m,l||na.stringFilter,c))},$ne=function(e,t,n,r,s){if(Ti(e)&&(e=dm(e,s,t,n,r)),!el(e)||e.style&&e.nodeType||jr(e)||BU(e))return dr(e)?dm(e,s,t,n,r):e;var a={},o;for(o in e)a[o]=dm(e[o],s,t,n,r);return a},yF=function(e,t,n,r,s,a){var o,l,c,u;if($s[e]&&(o=new $s[e]).init(s,o.rawVars?t[e]:$ne(t[e],r,s,a,n),n,r,a)!==!1&&(n._pt=l=new As(n._pt,s,e,0,1,o.render,o,0,o.priority),n!==Nf))for(c=n._ptLookup[n._targets.indexOf(s)],u=o._props.length;u--;)c[o._props[u]]=l;return o},Jc,u5,zT=function i(e,t,n){var r=e.vars,s=r.ease,a=r.startAt,o=r.immediateRender,l=r.lazy,c=r.onUpdate,u=r.runBackwards,d=r.yoyoEase,p=r.keyframes,m=r.autoRevert,g=e._dur,y=e._startAt,x=e._targets,_=e.parent,S=_&&_.data==="nested"?_.vars.targets:x,w=e._overwrite==="auto"&&!CT,T=e.timeline,C,E,D,O,R,P,L,V,j,B,J,U,X;if(T&&(!p||!s)&&(s="none"),e._ease=jh(s,t0.ease),e._yEase=d?pF(jh(d===!0?s:d,t0.ease)):0,d&&e._yoyo&&!e._repeat&&(d=e._yEase,e._yEase=e._ease,e._ease=d),e._from=!T&&!!r.runBackwards,!T||p&&!r.stagger){if(V=x[0]?Bh(x[0]).harness:0,U=V&&r[V.prop],C=iv(r,DT),y&&(y._zTime<0&&y.progress(1),t<0&&u&&o&&!m?y.render(-1,!0):y.revert(u&&g?Py:wne),y._lazy=0),a){if(mu(e._startAt=Oi.set(x,oa({data:"isStart",overwrite:!1,parent:_,immediateRender:!0,lazy:!y&&Ms(l),startAt:null,delay:0,onUpdate:c&&function(){return Qs(e,"onUpdate")},stagger:0},a))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Tr||!o&&!m)&&e._startAt.revert(Py),o&&g&&t<=0&&n<=0){t&&(e._zTime=t);return}}else if(u&&g&&!y){if(t&&(o=!1),D=oa({overwrite:!1,data:"isFromStart",lazy:o&&!y&&Ms(l),immediateRender:o,stagger:0,parent:_},C),U&&(D[V.prop]=U),mu(e._startAt=Oi.set(x,D)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Tr?e._startAt.revert(Py):e._startAt.render(-1,!0)),e._zTime=t,!o)i(e._startAt,Bn,Bn);else if(!t)return}for(e._pt=e._ptCache=0,l=g&&Ms(l)||l&&!g,E=0;E<x.length;E++){if(R=x[E],L=R._gsap||LT(x)[E]._gsap,e._ptLookup[E]=B={},r5[L.id]&&lu.length&&nv(),J=S===x?E:S.indexOf(R),V&&(j=new V).init(R,U||C,e,J,S)!==!1&&(e._pt=O=new As(e._pt,R,j.name,0,1,j.render,j,0,j.priority),j._props.forEach(function($){B[$]=O}),j.priority&&(P=1)),!V||U)for(D in C)$s[D]&&(j=yF(D,C,e,J,R,S))?j.priority&&(P=1):B[D]=O=OT.call(e,R,D,"get",C[D],J,S,0,r.stringFilter);e._op&&e._op[E]&&e.kill(R,e._op[E]),w&&e._pt&&(Jc=e,ui.killTweensOf(R,B,e.globalTime(t)),X=!e.parent,Jc=0),e._pt&&l&&(r5[L.id]=1)}P&&MF(e),e._onInit&&e._onInit(e)}e._onUpdate=c,e._initted=(!e._op||e._pt)&&!X,p&&t<=0&&T.render(Pa,!0,!0)},Kne=function(e,t,n,r,s,a,o,l){var c=(e._pt&&e._ptCache||(e._ptCache={}))[t],u,d,p,m;if(!c)for(c=e._ptCache[t]=[],p=e._ptLookup,m=e._targets.length;m--;){if(u=p[m][t],u&&u.d&&u.d._pt)for(u=u.d._pt;u&&u.p!==t&&u.fp!==t;)u=u._next;if(!u)return u5=1,e.vars[t]="+=0",zT(e,o),u5=0,l?Bm(t+" not eligible for reset"):1;c.push(u)}for(m=c.length;m--;)d=c[m],u=d._pt||d,u.s=(r||r===0)&&!s?r:u.s+(r||0)+a*u.c,u.c=n-u.s,d.e&&(d.e=Ri(n)+zr(d.e)),d.b&&(d.b=u.s+zr(d.b))},Zne=function(e,t){var n=e[0]?Bh(e[0]).harness:0,r=n&&n.aliases,s,a,o,l;if(!r)return t;s=n0({},t);for(a in r)if(a in s)for(l=r[a].split(","),o=l.length;o--;)s[l[o]]=s[a];return s},Qne=function(e,t,n,r){var s=t.ease||r||"power1.inOut",a,o;if(jr(t))o=n[e]||(n[e]=[]),t.forEach(function(l,c){return o.push({t:c/(t.length-1)*100,v:l,e:s})});else for(a in t)o=n[a]||(n[a]=[]),a==="ease"||o.push({t:parseFloat(e),v:t[a],e:s})},dm=function(e,t,n,r,s){return Ti(e)?e.call(t,n,r,s):dr(e)&&~e.indexOf("random(")?jm(e):e},vF=NT+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",bF={};Ts(vF+",id,stagger,delay,duration,paused,scrollTrigger",function(i){return bF[i]=1});var Oi=(function(i){UU(e,i);function e(n,r,s,a){var o;typeof r=="number"&&(s.duration=r,r=s,s=null),o=i.call(this,a?r:um(r))||this;var l=o.vars,c=l.duration,u=l.delay,d=l.immediateRender,p=l.stagger,m=l.overwrite,g=l.keyframes,y=l.defaults,x=l.scrollTrigger,_=l.yoyoEase,S=r.parent||ui,w=(jr(n)||BU(n)?cc(n[0]):"length"in r)?[n]:Ia(n),T,C,E,D,O,R,P,L;if(o._targets=w.length?LT(w):Bm("GSAP target "+n+" not found. https://gsap.com",!na.nullTargetWarn)||[],o._ptLookup=[],o._overwrite=m,g||p||l1(c)||l1(u)){if(r=o.vars,T=o.timeline=new Jr({data:"nested",defaults:y||{},targets:S&&S.data==="nested"?S.vars.targets:w}),T.kill(),T.parent=T._dp=Fl(o),T._start=0,p||l1(c)||l1(u)){if(D=w.length,P=p&&rF(p),el(p))for(O in p)~vF.indexOf(O)&&(L||(L={}),L[O]=p[O]);for(C=0;C<D;C++)E=iv(r,bF),E.stagger=0,_&&(E.yoyoEase=_),L&&n0(E,L),R=w[C],E.duration=+dm(c,Fl(o),C,R,w),E.delay=(+dm(u,Fl(o),C,R,w)||0)-o._delay,!p&&D===1&&E.delay&&(o._delay=u=E.delay,o._start+=u,E.delay=0),T.to(R,E,P?P(C,R,w):0),T._ease=pn.none;T.duration()?c=u=0:o.timeline=0}else if(g){um(oa(T.vars.defaults,{ease:"none"})),T._ease=jh(g.ease||r.ease||"none");var V=0,j,B,J;if(jr(g))g.forEach(function(U){return T.to(w,U,">")}),T.duration();else{E={};for(O in g)O==="ease"||O==="easeEach"||Qne(O,g[O],E,g.easeEach);for(O in E)for(j=E[O].sort(function(U,X){return U.t-X.t}),V=0,C=0;C<j.length;C++)B=j[C],J={ease:B.e,duration:(B.t-(C?j[C-1].t:0))/100*c},J[O]=B.v,T.to(w,J,V),V+=J.duration;T.duration()<c&&T.to({},{duration:c-T.duration()})}}c||o.duration(c=T.duration())}else o.timeline=0;return m===!0&&!CT&&(Jc=Fl(o),ui.killTweensOf(w),Jc=0),zo(S,Fl(o),s),r.reversed&&o.reverse(),r.paused&&o.paused(!0),(d||!c&&!g&&o._start===zi(S._time)&&Ms(d)&&Rne(Fl(o))&&S.data!=="nested")&&(o._tTime=-Bn,o.render(Math.max(0,-u)||0)),x&&eF(Fl(o),x),o}var t=e.prototype;return t.render=function(r,s,a){var o=this._time,l=this._tDur,c=this._dur,u=r<0,d=r>l-Bn&&!u?l:r<Bn?0:r,p,m,g,y,x,_,S,w,T;if(!c)Ine(this,r,s,a);else if(d!==this._tTime||!r||a||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==u||this._lazy){if(p=d,w=this.timeline,this._repeat){if(y=c+this._rDelay,this._repeat<-1&&u)return this.totalTime(y*100+r,s,a);if(p=zi(d%y),d===l?(g=this._repeat,p=c):(x=zi(d/y),g=~~x,g&&g===x?(p=c,g--):p>c&&(p=c)),_=this._yoyo&&g&1,_&&(T=this._yEase,p=c-p),x=i0(this._tTime,y),p===o&&!a&&this._initted&&g===x)return this._tTime=d,this;g!==x&&(w&&this._yEase&&mF(w,_),this.vars.repeatRefresh&&!_&&!this._lock&&p!==y&&this._initted&&(this._lock=a=1,this.render(zi(y*g),!0).invalidate()._lock=0))}if(!this._initted){if(tF(this,u?r:p,a,s,d))return this._tTime=0,this;if(o!==this._time&&!(a&&this.vars.repeatRefresh&&g!==x))return this;if(c!==this._dur)return this.render(r,s,a)}if(this._tTime=d,this._time=p,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=S=(T||this._ease)(p/c),this._from&&(this.ratio=S=1-S),!o&&d&&!s&&!x&&(Qs(this,"onStart"),this._tTime!==d))return this;for(m=this._pt;m;)m.r(S,m.d),m=m._next;w&&w.render(r<0?r:w._dur*w._ease(p/this._dur),s,a)||this._startAt&&(this._zTime=r),this._onUpdate&&!s&&(u&&s5(this,r,s,a),Qs(this,"onUpdate")),this._repeat&&g!==x&&this.vars.onRepeat&&!s&&this.parent&&Qs(this,"onRepeat"),(d===this._tDur||!d)&&this._tTime===d&&(u&&!this._onUpdate&&s5(this,r,!0,!0),(r||!c)&&(d===this._tDur&&this._ts>0||!d&&this._ts<0)&&mu(this,1),!s&&!(u&&!o)&&(d||o||_)&&(Qs(this,d===l?"onComplete":"onReverseComplete",!0),this._prom&&!(d<l&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),i.prototype.invalidate.call(this,r)},t.resetTo=function(r,s,a,o,l){Vm||Ks.wake(),this._ts||this.play();var c=Math.min(this._dur,(this._dp._time-this._start)*this._ts),u;return this._initted||zT(this,c),u=this._ease(c/this._dur),Kne(this,r,s,a,o,u,c,l)?this.resetTo(r,s,a,o,1):(e2(this,0),this.parent||QU(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(r,s){if(s===void 0&&(s="all"),!r&&(!s||s==="all"))return this._lazy=this._pt=0,this.parent?Zp(this):this.scrollTrigger&&this.scrollTrigger.kill(!!Tr),this;if(this.timeline){var a=this.timeline.totalDuration();return this.timeline.killTweensOf(r,s,Jc&&Jc.vars.overwrite!==!0)._first||Zp(this),this.parent&&a!==this.timeline.totalDuration()&&r0(this,this._dur*this.timeline._tDur/a,0,1),this}var o=this._targets,l=r?Ia(r):o,c=this._ptLookup,u=this._pt,d,p,m,g,y,x,_;if((!s||s==="all")&&Cne(o,l))return s==="all"&&(this._pt=0),Zp(this);for(d=this._op=this._op||[],s!=="all"&&(dr(s)&&(y={},Ts(s,function(S){return y[S]=1}),s=y),s=Zne(o,s)),_=o.length;_--;)if(~l.indexOf(o[_])){p=c[_],s==="all"?(d[_]=s,g=p,m={}):(m=d[_]=d[_]||{},g=s);for(y in g)x=p&&p[y],x&&((!("kill"in x.d)||x.d.kill(y)===!0)&&Qb(this,x,"_pt"),delete p[y]),m!=="all"&&(m[y]=1)}return this._initted&&!this._pt&&u&&Zp(this),this},e.to=function(r,s){return new e(r,s,arguments[2])},e.from=function(r,s){return hm(1,arguments)},e.delayedCall=function(r,s,a,o){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:s,onReverseComplete:s,onCompleteParams:a,onReverseCompleteParams:a,callbackScope:o})},e.fromTo=function(r,s,a){return hm(2,arguments)},e.set=function(r,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(r,s)},e.killTweensOf=function(r,s,a){return ui.killTweensOf(r,s,a)},e})(Gm);oa(Oi.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});Ts("staggerTo,staggerFrom,staggerFromTo",function(i){Oi[i]=function(){var e=new Jr,t=o5.call(arguments,0);return t.splice(i==="staggerFromTo"?5:4,0,0),e[i].apply(e,t)}});var UT=function(e,t,n){return e[t]=n},_F=function(e,t,n){return e[t](n)},Jne=function(e,t,n,r){return e[t](r.fp,n)},eie=function(e,t,n){return e.setAttribute(t,n)},FT=function(e,t){return Ti(e[t])?_F:ET(e[t])&&e.setAttribute?eie:UT},SF=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},tie=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},wF=function(e,t){var n=t._pt,r="";if(!e&&t.b)r=t.b;else if(e===1&&t.e)r=t.e;else{for(;n;)r=n.p+(n.m?n.m(n.s+n.c*e):Math.round((n.s+n.c*e)*1e4)/1e4)+r,n=n._next;r+=t.c}t.set(t.t,t.p,r,t)},BT=function(e,t){for(var n=t._pt;n;)n.r(e,n.d),n=n._next},nie=function(e,t,n,r){for(var s=this._pt,a;s;)a=s._next,s.p===r&&s.modifier(e,t,n),s=a},iie=function(e){for(var t=this._pt,n,r;t;)r=t._next,t.p===e&&!t.op||t.op===e?Qb(this,t,"_pt"):t.dep||(n=1),t=r;return!n},rie=function(e,t,n,r){r.mSet(e,t,r.m.call(r.tween,n,r.mt),r)},MF=function(e){for(var t=e._pt,n,r,s,a;t;){for(n=t._next,r=s;r&&r.pr>t.pr;)r=r._next;(t._prev=r?r._prev:a)?t._prev._next=t:s=t,(t._next=r)?r._prev=t:a=t,t=n}e._pt=s},As=(function(){function i(t,n,r,s,a,o,l,c,u){this.t=n,this.s=s,this.c=a,this.p=r,this.r=o||SF,this.d=l||this,this.set=c||UT,this.pr=u||0,this._next=t,t&&(t._prev=this)}var e=i.prototype;return e.modifier=function(n,r,s){this.mSet=this.mSet||this.set,this.set=rie,this.m=n,this.mt=s,this.tween=r},i})();Ts(NT+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(i){return DT[i]=1});aa.TweenMax=aa.TweenLite=Oi;aa.TimelineLite=aa.TimelineMax=Jr;ui=new Jr({sortChildren:!1,defaults:t0,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});na.stringFilter=fF;var Vh=[],Dy={},sie=[],UR=0,aie=0,SS=function(e){return(Dy[e]||sie).map(function(t){return t()})},h5=function(){var e=Date.now(),t=[];e-UR>2&&(SS("matchMediaInit"),Vh.forEach(function(n){var r=n.queries,s=n.conditions,a,o,l,c;for(o in r)a=No.matchMedia(r[o]).matches,a&&(l=1),a!==s[o]&&(s[o]=a,c=1);c&&(n.revert(),l&&t.push(n))}),SS("matchMediaRevert"),t.forEach(function(n){return n.onMatch(n,function(r){return n.add(null,r)})}),UR=e,SS("matchMedia"))},TF=(function(){function i(t,n){this.selector=n&&l5(n),this.data=[],this._r=[],this.isReverted=!1,this.id=aie++,t&&this.add(t)}var e=i.prototype;return e.add=function(n,r,s){Ti(n)&&(s=r,r=n,n=Ti);var a=this,o=function(){var c=ii,u=a.selector,d;return c&&c!==a&&c.data.push(a),s&&(a.selector=l5(s)),ii=a,d=r.apply(a,arguments),Ti(d)&&a._r.push(d),ii=c,a.selector=u,a.isReverted=!1,d};return a.last=o,n===Ti?o(a,function(l){return a.add(null,l)}):n?a[n]=o:o},e.ignore=function(n){var r=ii;ii=null,n(this),ii=r},e.getTweens=function(){var n=[];return this.data.forEach(function(r){return r instanceof i?n.push.apply(n,r.getTweens()):r instanceof Oi&&!(r.parent&&r.parent.data==="nested")&&n.push(r)}),n},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(n,r){var s=this;if(n?(function(){for(var o=s.getTweens(),l=s.data.length,c;l--;)c=s.data[l],c.data==="isFlip"&&(c.revert(),c.getChildren(!0,!0,!1).forEach(function(u){return o.splice(o.indexOf(u),1)}));for(o.map(function(u){return{g:u._dur||u._delay||u._sat&&!u._sat.vars.immediateRender?u.globalTime(0):-1/0,t:u}}).sort(function(u,d){return d.g-u.g||-1/0}).forEach(function(u){return u.t.revert(n)}),l=s.data.length;l--;)c=s.data[l],c instanceof Jr?c.data!=="nested"&&(c.scrollTrigger&&c.scrollTrigger.revert(),c.kill()):!(c instanceof Oi)&&c.revert&&c.revert(n);s._r.forEach(function(u){return u(n,s)}),s.isReverted=!0})():this.data.forEach(function(o){return o.kill&&o.kill()}),this.clear(),r)for(var a=Vh.length;a--;)Vh[a].id===this.id&&Vh.splice(a,1)},e.revert=function(n){this.kill(n||{})},i})(),oie=(function(){function i(t){this.contexts=[],this.scope=t,ii&&ii.data.push(this)}var e=i.prototype;return e.add=function(n,r,s){el(n)||(n={matches:n});var a=new TF(0,s||this.scope),o=a.conditions={},l,c,u;ii&&!a.selector&&(a.selector=ii.selector),this.contexts.push(a),r=a.add("onMatch",r),a.queries=n;for(c in n)c==="all"?u=1:(l=No.matchMedia(n[c]),l&&(Vh.indexOf(a)<0&&Vh.push(a),(o[c]=l.matches)&&(u=1),l.addListener?l.addListener(h5):l.addEventListener("change",h5)));return u&&r(a,function(d){return a.add(null,d)}),this},e.revert=function(n){this.kill(n||{})},e.kill=function(n){this.contexts.forEach(function(r){return r.kill(n,!0)})},i})(),sv={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(function(r){return uF(r)})},timeline:function(e){return new Jr(e)},getTweensOf:function(e,t){return ui.getTweensOf(e,t)},getProperty:function(e,t,n,r){dr(e)&&(e=Ia(e)[0]);var s=Bh(e||{}).get,a=n?ZU:KU;return n==="native"&&(n=""),e&&(t?a(($s[t]&&$s[t].get||s)(e,t,n,r)):function(o,l,c){return a(($s[o]&&$s[o].get||s)(e,o,l,c))})},quickSetter:function(e,t,n){if(e=Ia(e),e.length>1){var r=e.map(function(u){return Rs.quickSetter(u,t,n)}),s=r.length;return function(u){for(var d=s;d--;)r[d](u)}}e=e[0]||{};var a=$s[t],o=Bh(e),l=o.harness&&(o.harness.aliases||{})[t]||t,c=a?function(u){var d=new a;Nf._pt=0,d.init(e,n?u+n:u,Nf,0,[e]),d.render(1,d),Nf._pt&&BT(1,Nf)}:o.set(e,l);return a?c:function(u){return c(e,l,n?u+n:u,o,1)}},quickTo:function(e,t,n){var r,s=Rs.to(e,oa((r={},r[t]="+=0.1",r.paused=!0,r.stagger=0,r),n||{})),a=function(l,c,u){return s.resetTo(t,l,c,u)};return a.tween=s,a},isTweening:function(e){return ui.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=jh(e.ease,t0.ease)),NR(t0,e||{})},config:function(e){return NR(na,e||{})},registerEffect:function(e){var t=e.name,n=e.effect,r=e.plugins,s=e.defaults,a=e.extendTimeline;(r||"").split(",").forEach(function(o){return o&&!$s[o]&&!aa[o]&&Bm(t+" effect requires "+o+" plugin.")}),yS[t]=function(o,l,c){return n(Ia(o),oa(l||{},s),c)},a&&(Jr.prototype[t]=function(o,l,c){return this.add(yS[t](o,el(l)?l:(c=l)&&{},this),c)})},registerEase:function(e,t){pn[e]=jh(t)},parseEase:function(e,t){return arguments.length?jh(e,t):pn},getById:function(e){return ui.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var n=new Jr(e),r,s;for(n.smoothChildTiming=Ms(e.smoothChildTiming),ui.remove(n),n._dp=0,n._time=n._tTime=ui._time,r=ui._first;r;)s=r._next,(t||!(!r._dur&&r instanceof Oi&&r.vars.onComplete===r._targets[0]))&&zo(n,r,r._start-r._delay),r=s;return zo(ui,n,0),n},context:function(e,t){return e?new TF(e,t):ii},matchMedia:function(e){return new oie(e)},matchMediaRefresh:function(){return Vh.forEach(function(e){var t=e.conditions,n,r;for(r in t)t[r]&&(t[r]=!1,n=1);n&&e.revert()})||h5()},addEventListener:function(e,t){var n=Dy[e]||(Dy[e]=[]);~n.indexOf(t)||n.push(t)},removeEventListener:function(e,t){var n=Dy[e],r=n&&n.indexOf(t);r>=0&&n.splice(r,1)},utils:{wrap:Fne,wrapYoyo:Bne,distribute:rF,random:aF,snap:sF,normalize:Une,getUnit:zr,clamp:Lne,splitColor:hF,toArray:Ia,selector:l5,mapRange:lF,pipe:One,unitize:zne,interpolate:Hne,shuffle:iF},install:WU,effects:yS,ticker:Ks,updateRoot:Jr.updateRoot,plugins:$s,globalTimeline:ui,core:{PropTween:As,globals:qU,Tween:Oi,Timeline:Jr,Animation:Gm,getCache:Bh,_removeLinkedListItem:Qb,reverting:function(){return Tr},context:function(e){return e&&ii&&(ii.data.push(e),e._ctx=ii),ii},suppressOverwrites:function(e){return CT=e}}};Ts("to,from,fromTo,delayedCall,set,killTweensOf",function(i){return sv[i]=Oi[i]});Ks.add(Jr.updateRoot);Nf=sv.to({},{duration:0});var lie=function(e,t){for(var n=e._pt;n&&n.p!==t&&n.op!==t&&n.fp!==t;)n=n._next;return n},cie=function(e,t){var n=e._targets,r,s,a;for(r in t)for(s=n.length;s--;)a=e._ptLookup[s][r],a&&(a=a.d)&&(a._pt&&(a=lie(a,r)),a&&a.modifier&&a.modifier(t[r],e,n[s],r))},wS=function(e,t){return{name:e,headless:1,rawVars:1,init:function(r,s,a){a._onInit=function(o){var l,c;if(dr(s)&&(l={},Ts(s,function(u){return l[u]=1}),s=l),t){l={};for(c in s)l[c]=t(s[c]);s=l}cie(o,s)}}}},Rs=sv.registerPlugin({name:"attr",init:function(e,t,n,r,s){var a,o,l;this.tween=n;for(a in t)l=e.getAttribute(a)||"",o=this.add(e,"setAttribute",(l||0)+"",t[a],r,s,0,0,a),o.op=a,o.b=l,this._props.push(a)},render:function(e,t){for(var n=t._pt;n;)Tr?n.set(n.t,n.p,n.b,n):n.r(e,n.d),n=n._next}},{name:"endArray",headless:1,init:function(e,t){for(var n=t.length;n--;)this.add(e,n,e[n]||0,t[n],0,0,0,0,0,1)}},wS("roundProps",c5),wS("modifiers"),wS("snap",sF))||sv;Oi.version=Jr.version=Rs.version="3.13.0";GU=1;RT()&&s0();pn.Power0;pn.Power1;pn.Power2;pn.Power3;pn.Power4;pn.Linear;pn.Quad;pn.Cubic;pn.Quart;pn.Quint;pn.Strong;pn.Elastic;pn.Back;pn.SteppedEase;pn.Bounce;pn.Sine;pn.Expo;pn.Circ;var FR,eu,jf,HT,Lh,BR,jT,uie=function(){return typeof window<"u"},uc={},Rh=180/Math.PI,Vf=Math.PI/180,Zd=Math.atan2,HR=1e8,VT=/([A-Z])/g,hie=/(left|right|width|margin|padding|x)/i,die=/[\s,\(]\S/,Bo={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},d5=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},fie=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},pie=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},mie=function(e,t){var n=t.s+t.c*e;t.set(t.t,t.p,~~(n+(n<0?-.5:.5))+t.u,t)},AF=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},CF=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},gie=function(e,t,n){return e.style[t]=n},xie=function(e,t,n){return e.style.setProperty(t,n)},yie=function(e,t,n){return e._gsap[t]=n},vie=function(e,t,n){return e._gsap.scaleX=e._gsap.scaleY=n},bie=function(e,t,n,r,s){var a=e._gsap;a.scaleX=a.scaleY=n,a.renderTransform(s,a)},_ie=function(e,t,n,r,s){var a=e._gsap;a[t]=n,a.renderTransform(s,a)},fi="transform",Cs=fi+"Origin",Sie=function i(e,t){var n=this,r=this.target,s=r.style,a=r._gsap;if(e in uc&&s){if(this.tfm=this.tfm||{},e!=="transform")e=Bo[e]||e,~e.indexOf(",")?e.split(",").forEach(function(o){return n.tfm[o]=jl(r,o)}):this.tfm[e]=a.x?a[e]:jl(r,e),e===Cs&&(this.tfm.zOrigin=a.zOrigin);else return Bo.transform.split(",").forEach(function(o){return i.call(n,o,t)});if(this.props.indexOf(fi)>=0)return;a.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(Cs,t,"")),e=fi}(s||t)&&this.props.push(e,t,s[e])},EF=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},wie=function(){var e=this.props,t=this.target,n=t.style,r=t._gsap,s,a;for(s=0;s<e.length;s+=3)e[s+1]?e[s+1]===2?t[e[s]](e[s+2]):t[e[s]]=e[s+2]:e[s+2]?n[e[s]]=e[s+2]:n.removeProperty(e[s].substr(0,2)==="--"?e[s]:e[s].replace(VT,"-$1").toLowerCase());if(this.tfm){for(a in this.tfm)r[a]=this.tfm[a];r.svg&&(r.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),s=jT(),(!s||!s.isStart)&&!n[fi]&&(EF(n),r.zOrigin&&n[Cs]&&(n[Cs]+=" "+r.zOrigin+"px",r.zOrigin=0,r.renderTransform()),r.uncache=1)}},RF=function(e,t){var n={target:e,props:[],revert:wie,save:Sie};return e._gsap||Rs.core.getCache(e),t&&e.style&&e.nodeType&&t.split(",").forEach(function(r){return n.save(r)}),n},PF,f5=function(e,t){var n=eu.createElementNS?eu.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):eu.createElement(e);return n&&n.style?n:eu.createElement(e)},Da=function i(e,t,n){var r=getComputedStyle(e);return r[t]||r.getPropertyValue(t.replace(VT,"-$1").toLowerCase())||r.getPropertyValue(t)||!n&&i(e,a0(t)||t,1)||""},jR="O,Moz,ms,Ms,Webkit".split(","),a0=function(e,t,n){var r=t||Lh,s=r.style,a=5;if(e in s&&!n)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);a--&&!(jR[a]+e in s););return a<0?null:(a===3?"ms":a>=0?jR[a]:"")+e},p5=function(){uie()&&window.document&&(FR=window,eu=FR.document,jf=eu.documentElement,Lh=f5("div")||{style:{}},f5("div"),fi=a0(fi),Cs=fi+"Origin",Lh.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",PF=!!a0("perspective"),jT=Rs.core.reverting,HT=1)},VR=function(e){var t=e.ownerSVGElement,n=f5("svg",t&&t.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),r=e.cloneNode(!0),s;r.style.display="block",n.appendChild(r),jf.appendChild(n);try{s=r.getBBox()}catch{}return n.removeChild(r),jf.removeChild(n),s},GR=function(e,t){for(var n=t.length;n--;)if(e.hasAttribute(t[n]))return e.getAttribute(t[n])},IF=function(e){var t,n;try{t=e.getBBox()}catch{t=VR(e),n=1}return t&&(t.width||t.height)||n||(t=VR(e)),t&&!t.width&&!t.x&&!t.y?{x:+GR(e,["x","cx","x1"])||0,y:+GR(e,["y","cy","y1"])||0,width:0,height:0}:t},DF=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&IF(e))},Qh=function(e,t){if(t){var n=e.style,r;t in uc&&t!==Cs&&(t=fi),n.removeProperty?(r=t.substr(0,2),(r==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),n.removeProperty(r==="--"?t:t.replace(VT,"-$1").toLowerCase())):n.removeAttribute(t)}},tu=function(e,t,n,r,s,a){var o=new As(e._pt,t,n,0,1,a?CF:AF);return e._pt=o,o.b=r,o.e=s,e._props.push(n),o},WR={deg:1,rad:1,turn:1},Mie={grid:1,flex:1},gu=function i(e,t,n,r){var s=parseFloat(n)||0,a=(n+"").trim().substr((s+"").length)||"px",o=Lh.style,l=hie.test(t),c=e.tagName.toLowerCase()==="svg",u=(c?"client":"offset")+(l?"Width":"Height"),d=100,p=r==="px",m=r==="%",g,y,x,_;if(r===a||!s||WR[r]||WR[a])return s;if(a!=="px"&&!p&&(s=i(e,t,n,"px")),_=e.getCTM&&DF(e),(m||a==="%")&&(uc[t]||~t.indexOf("adius")))return g=_?e.getBBox()[l?"width":"height"]:e[u],Ri(m?s/g*d:s/100*g);if(o[l?"width":"height"]=d+(p?a:r),y=r!=="rem"&&~t.indexOf("adius")||r==="em"&&e.appendChild&&!c?e:e.parentNode,_&&(y=(e.ownerSVGElement||{}).parentNode),(!y||y===eu||!y.appendChild)&&(y=eu.body),x=y._gsap,x&&m&&x.width&&l&&x.time===Ks.time&&!x.uncache)return Ri(s/x.width*d);if(m&&(t==="height"||t==="width")){var S=e.style[t];e.style[t]=d+r,g=e[u],S?e.style[t]=S:Qh(e,t)}else(m||a==="%")&&!Mie[Da(y,"display")]&&(o.position=Da(e,"position")),y===e&&(o.position="static"),y.appendChild(Lh),g=Lh[u],y.removeChild(Lh),o.position="absolute";return l&&m&&(x=Bh(y),x.time=Ks.time,x.width=y[u]),Ri(p?g*s/d:g&&s?d/g*s:0)},jl=function(e,t,n,r){var s;return HT||p5(),t in Bo&&t!=="transform"&&(t=Bo[t],~t.indexOf(",")&&(t=t.split(",")[0])),uc[t]&&t!=="transform"?(s=qm(e,r),s=t!=="transformOrigin"?s[t]:s.svg?s.origin:ov(Da(e,Cs))+" "+s.zOrigin+"px"):(s=e.style[t],(!s||s==="auto"||r||~(s+"").indexOf("calc("))&&(s=av[t]&&av[t](e,t,n)||Da(e,t)||YU(e,t)||(t==="opacity"?1:0))),n&&!~(s+"").trim().indexOf(" ")?gu(e,t,s,n)+n:s},Tie=function(e,t,n,r){if(!n||n==="none"){var s=a0(t,e,1),a=s&&Da(e,s,1);a&&a!==n?(t=s,n=a):t==="borderColor"&&(n=Da(e,"borderTopColor"))}var o=new As(this._pt,e.style,t,0,1,wF),l=0,c=0,u,d,p,m,g,y,x,_,S,w,T,C;if(o.b=n,o.e=r,n+="",r+="",r.substring(0,6)==="var(--"&&(r=Da(e,r.substring(4,r.indexOf(")")))),r==="auto"&&(y=e.style[t],e.style[t]=r,r=Da(e,t)||r,y?e.style[t]=y:Qh(e,t)),u=[n,r],fF(u),n=u[0],r=u[1],p=n.match(Df)||[],C=r.match(Df)||[],C.length){for(;d=Df.exec(r);)x=d[0],S=r.substring(l,d.index),g?g=(g+1)%5:(S.substr(-5)==="rgba("||S.substr(-5)==="hsla(")&&(g=1),x!==(y=p[c++]||"")&&(m=parseFloat(y)||0,T=y.substr((m+"").length),x.charAt(1)==="="&&(x=Hf(m,x)+T),_=parseFloat(x),w=x.substr((_+"").length),l=Df.lastIndex-w.length,w||(w=w||na.units[t]||T,l===r.length&&(r+=w,o.e+=w)),T!==w&&(m=gu(e,t,y,w)||0),o._pt={_next:o._pt,p:S||c===1?S:",",s:m,c:_-m,m:g&&g<4||t==="zIndex"?Math.round:0});o.c=l<r.length?r.substring(l,r.length):""}else o.r=t==="display"&&r==="none"?CF:AF;return jU.test(r)&&(o.e=0),this._pt=o,o},qR={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Aie=function(e){var t=e.split(" "),n=t[0],r=t[1]||"50%";return(n==="top"||n==="bottom"||r==="left"||r==="right")&&(e=n,n=r,r=e),t[0]=qR[n]||n,t[1]=qR[r]||r,t.join(" ")},Cie=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var n=t.t,r=n.style,s=t.u,a=n._gsap,o,l,c;if(s==="all"||s===!0)r.cssText="",l=1;else for(s=s.split(","),c=s.length;--c>-1;)o=s[c],uc[o]&&(l=1,o=o==="transformOrigin"?Cs:fi),Qh(n,o);l&&(Qh(n,fi),a&&(a.svg&&n.removeAttribute("transform"),r.scale=r.rotate=r.translate="none",qm(n,1),a.uncache=1,EF(r)))}},av={clearProps:function(e,t,n,r,s){if(s.data!=="isFromStart"){var a=e._pt=new As(e._pt,t,n,0,0,Cie);return a.u=r,a.pr=-10,a.tween=s,e._props.push(n),1}}},Wm=[1,0,0,1,0,0],NF={},LF=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},XR=function(e){var t=Da(e,fi);return LF(t)?Wm:t.substr(7).match(HU).map(Ri)},GT=function(e,t){var n=e._gsap||Bh(e),r=e.style,s=XR(e),a,o,l,c;return n.svg&&e.getAttribute("transform")?(l=e.transform.baseVal.consolidate().matrix,s=[l.a,l.b,l.c,l.d,l.e,l.f],s.join(",")==="1,0,0,1,0,0"?Wm:s):(s===Wm&&!e.offsetParent&&e!==jf&&!n.svg&&(l=r.display,r.display="block",a=e.parentNode,(!a||!e.offsetParent&&!e.getBoundingClientRect().width)&&(c=1,o=e.nextElementSibling,jf.appendChild(e)),s=XR(e),l?r.display=l:Qh(e,"display"),c&&(o?a.insertBefore(e,o):a?a.appendChild(e):jf.removeChild(e))),t&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},m5=function(e,t,n,r,s,a){var o=e._gsap,l=s||GT(e,!0),c=o.xOrigin||0,u=o.yOrigin||0,d=o.xOffset||0,p=o.yOffset||0,m=l[0],g=l[1],y=l[2],x=l[3],_=l[4],S=l[5],w=t.split(" "),T=parseFloat(w[0])||0,C=parseFloat(w[1])||0,E,D,O,R;n?l!==Wm&&(D=m*x-g*y)&&(O=T*(x/D)+C*(-y/D)+(y*S-x*_)/D,R=T*(-g/D)+C*(m/D)-(m*S-g*_)/D,T=O,C=R):(E=IF(e),T=E.x+(~w[0].indexOf("%")?T/100*E.width:T),C=E.y+(~(w[1]||w[0]).indexOf("%")?C/100*E.height:C)),r||r!==!1&&o.smooth?(_=T-c,S=C-u,o.xOffset=d+(_*m+S*y)-_,o.yOffset=p+(_*g+S*x)-S):o.xOffset=o.yOffset=0,o.xOrigin=T,o.yOrigin=C,o.smooth=!!r,o.origin=t,o.originIsAbsolute=!!n,e.style[Cs]="0px 0px",a&&(tu(a,o,"xOrigin",c,T),tu(a,o,"yOrigin",u,C),tu(a,o,"xOffset",d,o.xOffset),tu(a,o,"yOffset",p,o.yOffset)),e.setAttribute("data-svg-origin",T+" "+C)},qm=function(e,t){var n=e._gsap||new xF(e);if("x"in n&&!t&&!n.uncache)return n;var r=e.style,s=n.scaleX<0,a="px",o="deg",l=getComputedStyle(e),c=Da(e,Cs)||"0",u,d,p,m,g,y,x,_,S,w,T,C,E,D,O,R,P,L,V,j,B,J,U,X,$,Q,se,ye,we,He,De,Oe;return u=d=p=y=x=_=S=w=T=0,m=g=1,n.svg=!!(e.getCTM&&DF(e)),l.translate&&((l.translate!=="none"||l.scale!=="none"||l.rotate!=="none")&&(r[fi]=(l.translate!=="none"?"translate3d("+(l.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(l.rotate!=="none"?"rotate("+l.rotate+") ":"")+(l.scale!=="none"?"scale("+l.scale.split(" ").join(",")+") ":"")+(l[fi]!=="none"?l[fi]:"")),r.scale=r.rotate=r.translate="none"),D=GT(e,n.svg),n.svg&&(n.uncache?($=e.getBBox(),c=n.xOrigin-$.x+"px "+(n.yOrigin-$.y)+"px",X=""):X=!t&&e.getAttribute("data-svg-origin"),m5(e,X||c,!!X||n.originIsAbsolute,n.smooth!==!1,D)),C=n.xOrigin||0,E=n.yOrigin||0,D!==Wm&&(L=D[0],V=D[1],j=D[2],B=D[3],u=J=D[4],d=U=D[5],D.length===6?(m=Math.sqrt(L*L+V*V),g=Math.sqrt(B*B+j*j),y=L||V?Zd(V,L)*Rh:0,S=j||B?Zd(j,B)*Rh+y:0,S&&(g*=Math.abs(Math.cos(S*Vf))),n.svg&&(u-=C-(C*L+E*j),d-=E-(C*V+E*B))):(Oe=D[6],He=D[7],se=D[8],ye=D[9],we=D[10],De=D[11],u=D[12],d=D[13],p=D[14],O=Zd(Oe,we),x=O*Rh,O&&(R=Math.cos(-O),P=Math.sin(-O),X=J*R+se*P,$=U*R+ye*P,Q=Oe*R+we*P,se=J*-P+se*R,ye=U*-P+ye*R,we=Oe*-P+we*R,De=He*-P+De*R,J=X,U=$,Oe=Q),O=Zd(-j,we),_=O*Rh,O&&(R=Math.cos(-O),P=Math.sin(-O),X=L*R-se*P,$=V*R-ye*P,Q=j*R-we*P,De=B*P+De*R,L=X,V=$,j=Q),O=Zd(V,L),y=O*Rh,O&&(R=Math.cos(O),P=Math.sin(O),X=L*R+V*P,$=J*R+U*P,V=V*R-L*P,U=U*R-J*P,L=X,J=$),x&&Math.abs(x)+Math.abs(y)>359.9&&(x=y=0,_=180-_),m=Ri(Math.sqrt(L*L+V*V+j*j)),g=Ri(Math.sqrt(U*U+Oe*Oe)),O=Zd(J,U),S=Math.abs(O)>2e-4?O*Rh:0,T=De?1/(De<0?-De:De):0),n.svg&&(X=e.getAttribute("transform"),n.forceCSS=e.setAttribute("transform","")||!LF(Da(e,fi)),X&&e.setAttribute("transform",X))),Math.abs(S)>90&&Math.abs(S)<270&&(s?(m*=-1,S+=y<=0?180:-180,y+=y<=0?180:-180):(g*=-1,S+=S<=0?180:-180)),t=t||n.uncache,n.x=u-((n.xPercent=u&&(!t&&n.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-u)?-50:0)))?e.offsetWidth*n.xPercent/100:0)+a,n.y=d-((n.yPercent=d&&(!t&&n.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-d)?-50:0)))?e.offsetHeight*n.yPercent/100:0)+a,n.z=p+a,n.scaleX=Ri(m),n.scaleY=Ri(g),n.rotation=Ri(y)+o,n.rotationX=Ri(x)+o,n.rotationY=Ri(_)+o,n.skewX=S+o,n.skewY=w+o,n.transformPerspective=T+a,(n.zOrigin=parseFloat(c.split(" ")[2])||!t&&n.zOrigin||0)&&(r[Cs]=ov(c)),n.xOffset=n.yOffset=0,n.force3D=na.force3D,n.renderTransform=n.svg?Rie:PF?kF:Eie,n.uncache=0,n},ov=function(e){return(e=e.split(" "))[0]+" "+e[1]},MS=function(e,t,n){var r=zr(t);return Ri(parseFloat(t)+parseFloat(gu(e,"x",n+"px",r)))+r},Eie=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,kF(e,t)},sh="0deg",Tp="0px",ah=") ",kF=function(e,t){var n=t||this,r=n.xPercent,s=n.yPercent,a=n.x,o=n.y,l=n.z,c=n.rotation,u=n.rotationY,d=n.rotationX,p=n.skewX,m=n.skewY,g=n.scaleX,y=n.scaleY,x=n.transformPerspective,_=n.force3D,S=n.target,w=n.zOrigin,T="",C=_==="auto"&&e&&e!==1||_===!0;if(w&&(d!==sh||u!==sh)){var E=parseFloat(u)*Vf,D=Math.sin(E),O=Math.cos(E),R;E=parseFloat(d)*Vf,R=Math.cos(E),a=MS(S,a,D*R*-w),o=MS(S,o,-Math.sin(E)*-w),l=MS(S,l,O*R*-w+w)}x!==Tp&&(T+="perspective("+x+ah),(r||s)&&(T+="translate("+r+"%, "+s+"%) "),(C||a!==Tp||o!==Tp||l!==Tp)&&(T+=l!==Tp||C?"translate3d("+a+", "+o+", "+l+") ":"translate("+a+", "+o+ah),c!==sh&&(T+="rotate("+c+ah),u!==sh&&(T+="rotateY("+u+ah),d!==sh&&(T+="rotateX("+d+ah),(p!==sh||m!==sh)&&(T+="skew("+p+", "+m+ah),(g!==1||y!==1)&&(T+="scale("+g+", "+y+ah),S.style[fi]=T||"translate(0, 0)"},Rie=function(e,t){var n=t||this,r=n.xPercent,s=n.yPercent,a=n.x,o=n.y,l=n.rotation,c=n.skewX,u=n.skewY,d=n.scaleX,p=n.scaleY,m=n.target,g=n.xOrigin,y=n.yOrigin,x=n.xOffset,_=n.yOffset,S=n.forceCSS,w=parseFloat(a),T=parseFloat(o),C,E,D,O,R;l=parseFloat(l),c=parseFloat(c),u=parseFloat(u),u&&(u=parseFloat(u),c+=u,l+=u),l||c?(l*=Vf,c*=Vf,C=Math.cos(l)*d,E=Math.sin(l)*d,D=Math.sin(l-c)*-p,O=Math.cos(l-c)*p,c&&(u*=Vf,R=Math.tan(c-u),R=Math.sqrt(1+R*R),D*=R,O*=R,u&&(R=Math.tan(u),R=Math.sqrt(1+R*R),C*=R,E*=R)),C=Ri(C),E=Ri(E),D=Ri(D),O=Ri(O)):(C=d,O=p,E=D=0),(w&&!~(a+"").indexOf("px")||T&&!~(o+"").indexOf("px"))&&(w=gu(m,"x",a,"px"),T=gu(m,"y",o,"px")),(g||y||x||_)&&(w=Ri(w+g-(g*C+y*D)+x),T=Ri(T+y-(g*E+y*O)+_)),(r||s)&&(R=m.getBBox(),w=Ri(w+r/100*R.width),T=Ri(T+s/100*R.height)),R="matrix("+C+","+E+","+D+","+O+","+w+","+T+")",m.setAttribute("transform",R),S&&(m.style[fi]=R)},Pie=function(e,t,n,r,s){var a=360,o=dr(s),l=parseFloat(s)*(o&&~s.indexOf("rad")?Rh:1),c=l-r,u=r+c+"deg",d,p;return o&&(d=s.split("_")[1],d==="short"&&(c%=a,c!==c%(a/2)&&(c+=c<0?a:-a)),d==="cw"&&c<0?c=(c+a*HR)%a-~~(c/a)*a:d==="ccw"&&c>0&&(c=(c-a*HR)%a-~~(c/a)*a)),e._pt=p=new As(e._pt,t,n,r,c,fie),p.e=u,p.u="deg",e._props.push(n),p},YR=function(e,t){for(var n in t)e[n]=t[n];return e},Iie=function(e,t,n){var r=YR({},n._gsap),s="perspective,force3D,transformOrigin,svgOrigin",a=n.style,o,l,c,u,d,p,m,g;r.svg?(c=n.getAttribute("transform"),n.setAttribute("transform",""),a[fi]=t,o=qm(n,1),Qh(n,fi),n.setAttribute("transform",c)):(c=getComputedStyle(n)[fi],a[fi]=t,o=qm(n,1),a[fi]=c);for(l in uc)c=r[l],u=o[l],c!==u&&s.indexOf(l)<0&&(m=zr(c),g=zr(u),d=m!==g?gu(n,l,c,g):parseFloat(c),p=parseFloat(u),e._pt=new As(e._pt,o,l,d,p-d,d5),e._pt.u=g||0,e._props.push(l));YR(o,r)};Ts("padding,margin,Width,Radius",function(i,e){var t="Top",n="Right",r="Bottom",s="Left",a=(e<3?[t,n,r,s]:[t+s,t+n,r+n,r+s]).map(function(o){return e<2?i+o:"border"+o+i});av[e>1?"border"+i:i]=function(o,l,c,u,d){var p,m;if(arguments.length<4)return p=a.map(function(g){return jl(o,g,c)}),m=p.join(" "),m.split(p[0]).length===5?p[0]:m;p=(u+"").split(" "),m={},a.forEach(function(g,y){return m[g]=p[y]=p[y]||p[(y-1)/2|0]}),o.init(l,m,d)}});var OF={name:"css",register:p5,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,n,r,s){var a=this._props,o=e.style,l=n.vars.startAt,c,u,d,p,m,g,y,x,_,S,w,T,C,E,D,O;HT||p5(),this.styles=this.styles||RF(e),O=this.styles.props,this.tween=n;for(y in t)if(y!=="autoRound"&&(u=t[y],!($s[y]&&yF(y,t,n,r,e,s)))){if(m=typeof u,g=av[y],m==="function"&&(u=u.call(n,r,e,s),m=typeof u),m==="string"&&~u.indexOf("random(")&&(u=jm(u)),g)g(this,e,y,u,n)&&(D=1);else if(y.substr(0,2)==="--")c=(getComputedStyle(e).getPropertyValue(y)+"").trim(),u+="",cu.lastIndex=0,cu.test(c)||(x=zr(c),_=zr(u)),_?x!==_&&(c=gu(e,y,c,_)+_):x&&(u+=x),this.add(o,"setProperty",c,u,r,s,0,0,y),a.push(y),O.push(y,0,o[y]);else if(m!=="undefined"){if(l&&y in l?(c=typeof l[y]=="function"?l[y].call(n,r,e,s):l[y],dr(c)&&~c.indexOf("random(")&&(c=jm(c)),zr(c+"")||c==="auto"||(c+=na.units[y]||zr(jl(e,y))||""),(c+"").charAt(1)==="="&&(c=jl(e,y))):c=jl(e,y),p=parseFloat(c),S=m==="string"&&u.charAt(1)==="="&&u.substr(0,2),S&&(u=u.substr(2)),d=parseFloat(u),y in Bo&&(y==="autoAlpha"&&(p===1&&jl(e,"visibility")==="hidden"&&d&&(p=0),O.push("visibility",0,o.visibility),tu(this,o,"visibility",p?"inherit":"hidden",d?"inherit":"hidden",!d)),y!=="scale"&&y!=="transform"&&(y=Bo[y],~y.indexOf(",")&&(y=y.split(",")[0]))),w=y in uc,w){if(this.styles.save(y),m==="string"&&u.substring(0,6)==="var(--"&&(u=Da(e,u.substring(4,u.indexOf(")"))),d=parseFloat(u)),T||(C=e._gsap,C.renderTransform&&!t.parseTransform||qm(e,t.parseTransform),E=t.smoothOrigin!==!1&&C.smooth,T=this._pt=new As(this._pt,o,fi,0,1,C.renderTransform,C,0,-1),T.dep=1),y==="scale")this._pt=new As(this._pt,C,"scaleY",C.scaleY,(S?Hf(C.scaleY,S+d):d)-C.scaleY||0,d5),this._pt.u=0,a.push("scaleY",y),y+="X";else if(y==="transformOrigin"){O.push(Cs,0,o[Cs]),u=Aie(u),C.svg?m5(e,u,0,E,0,this):(_=parseFloat(u.split(" ")[2])||0,_!==C.zOrigin&&tu(this,C,"zOrigin",C.zOrigin,_),tu(this,o,y,ov(c),ov(u)));continue}else if(y==="svgOrigin"){m5(e,u,1,E,0,this);continue}else if(y in NF){Pie(this,C,y,p,S?Hf(p,S+u):u);continue}else if(y==="smoothOrigin"){tu(this,C,"smooth",C.smooth,u);continue}else if(y==="force3D"){C[y]=u;continue}else if(y==="transform"){Iie(this,u,e);continue}}else y in o||(y=a0(y)||y);if(w||(d||d===0)&&(p||p===0)&&!die.test(u)&&y in o)x=(c+"").substr((p+"").length),d||(d=0),_=zr(u)||(y in na.units?na.units[y]:x),x!==_&&(p=gu(e,y,c,_)),this._pt=new As(this._pt,w?C:o,y,p,(S?Hf(p,S+d):d)-p,!w&&(_==="px"||y==="zIndex")&&t.autoRound!==!1?mie:d5),this._pt.u=_||0,x!==_&&_!=="%"&&(this._pt.b=c,this._pt.r=pie);else if(y in o)Tie.call(this,e,y,c,S?S+u:u);else if(y in e)this.add(e,y,c||e[y],S?S+u:u,r,s);else if(y!=="parseTransform"){IT(y,u);continue}w||(y in o?O.push(y,0,o[y]):typeof e[y]=="function"?O.push(y,2,e[y]()):O.push(y,1,c||e[y])),a.push(y)}}D&&MF(this)},render:function(e,t){if(t.tween._time||!jT())for(var n=t._pt;n;)n.r(e,n.d),n=n._next;else t.styles.revert()},get:jl,aliases:Bo,getSetter:function(e,t,n){var r=Bo[t];return r&&r.indexOf(",")<0&&(t=r),t in uc&&t!==Cs&&(e._gsap.x||jl(e,"x"))?n&&BR===n?t==="scale"?vie:yie:(BR=n||{})&&(t==="scale"?bie:_ie):e.style&&!ET(e.style[t])?gie:~t.indexOf("-")?xie:FT(e,t)},core:{_removeProperty:Qh,_getMatrix:GT}};Rs.utils.checkPrefix=a0;Rs.core.getStyleSaver=RF;(function(i,e,t,n){var r=Ts(i+","+e+","+t,function(s){uc[s]=1});Ts(e,function(s){na.units[s]="deg",NF[s]=1}),Bo[r[13]]=i+","+e,Ts(n,function(s){var a=s.split(":");Bo[a[1]]=r[a[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");Ts("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(i){na.units[i]="px"});Rs.registerPlugin(OF);var nu=Rs.registerPlugin(OF)||Rs;nu.core.Tween;function WT(){const i=Hn(r=>r.setView),e=z.useRef(null);z.useEffect(()=>()=>{e.current&&e.current.kill()},[]);const t=z.useCallback((r,s,a)=>{e.current&&e.current.kill();const o=Hn.getState().view,l=(r-o.yawDeg)%360,c=2*l%360-l,u=o.yawDeg+c,d={yaw:o.yawDeg,pitch:o.pitchDeg,scale:o.scale},p=nu.timeline({onUpdate:()=>{i({yawDeg:d.yaw,pitchDeg:d.pitch,scale:d.scale})},onComplete:()=>{e.current=null}});e.current=p,o.scale>1&&a>1?(p.to(d,{yaw:u,pitch:s,duration:2,ease:"power2.inOut"},0),p.to(d,{scale:1,duration:1,ease:"power2.inOut"},0),p.to(d,{scale:a,duration:1,ease:"power2.inOut"},1)):p.to(d,{yaw:u,pitch:s,scale:a,duration:1.5,ease:"power3.inOut"},0)},[i]),n=z.useCallback(()=>{e.current&&(e.current.kill(),e.current=null)},[]);return{animateToView:t,stopAnimation:n}}cl({Container:Fi});const $R=.9,KR=.01,Die=.1,Nie=1e3,c1=1;function Lie({children:i}){const{app:e}=D0(),{view:t,setView:n}=Hn(Tt(g=>({view:g.view,setView:g.setView}))),{stopAnimation:r}=WT(),s=z.useRef(t);z.useEffect(()=>Hn.subscribe(y=>{s.current=y.view}),[]);const a=z.useRef(!1),o=z.useRef(null),l=z.useRef({vx:0,vy:0});Zb(g=>{if(a.current||Math.abs(l.current.vx)<KR&&Math.abs(l.current.vy)<KR)return;const y=g.deltaTime,x=s.current.scale,_=l.current.vx/x*y,S=l.current.vy/x*y,w=tE(s.current.yawDeg+_),T=Zn(s.current.pitchDeg-S,-89.5,89.5);n({yawDeg:w,pitchDeg:T}),l.current.vx*=$R,l.current.vy*=$R});const c=z.useCallback(g=>{g.stopPropagation(),r(),a.current=!0,o.current={x:g.global.x,y:g.global.y},l.current={vx:0,vy:0},e?.renderer&&(e.renderer.events.cursorStyles.default="grabbing",e.renderer.events.setCursor("grabbing"))},[e,r]),u=z.useCallback(()=>{a.current=!1,o.current=null,e?.renderer&&(e.renderer.events.cursorStyles.default="grab",e.renderer.events.setCursor("grab"))},[e]),d=z.useCallback(g=>{if(!a.current||!o.current)return;const y=g.global.x,x=g.global.y,_=y-o.current.x,S=x-o.current.y;o.current={x:y,y:x};const w=s.current.scale;n({yawDeg:tE(s.current.yawDeg-_*c1/w),pitchDeg:Zn(s.current.pitchDeg+S*c1/w,-89.5,89.5)}),l.current={vx:-_*c1,vy:-S*c1}},[n]),p=z.useCallback(g=>{r(),l.current={vx:0,vy:0};const y=Math.exp(-.0015*g.deltaY),x=Zn(s.current.scale*y,Die,Nie);n({scale:x})},[n,r]),m=e===void 0||e.renderer===void 0?null:e.canvas;return z.useEffect(()=>{if(!e?.renderer||!m)return;const g=y=>y.preventDefault();return m.addEventListener("wheel",g,{passive:!1}),()=>{m.removeEventListener("wheel",g)}},[e,m]),!e||!e.renderer||!m?null:v.jsx("pixiContainer",{hitArea:e.screen,eventMode:"static",onPointerDown:c,onPointerUp:u,onPointerUpOutside:u,onGlobalPointerMove:d,onWheel:p,children:i})}cl({Container:Fi,Text:Zee});function kie(){const i=Hn(t=>t.hoveredFootprintId),e=Hn(t=>t.hoveredFootprintMousePosition);return!i||!e?null:v.jsx("pixiContainer",{eventMode:"passive",children:v.jsx("pixiText",{x:e.x+12,y:e.y+12,roundPixels:!0,text:`ID: ${i}`,style:{fontSize:12,fill:16777215,stroke:{color:0,width:3,alignment:.5},dropShadow:{color:0,blur:2,distance:2,alpha:.4}}})})}const u1={strokeNormal:6497874,hoveredFill:3355443,strokeSelected:11141120};class Oie extends Fi{footprints=[];graphicsMap=new Map;onFootprintHover;onFootprintSelect;hoveredFootprintId=null;selectedFootprintId=null;constructor(){super(),this.sortableChildren=!0}bindEvents(e,t){e.on("pointerover",n=>{this.onFootprintHover?.(t,{x:n.global.x,y:n.global.y})}),e.on("pointerout",()=>{this.onFootprintHover?.(null)}),e.on("pointermove",n=>{this.hoveredFootprintId===t&&this.onFootprintHover?.(t,{x:n.global.x,y:n.global.y})}),e.on("click",n=>{n.stopPropagation(),this.onFootprintSelect?.(t)})}setFootprints(e){this.footprints=e;const t=new Set(this.graphicsMap.keys());e.forEach(n=>{if(this.graphicsMap.has(n.id))t.delete(n.id);else{const r=new Jo;r.label=n.id,r.eventMode="dynamic",this.bindEvents(r,n.id),this.addChild(r),this.graphicsMap.set(n.id,r)}}),t.forEach(n=>{const r=this.graphicsMap.get(n);r&&(r.destroy(),this.graphicsMap.delete(n))})}updateInteractiveState(e,t){this.hoveredFootprintId=e,this.selectedFootprintId=t,this.sortChildren()}renderFrame(e,t){const{centerX:n,centerY:r,initialRadius:s}=t;this.footprints.forEach(a=>{const o=this.graphicsMap.get(a.id);if(!o)return;const l=a.vertices.map(m=>ML(m.ra,m.dec,e.yawDeg,e.pitchDeg));if(!l.every(m=>m.visible)){o.visible=!1;return}o.visible=!0;const u=l.map(m=>TL(m,n,r,e.scale,s)).flatMap(m=>[m.x,m.y]);o.hitArea=new Bf(u),o.clear(),o.poly(u);const d=this.selectedFootprintId===a.id,p=this.hoveredFootprintId===a.id;d?(o.stroke({color:u1.strokeSelected,width:2}),o.zIndex=3):p?(o.fill({color:u1.hoveredFill,alpha:.2}).stroke({color:u1.strokeNormal,width:1}),o.zIndex=2):(o.stroke({color:u1.strokeNormal,width:1}),o.zIndex=1)})}}cl({FootprintContainer:Oie});function zie({layerRef:i}){const{app:e}=D0(),{footprints:t,globeBackground:n,hoveredFootprintId:r,selectedFootprintId:s,setHoveredFootprintId:a,setHoveredFootprintMousePosition:o,setSelectedFootprintId:l}=Hn(Tt(d=>({footprints:d.footprints,globeBackground:d.globeBackground,hoveredFootprintId:d.hoveredFootprintId,selectedFootprintId:d.selectedFootprintId,setHoveredFootprintId:d.setHoveredFootprintId,setHoveredFootprintMousePosition:d.setHoveredFootprintMousePosition,setSelectedFootprintId:d.setSelectedFootprintId}))),c=z.useRef(null);z.useEffect(()=>{const d=i.current,p=c.current;if(!(!d||!p))return d.attach(p),()=>{d.detach(p)}},[i]),z.useEffect(()=>{c.current&&c.current.setFootprints(t)},[t]),z.useEffect(()=>{c.current&&(c.current.onFootprintHover=(d,p)=>{a(d),o(p||null)},c.current.onFootprintSelect=d=>{const p=Hn.getState().selectedFootprintId;l(p===d?null:d)})},[a,o,l]),z.useEffect(()=>{c.current&&c.current.updateInteractiveState(r,s)},[r,s]);const u=z.useRef(Hn.getState().view);return z.useEffect(()=>Hn.subscribe(d=>{u.current=d.view}),[]),Zb(()=>{c.current&&e&&c.current.renderFrame(u.current,n)}),v.jsx("pixiFootprintContainer",{ref:c})}cl({Container:Fi,RenderLayer:MU});function Uie(){const i=z.useRef(null),e=z.useRef(null),t=z.useRef(null);Hn(a=>a.setGlobeBackground)({centerX:400,centerY:300,initialRadius:Math.min(800,600)/2*.9});const r=Hn(a=>a.setFootprints),s=AL({queryKey:["grism_footprints"],path:"/overview/grism_footprints"});return z.useEffect(()=>{if(!s.isSuccess)return;const o=(s.data??[]).map(l=>({id:l.id,vertices:l.footprint.vertices.map(c=>({ra:c[0],dec:c[1]})),meta:{...l.meta,center:{ra:l.footprint.center[0],dec:l.footprint.center[1]}}}));r(o)},[s.data,s.isSuccess,r]),v.jsx(qe,{ref:i,width:"800px",height:"600px",border:"1px solid black",children:v.jsx(zU,{resizeTo:i,backgroundColor:16777215,resolution:1,antialias:!0,autoDensity:!0,children:v.jsxs(Lie,{children:[v.jsx("pixiRenderLayer",{ref:t,sortableChildren:!0}),v.jsx("pixiRenderLayer",{ref:e,sortableChildren:!0}),v.jsx(zie,{layerRef:e}),v.jsx(mne,{layerRef:t}),v.jsx(fne,{layerRef:t}),v.jsx(kie,{})]})})})}function Fie(){const{animateToView:i}=WT(),{footprints:e,selectedFootprintId:t,setSelectedFootprintId:n,setFootprintMeta:r}=Hn(Tt(o=>({footprints:o.footprints,selectedFootprintId:o.selectedFootprintId,setSelectedFootprintId:o.setSelectedFootprintId,setFootprintMeta:o.setFootprintMeta,setView:o.setView}))),s=z.useMemo(()=>e.map(o=>{const l=o.meta?.center,c=o.meta?.included_files||[],u=o.meta?.selected_file,d=(u&&c.includes(u)?u:void 0)??c[0]??"",p=oc({items:c.map(m=>({label:m,value:m}))});return{fp:o,center:l,included_files:c,current:d,collection:p}}),[e]),a=o=>{n(t===o?null:o)};return e.length===0?v.jsx(qe,{p:3,children:v.jsx(ke,{color:"fg.muted",children:"No footprints loaded."})}):v.jsx(wt,{gap:3,p:3,children:s.map(({fp:o,center:l,included_files:c,current:u,collection:d})=>{const p=t===o.id;return v.jsxs(qe,{rounded:"md",borderWidth:"1px",borderColor:p?"blue.400":"border.subtle",bg:p?"blue.subtle":"transparent",_hover:{bg:p?"blue.subtle":"bg.muted"},cursor:"pointer",onClick:()=>a(o.id),transition:"background 0.15s ease",children:[v.jsxs(gt,{justify:"space-between",p:2,pe:3,children:[v.jsx(ke,{fontWeight:"medium",children:o.id}),v.jsx(ec,{colorPalette:p?"blue":"gray",children:p?"Selected":"Select"})]}),v.jsxs(gt,{px:3,pb:2,wrap:"wrap",gap:3,children:[v.jsxs(ke,{fontSize:"sm",color:"fg.muted",children:["RA: ",Number.isFinite(l?.ra)?l?.ra.toFixed(5):"--",""]}),v.jsxs(ke,{fontSize:"sm",color:"fg.muted",children:["Dec:"," ",Number.isFinite(l?.dec)?l?.dec.toFixed(5):"--",""]})]}),v.jsx(qe,{px:3,pb:2,onClick:m=>m.stopPropagation(),children:c.length>0?v.jsxs(Hb,{collection:d,size:"sm",width:"100%",value:u?[u]:[],disabled:!p,onValueChange:({value:m})=>r(o.id,"selected_file",m?.[0]??null),positioning:{sameWidth:!0},children:[v.jsx(lT,{}),v.jsx(kK,{children:"File to show"}),v.jsxs(oT,{children:[v.jsx(jb,{children:v.jsx(Wb,{placeholder:"No items"})}),v.jsx(LK,{children:v.jsx(ZO,{})})]}),v.jsx(Vb,{children:v.jsx(Gb,{children:d.items.map(m=>v.jsxs(qb,{item:m,children:[m.label,v.jsx(aT,{})]},m.value))})})]}):v.jsx(ke,{fontSize:"sm",color:"fg.muted",children:"No included files"})}),v.jsx(gt,{p:3,pt:1,gap:2,justify:"flex-end",children:v.jsx(hr,{size:"sm",onClick:m=>{if(m.stopPropagation(),l){const{yawDeg:g,pitchDeg:y}=CL(l.ra,l.dec);i(g,y,200)}},children:"Goto"})})]},o.id)})})}function Bie(){const i=Hn(y=>y.view),{animateToView:e}=WT(),t=z.useMemo(()=>LY(i.yawDeg,i.pitchDeg),[i.yawDeg,i.pitchDeg]),[n,r]=z.useState(t.ra),[s,a]=z.useState(t.dec),[o,l]=z.useState(!1),[c,u]=z.useState(!1),d=z.useCallback(()=>{const y=o?n:t.ra,x=c?s:t.dec,{yawDeg:_,pitchDeg:S}=CL(y,x);e(_,S,200),l(!1),u(!1)},[n,s,o,c,t.ra,t.dec,e]),p=z.useCallback(()=>{e(0,0,1),l(!1),u(!1)},[e]),m=o?n:t.ra,g=c?s:t.dec;return v.jsx(qe,{display:"inline-flex",flexDirection:"column",gap:"8px",children:v.jsxs(gt,{gap:2,p:"6px 10px",rounded:"md",boxShadow:"sm",children:[v.jsxs(gt,{gap:1,children:[v.jsx(ke,{children:"RA"}),v.jsx(qo,{size:"sm",maxW:"120px",value:String(m),onValueChange:({valueAsNumber:y})=>{r(Number.isNaN(y)?0:y),l(!0)},children:v.jsx(Xo,{placeholder:Number.isFinite(t.ra)?t.ra.toFixed(4):""})})]}),v.jsxs(gt,{gap:1,children:[v.jsx(ke,{children:"Dec"}),v.jsx(qo,{size:"sm",maxW:"120px",value:String(g),onValueChange:({valueAsNumber:y})=>{a(Number.isNaN(y)?0:y),u(!0)},children:v.jsx(Xo,{placeholder:Number.isFinite(t.dec)?t.dec.toFixed(4):""})})]}),v.jsx(hr,{size:"sm",onClick:d,children:"Go To"}),v.jsx(hr,{size:"sm",onClick:p,children:"Reset View"})]})})}function Hie(){return v.jsxs(gt,{align:"start",gap:10,width:"max-content",height:"100%",wrap:"nowrap",children:[v.jsxs(qe,{position:"relative",children:[v.jsx(Uie,{}),v.jsx(WK,{position:"absolute",top:"8px",left:"8px",children:v.jsx(Bie,{})})]}),v.jsx(qe,{minW:"400px",h:"600px",flexShrink:0,overflowY:"auto",borderWidth:"1px",borderColor:"border.subtle",borderRadius:"md",bg:"bg",overscrollBehavior:"contain",children:v.jsx(Fie,{})})]})}const Vg="181",Vl={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Gl={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},zF=0,g5=1,UF=2,jie=3,FF=0,t2=1,fm=2,io=3,hc=0,as=1,co=2,Yo=0,Gh=1,x5=2,y5=3,v5=4,BF=5,Kc=100,HF=101,jF=102,VF=103,GF=104,WF=200,qF=201,XF=202,YF=203,lv=204,cv=205,$F=206,KF=207,ZF=208,QF=209,JF=210,eB=211,tB=212,nB=213,iB=214,uv=0,hv=1,dv=2,Jh=3,fv=4,pv=5,mv=6,gv=7,Gg=0,rB=1,sB=2,$o=0,aB=1,oB=2,lB=3,qT=4,cB=5,uB=6,hB=7,b5="attached",dB="detached",n2=300,dc=301,xu=302,Xm=303,Ym=304,N0=306,$m=1e3,or=1001,Km=1002,qi=1003,XT=1004,Vie=1004,Lf=1005,Gie=1005,Jn=1006,pm=1007,Wie=1007,Ho=1008,qie=1008,za=1009,YT=1010,$T=1011,o0=1012,i2=1013,fc=1014,ns=1015,bc=1016,r2=1017,s2=1018,l0=1020,KT=35902,ZT=35899,QT=1021,JT=1022,Fr=1023,c0=1026,u0=1027,Wg=1028,qg=1029,a2=1030,o2=1031,Xie=1032,l2=1033,mm=33776,gm=33777,xm=33778,ym=33779,xv=35840,yv=35841,vv=35842,bv=35843,_v=36196,Sv=37492,wv=37496,Mv=37808,Tv=37809,Av=37810,Cv=37811,Ev=37812,Rv=37813,Pv=37814,Iv=37815,Dv=37816,Nv=37817,Lv=37818,kv=37819,Ov=37820,zv=37821,Uv=36492,Fv=36494,Bv=36495,Hv=36283,jv=36284,Vv=36285,Gv=36286,fB=2200,pB=2201,mB=2202,Zm=2300,Wv=2301,Ny=2302,kh=2400,Oh=2401,Qm=2402,c2=2500,eA=2501,Yie=0,$ie=1,Kie=2,gB=3200,xB=3201,Zie=3202,Qie=3203,Nu=0,yB=1,Yl="",Mr="srgb",yu="srgb-linear",Jm="linear",Pn="srgb",Jie=0,Ph=7680,ere=7681,tre=7682,nre=7683,ire=34055,rre=34056,sre=5386,are=512,ore=513,lre=514,cre=515,ure=516,hre=517,dre=518,_5=519,vB=512,bB=513,_B=514,tA=515,SB=516,wB=517,MB=518,TB=519,eg=35044,fre=35048,pre=35040,mre=35045,gre=35049,xre=35041,yre=35046,vre=35050,bre=35042,_re="100",S5="300 es",Js=2e3,h0=2001,Sre={COMPUTE:"compute",RENDER:"render"},wre={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},Mre={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};function AB(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}const Tre={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function kf(i,e){return new Tre[i](e)}function tg(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function CB(){const i=tg("canvas");return i.style.display="block",i}const ZR={};let vu=null;function Are(i){vu=i}function Cre(){return vu}function ng(...i){const e="THREE."+i.shift();vu?vu("log",e,...i):console.log(e,...i)}function lt(...i){const e="THREE."+i.shift();vu?vu("warn",e,...i):console.warn(e,...i)}function Vt(...i){const e="THREE."+i.shift();vu?vu("error",e,...i):console.error(e,...i)}function d0(...i){const e=i.join(" ");e in ZR||(ZR[e]=!0,lt(...i))}function Ere(i,e,t){return new Promise(function(n,r){function s(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:r();break;case i.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:n()}}setTimeout(s,t)})}let ul=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const r=n[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,e);e.target=null}}};const Lr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let QR=1234567;const Wh=Math.PI/180,f0=180/Math.PI;function ia(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Lr[i&255]+Lr[i>>8&255]+Lr[i>>16&255]+Lr[i>>24&255]+"-"+Lr[e&255]+Lr[e>>8&255]+"-"+Lr[e>>16&15|64]+Lr[e>>24&255]+"-"+Lr[t&63|128]+Lr[t>>8&255]+"-"+Lr[t>>16&255]+Lr[t>>24&255]+Lr[n&255]+Lr[n>>8&255]+Lr[n>>16&255]+Lr[n>>24&255]).toLowerCase()}function Ft(i,e,t){return Math.max(e,Math.min(t,i))}function nA(i,e){return(i%e+e)%e}function Rre(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)}function Pre(i,e,t){return i!==e?(t-i)/(e-i):0}function vm(i,e,t){return(1-t)*i+t*e}function Ire(i,e,t,n){return vm(i,e,1-Math.exp(-t*n))}function Dre(i,e=1){return e-Math.abs(nA(i,e*2)-e)}function Nre(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function Lre(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function kre(i,e){return i+Math.floor(Math.random()*(e-i+1))}function Ore(i,e){return i+Math.random()*(e-i)}function zre(i){return i*(.5-Math.random())}function Ure(i){i!==void 0&&(QR=i);let e=QR+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Fre(i){return i*Wh}function Bre(i){return i*f0}function Hre(i){return(i&i-1)===0&&i!==0}function jre(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function Vre(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function Gre(i,e,t,n,r){const s=Math.cos,a=Math.sin,o=s(t/2),l=a(t/2),c=s((e+n)/2),u=a((e+n)/2),d=s((e-n)/2),p=a((e-n)/2),m=s((n-e)/2),g=a((n-e)/2);switch(r){case"XYX":i.set(o*u,l*d,l*p,o*c);break;case"YZY":i.set(l*p,o*u,l*d,o*c);break;case"ZXZ":i.set(l*d,l*p,o*u,o*c);break;case"XZX":i.set(o*u,l*g,l*m,o*c);break;case"YXY":i.set(l*m,o*u,l*g,o*c);break;case"ZYZ":i.set(l*g,l*m,o*u,o*c);break;default:lt("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function es(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function Kt(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const iA={DEG2RAD:Wh,RAD2DEG:f0,generateUUID:ia,clamp:Ft,euclideanModulo:nA,mapLinear:Rre,inverseLerp:Pre,lerp:vm,damp:Ire,pingpong:Dre,smoothstep:Nre,smootherstep:Lre,randInt:kre,randFloat:Ore,randFloatSpread:zre,seededRandom:Ure,degToRad:Fre,radToDeg:Bre,isPowerOfTwo:Hre,ceilPowerOfTwo:jre,floorPowerOfTwo:Vre,setQuaternionFromProperEuler:Gre,normalize:Kt,denormalize:es};class Me{constructor(e=0,t=0){Me.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Ft(this.x,e.x,t.x),this.y=Ft(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Ft(this.x,e,t),this.y=Ft(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Ft(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Ft(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*n-a*r+e.x,this.y=s*r+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Vr{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,a,o){let l=n[r+0],c=n[r+1],u=n[r+2],d=n[r+3],p=s[a+0],m=s[a+1],g=s[a+2],y=s[a+3];if(o<=0){e[t+0]=l,e[t+1]=c,e[t+2]=u,e[t+3]=d;return}if(o>=1){e[t+0]=p,e[t+1]=m,e[t+2]=g,e[t+3]=y;return}if(d!==y||l!==p||c!==m||u!==g){let x=l*p+c*m+u*g+d*y;x<0&&(p=-p,m=-m,g=-g,y=-y,x=-x);let _=1-o;if(x<.9995){const S=Math.acos(x),w=Math.sin(S);_=Math.sin(_*S)/w,o=Math.sin(o*S)/w,l=l*_+p*o,c=c*_+m*o,u=u*_+g*o,d=d*_+y*o}else{l=l*_+p*o,c=c*_+m*o,u=u*_+g*o,d=d*_+y*o;const S=1/Math.sqrt(l*l+c*c+u*u+d*d);l*=S,c*=S,u*=S,d*=S}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,n,r,s,a){const o=n[r],l=n[r+1],c=n[r+2],u=n[r+3],d=s[a],p=s[a+1],m=s[a+2],g=s[a+3];return e[t]=o*g+u*d+l*m-c*p,e[t+1]=l*g+u*p+c*d-o*m,e[t+2]=c*g+u*m+o*p-l*d,e[t+3]=u*g-o*d-l*p-c*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,s=e._z,a=e._order,o=Math.cos,l=Math.sin,c=o(n/2),u=o(r/2),d=o(s/2),p=l(n/2),m=l(r/2),g=l(s/2);switch(a){case"XYZ":this._x=p*u*d+c*m*g,this._y=c*m*d-p*u*g,this._z=c*u*g+p*m*d,this._w=c*u*d-p*m*g;break;case"YXZ":this._x=p*u*d+c*m*g,this._y=c*m*d-p*u*g,this._z=c*u*g-p*m*d,this._w=c*u*d+p*m*g;break;case"ZXY":this._x=p*u*d-c*m*g,this._y=c*m*d+p*u*g,this._z=c*u*g+p*m*d,this._w=c*u*d-p*m*g;break;case"ZYX":this._x=p*u*d-c*m*g,this._y=c*m*d+p*u*g,this._z=c*u*g-p*m*d,this._w=c*u*d+p*m*g;break;case"YZX":this._x=p*u*d+c*m*g,this._y=c*m*d+p*u*g,this._z=c*u*g-p*m*d,this._w=c*u*d-p*m*g;break;case"XZY":this._x=p*u*d-c*m*g,this._y=c*m*d-p*u*g,this._z=c*u*g+p*m*d,this._w=c*u*d+p*m*g;break;default:lt("Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],a=t[1],o=t[5],l=t[9],c=t[2],u=t[6],d=t[10],p=n+o+d;if(p>0){const m=.5/Math.sqrt(p+1);this._w=.25/m,this._x=(u-l)*m,this._y=(s-c)*m,this._z=(a-r)*m}else if(n>o&&n>d){const m=2*Math.sqrt(1+n-o-d);this._w=(u-l)/m,this._x=.25*m,this._y=(r+a)/m,this._z=(s+c)/m}else if(o>d){const m=2*Math.sqrt(1+o-n-d);this._w=(s-c)/m,this._x=(r+a)/m,this._y=.25*m,this._z=(l+u)/m}else{const m=2*Math.sqrt(1+d-n-o);this._w=(a-r)/m,this._x=(s+c)/m,this._y=(l+u)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ft(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,a=e._w,o=t._x,l=t._y,c=t._z,u=t._w;return this._x=n*u+a*o+r*c-s*l,this._y=r*u+a*l+s*o-n*c,this._z=s*u+a*c+n*l-r*o,this._w=a*u-n*o-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let n=e._x,r=e._y,s=e._z,a=e._w,o=this.dot(e);o<0&&(n=-n,r=-r,s=-s,a=-a,o=-o);let l=1-t;if(o<.9995){const c=Math.acos(o),u=Math.sin(c);l=Math.sin(l*c)/u,t=Math.sin(t*c)/u,this._x=this._x*l+n*t,this._y=this._y*l+r*t,this._z=this._z*l+s*t,this._w=this._w*l+a*t,this._onChangeCallback()}else this._x=this._x*l+n*t,this._y=this._y*l+r*t,this._z=this._z*l+s*t,this._w=this._w*l+a*t,this.normalize();return this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),s=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class K{constructor(e=0,t=0,n=0){K.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(JR.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(JR.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,a=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*a,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*a,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,a=e.y,o=e.z,l=e.w,c=2*(a*r-o*n),u=2*(o*t-s*r),d=2*(s*n-a*t);return this.x=t+l*c+a*d-o*u,this.y=n+l*u+o*c-s*d,this.z=r+l*d+s*u-a*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Ft(this.x,e.x,t.x),this.y=Ft(this.y,e.y,t.y),this.z=Ft(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Ft(this.x,e,t),this.y=Ft(this.y,e,t),this.z=Ft(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Ft(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,a=t.x,o=t.y,l=t.z;return this.x=r*l-s*o,this.y=s*a-n*l,this.z=n*o-r*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return TS.copy(this).projectOnVector(e),this.sub(TS)}reflect(e){return this.sub(TS.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Ft(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const TS=new K,JR=new Vr;class qt{constructor(e,t,n,r,s,a,o,l,c){qt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,a,o,l,c)}set(e,t,n,r,s,a,o,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=o,u[3]=t,u[4]=s,u[5]=l,u[6]=n,u[7]=a,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,a=n[0],o=n[3],l=n[6],c=n[1],u=n[4],d=n[7],p=n[2],m=n[5],g=n[8],y=r[0],x=r[3],_=r[6],S=r[1],w=r[4],T=r[7],C=r[2],E=r[5],D=r[8];return s[0]=a*y+o*S+l*C,s[3]=a*x+o*w+l*E,s[6]=a*_+o*T+l*D,s[1]=c*y+u*S+d*C,s[4]=c*x+u*w+d*E,s[7]=c*_+u*T+d*D,s[2]=p*y+m*S+g*C,s[5]=p*x+m*w+g*E,s[8]=p*_+m*T+g*D,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8];return t*a*u-t*o*c-n*s*u+n*o*l+r*s*c-r*a*l}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8],d=u*a-o*c,p=o*l-u*s,m=c*s-a*l,g=t*d+n*p+r*m;if(g===0)return this.set(0,0,0,0,0,0,0,0,0);const y=1/g;return e[0]=d*y,e[1]=(r*c-u*n)*y,e[2]=(o*n-r*a)*y,e[3]=p*y,e[4]=(u*t-r*l)*y,e[5]=(r*s-o*t)*y,e[6]=m*y,e[7]=(n*l-c*t)*y,e[8]=(a*t-n*s)*y,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,a,o){const l=Math.cos(s),c=Math.sin(s);return this.set(n*l,n*c,-n*(l*a+c*o)+a+e,-r*c,r*l,-r*(-c*a+l*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(AS.makeScale(e,t)),this}rotate(e){return this.premultiply(AS.makeRotation(-e)),this}translate(e,t){return this.premultiply(AS.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const AS=new qt,e9=new qt().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),t9=new qt().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function Wre(){const i={enabled:!0,workingColorSpace:yu,spaces:{},convert:function(r,s,a){return this.enabled===!1||s===a||!s||!a||(this.spaces[s].transfer===Pn&&(r.r=ic(r.r),r.g=ic(r.g),r.b=ic(r.b)),this.spaces[s].primaries!==this.spaces[a].primaries&&(r.applyMatrix3(this.spaces[s].toXYZ),r.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===Pn&&(r.r=Gf(r.r),r.g=Gf(r.g),r.b=Gf(r.b))),r},workingToColorSpace:function(r,s){return this.convert(r,this.workingColorSpace,s)},colorSpaceToWorking:function(r,s){return this.convert(r,s,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===Yl?Jm:this.spaces[r].transfer},getToneMappingMode:function(r){return this.spaces[r].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(r,s=this.workingColorSpace){return r.fromArray(this.spaces[s].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,s,a){return r.copy(this.spaces[s].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,s){return d0("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),i.workingToColorSpace(r,s)},toWorkingColorSpace:function(r,s){return d0("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),i.colorSpaceToWorking(r,s)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return i.define({[yu]:{primaries:e,whitePoint:n,transfer:Jm,toXYZ:e9,fromXYZ:t9,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:Mr},outputColorSpaceConfig:{drawingBufferColorSpace:Mr}},[Mr]:{primaries:e,whitePoint:n,transfer:Pn,toXYZ:e9,fromXYZ:t9,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:Mr}}}),i}const fn=Wre();function ic(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function Gf(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let Qd;class EB{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{Qd===void 0&&(Qd=tg("canvas")),Qd.width=e.width,Qd.height=e.height;const r=Qd.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=Qd}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=tg("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let a=0;a<s.length;a++)s[a]=ic(s[a]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(ic(t[n]/255)*255):t[n]=ic(t[n]);return{data:t,width:e.width,height:e.height}}else return lt("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let qre=0;class iu{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:qre++}),this.uuid=ia(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let a=0,o=r.length;a<o;a++)r[a].isDataTexture?s.push(CS(r[a].image)):s.push(CS(r[a]))}else s=CS(r);n.url=s}return t||(e.images[this.uuid]=n),n}}function CS(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?EB.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(lt("Texture: Unable to serialize Texture."),{})}let Xre=0;const ES=new K;class ri extends ul{constructor(e=ri.DEFAULT_IMAGE,t=ri.DEFAULT_MAPPING,n=or,r=or,s=Jn,a=Ho,o=Fr,l=za,c=ri.DEFAULT_ANISOTROPY,u=Yl){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Xre++}),this.uuid=ia(),this.name="",this.source=new iu(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=a,this.anisotropy=c,this.format=o,this.internalFormat=null,this.type=l,this.offset=new Me(0,0),this.repeat=new Me(1,1),this.center=new Me(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new qt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=u,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(ES).x}get height(){return this.source.getSize(ES).y}get depth(){return this.source.getSize(ES).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){lt(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){lt(`Texture.setValues(): property '${t}' does not exist.`);continue}r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==n2)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case $m:e.x=e.x-Math.floor(e.x);break;case or:e.x=e.x<0?0:1;break;case Km:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case $m:e.y=e.y-Math.floor(e.y);break;case or:e.y=e.y<0?0:1;break;case Km:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}ri.DEFAULT_IMAGE=null;ri.DEFAULT_MAPPING=n2;ri.DEFAULT_ANISOTROPY=1;class sn{constructor(e=0,t=0,n=0,r=1){sn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*s,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*s,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*s,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const l=e.elements,c=l[0],u=l[4],d=l[8],p=l[1],m=l[5],g=l[9],y=l[2],x=l[6],_=l[10];if(Math.abs(u-p)<.01&&Math.abs(d-y)<.01&&Math.abs(g-x)<.01){if(Math.abs(u+p)<.1&&Math.abs(d+y)<.1&&Math.abs(g+x)<.1&&Math.abs(c+m+_-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const w=(c+1)/2,T=(m+1)/2,C=(_+1)/2,E=(u+p)/4,D=(d+y)/4,O=(g+x)/4;return w>T&&w>C?w<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(w),r=E/n,s=D/n):T>C?T<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(T),n=E/r,s=O/r):C<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(C),n=D/s,r=O/s),this.set(n,r,s,t),this}let S=Math.sqrt((x-g)*(x-g)+(d-y)*(d-y)+(p-u)*(p-u));return Math.abs(S)<.001&&(S=1),this.x=(x-g)/S,this.y=(d-y)/S,this.z=(p-u)/S,this.w=Math.acos((c+m+_-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Ft(this.x,e.x,t.x),this.y=Ft(this.y,e.y,t.y),this.z=Ft(this.z,e.z,t.z),this.w=Ft(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Ft(this.x,e,t),this.y=Ft(this.y,e,t),this.z=Ft(this.z,e,t),this.w=Ft(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Ft(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class rA extends ul{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Jn,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new sn(0,0,e,t),this.scissorTest=!1,this.viewport=new sn(0,0,e,t);const r={width:e,height:t,depth:n.depth},s=new ri(r);this.textures=[];const a=n.count;for(let o=0;o<a;o++)this.textures[o]=s.clone(),this.textures[o].isRenderTargetTexture=!0,this.textures[o].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:Jn,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,this.textures[r].isData3DTexture!==!0&&(this.textures[r].isArrayTexture=this.textures[r].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const r=Object.assign({},e.textures[t].image);this.textures[t].source=new iu(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class go extends rA{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class u2 extends ri{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=qi,this.minFilter=qi,this.wrapR=or,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Yre extends go{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new u2(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class h2 extends ri{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=qi,this.minFilter=qi,this.wrapR=or,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class $re extends go{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new h2(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class Xi{constructor(e=new K(1/0,1/0,1/0),t=new K(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Qa.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Qa.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Qa.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const s=n.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,o=s.count;a<o;a++)e.isMesh===!0?e.getVertexPosition(a,Qa):Qa.fromBufferAttribute(s,a),Qa.applyMatrix4(e.matrixWorld),this.expandByPoint(Qa);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),h1.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),h1.copy(n.boundingBox)),h1.applyMatrix4(e.matrixWorld),this.union(h1)}const r=e.children;for(let s=0,a=r.length;s<a;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Qa),Qa.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ap),d1.subVectors(this.max,Ap),Jd.subVectors(e.a,Ap),ef.subVectors(e.b,Ap),tf.subVectors(e.c,Ap),Fc.subVectors(ef,Jd),Bc.subVectors(tf,ef),oh.subVectors(Jd,tf);let t=[0,-Fc.z,Fc.y,0,-Bc.z,Bc.y,0,-oh.z,oh.y,Fc.z,0,-Fc.x,Bc.z,0,-Bc.x,oh.z,0,-oh.x,-Fc.y,Fc.x,0,-Bc.y,Bc.x,0,-oh.y,oh.x,0];return!RS(t,Jd,ef,tf,d1)||(t=[1,0,0,0,1,0,0,0,1],!RS(t,Jd,ef,tf,d1))?!1:(f1.crossVectors(Fc,Bc),t=[f1.x,f1.y,f1.z],RS(t,Jd,ef,tf,d1))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Qa).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Qa).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Pl[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Pl[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Pl[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Pl[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Pl[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Pl[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Pl[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Pl[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Pl),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const Pl=[new K,new K,new K,new K,new K,new K,new K,new K],Qa=new K,h1=new Xi,Jd=new K,ef=new K,tf=new K,Fc=new K,Bc=new K,oh=new K,Ap=new K,d1=new K,f1=new K,lh=new K;function RS(i,e,t,n,r){for(let s=0,a=i.length-3;s<=a;s+=3){lh.fromArray(i,s);const o=r.x*Math.abs(lh.x)+r.y*Math.abs(lh.y)+r.z*Math.abs(lh.z),l=e.dot(lh),c=t.dot(lh),u=n.dot(lh);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>o)return!1}return!0}const Kre=new Xi,Cp=new K,PS=new K;class Yi{constructor(e=new K,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):Kre.setFromPoints(e).getCenter(n);let r=0;for(let s=0,a=e.length;s<a;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Cp.subVectors(e,this.center);const t=Cp.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(Cp,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(PS.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Cp.copy(e.center).add(PS)),this.expandByPoint(Cp.copy(e.center).sub(PS))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const Il=new K,IS=new K,p1=new K,Hc=new K,DS=new K,m1=new K,NS=new K;class fd{constructor(e=new K,t=new K(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Il)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Il.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Il.copy(this.origin).addScaledVector(this.direction,t),Il.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){IS.copy(e).add(t).multiplyScalar(.5),p1.copy(t).sub(e).normalize(),Hc.copy(this.origin).sub(IS);const s=e.distanceTo(t)*.5,a=-this.direction.dot(p1),o=Hc.dot(this.direction),l=-Hc.dot(p1),c=Hc.lengthSq(),u=Math.abs(1-a*a);let d,p,m,g;if(u>0)if(d=a*l-o,p=a*o-l,g=s*u,d>=0)if(p>=-g)if(p<=g){const y=1/u;d*=y,p*=y,m=d*(d+a*p+2*o)+p*(a*d+p+2*l)+c}else p=s,d=Math.max(0,-(a*p+o)),m=-d*d+p*(p+2*l)+c;else p=-s,d=Math.max(0,-(a*p+o)),m=-d*d+p*(p+2*l)+c;else p<=-g?(d=Math.max(0,-(-a*s+o)),p=d>0?-s:Math.min(Math.max(-s,-l),s),m=-d*d+p*(p+2*l)+c):p<=g?(d=0,p=Math.min(Math.max(-s,-l),s),m=p*(p+2*l)+c):(d=Math.max(0,-(a*s+o)),p=d>0?s:Math.min(Math.max(-s,-l),s),m=-d*d+p*(p+2*l)+c);else p=a>0?-s:s,d=Math.max(0,-(a*p+o)),m=-d*d+p*(p+2*l)+c;return n&&n.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(IS).addScaledVector(p1,p),m}intersectSphere(e,t){Il.subVectors(e.center,this.origin);const n=Il.dot(this.direction),r=Il.dot(Il)-n*n,s=e.radius*e.radius;if(r>s)return null;const a=Math.sqrt(s-r),o=n-a,l=n+a;return l<0?null:o<0?this.at(l,t):this.at(o,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,a,o,l;const c=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,p=this.origin;return c>=0?(n=(e.min.x-p.x)*c,r=(e.max.x-p.x)*c):(n=(e.max.x-p.x)*c,r=(e.min.x-p.x)*c),u>=0?(s=(e.min.y-p.y)*u,a=(e.max.y-p.y)*u):(s=(e.max.y-p.y)*u,a=(e.min.y-p.y)*u),n>a||s>r||((s>n||isNaN(n))&&(n=s),(a<r||isNaN(r))&&(r=a),d>=0?(o=(e.min.z-p.z)*d,l=(e.max.z-p.z)*d):(o=(e.max.z-p.z)*d,l=(e.min.z-p.z)*d),n>l||o>r)||((o>n||n!==n)&&(n=o),(l<r||r!==r)&&(r=l),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,Il)!==null}intersectTriangle(e,t,n,r,s){DS.subVectors(t,e),m1.subVectors(n,e),NS.crossVectors(DS,m1);let a=this.direction.dot(NS),o;if(a>0){if(r)return null;o=1}else if(a<0)o=-1,a=-a;else return null;Hc.subVectors(this.origin,e);const l=o*this.direction.dot(m1.crossVectors(Hc,m1));if(l<0)return null;const c=o*this.direction.dot(DS.cross(Hc));if(c<0||l+c>a)return null;const u=-o*Hc.dot(NS);return u<0?null:this.at(u/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Bt{constructor(e,t,n,r,s,a,o,l,c,u,d,p,m,g,y,x){Bt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,a,o,l,c,u,d,p,m,g,y,x)}set(e,t,n,r,s,a,o,l,c,u,d,p,m,g,y,x){const _=this.elements;return _[0]=e,_[4]=t,_[8]=n,_[12]=r,_[1]=s,_[5]=a,_[9]=o,_[13]=l,_[2]=c,_[6]=u,_[10]=d,_[14]=p,_[3]=m,_[7]=g,_[11]=y,_[15]=x,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Bt().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/nf.setFromMatrixColumn(e,0).length(),s=1/nf.setFromMatrixColumn(e,1).length(),a=1/nf.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,s=e.z,a=Math.cos(n),o=Math.sin(n),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),d=Math.sin(s);if(e.order==="XYZ"){const p=a*u,m=a*d,g=o*u,y=o*d;t[0]=l*u,t[4]=-l*d,t[8]=c,t[1]=m+g*c,t[5]=p-y*c,t[9]=-o*l,t[2]=y-p*c,t[6]=g+m*c,t[10]=a*l}else if(e.order==="YXZ"){const p=l*u,m=l*d,g=c*u,y=c*d;t[0]=p+y*o,t[4]=g*o-m,t[8]=a*c,t[1]=a*d,t[5]=a*u,t[9]=-o,t[2]=m*o-g,t[6]=y+p*o,t[10]=a*l}else if(e.order==="ZXY"){const p=l*u,m=l*d,g=c*u,y=c*d;t[0]=p-y*o,t[4]=-a*d,t[8]=g+m*o,t[1]=m+g*o,t[5]=a*u,t[9]=y-p*o,t[2]=-a*c,t[6]=o,t[10]=a*l}else if(e.order==="ZYX"){const p=a*u,m=a*d,g=o*u,y=o*d;t[0]=l*u,t[4]=g*c-m,t[8]=p*c+y,t[1]=l*d,t[5]=y*c+p,t[9]=m*c-g,t[2]=-c,t[6]=o*l,t[10]=a*l}else if(e.order==="YZX"){const p=a*l,m=a*c,g=o*l,y=o*c;t[0]=l*u,t[4]=y-p*d,t[8]=g*d+m,t[1]=d,t[5]=a*u,t[9]=-o*u,t[2]=-c*u,t[6]=m*d+g,t[10]=p-y*d}else if(e.order==="XZY"){const p=a*l,m=a*c,g=o*l,y=o*c;t[0]=l*u,t[4]=-d,t[8]=c*u,t[1]=p*d+y,t[5]=a*u,t[9]=m*d-g,t[2]=g*d-m,t[6]=o*u,t[10]=y*d+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Zre,e,Qre)}lookAt(e,t,n){const r=this.elements;return Ws.subVectors(e,t),Ws.lengthSq()===0&&(Ws.z=1),Ws.normalize(),jc.crossVectors(n,Ws),jc.lengthSq()===0&&(Math.abs(n.z)===1?Ws.x+=1e-4:Ws.z+=1e-4,Ws.normalize(),jc.crossVectors(n,Ws)),jc.normalize(),g1.crossVectors(Ws,jc),r[0]=jc.x,r[4]=g1.x,r[8]=Ws.x,r[1]=jc.y,r[5]=g1.y,r[9]=Ws.y,r[2]=jc.z,r[6]=g1.z,r[10]=Ws.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,a=n[0],o=n[4],l=n[8],c=n[12],u=n[1],d=n[5],p=n[9],m=n[13],g=n[2],y=n[6],x=n[10],_=n[14],S=n[3],w=n[7],T=n[11],C=n[15],E=r[0],D=r[4],O=r[8],R=r[12],P=r[1],L=r[5],V=r[9],j=r[13],B=r[2],J=r[6],U=r[10],X=r[14],$=r[3],Q=r[7],se=r[11],ye=r[15];return s[0]=a*E+o*P+l*B+c*$,s[4]=a*D+o*L+l*J+c*Q,s[8]=a*O+o*V+l*U+c*se,s[12]=a*R+o*j+l*X+c*ye,s[1]=u*E+d*P+p*B+m*$,s[5]=u*D+d*L+p*J+m*Q,s[9]=u*O+d*V+p*U+m*se,s[13]=u*R+d*j+p*X+m*ye,s[2]=g*E+y*P+x*B+_*$,s[6]=g*D+y*L+x*J+_*Q,s[10]=g*O+y*V+x*U+_*se,s[14]=g*R+y*j+x*X+_*ye,s[3]=S*E+w*P+T*B+C*$,s[7]=S*D+w*L+T*J+C*Q,s[11]=S*O+w*V+T*U+C*se,s[15]=S*R+w*j+T*X+C*ye,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],a=e[1],o=e[5],l=e[9],c=e[13],u=e[2],d=e[6],p=e[10],m=e[14],g=e[3],y=e[7],x=e[11],_=e[15];return g*(+s*l*d-r*c*d-s*o*p+n*c*p+r*o*m-n*l*m)+y*(+t*l*m-t*c*p+s*a*p-r*a*m+r*c*u-s*l*u)+x*(+t*c*d-t*o*m-s*a*d+n*a*m+s*o*u-n*c*u)+_*(-r*o*u-t*l*d+t*o*p+r*a*d-n*a*p+n*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8],d=e[9],p=e[10],m=e[11],g=e[12],y=e[13],x=e[14],_=e[15],S=d*x*c-y*p*c+y*l*m-o*x*m-d*l*_+o*p*_,w=g*p*c-u*x*c-g*l*m+a*x*m+u*l*_-a*p*_,T=u*y*c-g*d*c+g*o*m-a*y*m-u*o*_+a*d*_,C=g*d*l-u*y*l-g*o*p+a*y*p+u*o*x-a*d*x,E=t*S+n*w+r*T+s*C;if(E===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const D=1/E;return e[0]=S*D,e[1]=(y*p*s-d*x*s-y*r*m+n*x*m+d*r*_-n*p*_)*D,e[2]=(o*x*s-y*l*s+y*r*c-n*x*c-o*r*_+n*l*_)*D,e[3]=(d*l*s-o*p*s-d*r*c+n*p*c+o*r*m-n*l*m)*D,e[4]=w*D,e[5]=(u*x*s-g*p*s+g*r*m-t*x*m-u*r*_+t*p*_)*D,e[6]=(g*l*s-a*x*s-g*r*c+t*x*c+a*r*_-t*l*_)*D,e[7]=(a*p*s-u*l*s+u*r*c-t*p*c-a*r*m+t*l*m)*D,e[8]=T*D,e[9]=(g*d*s-u*y*s-g*n*m+t*y*m+u*n*_-t*d*_)*D,e[10]=(a*y*s-g*o*s+g*n*c-t*y*c-a*n*_+t*o*_)*D,e[11]=(u*o*s-a*d*s-u*n*c+t*d*c+a*n*m-t*o*m)*D,e[12]=C*D,e[13]=(u*y*r-g*d*r+g*n*p-t*y*p-u*n*x+t*d*x)*D,e[14]=(g*o*r-a*y*r-g*n*l+t*y*l+a*n*x-t*o*x)*D,e[15]=(a*d*r-u*o*r+u*n*l-t*d*l-a*n*p+t*o*p)*D,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,a=e.x,o=e.y,l=e.z,c=s*a,u=s*o;return this.set(c*a+n,c*o-r*l,c*l+r*o,0,c*o+r*l,u*o+n,u*l-r*a,0,c*l-r*o,u*l+r*a,s*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,a){return this.set(1,n,s,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,a=t._y,o=t._z,l=t._w,c=s+s,u=a+a,d=o+o,p=s*c,m=s*u,g=s*d,y=a*u,x=a*d,_=o*d,S=l*c,w=l*u,T=l*d,C=n.x,E=n.y,D=n.z;return r[0]=(1-(y+_))*C,r[1]=(m+T)*C,r[2]=(g-w)*C,r[3]=0,r[4]=(m-T)*E,r[5]=(1-(p+_))*E,r[6]=(x+S)*E,r[7]=0,r[8]=(g+w)*D,r[9]=(x-S)*D,r[10]=(1-(p+y))*D,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let s=nf.set(r[0],r[1],r[2]).length();const a=nf.set(r[4],r[5],r[6]).length(),o=nf.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Ja.copy(this);const c=1/s,u=1/a,d=1/o;return Ja.elements[0]*=c,Ja.elements[1]*=c,Ja.elements[2]*=c,Ja.elements[4]*=u,Ja.elements[5]*=u,Ja.elements[6]*=u,Ja.elements[8]*=d,Ja.elements[9]*=d,Ja.elements[10]*=d,t.setFromRotationMatrix(Ja),n.x=s,n.y=a,n.z=o,this}makePerspective(e,t,n,r,s,a,o=Js,l=!1){const c=this.elements,u=2*s/(t-e),d=2*s/(n-r),p=(t+e)/(t-e),m=(n+r)/(n-r);let g,y;if(l)g=s/(a-s),y=a*s/(a-s);else if(o===Js)g=-(a+s)/(a-s),y=-2*a*s/(a-s);else if(o===h0)g=-a/(a-s),y=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return c[0]=u,c[4]=0,c[8]=p,c[12]=0,c[1]=0,c[5]=d,c[9]=m,c[13]=0,c[2]=0,c[6]=0,c[10]=g,c[14]=y,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,n,r,s,a,o=Js,l=!1){const c=this.elements,u=2/(t-e),d=2/(n-r),p=-(t+e)/(t-e),m=-(n+r)/(n-r);let g,y;if(l)g=1/(a-s),y=a/(a-s);else if(o===Js)g=-2/(a-s),y=-(a+s)/(a-s);else if(o===h0)g=-1/(a-s),y=-s/(a-s);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return c[0]=u,c[4]=0,c[8]=0,c[12]=p,c[1]=0,c[5]=d,c[9]=0,c[13]=m,c[2]=0,c[6]=0,c[10]=g,c[14]=y,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const nf=new K,Ja=new Bt,Zre=new K(0,0,0),Qre=new K(1,1,1),jc=new K,g1=new K,Ws=new K,n9=new Bt,i9=new Vr;class la{constructor(e=0,t=0,n=0,r=la.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,s=r[0],a=r[4],o=r[8],l=r[1],c=r[5],u=r[9],d=r[2],p=r[6],m=r[10];switch(t){case"XYZ":this._y=Math.asin(Ft(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,m),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(p,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Ft(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(o,m),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-d,s),this._z=0);break;case"ZXY":this._x=Math.asin(Ft(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-d,m),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Ft(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(p,m),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-a,c));break;case"YZX":this._z=Math.asin(Ft(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(o,m));break;case"XZY":this._z=Math.asin(-Ft(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(p,c),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-u,m),this._y=0);break;default:lt("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return n9.makeRotationFromQuaternion(e),this.setFromRotationMatrix(n9,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return i9.setFromEuler(this),this.setFromQuaternion(i9,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}la.DEFAULT_ORDER="XYZ";class p0{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Jre=0;const r9=new K,rf=new Vr,Dl=new Bt,x1=new K,Ep=new K,ese=new K,tse=new Vr,s9=new K(1,0,0),a9=new K(0,1,0),o9=new K(0,0,1),l9={type:"added"},nse={type:"removed"},sf={type:"childadded",child:null},LS={type:"childremoved",child:null};class xn extends ul{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Jre++}),this.uuid=ia(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=xn.DEFAULT_UP.clone();const e=new K,t=new la,n=new Vr,r=new K(1,1,1);function s(){n.setFromEuler(t,!1)}function a(){t.setFromQuaternion(n,void 0,!1)}t._onChange(s),n._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Bt},normalMatrix:{value:new qt}}),this.matrix=new Bt,this.matrixWorld=new Bt,this.matrixAutoUpdate=xn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=xn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new p0,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return rf.setFromAxisAngle(e,t),this.quaternion.multiply(rf),this}rotateOnWorldAxis(e,t){return rf.setFromAxisAngle(e,t),this.quaternion.premultiply(rf),this}rotateX(e){return this.rotateOnAxis(s9,e)}rotateY(e){return this.rotateOnAxis(a9,e)}rotateZ(e){return this.rotateOnAxis(o9,e)}translateOnAxis(e,t){return r9.copy(e).applyQuaternion(this.quaternion),this.position.add(r9.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(s9,e)}translateY(e){return this.translateOnAxis(a9,e)}translateZ(e){return this.translateOnAxis(o9,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Dl.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?x1.copy(e):x1.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Ep.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Dl.lookAt(Ep,x1,this.up):Dl.lookAt(x1,Ep,this.up),this.quaternion.setFromRotationMatrix(Dl),r&&(Dl.extractRotation(r.matrixWorld),rf.setFromRotationMatrix(Dl),this.quaternion.premultiply(rf.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(Vt("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(l9),sf.child=e,this.dispatchEvent(sf),sf.child=null):Vt("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(nse),LS.child=e,this.dispatchEvent(LS),LS.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Dl.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Dl.multiply(e.parent.matrixWorld)),e.applyMatrix4(Dl),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(l9),sf.child=e,this.dispatchEvent(sf),sf.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const a=this.children[n].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ep,e,ese),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ep,tse,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(o=>({...o,boundingBox:o.boundingBox?o.boundingBox.toJSON():void 0,boundingSphere:o.boundingSphere?o.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(o=>({...o})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(r.boundingBox=this.boundingBox.toJSON()));function s(o,l){return o[l.uuid]===void 0&&(o[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const l=o.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){const d=l[c];s(e.shapes,d)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let l=0,c=this.material.length;l<c;l++)o.push(s(e.materials,this.material[l]));r.material=o}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let o=0;o<this.children.length;o++)r.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let o=0;o<this.animations.length;o++){const l=this.animations[o];r.animations.push(s(e.animations,l))}}if(t){const o=a(e.geometries),l=a(e.materials),c=a(e.textures),u=a(e.images),d=a(e.shapes),p=a(e.skeletons),m=a(e.animations),g=a(e.nodes);o.length>0&&(n.geometries=o),l.length>0&&(n.materials=l),c.length>0&&(n.textures=c),u.length>0&&(n.images=u),d.length>0&&(n.shapes=d),p.length>0&&(n.skeletons=p),m.length>0&&(n.animations=m),g.length>0&&(n.nodes=g)}return n.object=r,n;function a(o){const l=[];for(const c in o){const u=o[c];delete u.metadata,l.push(u)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}xn.DEFAULT_UP=new K(0,1,0);xn.DEFAULT_MATRIX_AUTO_UPDATE=!0;xn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const eo=new K,Nl=new K,kS=new K,Ll=new K,af=new K,of=new K,c9=new K,OS=new K,zS=new K,US=new K,FS=new sn,BS=new sn,HS=new sn;class Ss{constructor(e=new K,t=new K,n=new K){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),eo.subVectors(e,t),r.cross(eo);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){eo.subVectors(r,t),Nl.subVectors(n,t),kS.subVectors(e,t);const a=eo.dot(eo),o=eo.dot(Nl),l=eo.dot(kS),c=Nl.dot(Nl),u=Nl.dot(kS),d=a*c-o*o;if(d===0)return s.set(0,0,0),null;const p=1/d,m=(c*l-o*u)*p,g=(a*u-o*l)*p;return s.set(1-m-g,g,m)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Ll)===null?!1:Ll.x>=0&&Ll.y>=0&&Ll.x+Ll.y<=1}static getInterpolation(e,t,n,r,s,a,o,l){return this.getBarycoord(e,t,n,r,Ll)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,Ll.x),l.addScaledVector(a,Ll.y),l.addScaledVector(o,Ll.z),l)}static getInterpolatedAttribute(e,t,n,r,s,a){return FS.setScalar(0),BS.setScalar(0),HS.setScalar(0),FS.fromBufferAttribute(e,t),BS.fromBufferAttribute(e,n),HS.fromBufferAttribute(e,r),a.setScalar(0),a.addScaledVector(FS,s.x),a.addScaledVector(BS,s.y),a.addScaledVector(HS,s.z),a}static isFrontFacing(e,t,n,r){return eo.subVectors(n,t),Nl.subVectors(e,t),eo.cross(Nl).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return eo.subVectors(this.c,this.b),Nl.subVectors(this.a,this.b),eo.cross(Nl).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Ss.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Ss.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,s){return Ss.getInterpolation(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return Ss.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Ss.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let a,o;af.subVectors(r,n),of.subVectors(s,n),OS.subVectors(e,n);const l=af.dot(OS),c=of.dot(OS);if(l<=0&&c<=0)return t.copy(n);zS.subVectors(e,r);const u=af.dot(zS),d=of.dot(zS);if(u>=0&&d<=u)return t.copy(r);const p=l*d-u*c;if(p<=0&&l>=0&&u<=0)return a=l/(l-u),t.copy(n).addScaledVector(af,a);US.subVectors(e,s);const m=af.dot(US),g=of.dot(US);if(g>=0&&m<=g)return t.copy(s);const y=m*c-l*g;if(y<=0&&c>=0&&g<=0)return o=c/(c-g),t.copy(n).addScaledVector(of,o);const x=u*g-m*d;if(x<=0&&d-u>=0&&m-g>=0)return c9.subVectors(s,r),o=(d-u)/(d-u+(m-g)),t.copy(r).addScaledVector(c9,o);const _=1/(x+y+p);return a=y*_,o=p*_,t.copy(n).addScaledVector(af,a).addScaledVector(of,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const RB={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Vc={h:0,s:0,l:0},y1={h:0,s:0,l:0};function jS(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}let pt=class{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Mr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,fn.colorSpaceToWorking(this,t),this}setRGB(e,t,n,r=fn.workingColorSpace){return this.r=e,this.g=t,this.b=n,fn.colorSpaceToWorking(this,r),this}setHSL(e,t,n,r=fn.workingColorSpace){if(e=nA(e,1),t=Ft(t,0,1),n=Ft(n,0,1),t===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+t):n+t-n*t,a=2*n-s;this.r=jS(a,s,e+1/3),this.g=jS(a,s,e),this.b=jS(a,s,e-1/3)}return fn.colorSpaceToWorking(this,r),this}setStyle(e,t=Mr){function n(s){s!==void 0&&parseFloat(s)<1&&lt("Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[1],o=r[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:lt("Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(s,16),t);lt("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Mr){const n=RB[e.toLowerCase()];return n!==void 0?this.setHex(n,t):lt("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=ic(e.r),this.g=ic(e.g),this.b=ic(e.b),this}copyLinearToSRGB(e){return this.r=Gf(e.r),this.g=Gf(e.g),this.b=Gf(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Mr){return fn.workingToColorSpace(kr.copy(this),e),Math.round(Ft(kr.r*255,0,255))*65536+Math.round(Ft(kr.g*255,0,255))*256+Math.round(Ft(kr.b*255,0,255))}getHexString(e=Mr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=fn.workingColorSpace){fn.workingToColorSpace(kr.copy(this),t);const n=kr.r,r=kr.g,s=kr.b,a=Math.max(n,r,s),o=Math.min(n,r,s);let l,c;const u=(o+a)/2;if(o===a)l=0,c=0;else{const d=a-o;switch(c=u<=.5?d/(a+o):d/(2-a-o),a){case n:l=(r-s)/d+(r<s?6:0);break;case r:l=(s-n)/d+2;break;case s:l=(n-r)/d+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=fn.workingColorSpace){return fn.workingToColorSpace(kr.copy(this),t),e.r=kr.r,e.g=kr.g,e.b=kr.b,e}getStyle(e=Mr){fn.workingToColorSpace(kr.copy(this),e);const t=kr.r,n=kr.g,r=kr.b;return e!==Mr?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(Vc),this.setHSL(Vc.h+e,Vc.s+t,Vc.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Vc),e.getHSL(y1);const n=vm(Vc.h,y1.h,t),r=vm(Vc.s,y1.s,t),s=vm(Vc.l,y1.l,t);return this.setHSL(n,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*n+s[6]*r,this.g=s[1]*t+s[4]*n+s[7]*r,this.b=s[2]*t+s[5]*n+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const kr=new pt;pt.NAMES=RB;let ise=0;class Wr extends ul{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:ise++}),this.uuid=ia(),this.name="",this.type="Material",this.blending=Gh,this.side=hc,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=lv,this.blendDst=cv,this.blendEquation=Kc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new pt(0,0,0),this.blendAlpha=0,this.depthFunc=Jh,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=_5,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ph,this.stencilZFail=Ph,this.stencilZPass=Ph,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){lt(`Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){lt(`Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Gh&&(n.blending=this.blending),this.side!==hc&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==lv&&(n.blendSrc=this.blendSrc),this.blendDst!==cv&&(n.blendDst=this.blendDst),this.blendEquation!==Kc&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Jh&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==_5&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Ph&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Ph&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Ph&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){const a=[];for(const o in s){const l=s[o];delete l.metadata,a.push(l)}return a}if(t){const s=r(e.textures),a=r(e.images);s.length>0&&(n.textures=s),a.length>0&&(n.images=a)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Lu extends Wr{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new pt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new la,this.combine=Gg,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const $l=rse();function rse(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(n[l]=0,n[l|256]=32768,r[l]=24,r[l|256]=24):c<-14?(n[l]=1024>>-c-14,n[l|256]=1024>>-c-14|32768,r[l]=-c-1,r[l|256]=-c-1):c<=15?(n[l]=c+15<<10,n[l|256]=c+15<<10|32768,r[l]=13,r[l|256]=13):c<128?(n[l]=31744,n[l|256]=64512,r[l]=24,r[l|256]=24):(n[l]=31744,n[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,u=0;for(;(c&8388608)===0;)c<<=1,u-=8388608;c&=-8388609,u+=947912704,s[l]=c|u}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)a[l]=l<<23;a[31]=1199570944,a[32]=2147483648;for(let l=33;l<63;++l)a[l]=2147483648+(l-32<<23);a[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(o[l]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:s,exponentTable:a,offsetTable:o}}function fs(i){Math.abs(i)>65504&&lt("DataUtils.toHalfFloat(): Value out of range."),i=Ft(i,-65504,65504),$l.floatView[0]=i;const e=$l.uint32View[0],t=e>>23&511;return $l.baseTable[t]+((e&8388607)>>$l.shiftTable[t])}function Jp(i){const e=i>>10;return $l.uint32View[0]=$l.mantissaTable[$l.offsetTable[e]+(i&1023)]+$l.exponentTable[e],$l.floatView[0]}class sse{static toHalfFloat(e){return fs(e)}static fromHalfFloat(e){return Jp(e)}}const Li=new K,v1=new Me;let ase=0;class kn{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:ase++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=eg,this.updateRanges=[],this.gpuType=ns,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)v1.fromBufferAttribute(this,t),v1.applyMatrix3(e),this.setXY(t,v1.x,v1.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Li.fromBufferAttribute(this,t),Li.applyMatrix3(e),this.setXYZ(t,Li.x,Li.y,Li.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Li.fromBufferAttribute(this,t),Li.applyMatrix4(e),this.setXYZ(t,Li.x,Li.y,Li.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Li.fromBufferAttribute(this,t),Li.applyNormalMatrix(e),this.setXYZ(t,Li.x,Li.y,Li.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Li.fromBufferAttribute(this,t),Li.transformDirection(e),this.setXYZ(t,Li.x,Li.y,Li.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=es(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Kt(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=es(t,this.array)),t}setX(e,t){return this.normalized&&(t=Kt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=es(t,this.array)),t}setY(e,t){return this.normalized&&(t=Kt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=es(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Kt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=es(t,this.array)),t}setW(e,t){return this.normalized&&(t=Kt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Kt(t,this.array),n=Kt(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Kt(t,this.array),n=Kt(n,this.array),r=Kt(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=Kt(t,this.array),n=Kt(n,this.array),r=Kt(r,this.array),s=Kt(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==eg&&(e.usage=this.usage),e}}class ose extends kn{constructor(e,t,n){super(new Int8Array(e),t,n)}}class lse extends kn{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class cse extends kn{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class use extends kn{constructor(e,t,n){super(new Int16Array(e),t,n)}}class sA extends kn{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class hse extends kn{constructor(e,t,n){super(new Int32Array(e),t,n)}}class aA extends kn{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class dse extends kn{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=Jp(this.array[e*this.itemSize]);return this.normalized&&(t=es(t,this.array)),t}setX(e,t){return this.normalized&&(t=Kt(t,this.array)),this.array[e*this.itemSize]=fs(t),this}getY(e){let t=Jp(this.array[e*this.itemSize+1]);return this.normalized&&(t=es(t,this.array)),t}setY(e,t){return this.normalized&&(t=Kt(t,this.array)),this.array[e*this.itemSize+1]=fs(t),this}getZ(e){let t=Jp(this.array[e*this.itemSize+2]);return this.normalized&&(t=es(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Kt(t,this.array)),this.array[e*this.itemSize+2]=fs(t),this}getW(e){let t=Jp(this.array[e*this.itemSize+3]);return this.normalized&&(t=es(t,this.array)),t}setW(e,t){return this.normalized&&(t=Kt(t,this.array)),this.array[e*this.itemSize+3]=fs(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Kt(t,this.array),n=Kt(n,this.array)),this.array[e+0]=fs(t),this.array[e+1]=fs(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Kt(t,this.array),n=Kt(n,this.array),r=Kt(r,this.array)),this.array[e+0]=fs(t),this.array[e+1]=fs(n),this.array[e+2]=fs(r),this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=Kt(t,this.array),n=Kt(n,this.array),r=Kt(r,this.array),s=Kt(s,this.array)),this.array[e+0]=fs(t),this.array[e+1]=fs(n),this.array[e+2]=fs(r),this.array[e+3]=fs(s),this}}class _t extends kn{constructor(e,t,n){super(new Float32Array(e),t,n)}}let fse=0;const Ma=new Bt,VS=new xn,lf=new K,qs=new Xi,Rp=new Xi,nr=new K;class Yt extends ul{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:fse++}),this.uuid=ia(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(AB(e)?aA:sA)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new qt().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ma.makeRotationFromQuaternion(e),this.applyMatrix4(Ma),this}rotateX(e){return Ma.makeRotationX(e),this.applyMatrix4(Ma),this}rotateY(e){return Ma.makeRotationY(e),this.applyMatrix4(Ma),this}rotateZ(e){return Ma.makeRotationZ(e),this.applyMatrix4(Ma),this}translate(e,t,n){return Ma.makeTranslation(e,t,n),this.applyMatrix4(Ma),this}scale(e,t,n){return Ma.makeScale(e,t,n),this.applyMatrix4(Ma),this}lookAt(e){return VS.lookAt(e),VS.updateMatrix(),this.applyMatrix4(VS.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(lf).negate(),this.translate(lf.x,lf.y,lf.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let r=0,s=e.length;r<s;r++){const a=e[r];n.push(a.x,a.y,a.z||0)}this.setAttribute("position",new _t(n,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const s=e[r];t.setXYZ(r,s.x,s.y,s.z||0)}e.length>t.count&&lt("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Xi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Vt("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new K(-1/0,-1/0,-1/0),new K(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const s=t[n];qs.setFromBufferAttribute(s),this.morphTargetsRelative?(nr.addVectors(this.boundingBox.min,qs.min),this.boundingBox.expandByPoint(nr),nr.addVectors(this.boundingBox.max,qs.max),this.boundingBox.expandByPoint(nr)):(this.boundingBox.expandByPoint(qs.min),this.boundingBox.expandByPoint(qs.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&Vt('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Yi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Vt("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new K,1/0);return}if(e){const n=this.boundingSphere.center;if(qs.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){const o=t[s];Rp.setFromBufferAttribute(o),this.morphTargetsRelative?(nr.addVectors(qs.min,Rp.min),qs.expandByPoint(nr),nr.addVectors(qs.max,Rp.max),qs.expandByPoint(nr)):(qs.expandByPoint(Rp.min),qs.expandByPoint(Rp.max))}qs.getCenter(n);let r=0;for(let s=0,a=e.count;s<a;s++)nr.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(nr));if(t)for(let s=0,a=t.length;s<a;s++){const o=t[s],l=this.morphTargetsRelative;for(let c=0,u=o.count;c<u;c++)nr.fromBufferAttribute(o,c),l&&(lf.fromBufferAttribute(e,c),nr.add(lf)),r=Math.max(r,n.distanceToSquared(nr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&Vt('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){Vt("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new kn(new Float32Array(4*n.count),4));const a=this.getAttribute("tangent"),o=[],l=[];for(let O=0;O<n.count;O++)o[O]=new K,l[O]=new K;const c=new K,u=new K,d=new K,p=new Me,m=new Me,g=new Me,y=new K,x=new K;function _(O,R,P){c.fromBufferAttribute(n,O),u.fromBufferAttribute(n,R),d.fromBufferAttribute(n,P),p.fromBufferAttribute(s,O),m.fromBufferAttribute(s,R),g.fromBufferAttribute(s,P),u.sub(c),d.sub(c),m.sub(p),g.sub(p);const L=1/(m.x*g.y-g.x*m.y);isFinite(L)&&(y.copy(u).multiplyScalar(g.y).addScaledVector(d,-m.y).multiplyScalar(L),x.copy(d).multiplyScalar(m.x).addScaledVector(u,-g.x).multiplyScalar(L),o[O].add(y),o[R].add(y),o[P].add(y),l[O].add(x),l[R].add(x),l[P].add(x))}let S=this.groups;S.length===0&&(S=[{start:0,count:e.count}]);for(let O=0,R=S.length;O<R;++O){const P=S[O],L=P.start,V=P.count;for(let j=L,B=L+V;j<B;j+=3)_(e.getX(j+0),e.getX(j+1),e.getX(j+2))}const w=new K,T=new K,C=new K,E=new K;function D(O){C.fromBufferAttribute(r,O),E.copy(C);const R=o[O];w.copy(R),w.sub(C.multiplyScalar(C.dot(R))).normalize(),T.crossVectors(E,R);const L=T.dot(l[O])<0?-1:1;a.setXYZW(O,w.x,w.y,w.z,L)}for(let O=0,R=S.length;O<R;++O){const P=S[O],L=P.start,V=P.count;for(let j=L,B=L+V;j<B;j+=3)D(e.getX(j+0)),D(e.getX(j+1)),D(e.getX(j+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new kn(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let p=0,m=n.count;p<m;p++)n.setXYZ(p,0,0,0);const r=new K,s=new K,a=new K,o=new K,l=new K,c=new K,u=new K,d=new K;if(e)for(let p=0,m=e.count;p<m;p+=3){const g=e.getX(p+0),y=e.getX(p+1),x=e.getX(p+2);r.fromBufferAttribute(t,g),s.fromBufferAttribute(t,y),a.fromBufferAttribute(t,x),u.subVectors(a,s),d.subVectors(r,s),u.cross(d),o.fromBufferAttribute(n,g),l.fromBufferAttribute(n,y),c.fromBufferAttribute(n,x),o.add(u),l.add(u),c.add(u),n.setXYZ(g,o.x,o.y,o.z),n.setXYZ(y,l.x,l.y,l.z),n.setXYZ(x,c.x,c.y,c.z)}else for(let p=0,m=t.count;p<m;p+=3)r.fromBufferAttribute(t,p+0),s.fromBufferAttribute(t,p+1),a.fromBufferAttribute(t,p+2),u.subVectors(a,s),d.subVectors(r,s),u.cross(d),n.setXYZ(p+0,u.x,u.y,u.z),n.setXYZ(p+1,u.x,u.y,u.z),n.setXYZ(p+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)nr.fromBufferAttribute(e,t),nr.normalize(),e.setXYZ(t,nr.x,nr.y,nr.z)}toNonIndexed(){function e(o,l){const c=o.array,u=o.itemSize,d=o.normalized,p=new c.constructor(l.length*u);let m=0,g=0;for(let y=0,x=l.length;y<x;y++){o.isInterleavedBufferAttribute?m=l[y]*o.data.stride+o.offset:m=l[y]*u;for(let _=0;_<u;_++)p[g++]=c[m++]}return new kn(p,u,d)}if(this.index===null)return lt("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Yt,n=this.index.array,r=this.attributes;for(const o in r){const l=r[o],c=e(l,n);t.setAttribute(o,c)}const s=this.morphAttributes;for(const o in s){const l=[],c=s[o];for(let u=0,d=c.length;u<d;u++){const p=c[u],m=e(p,n);l.push(m)}t.morphAttributes[o]=l}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,l=a.length;o<l;o++){const c=a[o];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const l in n){const c=n[l];e.data.attributes[l]=c.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let d=0,p=c.length;d<p;d++){const m=c[d];u.push(m.toJSON(e.data))}u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere=o.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const r=e.attributes;for(const c in r){const u=r[c];this.setAttribute(c,u.clone(t))}const s=e.morphAttributes;for(const c in s){const u=[],d=s[c];for(let p=0,m=d.length;p<m;p++)u.push(d[p].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let c=0,u=a.length;c<u;c++){const d=a[c];this.addGroup(d.start,d.count,d.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const u9=new Bt,ch=new fd,b1=new Yi,h9=new K,_1=new K,S1=new K,w1=new K,GS=new K,M1=new K,d9=new K,T1=new K;class Bi extends xn{constructor(e=new Yt,t=new Lu){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const o=this.morphTargetInfluences;if(s&&o){M1.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=o[l],d=s[l];u!==0&&(GS.fromBufferAttribute(d,e),a?M1.addScaledVector(GS,u):M1.addScaledVector(GS.sub(t),u))}t.add(M1)}return t}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),b1.copy(n.boundingSphere),b1.applyMatrix4(s),ch.copy(e.ray).recast(e.near),!(b1.containsPoint(ch.origin)===!1&&(ch.intersectSphere(b1,h9)===null||ch.origin.distanceToSquared(h9)>(e.far-e.near)**2))&&(u9.copy(s).invert(),ch.copy(e.ray).applyMatrix4(u9),!(n.boundingBox!==null&&ch.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,ch)))}_computeIntersections(e,t,n){let r;const s=this.geometry,a=this.material,o=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,d=s.attributes.normal,p=s.groups,m=s.drawRange;if(o!==null)if(Array.isArray(a))for(let g=0,y=p.length;g<y;g++){const x=p[g],_=a[x.materialIndex],S=Math.max(x.start,m.start),w=Math.min(o.count,Math.min(x.start+x.count,m.start+m.count));for(let T=S,C=w;T<C;T+=3){const E=o.getX(T),D=o.getX(T+1),O=o.getX(T+2);r=A1(this,_,e,n,c,u,d,E,D,O),r&&(r.faceIndex=Math.floor(T/3),r.face.materialIndex=x.materialIndex,t.push(r))}}else{const g=Math.max(0,m.start),y=Math.min(o.count,m.start+m.count);for(let x=g,_=y;x<_;x+=3){const S=o.getX(x),w=o.getX(x+1),T=o.getX(x+2);r=A1(this,a,e,n,c,u,d,S,w,T),r&&(r.faceIndex=Math.floor(x/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(a))for(let g=0,y=p.length;g<y;g++){const x=p[g],_=a[x.materialIndex],S=Math.max(x.start,m.start),w=Math.min(l.count,Math.min(x.start+x.count,m.start+m.count));for(let T=S,C=w;T<C;T+=3){const E=T,D=T+1,O=T+2;r=A1(this,_,e,n,c,u,d,E,D,O),r&&(r.faceIndex=Math.floor(T/3),r.face.materialIndex=x.materialIndex,t.push(r))}}else{const g=Math.max(0,m.start),y=Math.min(l.count,m.start+m.count);for(let x=g,_=y;x<_;x+=3){const S=x,w=x+1,T=x+2;r=A1(this,a,e,n,c,u,d,S,w,T),r&&(r.faceIndex=Math.floor(x/3),t.push(r))}}}}function pse(i,e,t,n,r,s,a,o){let l;if(e.side===as?l=n.intersectTriangle(a,s,r,!0,o):l=n.intersectTriangle(r,s,a,e.side===hc,o),l===null)return null;T1.copy(o),T1.applyMatrix4(i.matrixWorld);const c=t.ray.origin.distanceTo(T1);return c<t.near||c>t.far?null:{distance:c,point:T1.clone(),object:i}}function A1(i,e,t,n,r,s,a,o,l,c){i.getVertexPosition(o,_1),i.getVertexPosition(l,S1),i.getVertexPosition(c,w1);const u=pse(i,e,t,n,_1,S1,w1,d9);if(u){const d=new K;Ss.getBarycoord(d9,_1,S1,w1,d),r&&(u.uv=Ss.getInterpolatedAttribute(r,o,l,c,d,new Me)),s&&(u.uv1=Ss.getInterpolatedAttribute(s,o,l,c,d,new Me)),a&&(u.normal=Ss.getInterpolatedAttribute(a,o,l,c,d,new K),u.normal.dot(n.direction)>0&&u.normal.multiplyScalar(-1));const p={a:o,b:l,c,normal:new K,materialIndex:0};Ss.getNormal(_1,S1,w1,p.normal),u.face=p,u.barycoord=d}return u}class pd extends Yt{constructor(e=1,t=1,n=1,r=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:a};const o=this;r=Math.floor(r),s=Math.floor(s),a=Math.floor(a);const l=[],c=[],u=[],d=[];let p=0,m=0;g("z","y","x",-1,-1,n,t,e,a,s,0),g("z","y","x",1,-1,n,t,-e,a,s,1),g("x","z","y",1,1,e,n,t,r,a,2),g("x","z","y",1,-1,e,n,-t,r,a,3),g("x","y","z",1,-1,e,t,n,r,s,4),g("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(l),this.setAttribute("position",new _t(c,3)),this.setAttribute("normal",new _t(u,3)),this.setAttribute("uv",new _t(d,2));function g(y,x,_,S,w,T,C,E,D,O,R){const P=T/D,L=C/O,V=T/2,j=C/2,B=E/2,J=D+1,U=O+1;let X=0,$=0;const Q=new K;for(let se=0;se<U;se++){const ye=se*L-j;for(let we=0;we<J;we++){const He=we*P-V;Q[y]=He*S,Q[x]=ye*w,Q[_]=B,c.push(Q.x,Q.y,Q.z),Q[y]=0,Q[x]=0,Q[_]=E>0?1:-1,u.push(Q.x,Q.y,Q.z),d.push(we/D),d.push(1-se/O),X+=1}}for(let se=0;se<O;se++)for(let ye=0;ye<D;ye++){const we=p+ye+J*se,He=p+ye+J*(se+1),De=p+(ye+1)+J*(se+1),Oe=p+(ye+1)+J*se;l.push(we,He,Oe),l.push(He,De,Oe),$+=6}o.addGroup(m,$,R),m+=$,p+=X}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pd(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function m0(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(lt("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function Kr(i){const e={};for(let t=0;t<i.length;t++){const n=m0(i[t]);for(const r in n)e[r]=n[r]}return e}function mse(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function PB(i){const e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:fn.workingColorSpace}const ig={clone:m0,merge:Kr};var gse=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,xse=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Ps extends Wr{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=gse,this.fragmentShader=xse,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=m0(e.uniforms),this.uniformsGroups=mse(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;a&&a.isTexture?t.uniforms[r]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[r]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[r]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[r]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[r]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[r]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[r]={type:"m4",value:a.toArray()}:t.uniforms[r]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class d2 extends xn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Bt,this.projectionMatrix=new Bt,this.projectionMatrixInverse=new Bt,this.coordinateSystem=Js,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Gc=new K,f9=new Me,p9=new Me;class Pi extends d2{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=f0*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Wh*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return f0*2*Math.atan(Math.tan(Wh*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Gc.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Gc.x,Gc.y).multiplyScalar(-e/Gc.z),Gc.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Gc.x,Gc.y).multiplyScalar(-e/Gc.z)}getViewSize(e,t){return this.getViewBounds(e,f9,p9),t.subVectors(p9,f9)}setViewOffset(e,t,n,r,s,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Wh*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r;const a=this.view;if(this.view!==null&&this.view.enabled){const l=a.fullWidth,c=a.fullHeight;s+=a.offsetX*r/l,t-=a.offsetY*n/c,r*=a.width/l,n*=a.height/c}const o=this.filmOffset;o!==0&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const cf=-90,uf=1;class IB extends xn{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Pi(cf,uf,e,t);r.layers=this.layers,this.add(r);const s=new Pi(cf,uf,e,t);s.layers=this.layers,this.add(s);const a=new Pi(cf,uf,e,t);a.layers=this.layers,this.add(a);const o=new Pi(cf,uf,e,t);o.layers=this.layers,this.add(o);const l=new Pi(cf,uf,e,t);l.layers=this.layers,this.add(l);const c=new Pi(cf,uf,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,s,a,o,l]=t;for(const c of t)this.remove(c);if(e===Js)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===h0)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,o,l,c,u]=this.children,d=e.getRenderTarget(),p=e.getActiveCubeFace(),m=e.getActiveMipmapLevel(),g=e.xr.enabled;e.xr.enabled=!1;const y=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,s),e.setRenderTarget(n,1,r),e.render(t,a),e.setRenderTarget(n,2,r),e.render(t,o),e.setRenderTarget(n,3,r),e.render(t,l),e.setRenderTarget(n,4,r),e.render(t,c),n.texture.generateMipmaps=y,e.setRenderTarget(n,5,r),e.render(t,u),e.setRenderTarget(d,p,m),e.xr.enabled=g,n.texture.needsPMREMUpdate=!0}}class Xg extends ri{constructor(e=[],t=dc,n,r,s,a,o,l,c,u){super(e,t,n,r,s,a,o,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class DB extends go{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new Xg(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new pd(5,5,5),s=new Ps({name:"CubemapFromEquirect",uniforms:m0(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:as,blending:Yo});s.uniforms.tEquirect.value=t;const a=new Bi(r,s),o=t.minFilter;return t.minFilter===Ho&&(t.minFilter=Jn),new IB(1,10,this).update(e,a),t.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,t=!0,n=!0,r=!0){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(s)}}let Of=class extends xn{constructor(){super(),this.isGroup=!0,this.type="Group"}};const yse={type:"move"};class Ly{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Of,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Of,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new K,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new K),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Of,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new K,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new K),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,a=null;const o=this._targetRay,l=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){a=!0;for(const y of e.hand.values()){const x=t.getJointPose(y,n),_=this._getHandJoint(c,y);x!==null&&(_.matrix.fromArray(x.transform.matrix),_.matrix.decompose(_.position,_.rotation,_.scale),_.matrixWorldNeedsUpdate=!0,_.jointRadius=x.radius),_.visible=x!==null}const u=c.joints["index-finger-tip"],d=c.joints["thumb-tip"],p=u.position.distanceTo(d.position),m=.02,g=.005;c.inputState.pinching&&p>m+g?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&p<=m-g&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));o!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&s!==null&&(r=s),r!==null&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(yse)))}return o!==null&&(o.visible=r!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new Of;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class f2{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new pt(e),this.density=t}clone(){return new f2(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class p2{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new pt(e),this.near=t,this.far=n}clone(){return new p2(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class oA extends xn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new la,this.environmentIntensity=1,this.environmentRotation=new la,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class m2{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=eg,this.updateRanges=[],this.version=0,this.uuid=ia()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ia()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ia()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Yr=new K;class ea{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Yr.fromBufferAttribute(this,t),Yr.applyMatrix4(e),this.setXYZ(t,Yr.x,Yr.y,Yr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Yr.fromBufferAttribute(this,t),Yr.applyNormalMatrix(e),this.setXYZ(t,Yr.x,Yr.y,Yr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Yr.fromBufferAttribute(this,t),Yr.transformDirection(e),this.setXYZ(t,Yr.x,Yr.y,Yr.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=es(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Kt(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=Kt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Kt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Kt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Kt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=es(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=es(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=es(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=es(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Kt(t,this.array),n=Kt(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Kt(t,this.array),n=Kt(n,this.array),r=Kt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Kt(t,this.array),n=Kt(n,this.array),r=Kt(r,this.array),s=Kt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){ng("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new kn(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new ea(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){ng("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class lA extends Wr{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new pt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let hf;const Pp=new K,df=new K,ff=new K,pf=new Me,Ip=new Me,NB=new Bt,C1=new K,Dp=new K,E1=new K,m9=new Me,WS=new Me,g9=new Me;class LB extends xn{constructor(e=new lA){if(super(),this.isSprite=!0,this.type="Sprite",hf===void 0){hf=new Yt;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new m2(t,5);hf.setIndex([0,1,2,0,2,3]),hf.setAttribute("position",new ea(n,3,0,!1)),hf.setAttribute("uv",new ea(n,2,3,!1))}this.geometry=hf,this.material=e,this.center=new Me(.5,.5),this.count=1}raycast(e,t){e.camera===null&&Vt('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),df.setFromMatrixScale(this.matrixWorld),NB.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ff.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&df.multiplyScalar(-ff.z);const n=this.material.rotation;let r,s;n!==0&&(s=Math.cos(n),r=Math.sin(n));const a=this.center;R1(C1.set(-.5,-.5,0),ff,a,df,r,s),R1(Dp.set(.5,-.5,0),ff,a,df,r,s),R1(E1.set(.5,.5,0),ff,a,df,r,s),m9.set(0,0),WS.set(1,0),g9.set(1,1);let o=e.ray.intersectTriangle(C1,Dp,E1,!1,Pp);if(o===null&&(R1(Dp.set(-.5,.5,0),ff,a,df,r,s),WS.set(0,1),o=e.ray.intersectTriangle(C1,E1,Dp,!1,Pp),o===null))return;const l=e.ray.origin.distanceTo(Pp);l<e.near||l>e.far||t.push({distance:l,point:Pp.clone(),uv:Ss.getInterpolation(Pp,C1,Dp,E1,m9,WS,g9,new Me),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function R1(i,e,t,n,r,s){pf.subVectors(i,t).addScalar(.5).multiply(n),r!==void 0?(Ip.x=s*pf.x-r*pf.y,Ip.y=r*pf.x+s*pf.y):Ip.copy(pf),i.copy(e),i.x+=Ip.x,i.y+=Ip.y,i.applyMatrix4(NB)}const P1=new K,x9=new K;class kB extends xn{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,r=t.length;n<r;n++){const s=t[n];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const r=this.levels;let s;for(s=0;s<r.length&&!(t<r[s].distance);s++);return r.splice(s,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const r=t.splice(n,1);return this.remove(r[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r;n++){let s=t[n].distance;if(t[n].object.visible&&(s-=s*t[n].hysteresis),e<s)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){P1.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(P1);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){P1.setFromMatrixPosition(e.matrixWorld),x9.setFromMatrixPosition(this.matrixWorld);const n=P1.distanceTo(x9)/e.zoom;t[0].object.visible=!0;let r,s;for(r=1,s=t.length;r<s;r++){let a=t[r].distance;if(t[r].object.visible&&(a-=a*t[r].hysteresis),n>=a)t[r-1].object.visible=!1,t[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let r=0,s=n.length;r<s;r++){const a=n[r];t.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return t}}const y9=new K,v9=new sn,b9=new sn,vse=new K,_9=new Bt,I1=new K,qS=new Yi,S9=new Bt,XS=new fd;class OB extends Bi{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=b5,this.bindMatrix=new Bt,this.bindMatrixInverse=new Bt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Xi),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,I1),this.boundingBox.expandByPoint(I1)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Yi),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,I1),this.boundingSphere.expandByPoint(I1)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,r=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),qS.copy(this.boundingSphere),qS.applyMatrix4(r),e.ray.intersectsSphere(qS)!==!1&&(S9.copy(r).invert(),XS.copy(e.ray).applyMatrix4(S9),!(this.boundingBox!==null&&XS.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,XS)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new sn,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===b5?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===dB?this.bindMatrixInverse.copy(this.bindMatrix).invert():lt("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,r=this.geometry;v9.fromBufferAttribute(r.attributes.skinIndex,e),b9.fromBufferAttribute(r.attributes.skinWeight,e),y9.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const a=b9.getComponent(s);if(a!==0){const o=v9.getComponent(s);_9.multiplyMatrices(n.bones[o].matrixWorld,n.boneInverses[o]),t.addScaledVector(vse.copy(y9).applyMatrix4(_9),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}class cA extends xn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Oa extends ri{constructor(e=null,t=1,n=1,r,s,a,o,l,c=qi,u=qi,d,p){super(null,a,o,l,c,u,r,s,d,p),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const w9=new Bt,bse=new Bt;class g2{constructor(e=[],t=[]){this.uuid=ia(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){lt("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Bt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new Bt;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,a=e.length;s<a;s++){const o=e[s]?e[s].matrixWorld:bse;w9.multiplyMatrices(o,t[s]),w9.toArray(n,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new g2(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Oa(t,e,e,Fr,ns);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const s=e.bones[n];let a=t[s];a===void 0&&(lt("Skeleton: No bone found with UUID:",s),a=new cA),this.bones.push(a),this.boneInverses.push(new Bt().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,s=t.length;r<s;r++){const a=t[r];e.bones.push(a.uuid);const o=n[r];e.boneInverses.push(o.toArray())}return e}}class g0 extends kn{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const mf=new Bt,M9=new Bt,D1=[],T9=new Xi,_se=new Bt,Np=new Bi,Lp=new Yi;class zB extends Bi{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new g0(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,_se)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Xi),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,mf),T9.copy(e.boundingBox).applyMatrix4(mf),this.boundingBox.union(T9)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Yi),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,mf),Lp.copy(e.boundingSphere).applyMatrix4(mf),this.boundingSphere.union(Lp)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,r=this.morphTexture.source.data.data,s=n.length+1,a=e*s+1;for(let o=0;o<n.length;o++)n[o]=r[a+o]}raycast(e,t){const n=this.matrixWorld,r=this.count;if(Np.geometry=this.geometry,Np.material=this.material,Np.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Lp.copy(this.boundingSphere),Lp.applyMatrix4(n),e.ray.intersectsSphere(Lp)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,mf),M9.multiplyMatrices(n,mf),Np.matrixWorld=M9,Np.raycast(e,D1);for(let a=0,o=D1.length;a<o;a++){const l=D1[a];l.instanceId=s,l.object=this,t.push(l)}D1.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new g0(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,r=n.length+1;this.morphTexture===null&&(this.morphTexture=new Oa(new Float32Array(r*this.count),r,this.count,Wg,ns));const s=this.morphTexture.source.data.data;let a=0;for(let c=0;c<n.length;c++)a+=n[c];const o=this.geometry.morphTargetsRelative?1:1-a,l=r*e;s[l]=o,s.set(n,l+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const YS=new K,Sse=new K,wse=new qt;class Wl{constructor(e=new K(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=YS.subVectors(n,t).cross(Sse.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(YS),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||wse.getNormalMatrix(e),r=this.coplanarPoint(YS).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const uh=new Yi,Mse=new Me(.5,.5),N1=new K;class L0{constructor(e=new Wl,t=new Wl,n=new Wl,r=new Wl,s=new Wl,a=new Wl){this.planes=[e,t,n,r,s,a]}set(e,t,n,r,s,a){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(s),o[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=Js,n=!1){const r=this.planes,s=e.elements,a=s[0],o=s[1],l=s[2],c=s[3],u=s[4],d=s[5],p=s[6],m=s[7],g=s[8],y=s[9],x=s[10],_=s[11],S=s[12],w=s[13],T=s[14],C=s[15];if(r[0].setComponents(c-a,m-u,_-g,C-S).normalize(),r[1].setComponents(c+a,m+u,_+g,C+S).normalize(),r[2].setComponents(c+o,m+d,_+y,C+w).normalize(),r[3].setComponents(c-o,m-d,_-y,C-w).normalize(),n)r[4].setComponents(l,p,x,T).normalize(),r[5].setComponents(c-l,m-p,_-x,C-T).normalize();else if(r[4].setComponents(c-l,m-p,_-x,C-T).normalize(),t===Js)r[5].setComponents(c+l,m+p,_+x,C+T).normalize();else if(t===h0)r[5].setComponents(l,p,x,T).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),uh.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),uh.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(uh)}intersectsSprite(e){uh.center.set(0,0,0);const t=Mse.distanceTo(e.center);return uh.radius=.7071067811865476+t,uh.applyMatrix4(e.matrixWorld),this.intersectsSphere(uh)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(N1.x=r.normal.x>0?e.max.x:e.min.x,N1.y=r.normal.y>0?e.max.y:e.min.y,N1.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(N1)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const To=new Bt,Ao=new L0;class x2{constructor(){this.coordinateSystem=Js}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(To.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ao.setFromProjectionMatrix(To,r.coordinateSystem,r.reversedDepth),Ao.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(To.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ao.setFromProjectionMatrix(To,r.coordinateSystem,r.reversedDepth),Ao.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(To.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ao.setFromProjectionMatrix(To,r.coordinateSystem,r.reversedDepth),Ao.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(To.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ao.setFromProjectionMatrix(To,r.coordinateSystem,r.reversedDepth),Ao.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(To.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ao.setFromProjectionMatrix(To,r.coordinateSystem,r.reversedDepth),Ao.containsPoint(e))return!0}return!1}clone(){return new x2}}function $S(i,e){return i-e}function Tse(i,e){return i.z-e.z}function Ase(i,e){return e.z-i.z}class Cse{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,r){const s=this.pool,a=this.list;this.index>=s.length&&s.push({start:-1,count:-1,z:-1,index:-1});const o=s[this.index];a.push(o),this.index++,o.start=e,o.count=t,o.z=n,o.index=r}reset(){this.list.length=0,this.index=0}}const ds=new Bt,Ese=new pt(1,1,1),A9=new L0,Rse=new x2,L1=new Xi,hh=new Yi,kp=new K,C9=new K,Pse=new K,KS=new Cse,Or=new Bi,k1=[];function Ise(i,e,t=0){const n=e.itemSize;if(i.isInterleavedBufferAttribute||i.array.constructor!==e.array.constructor){const r=i.count;for(let s=0;s<r;s++)for(let a=0;a<n;a++)e.setComponent(s+t,a,i.getComponent(s,a))}else e.array.set(i.array,t*n);e.needsUpdate=!0}function dh(i,e){if(i.constructor!==e.constructor){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++)e[n]=i[n]}else{const t=Math.min(i.length,e.length);e.set(new i.constructor(i.buffer,0,t))}}class UB extends Bi{constructor(e,t,n=t*2,r){super(new Yt,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new Oa(t,e,e,Fr,ns);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new Oa(t,e,e,qg,fc);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new Oa(t,e,e,Fr,ns);n.colorSpace=fn.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const a=e.getAttribute(s),{array:o,itemSize:l,normalized:c}=a,u=new o.constructor(n*l),d=new kn(u,l,c);t.setAttribute(s,d)}if(e.getIndex()!==null){const s=n>65535?new Uint32Array(r):new Uint16Array(r);t.setIndex(new kn(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const r=e.getAttribute(n),s=t.getAttribute(n);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Xi);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===!1)continue;const s=t[n].geometryIndex;this.getMatrixAt(n,ds),this.getBoundingBoxAt(s,L1).applyMatrix4(ds),e.union(L1)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Yi);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===!1)continue;const s=t[n].geometryIndex;this.getMatrixAt(n,ds),this.getBoundingSphereAt(s,hh).applyMatrix4(ds),e.union(hh)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const n={visible:!0,active:!0,geometryIndex:e};let r=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort($S),r=this._availableInstanceIds.shift(),this._instanceInfo[r]=n):(r=this._instanceInfo.length,this._instanceInfo.push(n));const s=this._matricesTexture;ds.identity().toArray(s.image.data,r*16),s.needsUpdate=!0;const a=this._colorsTexture;return a&&(Ese.toArray(a.image.data,r*4),a.needsUpdate=!0),this._visibilityChanged=!0,r}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);const r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},s=this._geometryInfo;r.vertexStart=this._nextVertexStart,r.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const a=e.getIndex();if(a!==null&&(r.indexStart=this._nextIndexStart,r.reservedIndexCount=n===-1?a.count:n),r.indexStart!==-1&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let l;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort($S),l=this._availableGeometryIds.shift(),s[l]=r):(l=this._geometryCount,this._geometryCount++,s.push(r)),this.setGeometryAt(l,e),this._nextIndexStart=r.indexStart+r.reservedIndexCount,this._nextVertexStart=r.vertexStart+r.reservedVertexCount,l}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,r=n.getIndex()!==null,s=n.getIndex(),a=t.getIndex(),o=this._geometryInfo[e];if(r&&a.count>o.reservedIndexCount||t.attributes.position.count>o.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const l=o.vertexStart,c=o.reservedVertexCount;o.vertexCount=t.getAttribute("position").count;for(const u in n.attributes){const d=t.getAttribute(u),p=n.getAttribute(u);Ise(d,p,l);const m=d.itemSize;for(let g=d.count,y=c;g<y;g++){const x=l+g;for(let _=0;_<m;_++)p.setComponent(x,_,0)}p.needsUpdate=!0,p.addUpdateRange(l*m,c*m)}if(r){const u=o.indexStart,d=o.reservedIndexCount;o.indexCount=t.getIndex().count;for(let p=0;p<a.count;p++)s.setX(u+p,l+a.getX(p));for(let p=a.count,m=d;p<m;p++)s.setX(u+p,l);s.needsUpdate=!0,s.addUpdateRange(u,o.reservedIndexCount)}return o.start=r?o.indexStart:o.vertexStart,o.count=r?o.indexCount:o.vertexCount,o.boundingBox=null,t.boundingBox!==null&&(o.boundingBox=t.boundingBox.clone()),o.boundingSphere=null,t.boundingSphere!==null&&(o.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const n=this._instanceInfo;for(let r=0,s=n.length;r<s;r++)n[r].active&&n[r].geometryIndex===e&&this.deleteInstance(r);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,r=n.map((a,o)=>o).sort((a,o)=>n[a].vertexStart-n[o].vertexStart),s=this.geometry;for(let a=0,o=n.length;a<o;a++){const l=r[a],c=n[l];if(c.active!==!1){if(s.index!==null){if(c.indexStart!==t){const{indexStart:u,vertexStart:d,reservedIndexCount:p}=c,m=s.index,g=m.array,y=e-d;for(let x=u;x<u+p;x++)g[x]=g[x]+y;m.array.copyWithin(t,u,u+p),m.addUpdateRange(t,p),c.indexStart=t}t+=c.reservedIndexCount}if(c.vertexStart!==e){const{vertexStart:u,reservedVertexCount:d}=c,p=s.attributes;for(const m in p){const g=p[m],{array:y,itemSize:x}=g;y.copyWithin(e*x,u*x,(u+d)*x),g.addUpdateRange(e*x,d*x)}c.vertexStart=e}e+=c.reservedVertexCount,c.start=s.index?c.indexStart:c.vertexStart,this._nextIndexStart=s.index?c.indexStart+c.reservedIndexCount:0,this._nextVertexStart=c.vertexStart+c.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,r=this._geometryInfo[e];if(r.boundingBox===null){const s=new Xi,a=n.index,o=n.attributes.position;for(let l=r.start,c=r.start+r.count;l<c;l++){let u=l;a&&(u=a.getX(u)),s.expandByPoint(kp.fromBufferAttribute(o,u))}r.boundingBox=s}return t.copy(r.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,r=this._geometryInfo[e];if(r.boundingSphere===null){const s=new Yi;this.getBoundingBoxAt(e,L1),L1.getCenter(s.center);const a=n.index,o=n.attributes.position;let l=0;for(let c=r.start,u=r.start+r.count;c<u;c++){let d=c;a&&(d=a.getX(d)),kp.fromBufferAttribute(o,d),l=Math.max(l,s.center.distanceToSquared(kp))}s.radius=Math.sqrt(l),r.boundingSphere=s}return t.copy(r.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,r=this._matricesTexture.image.data;return t.toArray(r,e*16),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort($S);t[t.length-1]===n.length-1;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const r=new Int32Array(e),s=new Int32Array(e);dh(this._multiDrawCounts,r),dh(this._multiDrawStarts,s),this._multiDrawCounts=r,this._multiDrawStarts=s,this._maxInstanceCount=e;const a=this._indirectTexture,o=this._matricesTexture,l=this._colorsTexture;a.dispose(),this._initIndirectTexture(),dh(a.image.data,this._indirectTexture.image.data),o.dispose(),this._initMatricesTexture(),dh(o.image.data,this._matricesTexture.image.data),l&&(l.dispose(),this._initColorsTexture(),dh(l.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(o=>o.active);if(Math.max(...n.map(o=>o.vertexStart+o.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...n.map(l=>l.indexStart+l.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const s=this.geometry;s.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new Yt,this._initializeGeometry(s));const a=this.geometry;s.index&&dh(s.index.array,a.index.array);for(const o in s.attributes)dh(s.attributes[o].array,a.attributes[o].array)}raycast(e,t){const n=this._instanceInfo,r=this._geometryInfo,s=this.matrixWorld,a=this.geometry;Or.material=this.material,Or.geometry.index=a.index,Or.geometry.attributes=a.attributes,Or.geometry.boundingBox===null&&(Or.geometry.boundingBox=new Xi),Or.geometry.boundingSphere===null&&(Or.geometry.boundingSphere=new Yi);for(let o=0,l=n.length;o<l;o++){if(!n[o].visible||!n[o].active)continue;const c=n[o].geometryIndex,u=r[c];Or.geometry.setDrawRange(u.start,u.count),this.getMatrixAt(o,Or.matrixWorld).premultiply(s),this.getBoundingBoxAt(c,Or.geometry.boundingBox),this.getBoundingSphereAt(c,Or.geometry.boundingSphere),Or.raycast(e,k1);for(let d=0,p=k1.length;d<p;d++){const m=k1[d];m.object=this,m.batchId=o,t.push(m)}k1.length=0}Or.material=null,Or.geometry.index=null,Or.geometry.attributes={},Or.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=r.getIndex(),o=a===null?1:a.array.BYTES_PER_ELEMENT,l=this._instanceInfo,c=this._multiDrawStarts,u=this._multiDrawCounts,d=this._geometryInfo,p=this.perObjectFrustumCulled,m=this._indirectTexture,g=m.image.data,y=n.isArrayCamera?Rse:A9;p&&!n.isArrayCamera&&(ds.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),A9.setFromProjectionMatrix(ds,n.coordinateSystem,n.reversedDepth));let x=0;if(this.sortObjects){ds.copy(this.matrixWorld).invert(),kp.setFromMatrixPosition(n.matrixWorld).applyMatrix4(ds),C9.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(ds);for(let w=0,T=l.length;w<T;w++)if(l[w].visible&&l[w].active){const C=l[w].geometryIndex;this.getMatrixAt(w,ds),this.getBoundingSphereAt(C,hh).applyMatrix4(ds);let E=!1;if(p&&(E=!y.intersectsSphere(hh,n)),!E){const D=d[C],O=Pse.subVectors(hh.center,kp).dot(C9);KS.push(D.start,D.count,O,w)}}const _=KS.list,S=this.customSort;S===null?_.sort(s.transparent?Ase:Tse):S.call(this,_,n);for(let w=0,T=_.length;w<T;w++){const C=_[w];c[x]=C.start*o,u[x]=C.count,g[x]=C.index,x++}KS.reset()}else for(let _=0,S=l.length;_<S;_++)if(l[_].visible&&l[_].active){const w=l[_].geometryIndex;let T=!1;if(p&&(this.getMatrixAt(_,ds),this.getBoundingSphereAt(w,hh).applyMatrix4(ds),T=!y.intersectsSphere(hh,n)),!T){const C=d[w];c[x]=C.start*o,u[x]=C.count,g[x]=_,x++}}m.needsUpdate=!0,this._multiDrawCount=x,this._visibilityChanged=!1}onBeforeShadow(e,t,n,r,s,a){this.onBeforeRender(e,null,r,s,a)}}class os extends Wr{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new pt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const qv=new K,Xv=new K,E9=new Bt,Op=new fd,O1=new Yi,ZS=new K,R9=new K;let bu=class extends xn{constructor(e=new Yt,t=new os){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)qv.fromBufferAttribute(t,r-1),Xv.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=qv.distanceTo(Xv);e.setAttribute("lineDistance",new _t(n,1))}else lt("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),O1.copy(n.boundingSphere),O1.applyMatrix4(r),O1.radius+=s,e.ray.intersectsSphere(O1)===!1)return;E9.copy(r).invert(),Op.copy(e.ray).applyMatrix4(E9);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,c=this.isLineSegments?2:1,u=n.index,p=n.attributes.position;if(u!==null){const m=Math.max(0,a.start),g=Math.min(u.count,a.start+a.count);for(let y=m,x=g-1;y<x;y+=c){const _=u.getX(y),S=u.getX(y+1),w=z1(this,e,Op,l,_,S,y);w&&t.push(w)}if(this.isLineLoop){const y=u.getX(g-1),x=u.getX(m),_=z1(this,e,Op,l,y,x,g-1);_&&t.push(_)}}else{const m=Math.max(0,a.start),g=Math.min(p.count,a.start+a.count);for(let y=m,x=g-1;y<x;y+=c){const _=z1(this,e,Op,l,y,y+1,y);_&&t.push(_)}if(this.isLineLoop){const y=z1(this,e,Op,l,g-1,m,g-1);y&&t.push(y)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}};function z1(i,e,t,n,r,s,a){const o=i.geometry.attributes.position;if(qv.fromBufferAttribute(o,r),Xv.fromBufferAttribute(o,s),t.distanceSqToSegment(qv,Xv,ZS,R9)>n)return;ZS.applyMatrix4(i.matrixWorld);const c=e.ray.origin.distanceTo(ZS);if(!(c<e.near||c>e.far))return{distance:c,point:R9.clone().applyMatrix4(i.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:i}}const P9=new K,I9=new K;class hl extends bu{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let r=0,s=t.count;r<s;r+=2)P9.fromBufferAttribute(t,r),I9.fromBufferAttribute(t,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+P9.distanceTo(I9);e.setAttribute("lineDistance",new _t(n,1))}else lt("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class FB extends bu{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class uA extends Wr{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new pt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const D9=new Bt,w5=new fd,U1=new Yi,F1=new K;class BB extends xn{constructor(e=new Yt,t=new uA){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),U1.copy(n.boundingSphere),U1.applyMatrix4(r),U1.radius+=s,e.ray.intersectsSphere(U1)===!1)return;D9.copy(r).invert(),w5.copy(e.ray).applyMatrix4(D9);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,c=n.index,d=n.attributes.position;if(c!==null){const p=Math.max(0,a.start),m=Math.min(c.count,a.start+a.count);for(let g=p,y=m;g<y;g++){const x=c.getX(g);F1.fromBufferAttribute(d,x),N9(F1,x,l,r,e,t,this)}}else{const p=Math.max(0,a.start),m=Math.min(d.count,a.start+a.count);for(let g=p,y=m;g<y;g++)F1.fromBufferAttribute(d,g),N9(F1,g,l,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function N9(i,e,t,n,r,s,a){const o=w5.distanceSqToPoint(i);if(o<t){const l=new K;w5.closestPointToPoint(i,l),l.applyMatrix4(n);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(o),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:a})}}class HB extends ri{constructor(e,t,n,r,s=Jn,a=Jn,o,l,c){super(e,t,n,r,s,a,o,l,c),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const u=this;function d(){u.needsUpdate=!0,u._requestVideoFrameCallbackId=e.requestVideoFrameCallback(d)}"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(d))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}}class Dse extends HB{constructor(e,t,n,r,s,a,o,l){super({},e,t,n,r,s,a,o,l),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class Nse extends ri{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=qi,this.minFilter=qi,this.generateMipmaps=!1,this.needsUpdate=!0}}class y2 extends ri{constructor(e,t,n,r,s,a,o,l,c,u,d,p){super(null,a,o,l,c,u,r,s,d,p),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class Lse extends y2{constructor(e,t,n,r,s,a){super(e,t,n,s,a),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=or,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class kse extends y2{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,dc),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class Ose extends ri{constructor(e,t,n,r,s,a,o,l,c){super(e,t,n,r,s,a,o,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class v2 extends ri{constructor(e,t,n=fc,r,s,a,o=qi,l=qi,c,u=c0,d=1){if(u!==c0&&u!==u0)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const p={width:e,height:t,depth:d};super(p,r,s,a,o,l,u,n,c),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new iu(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class hA extends ri{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class b2 extends Yt{constructor(e=1,t=1,n=4,r=8,s=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:r,heightSegments:s},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),r=Math.max(3,Math.floor(r)),s=Math.max(1,Math.floor(s));const a=[],o=[],l=[],c=[],u=t/2,d=Math.PI/2*e,p=t,m=2*d+p,g=n*2+s,y=r+1,x=new K,_=new K;for(let S=0;S<=g;S++){let w=0,T=0,C=0,E=0;if(S<=n){const R=S/n,P=R*Math.PI/2;T=-u-e*Math.cos(P),C=e*Math.sin(P),E=-e*Math.cos(P),w=R*d}else if(S<=n+s){const R=(S-n)/s;T=-u+R*t,C=e,E=0,w=d+R*p}else{const R=(S-n-s)/n,P=R*Math.PI/2;T=u+e*Math.sin(P),C=e*Math.cos(P),E=e*Math.sin(P),w=d+p+R*d}const D=Math.max(0,Math.min(1,w/m));let O=0;S===0?O=.5/r:S===g&&(O=-.5/r);for(let R=0;R<=r;R++){const P=R/r,L=P*Math.PI*2,V=Math.sin(L),j=Math.cos(L);_.x=-C*j,_.y=T,_.z=C*V,o.push(_.x,_.y,_.z),x.set(-C*j,E,C*V),x.normalize(),l.push(x.x,x.y,x.z),c.push(P+O,D)}if(S>0){const R=(S-1)*y;for(let P=0;P<r;P++){const L=R+P,V=R+P+1,j=S*y+P,B=S*y+P+1;a.push(L,V,j),a.push(V,B,j)}}}this.setIndex(a),this.setAttribute("position",new _t(o,3)),this.setAttribute("normal",new _t(l,3)),this.setAttribute("uv",new _t(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new b2(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class _2 extends Yt{constructor(e=1,t=32,n=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const s=[],a=[],o=[],l=[],c=new K,u=new Me;a.push(0,0,0),o.push(0,0,1),l.push(.5,.5);for(let d=0,p=3;d<=t;d++,p+=3){const m=n+d/t*r;c.x=e*Math.cos(m),c.y=e*Math.sin(m),a.push(c.x,c.y,c.z),o.push(0,0,1),u.x=(a[p]/e+1)/2,u.y=(a[p+1]/e+1)/2,l.push(u.x,u.y)}for(let d=1;d<=t;d++)s.push(d,d+1,0);this.setIndex(s),this.setAttribute("position",new _t(a,3)),this.setAttribute("normal",new _t(o,3)),this.setAttribute("uv",new _t(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _2(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Yg extends Yt{constructor(e=1,t=1,n=1,r=32,s=1,a=!1,o=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const u=[],d=[],p=[],m=[];let g=0;const y=[],x=n/2;let _=0;S(),a===!1&&(e>0&&w(!0),t>0&&w(!1)),this.setIndex(u),this.setAttribute("position",new _t(d,3)),this.setAttribute("normal",new _t(p,3)),this.setAttribute("uv",new _t(m,2));function S(){const T=new K,C=new K;let E=0;const D=(t-e)/n;for(let O=0;O<=s;O++){const R=[],P=O/s,L=P*(t-e)+e;for(let V=0;V<=r;V++){const j=V/r,B=j*l+o,J=Math.sin(B),U=Math.cos(B);C.x=L*J,C.y=-P*n+x,C.z=L*U,d.push(C.x,C.y,C.z),T.set(J,D,U).normalize(),p.push(T.x,T.y,T.z),m.push(j,1-P),R.push(g++)}y.push(R)}for(let O=0;O<r;O++)for(let R=0;R<s;R++){const P=y[R][O],L=y[R+1][O],V=y[R+1][O+1],j=y[R][O+1];(e>0||R!==0)&&(u.push(P,L,j),E+=3),(t>0||R!==s-1)&&(u.push(L,V,j),E+=3)}c.addGroup(_,E,0),_+=E}function w(T){const C=g,E=new Me,D=new K;let O=0;const R=T===!0?e:t,P=T===!0?1:-1;for(let V=1;V<=r;V++)d.push(0,x*P,0),p.push(0,P,0),m.push(.5,.5),g++;const L=g;for(let V=0;V<=r;V++){const B=V/r*l+o,J=Math.cos(B),U=Math.sin(B);D.x=R*U,D.y=x*P,D.z=R*J,d.push(D.x,D.y,D.z),p.push(0,P,0),E.x=J*.5+.5,E.y=U*.5*P+.5,m.push(E.x,E.y),g++}for(let V=0;V<r;V++){const j=C+V,B=L+V;T===!0?u.push(B,B+1,j):u.push(B+1,B,j),O+=3}c.addGroup(_,O,T===!0?1:2),_+=O}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Yg(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class $g extends Yg{constructor(e=1,t=1,n=32,r=1,s=!1,a=0,o=Math.PI*2){super(0,e,t,n,r,s,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:a,thetaLength:o}}static fromJSON(e){return new $g(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class ku extends Yt{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const s=[],a=[];o(r),c(n),u(),this.setAttribute("position",new _t(s,3)),this.setAttribute("normal",new _t(s.slice(),3)),this.setAttribute("uv",new _t(a,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function o(S){const w=new K,T=new K,C=new K;for(let E=0;E<t.length;E+=3)m(t[E+0],w),m(t[E+1],T),m(t[E+2],C),l(w,T,C,S)}function l(S,w,T,C){const E=C+1,D=[];for(let O=0;O<=E;O++){D[O]=[];const R=S.clone().lerp(T,O/E),P=w.clone().lerp(T,O/E),L=E-O;for(let V=0;V<=L;V++)V===0&&O===E?D[O][V]=R:D[O][V]=R.clone().lerp(P,V/L)}for(let O=0;O<E;O++)for(let R=0;R<2*(E-O)-1;R++){const P=Math.floor(R/2);R%2===0?(p(D[O][P+1]),p(D[O+1][P]),p(D[O][P])):(p(D[O][P+1]),p(D[O+1][P+1]),p(D[O+1][P]))}}function c(S){const w=new K;for(let T=0;T<s.length;T+=3)w.x=s[T+0],w.y=s[T+1],w.z=s[T+2],w.normalize().multiplyScalar(S),s[T+0]=w.x,s[T+1]=w.y,s[T+2]=w.z}function u(){const S=new K;for(let w=0;w<s.length;w+=3){S.x=s[w+0],S.y=s[w+1],S.z=s[w+2];const T=x(S)/2/Math.PI+.5,C=_(S)/Math.PI+.5;a.push(T,1-C)}g(),d()}function d(){for(let S=0;S<a.length;S+=6){const w=a[S+0],T=a[S+2],C=a[S+4],E=Math.max(w,T,C),D=Math.min(w,T,C);E>.9&&D<.1&&(w<.2&&(a[S+0]+=1),T<.2&&(a[S+2]+=1),C<.2&&(a[S+4]+=1))}}function p(S){s.push(S.x,S.y,S.z)}function m(S,w){const T=S*3;w.x=e[T+0],w.y=e[T+1],w.z=e[T+2]}function g(){const S=new K,w=new K,T=new K,C=new K,E=new Me,D=new Me,O=new Me;for(let R=0,P=0;R<s.length;R+=9,P+=6){S.set(s[R+0],s[R+1],s[R+2]),w.set(s[R+3],s[R+4],s[R+5]),T.set(s[R+6],s[R+7],s[R+8]),E.set(a[P+0],a[P+1]),D.set(a[P+2],a[P+3]),O.set(a[P+4],a[P+5]),C.copy(S).add(w).add(T).divideScalar(3);const L=x(C);y(E,P+0,S,L),y(D,P+2,w,L),y(O,P+4,T,L)}}function y(S,w,T,C){C<0&&S.x===1&&(a[w]=S.x-1),T.x===0&&T.z===0&&(a[w]=C/2/Math.PI+.5)}function x(S){return Math.atan2(S.z,-S.x)}function _(S){return Math.atan2(-S.y,Math.sqrt(S.x*S.x+S.z*S.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ku(e.vertices,e.indices,e.radius,e.details)}}class S2 extends ku{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=1/n,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,a,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new S2(e.radius,e.detail)}}const B1=new K,H1=new K,QS=new K,j1=new Ss;class jB extends Yt{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const r=Math.pow(10,4),s=Math.cos(Wh*t),a=e.getIndex(),o=e.getAttribute("position"),l=a?a.count:o.count,c=[0,0,0],u=["a","b","c"],d=new Array(3),p={},m=[];for(let g=0;g<l;g+=3){a?(c[0]=a.getX(g),c[1]=a.getX(g+1),c[2]=a.getX(g+2)):(c[0]=g,c[1]=g+1,c[2]=g+2);const{a:y,b:x,c:_}=j1;if(y.fromBufferAttribute(o,c[0]),x.fromBufferAttribute(o,c[1]),_.fromBufferAttribute(o,c[2]),j1.getNormal(QS),d[0]=`${Math.round(y.x*r)},${Math.round(y.y*r)},${Math.round(y.z*r)}`,d[1]=`${Math.round(x.x*r)},${Math.round(x.y*r)},${Math.round(x.z*r)}`,d[2]=`${Math.round(_.x*r)},${Math.round(_.y*r)},${Math.round(_.z*r)}`,!(d[0]===d[1]||d[1]===d[2]||d[2]===d[0]))for(let S=0;S<3;S++){const w=(S+1)%3,T=d[S],C=d[w],E=j1[u[S]],D=j1[u[w]],O=`${T}_${C}`,R=`${C}_${T}`;R in p&&p[R]?(QS.dot(p[R].normal)<=s&&(m.push(E.x,E.y,E.z),m.push(D.x,D.y,D.z)),p[R]=null):O in p||(p[O]={index0:c[S],index1:c[w],normal:QS.clone()})}}for(const g in p)if(p[g]){const{index0:y,index1:x}=p[g];B1.fromBufferAttribute(o,y),H1.fromBufferAttribute(o,x),m.push(B1.x,B1.y,B1.z),m.push(H1.x,H1.y,H1.z)}this.setAttribute("position",new _t(m,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class bo{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){lt("Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),s=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let r=0;const s=n.length;let a;t?a=t:a=e*n[s-1];let o=0,l=s-1,c;for(;o<=l;)if(r=Math.floor(o+(l-o)/2),c=n[r]-a,c<0)o=r+1;else if(c>0)l=r-1;else{l=r;break}if(r=l,n[r]===a)return r/(s-1);const u=n[r],p=n[r+1]-u,m=(a-u)/p;return(r+m)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const a=this.getPoint(r),o=this.getPoint(s),l=t||(a.isVector2?new Me:new K);return l.copy(o).sub(a).normalize(),l}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new K,r=[],s=[],a=[],o=new K,l=new Bt;for(let m=0;m<=e;m++){const g=m/e;r[m]=this.getTangentAt(g,new K)}s[0]=new K,a[0]=new K;let c=Number.MAX_VALUE;const u=Math.abs(r[0].x),d=Math.abs(r[0].y),p=Math.abs(r[0].z);u<=c&&(c=u,n.set(1,0,0)),d<=c&&(c=d,n.set(0,1,0)),p<=c&&n.set(0,0,1),o.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],o),a[0].crossVectors(r[0],s[0]);for(let m=1;m<=e;m++){if(s[m]=s[m-1].clone(),a[m]=a[m-1].clone(),o.crossVectors(r[m-1],r[m]),o.length()>Number.EPSILON){o.normalize();const g=Math.acos(Ft(r[m-1].dot(r[m]),-1,1));s[m].applyMatrix4(l.makeRotationAxis(o,g))}a[m].crossVectors(r[m],s[m])}if(t===!0){let m=Math.acos(Ft(s[0].dot(s[e]),-1,1));m/=e,r[0].dot(o.crossVectors(s[0],s[e]))>0&&(m=-m);for(let g=1;g<=e;g++)s[g].applyMatrix4(l.makeRotationAxis(r[g],m*g)),a[g].crossVectors(r[g],s[g])}return{tangents:r,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class w2 extends bo{constructor(e=0,t=0,n=1,r=1,s=0,a=Math.PI*2,o=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=o,this.aRotation=l}getPoint(e,t=new Me){const n=t,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(a?s=0:s=r),this.aClockwise===!0&&!a&&(s===r?s=-r:s=s-r);const o=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(o),c=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){const u=Math.cos(this.aRotation),d=Math.sin(this.aRotation),p=l-this.aX,m=c-this.aY;l=p*u-m*d+this.aX,c=p*d+m*u+this.aY}return n.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class VB extends w2{constructor(e,t,n,r,s,a){super(e,t,n,n,r,s,a),this.isArcCurve=!0,this.type="ArcCurve"}}function dA(){let i=0,e=0,t=0,n=0;function r(s,a,o,l){i=s,e=o,t=-3*s+3*a-2*o-l,n=2*s-2*a+o+l}return{initCatmullRom:function(s,a,o,l,c){r(a,o,c*(o-s),c*(l-a))},initNonuniformCatmullRom:function(s,a,o,l,c,u,d){let p=(a-s)/c-(o-s)/(c+u)+(o-a)/u,m=(o-a)/u-(l-a)/(u+d)+(l-o)/d;p*=u,m*=u,r(a,o,p,m)},calc:function(s){const a=s*s,o=a*s;return i+e*s+t*a+n*o}}}const V1=new K,JS=new dA,e4=new dA,t4=new dA;class GB extends bo{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new K){const n=t,r=this.points,s=r.length,a=(s-(this.closed?0:1))*e;let o=Math.floor(a),l=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/s)+1)*s:l===0&&o===s-1&&(o=s-2,l=1);let c,u;this.closed||o>0?c=r[(o-1)%s]:(V1.subVectors(r[0],r[1]).add(r[0]),c=V1);const d=r[o%s],p=r[(o+1)%s];if(this.closed||o+2<s?u=r[(o+2)%s]:(V1.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=V1),this.curveType==="centripetal"||this.curveType==="chordal"){const m=this.curveType==="chordal"?.5:.25;let g=Math.pow(c.distanceToSquared(d),m),y=Math.pow(d.distanceToSquared(p),m),x=Math.pow(p.distanceToSquared(u),m);y<1e-4&&(y=1),g<1e-4&&(g=y),x<1e-4&&(x=y),JS.initNonuniformCatmullRom(c.x,d.x,p.x,u.x,g,y,x),e4.initNonuniformCatmullRom(c.y,d.y,p.y,u.y,g,y,x),t4.initNonuniformCatmullRom(c.z,d.z,p.z,u.z,g,y,x)}else this.curveType==="catmullrom"&&(JS.initCatmullRom(c.x,d.x,p.x,u.x,this.tension),e4.initCatmullRom(c.y,d.y,p.y,u.y,this.tension),t4.initCatmullRom(c.z,d.z,p.z,u.z,this.tension));return n.set(JS.calc(l),e4.calc(l),t4.calc(l)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new K().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function L9(i,e,t,n,r){const s=(n-e)*.5,a=(r-t)*.5,o=i*i,l=i*o;return(2*t-2*n+s+a)*l+(-3*t+3*n-2*s-a)*o+s*i+t}function zse(i,e){const t=1-i;return t*t*e}function Use(i,e){return 2*(1-i)*i*e}function Fse(i,e){return i*i*e}function bm(i,e,t,n){return zse(i,e)+Use(i,t)+Fse(i,n)}function Bse(i,e){const t=1-i;return t*t*t*e}function Hse(i,e){const t=1-i;return 3*t*t*i*e}function jse(i,e){return 3*(1-i)*i*i*e}function Vse(i,e){return i*i*i*e}function _m(i,e,t,n,r){return Bse(i,e)+Hse(i,t)+jse(i,n)+Vse(i,r)}class fA extends bo{constructor(e=new Me,t=new Me,n=new Me,r=new Me){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new Me){const n=t,r=this.v0,s=this.v1,a=this.v2,o=this.v3;return n.set(_m(e,r.x,s.x,a.x,o.x),_m(e,r.y,s.y,a.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class WB extends bo{constructor(e=new K,t=new K,n=new K,r=new K){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new K){const n=t,r=this.v0,s=this.v1,a=this.v2,o=this.v3;return n.set(_m(e,r.x,s.x,a.x,o.x),_m(e,r.y,s.y,a.y,o.y),_m(e,r.z,s.z,a.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class pA extends bo{constructor(e=new Me,t=new Me){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Me){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Me){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class qB extends bo{constructor(e=new K,t=new K){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new K){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new K){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class mA extends bo{constructor(e=new Me,t=new Me,n=new Me){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Me){const n=t,r=this.v0,s=this.v1,a=this.v2;return n.set(bm(e,r.x,s.x,a.x),bm(e,r.y,s.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class gA extends bo{constructor(e=new K,t=new K,n=new K){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new K){const n=t,r=this.v0,s=this.v1,a=this.v2;return n.set(bm(e,r.x,s.x,a.x),bm(e,r.y,s.y,a.y),bm(e,r.z,s.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class xA extends bo{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Me){const n=t,r=this.points,s=(r.length-1)*e,a=Math.floor(s),o=s-a,l=r[a===0?a:a-1],c=r[a],u=r[a>r.length-2?r.length-1:a+1],d=r[a>r.length-3?r.length-1:a+2];return n.set(L9(o,l.x,c.x,u.x,d.x),L9(o,l.y,c.y,u.y,d.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new Me().fromArray(r))}return this}}var Yv=Object.freeze({__proto__:null,ArcCurve:VB,CatmullRomCurve3:GB,CubicBezierCurve:fA,CubicBezierCurve3:WB,EllipseCurve:w2,LineCurve:pA,LineCurve3:qB,QuadraticBezierCurve:mA,QuadraticBezierCurve3:gA,SplineCurve:xA});class XB extends bo{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Yv[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=n){const a=r[s]-n,o=this.curves[s],l=o.getLength(),c=l===0?0:1-a/l;return o.getPointAt(c,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let r=0,s=this.curves;r<s.length;r++){const a=s[r],o=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,l=a.getPoints(o);for(let c=0;c<l.length;c++){const u=l[c];n&&n.equals(u)||(t.push(u),n=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push(new Yv[r.type]().fromJSON(r))}return this}}let $v=class extends XB{constructor(e){super(),this.type="Path",this.currentPoint=new Me,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new pA(this.currentPoint.clone(),new Me(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const s=new mA(this.currentPoint.clone(),new Me(e,t),new Me(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,s,a){const o=new fA(this.currentPoint.clone(),new Me(e,t),new Me(n,r),new Me(s,a));return this.curves.push(o),this.currentPoint.set(s,a),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new xA(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,s,a){const o=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+o,t+l,n,r,s,a),this}absarc(e,t,n,r,s,a){return this.absellipse(e,t,n,n,r,s,a),this}ellipse(e,t,n,r,s,a,o,l){const c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+c,t+u,n,r,s,a,o,l),this}absellipse(e,t,n,r,s,a,o,l){const c=new w2(e,t,n,r,s,a,o,l);if(this.curves.length>0){const d=c.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}};class qh extends $v{constructor(e){super(e),this.uuid=ia(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push(new $v().fromJSON(r))}return this}}function Gse(i,e,t=2){const n=e&&e.length,r=n?e[0]*t:i.length;let s=YB(i,0,r,t,!0);const a=[];if(!s||s.next===s.prev)return a;let o,l,c;if(n&&(s=$se(i,e,s,t)),i.length>80*t){o=i[0],l=i[1];let u=o,d=l;for(let p=t;p<r;p+=t){const m=i[p],g=i[p+1];m<o&&(o=m),g<l&&(l=g),m>u&&(u=m),g>d&&(d=g)}c=Math.max(u-o,d-l),c=c!==0?32767/c:0}return rg(s,a,t,o,l,c,0),a}function YB(i,e,t,n,r){let s;if(r===aae(i,e,t,n)>0)for(let a=e;a<t;a+=n)s=k9(a/n|0,i[a],i[a+1],s);else for(let a=t-n;a>=e;a-=n)s=k9(a/n|0,i[a],i[a+1],s);return s&&x0(s,s.next)&&(ag(s),s=s.next),s}function ed(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(x0(t,t.next)||pi(t.prev,t,t.next)===0)){if(ag(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function rg(i,e,t,n,r,s,a){if(!i)return;!a&&s&&eae(i,n,r,s);let o=i;for(;i.prev!==i.next;){const l=i.prev,c=i.next;if(s?qse(i,n,r,s):Wse(i)){e.push(l.i,i.i,c.i),ag(i),i=c.next,o=c.next;continue}if(i=c,i===o){a?a===1?(i=Xse(ed(i),e),rg(i,e,t,n,r,s,2)):a===2&&Yse(i,e,t,n,r,s):rg(ed(i),e,t,n,r,s,1);break}}}function Wse(i){const e=i.prev,t=i,n=i.next;if(pi(e,t,n)>=0)return!1;const r=e.x,s=t.x,a=n.x,o=e.y,l=t.y,c=n.y,u=Math.min(r,s,a),d=Math.min(o,l,c),p=Math.max(r,s,a),m=Math.max(o,l,c);let g=n.next;for(;g!==e;){if(g.x>=u&&g.x<=p&&g.y>=d&&g.y<=m&&em(r,o,s,l,a,c,g.x,g.y)&&pi(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function qse(i,e,t,n){const r=i.prev,s=i,a=i.next;if(pi(r,s,a)>=0)return!1;const o=r.x,l=s.x,c=a.x,u=r.y,d=s.y,p=a.y,m=Math.min(o,l,c),g=Math.min(u,d,p),y=Math.max(o,l,c),x=Math.max(u,d,p),_=M5(m,g,e,t,n),S=M5(y,x,e,t,n);let w=i.prevZ,T=i.nextZ;for(;w&&w.z>=_&&T&&T.z<=S;){if(w.x>=m&&w.x<=y&&w.y>=g&&w.y<=x&&w!==r&&w!==a&&em(o,u,l,d,c,p,w.x,w.y)&&pi(w.prev,w,w.next)>=0||(w=w.prevZ,T.x>=m&&T.x<=y&&T.y>=g&&T.y<=x&&T!==r&&T!==a&&em(o,u,l,d,c,p,T.x,T.y)&&pi(T.prev,T,T.next)>=0))return!1;T=T.nextZ}for(;w&&w.z>=_;){if(w.x>=m&&w.x<=y&&w.y>=g&&w.y<=x&&w!==r&&w!==a&&em(o,u,l,d,c,p,w.x,w.y)&&pi(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;T&&T.z<=S;){if(T.x>=m&&T.x<=y&&T.y>=g&&T.y<=x&&T!==r&&T!==a&&em(o,u,l,d,c,p,T.x,T.y)&&pi(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}function Xse(i,e){let t=i;do{const n=t.prev,r=t.next.next;!x0(n,r)&&KB(n,t,t.next,r)&&sg(n,r)&&sg(r,n)&&(e.push(n.i,t.i,r.i),ag(t),ag(t.next),t=i=r),t=t.next}while(t!==i);return ed(t)}function Yse(i,e,t,n,r,s){let a=i;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&iae(a,o)){let l=ZB(a,o);a=ed(a,a.next),l=ed(l,l.next),rg(a,e,t,n,r,s,0),rg(l,e,t,n,r,s,0);return}o=o.next}a=a.next}while(a!==i)}function $se(i,e,t,n){const r=[];for(let s=0,a=e.length;s<a;s++){const o=e[s]*n,l=s<a-1?e[s+1]*n:i.length,c=YB(i,o,l,n,!1);c===c.next&&(c.steiner=!0),r.push(nae(c))}r.sort(Kse);for(let s=0;s<r.length;s++)t=Zse(r[s],t);return t}function Kse(i,e){let t=i.x-e.x;if(t===0&&(t=i.y-e.y,t===0)){const n=(i.next.y-i.y)/(i.next.x-i.x),r=(e.next.y-e.y)/(e.next.x-e.x);t=n-r}return t}function Zse(i,e){const t=Qse(i,e);if(!t)return e;const n=ZB(t,i);return ed(n,n.next),ed(t,t.next)}function Qse(i,e){let t=e;const n=i.x,r=i.y;let s=-1/0,a;if(x0(i,t))return t;do{if(x0(i,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const d=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=n&&d>s&&(s=d,a=t.x<t.next.x?t:t.next,d===n))return a}t=t.next}while(t!==e);if(!a)return null;const o=a,l=a.x,c=a.y;let u=1/0;t=a;do{if(n>=t.x&&t.x>=l&&n!==t.x&&$B(r<c?n:s,r,l,c,r<c?s:n,r,t.x,t.y)){const d=Math.abs(r-t.y)/(n-t.x);sg(t,i)&&(d<u||d===u&&(t.x>a.x||t.x===a.x&&Jse(a,t)))&&(a=t,u=d)}t=t.next}while(t!==o);return a}function Jse(i,e){return pi(i.prev,i,e.prev)<0&&pi(e.next,i,i.next)<0}function eae(i,e,t,n){let r=i;do r.z===0&&(r.z=M5(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,tae(r)}function tae(i){let e,t=1;do{let n=i,r;i=null;let s=null;for(e=0;n;){e++;let a=n,o=0;for(let c=0;c<t&&(o++,a=a.nextZ,!!a);c++);let l=t;for(;o>0||l>0&&a;)o!==0&&(l===0||!a||n.z<=a.z)?(r=n,n=n.nextZ,o--):(r=a,a=a.nextZ,l--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;n=a}s.nextZ=null,t*=2}while(e>1);return i}function M5(i,e,t,n,r){return i=(i-t)*r|0,e=(e-n)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function nae(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function $B(i,e,t,n,r,s,a,o){return(r-a)*(e-o)>=(i-a)*(s-o)&&(i-a)*(n-o)>=(t-a)*(e-o)&&(t-a)*(s-o)>=(r-a)*(n-o)}function em(i,e,t,n,r,s,a,o){return!(i===a&&e===o)&&$B(i,e,t,n,r,s,a,o)}function iae(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!rae(i,e)&&(sg(i,e)&&sg(e,i)&&sae(i,e)&&(pi(i.prev,i,e.prev)||pi(i,e.prev,e))||x0(i,e)&&pi(i.prev,i,i.next)>0&&pi(e.prev,e,e.next)>0)}function pi(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function x0(i,e){return i.x===e.x&&i.y===e.y}function KB(i,e,t,n){const r=W1(pi(i,e,t)),s=W1(pi(i,e,n)),a=W1(pi(t,n,i)),o=W1(pi(t,n,e));return!!(r!==s&&a!==o||r===0&&G1(i,t,e)||s===0&&G1(i,n,e)||a===0&&G1(t,i,n)||o===0&&G1(t,e,n))}function G1(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function W1(i){return i>0?1:i<0?-1:0}function rae(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&KB(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function sg(i,e){return pi(i.prev,i,i.next)<0?pi(i,e,i.next)>=0&&pi(i,i.prev,e)>=0:pi(i,e,i.prev)<0||pi(i,i.next,e)<0}function sae(i,e){let t=i,n=!1;const r=(i.x+e.x)/2,s=(i.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function ZB(i,e){const t=T5(i.i,i.x,i.y),n=T5(e.i,e.x,e.y),r=i.next,s=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function k9(i,e,t,n){const r=T5(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function ag(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function T5(i,e,t){return{i,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function aae(i,e,t,n){let r=0;for(let s=e,a=t-n;s<t;s+=n)r+=(i[a]-i[s])*(i[s+1]+i[a+1]),a=s;return r}class oae{static triangulate(e,t,n=2){return Gse(e,t,n)}}class ho{static area(e){const t=e.length;let n=0;for(let r=t-1,s=0;s<t;r=s++)n+=e[r].x*e[s].y-e[s].x*e[r].y;return n*.5}static isClockWise(e){return ho.area(e)<0}static triangulateShape(e,t){const n=[],r=[],s=[];O9(e),z9(n,e);let a=e.length;t.forEach(O9);for(let l=0;l<t.length;l++)r.push(a),a+=t[l].length,z9(n,t[l]);const o=oae.triangulate(n,r);for(let l=0;l<o.length;l+=3)s.push(o.slice(l,l+3));return s}}function O9(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function z9(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class M2 extends Yt{constructor(e=new qh([new Me(.5,.5),new Me(-.5,.5),new Me(-.5,-.5),new Me(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],s=[];for(let o=0,l=e.length;o<l;o++){const c=e[o];a(c)}this.setAttribute("position",new _t(r,3)),this.setAttribute("uv",new _t(s,2)),this.computeVertexNormals();function a(o){const l=[],c=t.curveSegments!==void 0?t.curveSegments:12,u=t.steps!==void 0?t.steps:1,d=t.depth!==void 0?t.depth:1;let p=t.bevelEnabled!==void 0?t.bevelEnabled:!0,m=t.bevelThickness!==void 0?t.bevelThickness:.2,g=t.bevelSize!==void 0?t.bevelSize:m-.1,y=t.bevelOffset!==void 0?t.bevelOffset:0,x=t.bevelSegments!==void 0?t.bevelSegments:3;const _=t.extrudePath,S=t.UVGenerator!==void 0?t.UVGenerator:lae;let w,T=!1,C,E,D,O;_&&(w=_.getSpacedPoints(u),T=!0,p=!1,C=_.computeFrenetFrames(u,!1),E=new K,D=new K,O=new K),p||(x=0,m=0,g=0,y=0);const R=o.extractPoints(c);let P=R.shape;const L=R.holes;if(!ho.isClockWise(P)){P=P.reverse();for(let Te=0,Y=L.length;Te<Y;Te++){const Ee=L[Te];ho.isClockWise(Ee)&&(L[Te]=Ee.reverse())}}function j(Te){const Ee=10000000000000001e-36;let Ie=Te[0];for(let Ge=1;Ge<=Te.length;Ge++){const Le=Ge%Te.length,ot=Te[Le],it=ot.x-Ie.x,ft=ot.y-Ie.y,Z=it*it+ft*ft,H=Math.max(Math.abs(ot.x),Math.abs(ot.y),Math.abs(Ie.x),Math.abs(Ie.y)),ue=Ee*H*H;if(Z<=ue){Te.splice(Le,1),Ge--;continue}Ie=ot}}j(P),L.forEach(j);const B=L.length,J=P;for(let Te=0;Te<B;Te++){const Y=L[Te];P=P.concat(Y)}function U(Te,Y,Ee){return Y||Vt("ExtrudeGeometry: vec does not exist"),Te.clone().addScaledVector(Y,Ee)}const X=P.length;function $(Te,Y,Ee){let Ie,Ge,Le;const ot=Te.x-Y.x,it=Te.y-Y.y,ft=Ee.x-Te.x,Z=Ee.y-Te.y,H=ot*ot+it*it,ue=ot*Z-it*ft;if(Math.abs(ue)>Number.EPSILON){const Se=Math.sqrt(H),Re=Math.sqrt(ft*ft+Z*Z),_e=Y.x-it/Se,Mt=Y.y+ot/Se,st=Ee.x-Z/Re,At=Ee.y+ft/Re,bt=((st-_e)*Z-(At-Mt)*ft)/(ot*Z-it*ft);Ie=_e+ot*bt-Te.x,Ge=Mt+it*bt-Te.y;const Pe=Ie*Ie+Ge*Ge;if(Pe<=2)return new Me(Ie,Ge);Le=Math.sqrt(Pe/2)}else{let Se=!1;ot>Number.EPSILON?ft>Number.EPSILON&&(Se=!0):ot<-Number.EPSILON?ft<-Number.EPSILON&&(Se=!0):Math.sign(it)===Math.sign(Z)&&(Se=!0),Se?(Ie=-it,Ge=ot,Le=Math.sqrt(H)):(Ie=ot,Ge=it,Le=Math.sqrt(H/2))}return new Me(Ie/Le,Ge/Le)}const Q=[];for(let Te=0,Y=J.length,Ee=Y-1,Ie=Te+1;Te<Y;Te++,Ee++,Ie++)Ee===Y&&(Ee=0),Ie===Y&&(Ie=0),Q[Te]=$(J[Te],J[Ee],J[Ie]);const se=[];let ye,we=Q.concat();for(let Te=0,Y=B;Te<Y;Te++){const Ee=L[Te];ye=[];for(let Ie=0,Ge=Ee.length,Le=Ge-1,ot=Ie+1;Ie<Ge;Ie++,Le++,ot++)Le===Ge&&(Le=0),ot===Ge&&(ot=0),ye[Ie]=$(Ee[Ie],Ee[Le],Ee[ot]);se.push(ye),we=we.concat(ye)}let He;if(x===0)He=ho.triangulateShape(J,L);else{const Te=[],Y=[];for(let Ee=0;Ee<x;Ee++){const Ie=Ee/x,Ge=m*Math.cos(Ie*Math.PI/2),Le=g*Math.sin(Ie*Math.PI/2)+y;for(let ot=0,it=J.length;ot<it;ot++){const ft=U(J[ot],Q[ot],Le);Qe(ft.x,ft.y,-Ge),Ie===0&&Te.push(ft)}for(let ot=0,it=B;ot<it;ot++){const ft=L[ot];ye=se[ot];const Z=[];for(let H=0,ue=ft.length;H<ue;H++){const Se=U(ft[H],ye[H],Le);Qe(Se.x,Se.y,-Ge),Ie===0&&Z.push(Se)}Ie===0&&Y.push(Z)}}He=ho.triangulateShape(Te,Y)}const De=He.length,Oe=g+y;for(let Te=0;Te<X;Te++){const Y=p?U(P[Te],we[Te],Oe):P[Te];T?(D.copy(C.normals[0]).multiplyScalar(Y.x),E.copy(C.binormals[0]).multiplyScalar(Y.y),O.copy(w[0]).add(D).add(E),Qe(O.x,O.y,O.z)):Qe(Y.x,Y.y,0)}for(let Te=1;Te<=u;Te++)for(let Y=0;Y<X;Y++){const Ee=p?U(P[Y],we[Y],Oe):P[Y];T?(D.copy(C.normals[Te]).multiplyScalar(Ee.x),E.copy(C.binormals[Te]).multiplyScalar(Ee.y),O.copy(w[Te]).add(D).add(E),Qe(O.x,O.y,O.z)):Qe(Ee.x,Ee.y,d/u*Te)}for(let Te=x-1;Te>=0;Te--){const Y=Te/x,Ee=m*Math.cos(Y*Math.PI/2),Ie=g*Math.sin(Y*Math.PI/2)+y;for(let Ge=0,Le=J.length;Ge<Le;Ge++){const ot=U(J[Ge],Q[Ge],Ie);Qe(ot.x,ot.y,d+Ee)}for(let Ge=0,Le=L.length;Ge<Le;Ge++){const ot=L[Ge];ye=se[Ge];for(let it=0,ft=ot.length;it<ft;it++){const Z=U(ot[it],ye[it],Ie);T?Qe(Z.x,Z.y+w[u-1].y,w[u-1].x+Ee):Qe(Z.x,Z.y,d+Ee)}}}fe(),ge();function fe(){const Te=r.length/3;if(p){let Y=0,Ee=X*Y;for(let Ie=0;Ie<De;Ie++){const Ge=He[Ie];et(Ge[2]+Ee,Ge[1]+Ee,Ge[0]+Ee)}Y=u+x*2,Ee=X*Y;for(let Ie=0;Ie<De;Ie++){const Ge=He[Ie];et(Ge[0]+Ee,Ge[1]+Ee,Ge[2]+Ee)}}else{for(let Y=0;Y<De;Y++){const Ee=He[Y];et(Ee[2],Ee[1],Ee[0])}for(let Y=0;Y<De;Y++){const Ee=He[Y];et(Ee[0]+X*u,Ee[1]+X*u,Ee[2]+X*u)}}n.addGroup(Te,r.length/3-Te,0)}function ge(){const Te=r.length/3;let Y=0;Ne(J,Y),Y+=J.length;for(let Ee=0,Ie=L.length;Ee<Ie;Ee++){const Ge=L[Ee];Ne(Ge,Y),Y+=Ge.length}n.addGroup(Te,r.length/3-Te,1)}function Ne(Te,Y){let Ee=Te.length;for(;--Ee>=0;){const Ie=Ee;let Ge=Ee-1;Ge<0&&(Ge=Te.length-1);for(let Le=0,ot=u+x*2;Le<ot;Le++){const it=X*Le,ft=X*(Le+1),Z=Y+Ie+it,H=Y+Ge+it,ue=Y+Ge+ft,Se=Y+Ie+ft;Nt(Z,H,ue,Se)}}}function Qe(Te,Y,Ee){l.push(Te),l.push(Y),l.push(Ee)}function et(Te,Y,Ee){Gt(Te),Gt(Y),Gt(Ee);const Ie=r.length/3,Ge=S.generateTopUV(n,r,Ie-3,Ie-2,Ie-1);vt(Ge[0]),vt(Ge[1]),vt(Ge[2])}function Nt(Te,Y,Ee,Ie){Gt(Te),Gt(Y),Gt(Ie),Gt(Y),Gt(Ee),Gt(Ie);const Ge=r.length/3,Le=S.generateSideWallUV(n,r,Ge-6,Ge-3,Ge-2,Ge-1);vt(Le[0]),vt(Le[1]),vt(Le[3]),vt(Le[1]),vt(Le[2]),vt(Le[3])}function Gt(Te){r.push(l[Te*3+0]),r.push(l[Te*3+1]),r.push(l[Te*3+2])}function vt(Te){s.push(Te.x),s.push(Te.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return cae(t,n,e)}static fromJSON(e,t){const n=[];for(let s=0,a=e.shapes.length;s<a;s++){const o=t[e.shapes[s]];n.push(o)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new Yv[r.type]().fromJSON(r)),new M2(n,e.options)}}const lae={generateTopUV:function(i,e,t,n,r){const s=e[t*3],a=e[t*3+1],o=e[n*3],l=e[n*3+1],c=e[r*3],u=e[r*3+1];return[new Me(s,a),new Me(o,l),new Me(c,u)]},generateSideWallUV:function(i,e,t,n,r,s){const a=e[t*3],o=e[t*3+1],l=e[t*3+2],c=e[n*3],u=e[n*3+1],d=e[n*3+2],p=e[r*3],m=e[r*3+1],g=e[r*3+2],y=e[s*3],x=e[s*3+1],_=e[s*3+2];return Math.abs(o-u)<Math.abs(a-c)?[new Me(a,1-l),new Me(c,1-d),new Me(p,1-g),new Me(y,1-_)]:[new Me(o,1-l),new Me(u,1-d),new Me(m,1-g),new Me(x,1-_)]}};function cae(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++){const s=i[n];t.shapes.push(s.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class T2 extends ku{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new T2(e.radius,e.detail)}}class A2 extends Yt{constructor(e=[new Me(0,-.5),new Me(.5,0),new Me(0,.5)],t=12,n=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=Ft(r,0,Math.PI*2);const s=[],a=[],o=[],l=[],c=[],u=1/t,d=new K,p=new Me,m=new K,g=new K,y=new K;let x=0,_=0;for(let S=0;S<=e.length-1;S++)switch(S){case 0:x=e[S+1].x-e[S].x,_=e[S+1].y-e[S].y,m.x=_*1,m.y=-x,m.z=_*0,y.copy(m),m.normalize(),l.push(m.x,m.y,m.z);break;case e.length-1:l.push(y.x,y.y,y.z);break;default:x=e[S+1].x-e[S].x,_=e[S+1].y-e[S].y,m.x=_*1,m.y=-x,m.z=_*0,g.copy(m),m.x+=y.x,m.y+=y.y,m.z+=y.z,m.normalize(),l.push(m.x,m.y,m.z),y.copy(g)}for(let S=0;S<=t;S++){const w=n+S*u*r,T=Math.sin(w),C=Math.cos(w);for(let E=0;E<=e.length-1;E++){d.x=e[E].x*T,d.y=e[E].y,d.z=e[E].x*C,a.push(d.x,d.y,d.z),p.x=S/t,p.y=E/(e.length-1),o.push(p.x,p.y);const D=l[3*E+0]*T,O=l[3*E+1],R=l[3*E+0]*C;c.push(D,O,R)}}for(let S=0;S<t;S++)for(let w=0;w<e.length-1;w++){const T=w+S*e.length,C=T,E=T+e.length,D=T+e.length+1,O=T+1;s.push(C,E,O),s.push(D,O,E)}this.setIndex(s),this.setAttribute("position",new _t(a,3)),this.setAttribute("uv",new _t(o,2)),this.setAttribute("normal",new _t(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new A2(e.points,e.segments,e.phiStart,e.phiLength)}}class Kg extends ku{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Kg(e.radius,e.detail)}}class k0 extends Yt{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const s=e/2,a=t/2,o=Math.floor(n),l=Math.floor(r),c=o+1,u=l+1,d=e/o,p=t/l,m=[],g=[],y=[],x=[];for(let _=0;_<u;_++){const S=_*p-a;for(let w=0;w<c;w++){const T=w*d-s;g.push(T,-S,0),y.push(0,0,1),x.push(w/o),x.push(1-_/l)}}for(let _=0;_<l;_++)for(let S=0;S<o;S++){const w=S+c*_,T=S+c*(_+1),C=S+1+c*(_+1),E=S+1+c*_;m.push(w,T,E),m.push(T,C,E)}this.setIndex(m),this.setAttribute("position",new _t(g,3)),this.setAttribute("normal",new _t(y,3)),this.setAttribute("uv",new _t(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new k0(e.width,e.height,e.widthSegments,e.heightSegments)}}class C2 extends Yt{constructor(e=.5,t=1,n=32,r=1,s=0,a=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:s,thetaLength:a},n=Math.max(3,n),r=Math.max(1,r);const o=[],l=[],c=[],u=[];let d=e;const p=(t-e)/r,m=new K,g=new Me;for(let y=0;y<=r;y++){for(let x=0;x<=n;x++){const _=s+x/n*a;m.x=d*Math.cos(_),m.y=d*Math.sin(_),l.push(m.x,m.y,m.z),c.push(0,0,1),g.x=(m.x/t+1)/2,g.y=(m.y/t+1)/2,u.push(g.x,g.y)}d+=p}for(let y=0;y<r;y++){const x=y*(n+1);for(let _=0;_<n;_++){const S=_+x,w=S,T=S+n+1,C=S+n+2,E=S+1;o.push(w,T,E),o.push(T,C,E)}}this.setIndex(o),this.setAttribute("position",new _t(l,3)),this.setAttribute("normal",new _t(c,3)),this.setAttribute("uv",new _t(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new C2(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class E2 extends Yt{constructor(e=new qh([new Me(0,.5),new Me(-.5,-.5),new Me(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],s=[],a=[];let o=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(o,l,u),o+=l,l=0;this.setIndex(n),this.setAttribute("position",new _t(r,3)),this.setAttribute("normal",new _t(s,3)),this.setAttribute("uv",new _t(a,2));function c(u){const d=r.length/3,p=u.extractPoints(t);let m=p.shape;const g=p.holes;ho.isClockWise(m)===!1&&(m=m.reverse());for(let x=0,_=g.length;x<_;x++){const S=g[x];ho.isClockWise(S)===!0&&(g[x]=S.reverse())}const y=ho.triangulateShape(m,g);for(let x=0,_=g.length;x<_;x++){const S=g[x];m=m.concat(S)}for(let x=0,_=m.length;x<_;x++){const S=m[x];r.push(S.x,S.y,0),s.push(0,0,1),a.push(S.x,S.y)}for(let x=0,_=y.length;x<_;x++){const S=y[x],w=S[0]+d,T=S[1]+d,C=S[2]+d;n.push(w,T,C),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return uae(t,e)}static fromJSON(e,t){const n=[];for(let r=0,s=e.shapes.length;r<s;r++){const a=t[e.shapes[r]];n.push(a)}return new E2(n,e.curveSegments)}}function uae(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,n=i.length;t<n;t++){const r=i[t];e.shapes.push(r.uuid)}else e.shapes.push(i.uuid);return e}class Zg extends Yt{constructor(e=1,t=32,n=16,r=0,s=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:s,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const l=Math.min(a+o,Math.PI);let c=0;const u=[],d=new K,p=new K,m=[],g=[],y=[],x=[];for(let _=0;_<=n;_++){const S=[],w=_/n;let T=0;_===0&&a===0?T=.5/t:_===n&&l===Math.PI&&(T=-.5/t);for(let C=0;C<=t;C++){const E=C/t;d.x=-e*Math.cos(r+E*s)*Math.sin(a+w*o),d.y=e*Math.cos(a+w*o),d.z=e*Math.sin(r+E*s)*Math.sin(a+w*o),g.push(d.x,d.y,d.z),p.copy(d).normalize(),y.push(p.x,p.y,p.z),x.push(E+T,1-w),S.push(c++)}u.push(S)}for(let _=0;_<n;_++)for(let S=0;S<t;S++){const w=u[_][S+1],T=u[_][S],C=u[_+1][S],E=u[_+1][S+1];(_!==0||a>0)&&m.push(w,T,E),(_!==n-1||l<Math.PI)&&m.push(T,C,E)}this.setIndex(m),this.setAttribute("position",new _t(g,3)),this.setAttribute("normal",new _t(y,3)),this.setAttribute("uv",new _t(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Zg(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class R2 extends ku{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,r,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new R2(e.radius,e.detail)}}class P2 extends Yt{constructor(e=1,t=.4,n=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:s},n=Math.floor(n),r=Math.floor(r);const a=[],o=[],l=[],c=[],u=new K,d=new K,p=new K;for(let m=0;m<=n;m++)for(let g=0;g<=r;g++){const y=g/r*s,x=m/n*Math.PI*2;d.x=(e+t*Math.cos(x))*Math.cos(y),d.y=(e+t*Math.cos(x))*Math.sin(y),d.z=t*Math.sin(x),o.push(d.x,d.y,d.z),u.x=e*Math.cos(y),u.y=e*Math.sin(y),p.subVectors(d,u).normalize(),l.push(p.x,p.y,p.z),c.push(g/r),c.push(m/n)}for(let m=1;m<=n;m++)for(let g=1;g<=r;g++){const y=(r+1)*m+g-1,x=(r+1)*(m-1)+g-1,_=(r+1)*(m-1)+g,S=(r+1)*m+g;a.push(y,x,S),a.push(x,_,S)}this.setIndex(a),this.setAttribute("position",new _t(o,3)),this.setAttribute("normal",new _t(l,3)),this.setAttribute("uv",new _t(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new P2(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class I2 extends Yt{constructor(e=1,t=.4,n=64,r=8,s=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:s,q:a},n=Math.floor(n),r=Math.floor(r);const o=[],l=[],c=[],u=[],d=new K,p=new K,m=new K,g=new K,y=new K,x=new K,_=new K;for(let w=0;w<=n;++w){const T=w/n*s*Math.PI*2;S(T,s,a,e,m),S(T+.01,s,a,e,g),x.subVectors(g,m),_.addVectors(g,m),y.crossVectors(x,_),_.crossVectors(y,x),y.normalize(),_.normalize();for(let C=0;C<=r;++C){const E=C/r*Math.PI*2,D=-t*Math.cos(E),O=t*Math.sin(E);d.x=m.x+(D*_.x+O*y.x),d.y=m.y+(D*_.y+O*y.y),d.z=m.z+(D*_.z+O*y.z),l.push(d.x,d.y,d.z),p.subVectors(d,m).normalize(),c.push(p.x,p.y,p.z),u.push(w/n),u.push(C/r)}}for(let w=1;w<=n;w++)for(let T=1;T<=r;T++){const C=(r+1)*(w-1)+(T-1),E=(r+1)*w+(T-1),D=(r+1)*w+T,O=(r+1)*(w-1)+T;o.push(C,E,O),o.push(E,D,O)}this.setIndex(o),this.setAttribute("position",new _t(l,3)),this.setAttribute("normal",new _t(c,3)),this.setAttribute("uv",new _t(u,2));function S(w,T,C,E,D){const O=Math.cos(w),R=Math.sin(w),P=C/T*w,L=Math.cos(P);D.x=E*(2+L)*.5*O,D.y=E*(2+L)*R*.5,D.z=E*Math.sin(P)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new I2(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class D2 extends Yt{constructor(e=new gA(new K(-1,-1,0),new K(-1,1,0),new K(1,1,0)),t=64,n=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:s};const a=e.computeFrenetFrames(t,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const o=new K,l=new K,c=new Me;let u=new K;const d=[],p=[],m=[],g=[];y(),this.setIndex(g),this.setAttribute("position",new _t(d,3)),this.setAttribute("normal",new _t(p,3)),this.setAttribute("uv",new _t(m,2));function y(){for(let w=0;w<t;w++)x(w);x(s===!1?t:0),S(),_()}function x(w){u=e.getPointAt(w/t,u);const T=a.normals[w],C=a.binormals[w];for(let E=0;E<=r;E++){const D=E/r*Math.PI*2,O=Math.sin(D),R=-Math.cos(D);l.x=R*T.x+O*C.x,l.y=R*T.y+O*C.y,l.z=R*T.z+O*C.z,l.normalize(),p.push(l.x,l.y,l.z),o.x=u.x+n*l.x,o.y=u.y+n*l.y,o.z=u.z+n*l.z,d.push(o.x,o.y,o.z)}}function _(){for(let w=1;w<=t;w++)for(let T=1;T<=r;T++){const C=(r+1)*(w-1)+(T-1),E=(r+1)*w+(T-1),D=(r+1)*w+T,O=(r+1)*(w-1)+T;g.push(C,E,O),g.push(E,D,O)}}function S(){for(let w=0;w<=t;w++)for(let T=0;T<=r;T++)c.x=w/t,c.y=T/r,m.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new D2(new Yv[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class yA extends Yt{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,r=new K,s=new K;if(e.index!==null){const a=e.attributes.position,o=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:o.count,materialIndex:0}]);for(let c=0,u=l.length;c<u;++c){const d=l[c],p=d.start,m=d.count;for(let g=p,y=p+m;g<y;g+=3)for(let x=0;x<3;x++){const _=o.getX(g+x),S=o.getX(g+(x+1)%3);r.fromBufferAttribute(a,_),s.fromBufferAttribute(a,S),U9(r,s,n)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const a=e.attributes.position;for(let o=0,l=a.count/3;o<l;o++)for(let c=0;c<3;c++){const u=3*o+c,d=3*o+(c+1)%3;r.fromBufferAttribute(a,u),s.fromBufferAttribute(a,d),U9(r,s,n)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new _t(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function U9(i,e,t){const n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return t.has(n)===!0||t.has(r)===!0?!1:(t.add(n),t.add(r),!0)}var F9=Object.freeze({__proto__:null,BoxGeometry:pd,CapsuleGeometry:b2,CircleGeometry:_2,ConeGeometry:$g,CylinderGeometry:Yg,DodecahedronGeometry:S2,EdgesGeometry:jB,ExtrudeGeometry:M2,IcosahedronGeometry:T2,LatheGeometry:A2,OctahedronGeometry:Kg,PlaneGeometry:k0,PolyhedronGeometry:ku,RingGeometry:C2,ShapeGeometry:E2,SphereGeometry:Zg,TetrahedronGeometry:R2,TorusGeometry:P2,TorusKnotGeometry:I2,TubeGeometry:D2,WireframeGeometry:yA});class QB extends Wr{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new pt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class JB extends Ps{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class vA extends Wr{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new pt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Nu,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new la,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class eH extends vA{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Me(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Ft(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new pt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new pt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new pt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class tH extends Wr{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new pt(16777215),this.specular=new pt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Nu,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new la,this.combine=Gg,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class nH extends Wr{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new pt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Nu,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class iH extends Wr{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Nu,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class rH extends Wr{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new pt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Nu,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new la,this.combine=Gg,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class bA extends Wr{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=gB,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class _A extends Wr{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class sH extends Wr{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new pt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Nu,this.normalScale=new Me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class aH extends os{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function zh(i,e){return!i||i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function oH(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function lH(i){function e(r,s){return i[r]-i[s]}const t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(e),n}function A5(i,e,t){const n=i.length,r=new i.constructor(n);for(let s=0,a=0;a!==n;++s){const o=t[s]*e;for(let l=0;l!==e;++l)r[a++]=i[o+l]}return r}function SA(i,e,t,n){let r=1,s=i[0];for(;s!==void 0&&s[n]===void 0;)s=i[r++];if(s===void 0)return;let a=s[n];if(a!==void 0)if(Array.isArray(a))do a=s[n],a!==void 0&&(e.push(s.time),t.push(...a)),s=i[r++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[n],a!==void 0&&(e.push(s.time),a.toArray(t,t.length)),s=i[r++];while(s!==void 0);else do a=s[n],a!==void 0&&(e.push(s.time),t.push(a)),s=i[r++];while(s!==void 0)}function hae(i,e,t,n,r=30){const s=i.clone();s.name=e;const a=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],u=c.getValueSize(),d=[],p=[];for(let m=0;m<c.times.length;++m){const g=c.times[m]*r;if(!(g<t||g>=n)){d.push(c.times[m]);for(let y=0;y<u;++y)p.push(c.values[m*u+y])}}d.length!==0&&(c.times=zh(d,c.times.constructor),c.values=zh(p,c.values.constructor),a.push(c))}s.tracks=a;let o=1/0;for(let l=0;l<s.tracks.length;++l)o>s.tracks[l].times[0]&&(o=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*o);return s.resetDuration(),s}function dae(i,e=0,t=i,n=30){n<=0&&(n=30);const r=t.tracks.length,s=e/n;for(let a=0;a<r;++a){const o=t.tracks[a],l=o.ValueTypeName;if(l==="bool"||l==="string")continue;const c=i.tracks.find(function(_){return _.name===o.name&&_.ValueTypeName===l});if(c===void 0)continue;let u=0;const d=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=d/3);let p=0;const m=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(p=m/3);const g=o.times.length-1;let y;if(s<=o.times[0]){const _=u,S=d-u;y=o.values.slice(_,S)}else if(s>=o.times[g]){const _=g*d+u,S=_+d-u;y=o.values.slice(_,S)}else{const _=o.createInterpolant(),S=u,w=d-u;_.evaluate(s),y=_.resultBuffer.slice(S,w)}l==="quaternion"&&new Vr().fromArray(y).normalize().conjugate().toArray(y);const x=c.times.length;for(let _=0;_<x;++_){const S=_*m+p;if(l==="quaternion")Vr.multiplyQuaternionsFlat(c.values,S,y,0,c.values,S);else{const w=m-p*2;for(let T=0;T<w;++T)c.values[S+T]-=y[T]}}}return i.blendMode=eA,i}class fae{static convertArray(e,t){return zh(e,t)}static isTypedArray(e){return oH(e)}static getKeyframeOrder(e){return lH(e)}static sortedArray(e,t,n){return A5(e,t,n)}static flattenJSON(e,t,n,r){SA(e,t,n,r)}static subclip(e,t,n,r,s=30){return hae(e,t,n,r,s)}static makeClipAdditive(e,t=0,n=e,r=30){return dae(e,t,n,r)}}class Qg{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],s=t[n-1];e:{t:{let a;n:{i:if(!(e<r)){for(let o=n+2;;){if(r===void 0){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===o)break;if(s=r,r=t[++n],e<r)break t}a=t.length;break n}if(!(e>=s)){const o=t[1];e<o&&(n=2,s=o);for(let l=n-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(r=s,s=t[--n-1],e>=s)break t}a=n,n=0;break n}break e}for(;n<a;){const o=n+a>>>1;e<t[o]?a=o:n=o+1}if(r=t[n],s=t[n-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let a=0;a!==r;++a)t[a]=n[s+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class cH extends Qg{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:kh,endingEnd:kh}}intervalChanged_(e,t,n){const r=this.parameterPositions;let s=e-2,a=e+1,o=r[s],l=r[a];if(o===void 0)switch(this.getSettings_().endingStart){case Oh:s=e,o=2*t-n;break;case Qm:s=r.length-2,o=t+r[s]-r[s+1];break;default:s=e,o=n}if(l===void 0)switch(this.getSettings_().endingEnd){case Oh:a=e,l=2*n-t;break;case Qm:a=1,l=n+r[1]-r[0];break;default:a=e-1,l=t}const c=(n-t)*.5,u=this.valueSize;this._weightPrev=c/(t-o),this._weightNext=c/(l-n),this._offsetPrev=s*u,this._offsetNext=a*u}interpolate_(e,t,n,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=e*o,c=l-o,u=this._offsetPrev,d=this._offsetNext,p=this._weightPrev,m=this._weightNext,g=(n-t)/(r-t),y=g*g,x=y*g,_=-p*x+2*p*y-p*g,S=(1+p)*x+(-1.5-2*p)*y+(-.5+p)*g+1,w=(-1-m)*x+(1.5+m)*y+.5*g,T=m*x-m*y;for(let C=0;C!==o;++C)s[C]=_*a[u+C]+S*a[c+C]+w*a[l+C]+T*a[d+C];return s}}class wA extends Qg{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=e*o,c=l-o,u=(n-t)/(r-t),d=1-u;for(let p=0;p!==o;++p)s[p]=a[c+p]*d+a[l+p]*u;return s}}class uH extends Qg{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Ga{constructor(e,t,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=zh(t,this.TimeBufferType),this.values=zh(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:zh(e.times,Array),values:zh(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new uH(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new wA(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new cH(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Zm:t=this.InterpolantFactoryMethodDiscrete;break;case Wv:t=this.InterpolantFactoryMethodLinear;break;case Ny:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return lt("KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Zm;case this.InterpolantFactoryMethodLinear:return Wv;case this.InterpolantFactoryMethodSmooth:return Ny}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let s=0,a=r-1;for(;s!==r&&n[s]<e;)++s;for(;a!==-1&&n[a]>t;)--a;if(++a,s!==0||a!==r){s>=a&&(a=Math.max(a,1),s=a-1);const o=this.getValueSize();this.times=n.slice(s,a),this.values=this.values.slice(s*o,a*o)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(Vt("KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,s=n.length;s===0&&(Vt("KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let o=0;o!==s;o++){const l=n[o];if(typeof l=="number"&&isNaN(l)){Vt("KeyframeTrack: Time is not a valid number.",this,o,l),e=!1;break}if(a!==null&&a>l){Vt("KeyframeTrack: Out of order keys.",this,o,l,a),e=!1;break}a=l}if(r!==void 0&&oH(r))for(let o=0,l=r.length;o!==l;++o){const c=r[o];if(isNaN(c)){Vt("KeyframeTrack: Value is not a valid number.",this,o,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===Ny,s=e.length-1;let a=1;for(let o=1;o<s;++o){let l=!1;const c=e[o],u=e[o+1];if(c!==u&&(o!==1||c!==e[0]))if(r)l=!0;else{const d=o*n,p=d-n,m=d+n;for(let g=0;g!==n;++g){const y=t[d+g];if(y!==t[p+g]||y!==t[m+g]){l=!0;break}}}if(l){if(o!==a){e[a]=e[o];const d=o*n,p=a*n;for(let m=0;m!==n;++m)t[p+m]=t[d+m]}++a}}if(s>0){e[a]=e[s];for(let o=s*n,l=a*n,c=0;c!==n;++c)t[l+c]=t[o+c];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,r=new n(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Ga.prototype.ValueTypeName="";Ga.prototype.TimeBufferType=Float32Array;Ga.prototype.ValueBufferType=Float32Array;Ga.prototype.DefaultInterpolation=Wv;class md extends Ga{constructor(e,t,n){super(e,t,n)}}md.prototype.ValueTypeName="bool";md.prototype.ValueBufferType=Array;md.prototype.DefaultInterpolation=Zm;md.prototype.InterpolantFactoryMethodLinear=void 0;md.prototype.InterpolantFactoryMethodSmooth=void 0;class MA extends Ga{constructor(e,t,n,r){super(e,t,n,r)}}MA.prototype.ValueTypeName="color";class og extends Ga{constructor(e,t,n,r){super(e,t,n,r)}}og.prototype.ValueTypeName="number";class hH extends Qg{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=(n-t)/(r-t);let c=e*o;for(let u=c+o;c!==u;c+=4)Vr.slerpFlat(s,0,a,c-o,a,c,l);return s}}class Jg extends Ga{constructor(e,t,n,r){super(e,t,n,r)}InterpolantFactoryMethodLinear(e){return new hH(this.times,this.values,this.getValueSize(),e)}}Jg.prototype.ValueTypeName="quaternion";Jg.prototype.InterpolantFactoryMethodSmooth=void 0;class gd extends Ga{constructor(e,t,n){super(e,t,n)}}gd.prototype.ValueTypeName="string";gd.prototype.ValueBufferType=Array;gd.prototype.DefaultInterpolation=Zm;gd.prototype.InterpolantFactoryMethodLinear=void 0;gd.prototype.InterpolantFactoryMethodSmooth=void 0;class lg extends Ga{constructor(e,t,n,r){super(e,t,n,r)}}lg.prototype.ValueTypeName="vector";class cg{constructor(e="",t=-1,n=[],r=c2){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=ia(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let a=0,o=n.length;a!==o;++a)t.push(mae(n[a]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s.userData=JSON.parse(e.userData||"{}"),s}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let s=0,a=n.length;s!==a;++s)t.push(Ga.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const s=t.length,a=[];for(let o=0;o<s;o++){let l=[],c=[];l.push((o+s-1)%s,o,(o+1)%s),c.push(0,1,0);const u=lH(l);l=A5(l,1,u),c=A5(c,1,u),!r&&l[0]===0&&(l.push(s),c.push(c[0])),a.push(new og(".morphTargetInfluences["+t[o].name+"]",l,c).scale(1/n))}return new this(e,-1,a)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},s=/^([\w-]*?)([\d]+)$/;for(let o=0,l=e.length;o<l;o++){const c=e[o],u=c.name.match(s);if(u&&u.length>1){const d=u[1];let p=r[d];p||(r[d]=p=[]),p.push(c)}}const a=[];for(const o in r)a.push(this.CreateFromMorphTargetSequence(o,r[o],t,n));return a}static parseAnimation(e,t){if(lt("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return Vt("AnimationClip: No animation in JSONLoader data."),null;const n=function(d,p,m,g,y){if(m.length!==0){const x=[],_=[];SA(m,x,_,g),x.length!==0&&y.push(new d(p,x,_))}},r=[],s=e.name||"default",a=e.fps||30,o=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let d=0;d<c.length;d++){const p=c[d].keys;if(!(!p||p.length===0))if(p[0].morphTargets){const m={};let g;for(g=0;g<p.length;g++)if(p[g].morphTargets)for(let y=0;y<p[g].morphTargets.length;y++)m[p[g].morphTargets[y]]=-1;for(const y in m){const x=[],_=[];for(let S=0;S!==p[g].morphTargets.length;++S){const w=p[g];x.push(w.time),_.push(w.morphTarget===y?1:0)}r.push(new og(".morphTargetInfluence["+y+"]",x,_))}l=m.length*a}else{const m=".bones["+t[d].name+"]";n(lg,m+".position",p,"pos",r),n(Jg,m+".quaternion",p,"rot",r),n(lg,m+".scale",p,"scl",r)}}return r.length===0?null:new this(s,l,r,o)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,r=e.length;n!==r;++n){const s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function pae(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return og;case"vector":case"vector2":case"vector3":case"vector4":return lg;case"color":return MA;case"quaternion":return Jg;case"bool":case"boolean":return md;case"string":return gd}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function mae(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=pae(i.type);if(i.times===void 0){const t=[],n=[];SA(i.keys,t,n,"value"),i.times=t,i.values=n}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const jo={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class TA{constructor(e,t,n){const r=this;let s=!1,a=0,o=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this._abortController=null,this.itemStart=function(u){o++,s===!1&&r.onStart!==void 0&&r.onStart(u,a,o),s=!0},this.itemEnd=function(u){a++,r.onProgress!==void 0&&r.onProgress(u,a,o),a===o&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,d){return c.push(u,d),this},this.removeHandler=function(u){const d=c.indexOf(u);return d!==-1&&c.splice(d,2),this},this.getHandler=function(u){for(let d=0,p=c.length;d<p;d+=2){const m=c[d],g=c[d+1];if(m.global&&(m.lastIndex=0),m.test(u))return g}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const dH=new TA;class Ns{constructor(e){this.manager=e!==void 0?e:dH,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,s){n.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}Ns.DEFAULT_MATERIAL_NAME="__DEFAULT";const kl={};class gae extends Error{constructor(e,t){super(e),this.response=t}}class pc extends Ns{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=jo.get(`file:${e}`);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(kl[e]!==void 0){kl[e].push({onLoad:t,onProgress:n,onError:r});return}kl[e]=[],kl[e].push({onLoad:t,onProgress:n,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),o=this.mimeType,l=this.responseType;fetch(a).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&lt("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const u=kl[e],d=c.body.getReader(),p=c.headers.get("X-File-Size")||c.headers.get("Content-Length"),m=p?parseInt(p):0,g=m!==0;let y=0;const x=new ReadableStream({start(_){S();function S(){d.read().then(({done:w,value:T})=>{if(w)_.close();else{y+=T.byteLength;const C=new ProgressEvent("progress",{lengthComputable:g,loaded:y,total:m});for(let E=0,D=u.length;E<D;E++){const O=u[E];O.onProgress&&O.onProgress(C)}_.enqueue(T),S()}},w=>{_.error(w)})}}});return new Response(x)}else throw new gae(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>new DOMParser().parseFromString(u,o));case"json":return c.json();default:if(o==="")return c.text();{const d=/charset="?([^;"\s]*)"?/i.exec(o),p=d&&d[1]?d[1].toLowerCase():void 0,m=new TextDecoder(p);return c.arrayBuffer().then(g=>m.decode(g))}}}).then(c=>{jo.add(`file:${e}`,c);const u=kl[e];delete kl[e];for(let d=0,p=u.length;d<p;d++){const m=u[d];m.onLoad&&m.onLoad(c)}}).catch(c=>{const u=kl[e];if(u===void 0)throw this.manager.itemError(e),c;delete kl[e];for(let d=0,p=u.length;d<p;d++){const m=u[d];m.onError&&m.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class xae extends Ns{constructor(e){super(e)}load(e,t,n,r){const s=this,a=new pc(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(o){try{t(s.parse(JSON.parse(o)))}catch(l){r?r(l):Vt(l),s.manager.itemError(e)}},n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=cg.parse(e[n]);t.push(r)}return t}}class yae extends Ns{constructor(e){super(e)}load(e,t,n,r){const s=this,a=[],o=new y2,l=new pc(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function u(d){l.load(e[d],function(p){const m=s.parse(p,!0);a[d]={width:m.width,height:m.height,format:m.format,mipmaps:m.mipmaps},c+=1,c===6&&(m.mipmapCount===1&&(o.minFilter=Jn),o.image=a,o.format=m.format,o.needsUpdate=!0,t&&t(o))},n,r)}if(Array.isArray(e))for(let d=0,p=e.length;d<p;++d)u(d);else l.load(e,function(d){const p=s.parse(d,!0);if(p.isCubemap){const m=p.mipmaps.length/p.mipmapCount;for(let g=0;g<m;g++){a[g]={mipmaps:[]};for(let y=0;y<p.mipmapCount;y++)a[g].mipmaps.push(p.mipmaps[g*p.mipmapCount+y]),a[g].format=p.format,a[g].width=p.width,a[g].height=p.height}o.image=a}else o.image.width=p.width,o.image.height=p.height,o.mipmaps=p.mipmaps;p.mipmapCount===1&&(o.minFilter=Jn),o.format=p.format,o.needsUpdate=!0,t&&t(o)},n,r);return o}}const gf=new WeakMap;class ug extends Ns{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=jo.get(`image:${e}`);if(a!==void 0){if(a.complete===!0)s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0);else{let d=gf.get(a);d===void 0&&(d=[],gf.set(a,d)),d.push({onLoad:t,onError:r})}return a}const o=tg("img");function l(){u(),t&&t(this);const d=gf.get(this)||[];for(let p=0;p<d.length;p++){const m=d[p];m.onLoad&&m.onLoad(this)}gf.delete(this),s.manager.itemEnd(e)}function c(d){u(),r&&r(d),jo.remove(`image:${e}`);const p=gf.get(this)||[];for(let m=0;m<p.length;m++){const g=p[m];g.onError&&g.onError(d)}gf.delete(this),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){o.removeEventListener("load",l,!1),o.removeEventListener("error",c,!1)}return o.addEventListener("load",l,!1),o.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),jo.add(`image:${e}`,o),s.manager.itemStart(e),o.src=e,o}}class vae extends Ns{constructor(e){super(e)}load(e,t,n,r){const s=new Xg;s.colorSpace=Mr;const a=new ug(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function l(c){a.load(e[c],function(u){s.images[c]=u,o++,o===6&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class bae extends Ns{constructor(e){super(e)}load(e,t,n,r){const s=this,a=new Oa,o=new pc(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(s.withCredentials),o.load(e,function(l){let c;try{c=s.parse(l)}catch(u){if(r!==void 0)r(u);else{u(u);return}}c.image!==void 0?a.image=c.image:c.data!==void 0&&(a.image.width=c.width,a.image.height=c.height,a.image.data=c.data),a.wrapS=c.wrapS!==void 0?c.wrapS:or,a.wrapT=c.wrapT!==void 0?c.wrapT:or,a.magFilter=c.magFilter!==void 0?c.magFilter:Jn,a.minFilter=c.minFilter!==void 0?c.minFilter:Jn,a.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0&&(a.colorSpace=c.colorSpace),c.flipY!==void 0&&(a.flipY=c.flipY),c.format!==void 0&&(a.format=c.format),c.type!==void 0&&(a.type=c.type),c.mipmaps!==void 0&&(a.mipmaps=c.mipmaps,a.minFilter=Ho),c.mipmapCount===1&&(a.minFilter=Jn),c.generateMipmaps!==void 0&&(a.generateMipmaps=c.generateMipmaps),a.needsUpdate=!0,t&&t(a,c)},n,r),a}}class _ae extends Ns{constructor(e){super(e)}load(e,t,n,r){const s=new ri,a=new ug(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){s.image=o,s.needsUpdate=!0,t!==void 0&&t(s)},n,r),s}}class Ou extends xn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new pt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class fH extends Ou{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(xn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new pt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const n4=new Bt,B9=new K,H9=new K;class AA{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Me(512,512),this.mapType=za,this.map=null,this.mapPass=null,this.matrix=new Bt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new L0,this._frameExtents=new Me(1,1),this._viewportCount=1,this._viewports=[new sn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;B9.setFromMatrixPosition(e.matrixWorld),t.position.copy(B9),H9.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(H9),t.updateMatrixWorld(),n4.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(n4,t.coordinateSystem,t.reversedDepth),t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(n4)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Sae extends AA{constructor(){super(new Pi(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=f0*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,s=e.distance||t.far;(n!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class pH extends Ou{constructor(e,t,n=0,r=Math.PI/3,s=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(xn.DEFAULT_UP),this.updateMatrix(),this.target=new xn,this.distance=n,this.angle=r,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new Sae}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const j9=new Bt,zp=new K,i4=new K;class wae extends AA{constructor(){super(new Pi(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Me(4,2),this._viewportCount=6,this._viewports=[new sn(2,1,1,1),new sn(0,1,1,1),new sn(3,1,1,1),new sn(1,1,1,1),new sn(3,0,1,1),new sn(1,0,1,1)],this._cubeDirections=[new K(1,0,0),new K(-1,0,0),new K(0,0,1),new K(0,0,-1),new K(0,1,0),new K(0,-1,0)],this._cubeUps=[new K(0,1,0),new K(0,1,0),new K(0,1,0),new K(0,1,0),new K(0,0,1),new K(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),zp.setFromMatrixPosition(e.matrixWorld),n.position.copy(zp),i4.copy(n.position),i4.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(i4),n.updateMatrixWorld(),r.makeTranslation(-zp.x,-zp.y,-zp.z),j9.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(j9,n.coordinateSystem,n.reversedDepth)}}class mH extends Ou{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new wae}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}let uu=class extends d2{constructor(e=-1,t=1,n=1,r=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,a=n+e,o=r+t,l=r-t;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,a=s+c*this.view.width,o-=u*this.view.offsetY,l=o-u*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,l,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}};class Mae extends AA{constructor(){super(new uu(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class gH extends Ou{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(xn.DEFAULT_UP),this.updateMatrix(),this.target=new xn,this.shadow=new Mae}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class xH extends Ou{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class yH extends Ou{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class vH{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new K)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*s),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],1.092548*(n*r)),t.addScaledVector(a[5],1.092548*(r*s)),t.addScaledVector(a[6],.315392*(3*s*s-1)),t.addScaledVector(a[7],1.092548*(n*s)),t.addScaledVector(a[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],2*.511664*r),t.addScaledVector(a[2],2*.511664*s),t.addScaledVector(a[3],2*.511664*n),t.addScaledVector(a[4],2*.429043*n*r),t.addScaledVector(a[5],2*.429043*r*s),t.addScaledVector(a[6],.743125*s*s-.247708),t.addScaledVector(a[7],2*.429043*n*s),t.addScaledVector(a[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const n=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-r*r)}}class bH extends Ou{constructor(e=new vH,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class N2 extends Ns{constructor(e){super(e),this.textures={}}load(e,t,n,r){const s=this,a=new pc(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{t(s.parse(JSON.parse(o)))}catch(l){r?r(l):Vt(l),s.manager.itemError(e)}},n,r)}parse(e){const t=this.textures;function n(s){return t[s]===void 0&&lt("MaterialLoader: Undefined texture",s),t[s]}const r=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new pt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(r.dispersion=e.dispersion),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const a=e.uniforms[s];switch(r.uniforms[s]={},a.type){case"t":r.uniforms[s].value=n(a.value);break;case"c":r.uniforms[s].value=new pt().setHex(a.value);break;case"v2":r.uniforms[s].value=new Me().fromArray(a.value);break;case"v3":r.uniforms[s].value=new K().fromArray(a.value);break;case"v4":r.uniforms[s].value=new sn().fromArray(a.value);break;case"m3":r.uniforms[s].value=new qt().fromArray(a.value);break;case"m4":r.uniforms[s].value=new Bt().fromArray(a.value);break;default:r.uniforms[s].value=a.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=n(e.map)),e.matcap!==void 0&&(r.matcap=n(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new Me().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=n(e.envMap)),e.envMapRotation!==void 0&&r.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new Me().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return N2.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:QB,SpriteMaterial:lA,RawShaderMaterial:JB,ShaderMaterial:Ps,PointsMaterial:uA,MeshPhysicalMaterial:eH,MeshStandardMaterial:vA,MeshPhongMaterial:tH,MeshToonMaterial:nH,MeshNormalMaterial:iH,MeshLambertMaterial:rH,MeshDepthMaterial:bA,MeshDistanceMaterial:_A,MeshBasicMaterial:Lu,MeshMatcapMaterial:sH,LineDashedMaterial:aH,LineBasicMaterial:os,Material:Wr};return new t[e]}}class C5{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class CA extends Yt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class _H extends Ns{constructor(e){super(e)}load(e,t,n,r){const s=this,a=new pc(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{t(s.parse(JSON.parse(o)))}catch(l){r?r(l):Vt(l),s.manager.itemError(e)}},n,r)}parse(e){const t={},n={};function r(m,g){if(t[g]!==void 0)return t[g];const x=m.interleavedBuffers[g],_=s(m,x.buffer),S=kf(x.type,_),w=new m2(S,x.stride);return w.uuid=x.uuid,t[g]=w,w}function s(m,g){if(n[g]!==void 0)return n[g];const x=m.arrayBuffers[g],_=new Uint32Array(x).buffer;return n[g]=_,_}const a=e.isInstancedBufferGeometry?new CA:new Yt,o=e.data.index;if(o!==void 0){const m=kf(o.type,o.array);a.setIndex(new kn(m,1))}const l=e.data.attributes;for(const m in l){const g=l[m];let y;if(g.isInterleavedBufferAttribute){const x=r(e.data,g.data);y=new ea(x,g.itemSize,g.offset,g.normalized)}else{const x=kf(g.type,g.array),_=g.isInstancedBufferAttribute?g0:kn;y=new _(x,g.itemSize,g.normalized)}g.name!==void 0&&(y.name=g.name),g.usage!==void 0&&y.setUsage(g.usage),a.setAttribute(m,y)}const c=e.data.morphAttributes;if(c)for(const m in c){const g=c[m],y=[];for(let x=0,_=g.length;x<_;x++){const S=g[x];let w;if(S.isInterleavedBufferAttribute){const T=r(e.data,S.data);w=new ea(T,S.itemSize,S.offset,S.normalized)}else{const T=kf(S.type,S.array);w=new kn(T,S.itemSize,S.normalized)}S.name!==void 0&&(w.name=S.name),y.push(w)}a.morphAttributes[m]=y}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const d=e.data.groups||e.data.drawcalls||e.data.offsets;if(d!==void 0)for(let m=0,g=d.length;m!==g;++m){const y=d[m];a.addGroup(y.start,y.count,y.materialIndex)}const p=e.data.boundingSphere;return p!==void 0&&(a.boundingSphere=new Yi().fromJSON(p)),e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}class Tae extends Ns{constructor(e){super(e)}load(e,t,n,r){const s=this,a=this.path===""?C5.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const o=new pc(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(d){r!==void 0&&r(d),d("ObjectLoader: Can't parse "+e+".",d.message);return}const u=c.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),Vt("ObjectLoader: Can't load "+e);return}s.parse(c,t)},n,r)}async loadAsync(e,t){const n=this,r=this.path===""?C5.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new pc(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const a=await s.loadAsync(e,t),o=JSON.parse(a),l=o.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(o)}parse(e,t){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,function(){t!==void 0&&t(c)}),o=this.parseTextures(e.textures,a),l=this.parseMaterials(e.materials,o),c=this.parseObject(e.object,s,l,o,n),u=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,u),this.bindLightTargets(c),t!==void 0){let d=!1;for(const p in a)if(a[p].data instanceof HTMLImageElement){d=!0;break}d===!1&&t(c)}return c}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),s=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,s),o=this.parseMaterials(e.materials,a),l=this.parseObject(e.object,r,o,a,t),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),this.bindLightTargets(l),l}parseShapes(e){const t={};if(e!==void 0)for(let n=0,r=e.length;n<r;n++){const s=new qh().fromJSON(e[n]);t[s.uuid]=s}return t}parseSkeletons(e,t){const n={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=new g2().fromJSON(e[s],r);n[o.uuid]=o}return n}parseGeometries(e,t){const n={};if(e!==void 0){const r=new _H;for(let s=0,a=e.length;s<a;s++){let o;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(l);break;default:l.type in F9?o=F9[l.type].fromJSON(l,t):lt(`ObjectLoader: Unsupported geometry type "${l.type}"`)}o.uuid=l.uuid,l.name!==void 0&&(o.name=l.name),l.userData!==void 0&&(o.userData=l.userData),n[l.uuid]=o}}return n}parseMaterials(e,t){const n={},r={};if(e!==void 0){const s=new N2;s.setTextures(t);for(let a=0,o=e.length;a<o;a++){const l=e[a];n[l.uuid]===void 0&&(n[l.uuid]=s.parse(l)),r[l.uuid]=n[l.uuid]}}return r}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const r=e[n],s=cg.parse(r);t[s.uuid]=s}return t}parseImages(e,t){const n=this,r={};let s;function a(l){return n.manager.itemStart(l),s.load(l,function(){n.manager.itemEnd(l)},void 0,function(){n.manager.itemError(l),n.manager.itemEnd(l)})}function o(l){if(typeof l=="string"){const c=l,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:n.resourcePath+c;return a(u)}else return l.data?{data:kf(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new TA(t);s=new ug(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,u=e.length;c<u;c++){const d=e[c],p=d.url;if(Array.isArray(p)){const m=[];for(let g=0,y=p.length;g<y;g++){const x=p[g],_=o(x);_!==null&&(_ instanceof HTMLImageElement?m.push(_):m.push(new Oa(_.data,_.width,_.height)))}r[d.uuid]=new iu(m)}else{const m=o(d.url);r[d.uuid]=new iu(m)}}}return r}async parseImagesAsync(e){const t=this,n={};let r;async function s(a){if(typeof a=="string"){const o=a,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(o)?o:t.resourcePath+o;return await r.loadAsync(l)}else return a.data?{data:kf(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){r=new ug(this.manager),r.setCrossOrigin(this.crossOrigin);for(let a=0,o=e.length;a<o;a++){const l=e[a],c=l.url;if(Array.isArray(c)){const u=[];for(let d=0,p=c.length;d<p;d++){const m=c[d],g=await s(m);g!==null&&(g instanceof HTMLImageElement?u.push(g):u.push(new Oa(g.data,g.width,g.height)))}n[l.uuid]=new iu(u)}else{const u=await s(l.url);n[l.uuid]=new iu(u)}}}return n}parseTextures(e,t){function n(s,a){return typeof s=="number"?s:(lt("ObjectLoader.parseTexture: Constant should be in numeric form.",s),a[s])}const r={};if(e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=e[s];o.image===void 0&&lt('ObjectLoader: No "image" specified for',o.uuid),t[o.image]===void 0&&lt("ObjectLoader: Undefined image",o.image);const l=t[o.image],c=l.data;let u;Array.isArray(c)?(u=new Xg,c.length===6&&(u.needsUpdate=!0)):(c&&c.data?u=new Oa:u=new ri,c&&(u.needsUpdate=!0)),u.source=l,u.uuid=o.uuid,o.name!==void 0&&(u.name=o.name),o.mapping!==void 0&&(u.mapping=n(o.mapping,Aae)),o.channel!==void 0&&(u.channel=o.channel),o.offset!==void 0&&u.offset.fromArray(o.offset),o.repeat!==void 0&&u.repeat.fromArray(o.repeat),o.center!==void 0&&u.center.fromArray(o.center),o.rotation!==void 0&&(u.rotation=o.rotation),o.wrap!==void 0&&(u.wrapS=n(o.wrap[0],V9),u.wrapT=n(o.wrap[1],V9)),o.format!==void 0&&(u.format=o.format),o.internalFormat!==void 0&&(u.internalFormat=o.internalFormat),o.type!==void 0&&(u.type=o.type),o.colorSpace!==void 0&&(u.colorSpace=o.colorSpace),o.minFilter!==void 0&&(u.minFilter=n(o.minFilter,G9)),o.magFilter!==void 0&&(u.magFilter=n(o.magFilter,G9)),o.anisotropy!==void 0&&(u.anisotropy=o.anisotropy),o.flipY!==void 0&&(u.flipY=o.flipY),o.generateMipmaps!==void 0&&(u.generateMipmaps=o.generateMipmaps),o.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=o.premultiplyAlpha),o.unpackAlignment!==void 0&&(u.unpackAlignment=o.unpackAlignment),o.compareFunction!==void 0&&(u.compareFunction=o.compareFunction),o.userData!==void 0&&(u.userData=o.userData),r[o.uuid]=u}return r}parseObject(e,t,n,r,s){let a;function o(p){return t[p]===void 0&&lt("ObjectLoader: Undefined geometry",p),t[p]}function l(p){if(p!==void 0){if(Array.isArray(p)){const m=[];for(let g=0,y=p.length;g<y;g++){const x=p[g];n[x]===void 0&&lt("ObjectLoader: Undefined material",x),m.push(n[x])}return m}return n[p]===void 0&&lt("ObjectLoader: Undefined material",p),n[p]}}function c(p){return r[p]===void 0&&lt("ObjectLoader: Undefined texture",p),r[p]}let u,d;switch(e.type){case"Scene":a=new oA,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new pt(e.background):a.background=c(e.background)),e.environment!==void 0&&(a.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?a.fog=new p2(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new f2(e.fog.color,e.fog.density)),e.fog.name!==""&&(a.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&a.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(a.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new Pi(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new uu(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new xH(e.color,e.intensity);break;case"DirectionalLight":a=new gH(e.color,e.intensity),a.target=e.target||"";break;case"PointLight":a=new mH(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new yH(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new pH(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),a.target=e.target||"";break;case"HemisphereLight":a=new fH(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=new bH().fromJSON(e);break;case"SkinnedMesh":u=o(e.geometry),d=l(e.material),a=new OB(u,d),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":u=o(e.geometry),d=l(e.material),a=new Bi(u,d);break;case"InstancedMesh":u=o(e.geometry),d=l(e.material);const p=e.count,m=e.instanceMatrix,g=e.instanceColor;a=new zB(u,d,p),a.instanceMatrix=new g0(new Float32Array(m.array),16),g!==void 0&&(a.instanceColor=new g0(new Float32Array(g.array),g.itemSize));break;case"BatchedMesh":u=o(e.geometry),d=l(e.material),a=new UB(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,d),a.geometry=u,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._geometryInfo=e.geometryInfo.map(y=>{let x=null,_=null;return y.boundingBox!==void 0&&(x=new Xi().fromJSON(y.boundingBox)),y.boundingSphere!==void 0&&(_=new Yi().fromJSON(y.boundingSphere)),{...y,boundingBox:x,boundingSphere:_}}),a._instanceInfo=e.instanceInfo,a._availableInstanceIds=e._availableInstanceIds,a._availableGeometryIds=e._availableGeometryIds,a._nextIndexStart=e.nextIndexStart,a._nextVertexStart=e.nextVertexStart,a._geometryCount=e.geometryCount,a._maxInstanceCount=e.maxInstanceCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._matricesTexture=c(e.matricesTexture.uuid),a._indirectTexture=c(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(a._colorsTexture=c(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(a.boundingSphere=new Yi().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(a.boundingBox=new Xi().fromJSON(e.boundingBox));break;case"LOD":a=new kB;break;case"Line":a=new bu(o(e.geometry),l(e.material));break;case"LineLoop":a=new FB(o(e.geometry),l(e.material));break;case"LineSegments":a=new hl(o(e.geometry),l(e.material));break;case"PointCloud":case"Points":a=new BB(o(e.geometry),l(e.material));break;case"Sprite":a=new LB(l(e.material));break;case"Group":a=new Of;break;case"Bone":a=new cA;break;default:a=new xn}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix!==void 0?(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)),e.up!==void 0&&a.up.fromArray(e.up),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(a.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){const p=e.children;for(let m=0;m<p.length;m++)a.add(this.parseObject(p[m],t,n,r,s))}if(e.animations!==void 0){const p=e.animations;for(let m=0;m<p.length;m++){const g=p[m];a.animations.push(s[g])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const p=e.levels;for(let m=0;m<p.length;m++){const g=p[m],y=a.getObjectByProperty("uuid",g.object);y!==void 0&&a.addLevel(y,g.distance,g.hysteresis)}}return a}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const r=t[n.skeleton];r===void 0?lt("ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,r=e.getObjectByProperty("uuid",n);r!==void 0?t.target=r:t.target=new xn}})}}const Aae={UVMapping:n2,CubeReflectionMapping:dc,CubeRefractionMapping:xu,EquirectangularReflectionMapping:Xm,EquirectangularRefractionMapping:Ym,CubeUVReflectionMapping:N0},V9={RepeatWrapping:$m,ClampToEdgeWrapping:or,MirroredRepeatWrapping:Km},G9={NearestFilter:qi,NearestMipmapNearestFilter:XT,NearestMipmapLinearFilter:Lf,LinearFilter:Jn,LinearMipmapNearestFilter:pm,LinearMipmapLinearFilter:Ho},r4=new WeakMap;class Cae extends Ns{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&lt("ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&lt("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=jo.get(`image-bitmap:${e}`);if(a!==void 0){if(s.manager.itemStart(e),a.then){a.then(c=>{if(r4.has(a)===!0)r&&r(r4.get(a)),s.manager.itemError(e),s.manager.itemEnd(e);else return t&&t(c),s.manager.itemEnd(e),c});return}return setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a}const o={};o.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",o.headers=this.requestHeader,o.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const l=fetch(e,o).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){return jo.add(`image-bitmap:${e}`,c),t&&t(c),s.manager.itemEnd(e),c}).catch(function(c){r&&r(c),r4.set(l,c),jo.remove(`image-bitmap:${e}`),s.manager.itemError(e),s.manager.itemEnd(e)});jo.add(`image-bitmap:${e}`,l),s.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let q1;class EA{static getContext(){return q1===void 0&&(q1=new(window.AudioContext||window.webkitAudioContext)),q1}static setContext(e){q1=e}}class Eae extends Ns{constructor(e){super(e)}load(e,t,n,r){const s=this,a=new pc(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){try{const c=l.slice(0);EA.getContext().decodeAudioData(c,function(d){t(d)}).catch(o)}catch(c){o(c)}},n,r);function o(l){r?r(l):Vt(l),s.manager.itemError(e)}}}const W9=new Bt,q9=new Bt,fh=new Bt;class Rae{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Pi,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Pi,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,fh.copy(e.projectionMatrix);const r=t.eyeSep/2,s=r*t.near/t.focus,a=t.near*Math.tan(Wh*t.fov*.5)/t.zoom;let o,l;q9.elements[12]=-r,W9.elements[12]=r,o=-a*t.aspect+s,l=a*t.aspect+s,fh.elements[0]=2*t.near/(l-o),fh.elements[8]=(l+o)/(l-o),this.cameraL.projectionMatrix.copy(fh),o=-a*t.aspect-s,l=a*t.aspect-s,fh.elements[0]=2*t.near/(l-o),fh.elements[8]=(l+o)/(l-o),this.cameraR.projectionMatrix.copy(fh)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(q9),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(W9)}}class SH extends Pi{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}let RA=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};const ph=new K,s4=new Vr,Pae=new K,mh=new K,gh=new K;class Iae extends xn{constructor(){super(),this.type="AudioListener",this.context=EA.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new RA}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(ph,s4,Pae),mh.set(0,0,-1).applyQuaternion(s4),gh.set(0,1,0).applyQuaternion(s4),t.positionX){const n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(ph.x,n),t.positionY.linearRampToValueAtTime(ph.y,n),t.positionZ.linearRampToValueAtTime(ph.z,n),t.forwardX.linearRampToValueAtTime(mh.x,n),t.forwardY.linearRampToValueAtTime(mh.y,n),t.forwardZ.linearRampToValueAtTime(mh.z,n),t.upX.linearRampToValueAtTime(gh.x,n),t.upY.linearRampToValueAtTime(gh.y,n),t.upZ.linearRampToValueAtTime(gh.z,n)}else t.setPosition(ph.x,ph.y,ph.z),t.setOrientation(mh.x,mh.y,mh.z,gh.x,gh.y,gh.z)}}class wH extends xn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){lt("Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){lt("Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){lt("Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){lt("Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){lt("Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(lt("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){lt("Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(lt("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const xh=new K,X9=new Vr,Dae=new K,yh=new K;class Nae extends wH{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(xh,X9,Dae),yh.set(0,0,1).applyQuaternion(X9);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(xh.x,n),t.positionY.linearRampToValueAtTime(xh.y,n),t.positionZ.linearRampToValueAtTime(xh.z,n),t.orientationX.linearRampToValueAtTime(yh.x,n),t.orientationY.linearRampToValueAtTime(yh.y,n),t.orientationZ.linearRampToValueAtTime(yh.z,n)}else t.setPosition(xh.x,xh.y,xh.z),t.setOrientation(yh.x,yh.y,yh.z)}}class Lae{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class MH{constructor(e,t,n){this.binding=e,this.valueSize=n;let r,s,a;switch(t){case"quaternion":r=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:r=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,s=e*r+r;let a=this.cumulativeWeight;if(a===0){for(let o=0;o!==r;++o)n[s+o]=n[o];a=t}else{a+=t;const o=t/a;this._mixBufferRegion(n,s,0,o,r)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=t*this._origIndex;this._mixBufferRegion(n,r,l,1-s,t)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(n[l]!==n[l+t]){o.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let s=n,a=r;s!==a;++s)t[s]=t[r+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,s){if(r>=.5)for(let a=0;a!==s;++a)e[t+a]=e[n+a]}_slerp(e,t,n,r){Vr.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,s){const a=this._workIndex*s;Vr.multiplyQuaternionsFlat(e,a,e,t,e,n),Vr.slerpFlat(e,t,e,t,e,a,r)}_lerp(e,t,n,r,s){const a=1-r;for(let o=0;o!==s;++o){const l=t+o;e[l]=e[l]*a+e[n+o]*r}}_lerpAdditive(e,t,n,r,s){for(let a=0;a!==s;++a){const o=t+a;e[o]=e[o]+e[n+a]*r}}}const PA="\\[\\]\\.:\\/",kae=new RegExp("["+PA+"]","g"),IA="[^"+PA+"]",Oae="[^"+PA.replace("\\.","")+"]",zae=/((?:WC+[\/:])*)/.source.replace("WC",IA),Uae=/(WCOD+)?/.source.replace("WCOD",Oae),Fae=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",IA),Bae=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",IA),Hae=new RegExp("^"+zae+Uae+Fae+Bae+"$"),jae=["material","materials","bones","map"];class Vae{constructor(e,t,n){const r=n||gn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class gn{constructor(e,t,n){this.path=t,this.parsedPath=n||gn.parseTrackName(t),this.node=gn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new gn.Composite(e,t,n):new gn(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(kae,"")}static parseTrackName(e){const t=Hae.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=n.nodeName.substring(r+1);jae.indexOf(s)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=s)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(s){for(let a=0;a<s.length;a++){const o=s[a];if(o.name===t||o.uuid===t)return o;const l=n(o.children);if(l)return l}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let s=t.propertyIndex;if(e||(e=gn.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){lt("PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let c=t.objectIndex;switch(n){case"materials":if(!e.material){Vt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){Vt("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){Vt("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===c){c=u;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){Vt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){Vt("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){Vt("PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(c!==void 0){if(e[c]===void 0){Vt("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const a=e[r];if(a===void 0){const c=t.nodeName;Vt("PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?o=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){Vt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){Vt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}gn.Composite=Vae;gn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};gn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};gn.prototype.GetterByBindingType=[gn.prototype._getValue_direct,gn.prototype._getValue_array,gn.prototype._getValue_arrayElement,gn.prototype._getValue_toArray];gn.prototype.SetterByBindingTypeAndVersioning=[[gn.prototype._setValue_direct,gn.prototype._setValue_direct_setNeedsUpdate,gn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[gn.prototype._setValue_array,gn.prototype._setValue_array_setNeedsUpdate,gn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[gn.prototype._setValue_arrayElement,gn.prototype._setValue_arrayElement_setNeedsUpdate,gn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[gn.prototype._setValue_fromArray,gn.prototype._setValue_fromArray_setNeedsUpdate,gn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Gae{constructor(){this.isAnimationObjectGroup=!0,this.uuid=ia(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,s=this._bindings,a=s.length;let o,l=e.length,c=this.nCachedObjects_;for(let u=0,d=arguments.length;u!==d;++u){const p=arguments[u],m=p.uuid;let g=t[m];if(g===void 0){g=l++,t[m]=g,e.push(p);for(let y=0,x=a;y!==x;++y)s[y].push(new gn(p,n[y],r[y]))}else if(g<c){o=e[g];const y=--c,x=e[y];t[x.uuid]=g,e[g]=x,t[m]=y,e[y]=p;for(let _=0,S=a;_!==S;++_){const w=s[_],T=w[y];let C=w[g];w[g]=T,C===void 0&&(C=new gn(p,n[_],r[_])),w[y]=C}}else e[g]!==o&&Vt("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_;for(let a=0,o=arguments.length;a!==o;++a){const l=arguments[a],c=l.uuid,u=t[c];if(u!==void 0&&u>=s){const d=s++,p=e[d];t[p.uuid]=u,e[u]=p,t[c]=d,e[d]=l;for(let m=0,g=r;m!==g;++m){const y=n[m],x=y[d],_=y[u];y[u]=x,y[d]=_}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_,a=e.length;for(let o=0,l=arguments.length;o!==l;++o){const c=arguments[o],u=c.uuid,d=t[u];if(d!==void 0)if(delete t[u],d<s){const p=--s,m=e[p],g=--a,y=e[g];t[m.uuid]=d,e[d]=m,t[y.uuid]=p,e[p]=y,e.pop();for(let x=0,_=r;x!==_;++x){const S=n[x],w=S[p],T=S[g];S[d]=w,S[p]=T,S.pop()}}else{const p=--a,m=e[p];p>0&&(t[m.uuid]=d),e[d]=m,e.pop();for(let g=0,y=r;g!==y;++g){const x=n[g];x[d]=x[p],x.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const s=this._bindings;if(r!==void 0)return s[r];const a=this._paths,o=this._parsedPaths,l=this._objects,c=l.length,u=this.nCachedObjects_,d=new Array(c);r=s.length,n[e]=r,a.push(e),o.push(t),s.push(d);for(let p=u,m=l.length;p!==m;++p){const g=l[p];d[p]=new gn(g,e,t)}return d}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const r=this._paths,s=this._parsedPaths,a=this._bindings,o=a.length-1,l=a[o],c=e[o];t[c]=n,a[n]=l,a.pop(),s[n]=s[o],s.pop(),r[n]=r[o],r.pop()}}}class TH{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const s=t.tracks,a=s.length,o=new Array(a),l={endingStart:kh,endingEnd:kh};for(let c=0;c!==a;++c){const u=s[c].createInterpolant(null);o[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=pB,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),n===!0){const r=this._clip.duration,s=e._clip.duration,a=s/r,o=r/s;e.warp(1,a,t),this.warp(o,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,s=r.time,a=this.timeScale;let o=this._timeScaleInterpolant;o===null&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);const l=o.parameterPositions,c=o.sampleValues;return l[0]=s,l[1]=s+n,c[0]=e/a,c[1]=t/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*n;l<0||n===0?t=0:(this._startTime=null,t=n*l)}t*=this._updateTimeScale(e);const a=this._updateTime(t),o=this._updateWeight(e);if(o>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case eA:for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(a),c[u].accumulateAdditive(o);break;case c2:default:for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(a),c[u].accumulate(r,o)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,s=this._loopCount;const a=n===mB;if(e===0)return s===-1?r:a&&(s&1)===1?t-r:r;if(n===fB){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),r>=t||r<0){const o=Math.floor(r/t);r-=t*o,s+=Math.abs(o);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=r;if(a&&(s&1)===1)return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=Oh,r.endingEnd=Oh):(e?r.endingStart=this.zeroSlopeAtStart?Oh:kh:r.endingStart=Qm,t?r.endingEnd=this.zeroSlopeAtEnd?Oh:kh:r.endingEnd=Qm)}_scheduleFading(e,t,n){const r=this._mixer,s=r.time;let a=this._weightInterpolant;a===null&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);const o=a.parameterPositions,l=a.sampleValues;return o[0]=s,l[0]=t,o[1]=s+e,l[1]=n,this}}const Wae=new Float32Array(1);class qae extends ul{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,s=r.length,a=e._propertyBindings,o=e._interpolants,l=n.uuid,c=this._bindingsByRootAndName;let u=c[l];u===void 0&&(u={},c[l]=u);for(let d=0;d!==s;++d){const p=r[d],m=p.name;let g=u[m];if(g!==void 0)++g.referenceCount,a[d]=g;else{if(g=a[d],g!==void 0){g._cacheIndex===null&&(++g.referenceCount,this._addInactiveBinding(g,l,m));continue}const y=t&&t._propertyBindings[d].binding.parsedPath;g=new MH(gn.create(n,m,y),p.ValueTypeName,p.getValueSize()),++g.referenceCount,this._addInactiveBinding(g,l,m),a[d]=g}o[d].resultBuffer=g.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,n)}const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,s=this._actionsByClip;let a=s[t];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=a;else{const o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,a=this._actionsByClip,o=a[s],l=o.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null;const d=o.actionByRoot,p=(e._localRoot||this._root).uuid;delete d[p],l.length===0&&delete a[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,s=this._bindings;let a=r[t];a===void 0&&(a={},r[t]=a),a[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,s=n.path,a=this._bindingsByRootAndName,o=a[r],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete o[s],Object.keys(o).length===0&&delete a[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new wA(new Float32Array(2),new Float32Array(2),1,Wae),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=n,t[n]=s}clipAction(e,t,n){const r=t||this._root,s=r.uuid;let a=typeof e=="string"?cg.findByName(r,e):e;const o=a!==null?a.uuid:e,l=this._actionsByClip[o];let c=null;if(n===void 0&&(a!==null?n=a.blendMode:n=c2),l!==void 0){const d=l.actionByRoot[s];if(d!==void 0&&d.blendMode===n)return d;c=l.knownActions[0],a===null&&(a=c._clip)}if(a===null)return null;const u=new TH(this,a,t,n);return this._bindAction(u,c),this._addInactiveAction(u,o,s),u}existingAction(e,t){const n=t||this._root,r=n.uuid,s=typeof e=="string"?cg.findByName(n,e):e,a=s?s.uuid:e,o=this._actionsByClip[a];return o!==void 0&&o.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,s=Math.sign(e),a=this._accuIndex^=1;for(let c=0;c!==n;++c)t[c]._update(r,e,s,a);const o=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)o[c].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,s=r[n];if(s!==void 0){const a=s.knownActions;for(let o=0,l=a.length;o!==l;++o){const c=a[o];this._deactivateAction(c);const u=c._cacheIndex,d=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,d._cacheIndex=u,t[u]=d,t.pop(),this._removeInactiveBindingsForAction(c)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const a in n){const o=n[a].actionByRoot,l=o[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const r=this._bindingsByRootAndName,s=r[t];if(s!==void 0)for(const a in s){const o=s[a];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class Xae extends rA{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isRenderTarget3D=!0,this.depth=n,this.texture=new h2(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class L2{constructor(e){this.value=e}clone(){return new L2(this.value.clone===void 0?this.value:this.value.clone())}}let Yae=0;class $ae extends ul{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Yae++}),this.name="",this.usage=eg,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,r=t.length;n<r;n++){const s=Array.isArray(t[n])?t[n]:[t[n]];for(let a=0;a<s.length;a++)this.uniforms.push(s[a].clone())}return this}clone(){return new this.constructor().copy(this)}}class Kv extends m2{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class Kae{constructor(e,t,n,r,s,a=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=s,this.normalized=a,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const Y9=new Bt;class AH{constructor(e,t,n=0,r=1/0){this.ray=new fd(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new p0,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):Vt("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return Y9.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(Y9),this}intersectObject(e,t=!0,n=[]){return E5(e,this,n,t),n.sort($9),n}intersectObjects(e,t=!0,n=[]){for(let r=0,s=e.length;r<s;r++)E5(e[r],this,n,t);return n.sort($9),n}}function $9(i,e){return i.distance-e.distance}function E5(i,e,t,n){let r=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(r=!1),r===!0&&n===!0){const s=i.children;for(let a=0,o=s.length;a<o;a++)E5(s[a],e,t,!0)}}class Zae{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=Qae.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}}function Qae(){this._document.hidden===!1&&this.reset()}class R5{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Ft(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Ft(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Jae{constructor(e=1,t=0,n=0){this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}class DA{constructor(e,t,n,r){DA.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){const s=this.elements;return s[0]=e,s[2]=t,s[1]=n,s[3]=r,this}}const K9=new Me;class eoe{constructor(e=new Me(1/0,1/0),t=new Me(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=K9.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,K9).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Z9=new K,X1=new K,xf=new K,yf=new K,a4=new K,toe=new K,noe=new K;class CH{constructor(e=new K,t=new K){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){Z9.subVectors(e,this.start),X1.subVectors(this.end,this.start);const n=X1.dot(X1);let s=X1.dot(Z9)/n;return t&&(s=Ft(s,0,1)),s}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}distanceSqToLine3(e,t=toe,n=noe){const r=10000000000000001e-32;let s,a;const o=this.start,l=e.start,c=this.end,u=e.end;xf.subVectors(c,o),yf.subVectors(u,l),a4.subVectors(o,l);const d=xf.dot(xf),p=yf.dot(yf),m=yf.dot(a4);if(d<=r&&p<=r)return t.copy(o),n.copy(l),t.sub(n),t.dot(t);if(d<=r)s=0,a=m/p,a=Ft(a,0,1);else{const g=xf.dot(a4);if(p<=r)a=0,s=Ft(-g/d,0,1);else{const y=xf.dot(yf),x=d*p-y*y;x!==0?s=Ft((y*m-g*p)/x,0,1):s=0,a=(y*s+m)/p,a<0?(a=0,s=Ft(-g/d,0,1)):a>1&&(a=1,s=Ft((y-g)/d,0,1))}}return t.copy(o).add(xf.multiplyScalar(s)),n.copy(l).add(yf.multiplyScalar(a)),t.sub(n),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const Q9=new K;class ioe extends xn{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new Yt,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,o=1,l=32;a<l;a++,o++){const c=a/l*Math.PI*2,u=o/l*Math.PI*2;r.push(Math.cos(c),Math.sin(c),1,Math.cos(u),Math.sin(u),1)}n.setAttribute("position",new _t(r,3));const s=new os({fog:!1,toneMapped:!1});this.cone=new hl(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Q9.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Q9),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Wc=new K,Y1=new Bt,o4=new Bt;class roe extends hl{constructor(e){const t=EH(e),n=new Yt,r=[],s=[];for(let c=0;c<t.length;c++){const u=t[c];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(0,0,0),s.push(0,0,0))}n.setAttribute("position",new _t(r,3)),n.setAttribute("color",new _t(s,3));const a=new os({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,a),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const o=new pt(255),l=new pt(65280);this.setColors(o,l)}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");o4.copy(this.root.matrixWorld).invert();for(let s=0,a=0;s<t.length;s++){const o=t[s];o.parent&&o.parent.isBone&&(Y1.multiplyMatrices(o4,o.matrixWorld),Wc.setFromMatrixPosition(Y1),r.setXYZ(a,Wc.x,Wc.y,Wc.z),Y1.multiplyMatrices(o4,o.parent.matrixWorld),Wc.setFromMatrixPosition(Y1),r.setXYZ(a+1,Wc.x,Wc.y,Wc.z),a+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const r=this.geometry.getAttribute("color");for(let s=0;s<r.count;s+=2)r.setXYZ(s,e.r,e.g,e.b),r.setXYZ(s+1,t.r,t.g,t.b);return r.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function EH(i){const e=[];i.isBone===!0&&e.push(i);for(let t=0;t<i.children.length;t++)e.push(...EH(i.children[t]));return e}class soe extends Bi{constructor(e,t,n){const r=new Zg(t,4,2),s=new Lu({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const aoe=new K,J9=new pt,eP=new pt;class ooe extends xn{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new Kg(t);r.rotateY(Math.PI*.5),this.material=new Lu({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),a=new Float32Array(s.count*3);r.setAttribute("color",new kn(a,3)),this.add(new Bi(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");J9.copy(this.light.color),eP.copy(this.light.groundColor);for(let n=0,r=t.count;n<r;n++){const s=n<r/2?J9:eP;t.setXYZ(n,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(aoe.setFromMatrixPosition(this.light.matrixWorld).negate())}}class loe extends hl{constructor(e=10,t=10,n=4473924,r=8947848){n=new pt(n),r=new pt(r);const s=t/2,a=e/t,o=e/2,l=[],c=[];for(let p=0,m=0,g=-o;p<=t;p++,g+=a){l.push(-o,0,g,o,0,g),l.push(g,0,-o,g,0,o);const y=p===s?n:r;y.toArray(c,m),m+=3,y.toArray(c,m),m+=3,y.toArray(c,m),m+=3,y.toArray(c,m),m+=3}const u=new Yt;u.setAttribute("position",new _t(l,3)),u.setAttribute("color",new _t(c,3));const d=new os({vertexColors:!0,toneMapped:!1});super(u,d),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class coe extends hl{constructor(e=10,t=16,n=8,r=64,s=4473924,a=8947848){s=new pt(s),a=new pt(a);const o=[],l=[];if(t>1)for(let d=0;d<t;d++){const p=d/t*(Math.PI*2),m=Math.sin(p)*e,g=Math.cos(p)*e;o.push(0,0,0),o.push(m,0,g);const y=d&1?s:a;l.push(y.r,y.g,y.b),l.push(y.r,y.g,y.b)}for(let d=0;d<n;d++){const p=d&1?s:a,m=e-e/n*d;for(let g=0;g<r;g++){let y=g/r*(Math.PI*2),x=Math.sin(y)*m,_=Math.cos(y)*m;o.push(x,0,_),l.push(p.r,p.g,p.b),y=(g+1)/r*(Math.PI*2),x=Math.sin(y)*m,_=Math.cos(y)*m,o.push(x,0,_),l.push(p.r,p.g,p.b)}}const c=new Yt;c.setAttribute("position",new _t(o,3)),c.setAttribute("color",new _t(l,3));const u=new os({vertexColors:!0,toneMapped:!1});super(c,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const tP=new K,$1=new K,nP=new K;class uoe extends xn{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new Yt;r.setAttribute("position",new _t([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new os({fog:!1,toneMapped:!1});this.lightPlane=new bu(r,s),this.add(this.lightPlane),r=new Yt,r.setAttribute("position",new _t([0,0,0,0,0,1],3)),this.targetLine=new bu(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),tP.setFromMatrixPosition(this.light.matrixWorld),$1.setFromMatrixPosition(this.light.target.matrixWorld),nP.subVectors($1,tP),this.lightPlane.lookAt($1),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt($1),this.targetLine.scale.z=nP.length()}}const K1=new K,bi=new d2;class hoe extends hl{constructor(e){const t=new Yt,n=new os({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],a={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(g,y){l(g),l(y)}function l(g){r.push(0,0,0),s.push(0,0,0),a[g]===void 0&&(a[g]=[]),a[g].push(r.length/3-1)}t.setAttribute("position",new _t(r,3)),t.setAttribute("color",new _t(s,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const c=new pt(16755200),u=new pt(16711680),d=new pt(43775),p=new pt(16777215),m=new pt(3355443);this.setColors(c,u,d,p,m)}setColors(e,t,n,r,s){const o=this.geometry.getAttribute("color");return o.setXYZ(0,e.r,e.g,e.b),o.setXYZ(1,e.r,e.g,e.b),o.setXYZ(2,e.r,e.g,e.b),o.setXYZ(3,e.r,e.g,e.b),o.setXYZ(4,e.r,e.g,e.b),o.setXYZ(5,e.r,e.g,e.b),o.setXYZ(6,e.r,e.g,e.b),o.setXYZ(7,e.r,e.g,e.b),o.setXYZ(8,e.r,e.g,e.b),o.setXYZ(9,e.r,e.g,e.b),o.setXYZ(10,e.r,e.g,e.b),o.setXYZ(11,e.r,e.g,e.b),o.setXYZ(12,e.r,e.g,e.b),o.setXYZ(13,e.r,e.g,e.b),o.setXYZ(14,e.r,e.g,e.b),o.setXYZ(15,e.r,e.g,e.b),o.setXYZ(16,e.r,e.g,e.b),o.setXYZ(17,e.r,e.g,e.b),o.setXYZ(18,e.r,e.g,e.b),o.setXYZ(19,e.r,e.g,e.b),o.setXYZ(20,e.r,e.g,e.b),o.setXYZ(21,e.r,e.g,e.b),o.setXYZ(22,e.r,e.g,e.b),o.setXYZ(23,e.r,e.g,e.b),o.setXYZ(24,t.r,t.g,t.b),o.setXYZ(25,t.r,t.g,t.b),o.setXYZ(26,t.r,t.g,t.b),o.setXYZ(27,t.r,t.g,t.b),o.setXYZ(28,t.r,t.g,t.b),o.setXYZ(29,t.r,t.g,t.b),o.setXYZ(30,t.r,t.g,t.b),o.setXYZ(31,t.r,t.g,t.b),o.setXYZ(32,n.r,n.g,n.b),o.setXYZ(33,n.r,n.g,n.b),o.setXYZ(34,n.r,n.g,n.b),o.setXYZ(35,n.r,n.g,n.b),o.setXYZ(36,n.r,n.g,n.b),o.setXYZ(37,n.r,n.g,n.b),o.setXYZ(38,r.r,r.g,r.b),o.setXYZ(39,r.r,r.g,r.b),o.setXYZ(40,s.r,s.g,s.b),o.setXYZ(41,s.r,s.g,s.b),o.setXYZ(42,s.r,s.g,s.b),o.setXYZ(43,s.r,s.g,s.b),o.setXYZ(44,s.r,s.g,s.b),o.setXYZ(45,s.r,s.g,s.b),o.setXYZ(46,s.r,s.g,s.b),o.setXYZ(47,s.r,s.g,s.b),o.setXYZ(48,s.r,s.g,s.b),o.setXYZ(49,s.r,s.g,s.b),o.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap,n=1,r=1;let s,a;if(bi.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)s=1,a=0;else if(this.camera.coordinateSystem===Js)s=-1,a=1;else if(this.camera.coordinateSystem===h0)s=0,a=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);Ei("c",t,e,bi,0,0,s),Ei("t",t,e,bi,0,0,a),Ei("n1",t,e,bi,-n,-r,s),Ei("n2",t,e,bi,n,-r,s),Ei("n3",t,e,bi,-n,r,s),Ei("n4",t,e,bi,n,r,s),Ei("f1",t,e,bi,-n,-r,a),Ei("f2",t,e,bi,n,-r,a),Ei("f3",t,e,bi,-n,r,a),Ei("f4",t,e,bi,n,r,a),Ei("u1",t,e,bi,n*.7,r*1.1,s),Ei("u2",t,e,bi,-n*.7,r*1.1,s),Ei("u3",t,e,bi,0,r*2,s),Ei("cf1",t,e,bi,-n,0,a),Ei("cf2",t,e,bi,n,0,a),Ei("cf3",t,e,bi,0,-r,a),Ei("cf4",t,e,bi,0,r,a),Ei("cn1",t,e,bi,-n,0,s),Ei("cn2",t,e,bi,n,0,s),Ei("cn3",t,e,bi,0,-r,s),Ei("cn4",t,e,bi,0,r,s),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Ei(i,e,t,n,r,s,a){K1.set(r,s,a).unproject(n);const o=e[i];if(o!==void 0){const l=t.getAttribute("position");for(let c=0,u=o.length;c<u;c++)l.setXYZ(o[c],K1.x,K1.y,K1.z)}}const Z1=new Xi;class doe extends hl{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),s=new Yt;s.setIndex(new kn(n,1)),s.setAttribute("position",new kn(r,3)),super(s,new os({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&Z1.setFromObject(this.object),Z1.isEmpty())return;const e=Z1.min,t=Z1.max,n=this.geometry.attributes.position,r=n.array;r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=e.x,r[4]=t.y,r[5]=t.z,r[6]=e.x,r[7]=e.y,r[8]=t.z,r[9]=t.x,r[10]=e.y,r[11]=t.z,r[12]=t.x,r[13]=t.y,r[14]=e.z,r[15]=e.x,r[16]=t.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=t.x,r[22]=e.y,r[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class foe extends hl{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Yt;s.setIndex(new kn(n,1)),s.setAttribute("position",new _t(r,3)),super(s,new os({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class poe extends bu{constructor(e,t=1,n=16776960){const r=n,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],a=new Yt;a.setAttribute("position",new _t(s,3)),a.computeBoundingSphere(),super(a,new os({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const o=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new Yt;l.setAttribute("position",new _t(o,3)),l.computeBoundingSphere(),this.add(new Bi(l,new Lu({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const iP=new K;let Q1,l4;class moe extends xn{constructor(e=new K(0,0,1),t=new K(0,0,0),n=1,r=16776960,s=n*.2,a=s*.2){super(),this.type="ArrowHelper",Q1===void 0&&(Q1=new Yt,Q1.setAttribute("position",new _t([0,0,0,0,1,0],3)),l4=new $g(.5,1,5,1),l4.translate(0,-.5,0)),this.position.copy(t),this.line=new bu(Q1,new os({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Bi(l4,new Lu({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,s,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{iP.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(iP,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class goe extends hl{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Yt;r.setAttribute("position",new _t(t,3)),r.setAttribute("color",new _t(n,3));const s=new os({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,t,n){const r=new pt,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(n),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class xoe{constructor(){this.type="ShapePath",this.color=new pt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new $v,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,s,a){return this.currentPath.bezierCurveTo(e,t,n,r,s,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(_){const S=[];for(let w=0,T=_.length;w<T;w++){const C=_[w],E=new qh;E.curves=C.curves,S.push(E)}return S}function n(_,S){const w=S.length;let T=!1;for(let C=w-1,E=0;E<w;C=E++){let D=S[C],O=S[E],R=O.x-D.x,P=O.y-D.y;if(Math.abs(P)>Number.EPSILON){if(P<0&&(D=S[E],R=-R,O=S[C],P=-P),_.y<D.y||_.y>O.y)continue;if(_.y===D.y){if(_.x===D.x)return!0}else{const L=P*(_.x-D.x)-R*(_.y-D.y);if(L===0)return!0;if(L<0)continue;T=!T}}else{if(_.y!==D.y)continue;if(O.x<=_.x&&_.x<=D.x||D.x<=_.x&&_.x<=O.x)return!0}}return T}const r=ho.isClockWise,s=this.subPaths;if(s.length===0)return[];let a,o,l;const c=[];if(s.length===1)return o=s[0],l=new qh,l.curves=o.curves,c.push(l),c;let u=!r(s[0].getPoints());u=e?!u:u;const d=[],p=[];let m=[],g=0,y;p[g]=void 0,m[g]=[];for(let _=0,S=s.length;_<S;_++)o=s[_],y=o.getPoints(),a=r(y),a=e?!a:a,a?(!u&&p[g]&&g++,p[g]={s:new qh,p:y},p[g].s.curves=o.curves,u&&g++,m[g]=[]):m[g].push({h:o,p:y[0]});if(!p[0])return t(s);if(p.length>1){let _=!1,S=0;for(let w=0,T=p.length;w<T;w++)d[w]=[];for(let w=0,T=p.length;w<T;w++){const C=m[w];for(let E=0;E<C.length;E++){const D=C[E];let O=!0;for(let R=0;R<p.length;R++)n(D.p,p[R].p)&&(w!==R&&S++,O?(O=!1,d[R].push(D)):_=!0);O&&d[w].push(D)}}S>0&&_===!1&&(m=d)}let x;for(let _=0,S=p.length;_<S;_++){l=p[_].s,c.push(l),x=m[_];for(let w=0,T=x.length;w<T;w++)l.holes.push(x[w].h)}return c}}class yoe extends ul{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){lt("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function voe(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2):(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0),i}function boe(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0):(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2),i}function _oe(i){return i.repeat.x=1,i.repeat.y=1,i.offset.x=0,i.offset.y=0,i}function P5(i,e,t,n){const r=Soe(n);switch(t){case QT:return i*e;case Wg:return i*e/r.components*r.byteLength;case qg:return i*e/r.components*r.byteLength;case a2:return i*e*2/r.components*r.byteLength;case o2:return i*e*2/r.components*r.byteLength;case JT:return i*e*3/r.components*r.byteLength;case Fr:return i*e*4/r.components*r.byteLength;case l2:return i*e*4/r.components*r.byteLength;case mm:case gm:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case xm:case ym:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case yv:case bv:return Math.max(i,16)*Math.max(e,8)/4;case xv:case vv:return Math.max(i,8)*Math.max(e,8)/2;case _v:case Sv:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case wv:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case Mv:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case Tv:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case Av:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case Cv:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case Ev:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case Rv:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case Pv:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case Iv:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case Dv:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case Nv:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case Lv:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case kv:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case Ov:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case zv:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case Uv:case Fv:case Bv:return Math.ceil(i/4)*Math.ceil(e/4)*16;case Hv:case jv:return Math.ceil(i/4)*Math.ceil(e/4)*8;case Vv:case Gv:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function Soe(i){switch(i){case za:case YT:return{byteLength:1,components:1};case o0:case $T:case bc:return{byteLength:2,components:1};case r2:case s2:return{byteLength:2,components:4};case fc:case i2:case ns:return{byteLength:4,components:1};case KT:case ZT:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}class woe{static contain(e,t){return voe(e,t)}static cover(e,t){return boe(e,t)}static fill(e){return _oe(e)}static getByteLength(e,t,n,r){return P5(e,t,n,r)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Vg}}));typeof window<"u"&&(window.__THREE__?lt("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Vg);function RH(){let i=null,e=!1,t=null,n=null;function r(s,a){t(s,a),n=i.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function Moe(i){const e=new WeakMap;function t(o,l){const c=o.array,u=o.usage,d=c.byteLength,p=i.createBuffer();i.bindBuffer(l,p),i.bufferData(l,c,u),o.onUploadCallback();let m;if(c instanceof Float32Array)m=i.FLOAT;else if(typeof Float16Array<"u"&&c instanceof Float16Array)m=i.HALF_FLOAT;else if(c instanceof Uint16Array)o.isFloat16BufferAttribute?m=i.HALF_FLOAT:m=i.UNSIGNED_SHORT;else if(c instanceof Int16Array)m=i.SHORT;else if(c instanceof Uint32Array)m=i.UNSIGNED_INT;else if(c instanceof Int32Array)m=i.INT;else if(c instanceof Int8Array)m=i.BYTE;else if(c instanceof Uint8Array)m=i.UNSIGNED_BYTE;else if(c instanceof Uint8ClampedArray)m=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:p,type:m,bytesPerElement:c.BYTES_PER_ELEMENT,version:o.version,size:d}}function n(o,l,c){const u=l.array,d=l.updateRanges;if(i.bindBuffer(c,o),d.length===0)i.bufferSubData(c,0,u);else{d.sort((m,g)=>m.start-g.start);let p=0;for(let m=1;m<d.length;m++){const g=d[p],y=d[m];y.start<=g.start+g.count+1?g.count=Math.max(g.count,y.start+y.count-g.start):(++p,d[p]=y)}d.length=p+1;for(let m=0,g=d.length;m<g;m++){const y=d[m];i.bufferSubData(c,y.start*u.BYTES_PER_ELEMENT,u,y.start,y.count)}l.clearUpdateRanges()}l.onUploadCallback()}function r(o){return o.isInterleavedBufferAttribute&&(o=o.data),e.get(o)}function s(o){o.isInterleavedBufferAttribute&&(o=o.data);const l=e.get(o);l&&(i.deleteBuffer(l.buffer),e.delete(o))}function a(o,l){if(o.isInterleavedBufferAttribute&&(o=o.data),o.isGLBufferAttribute){const u=e.get(o);(!u||u.version<o.version)&&e.set(o,{buffer:o.buffer,type:o.type,bytesPerElement:o.elementSize,version:o.version});return}const c=e.get(o);if(c===void 0)e.set(o,t(o,l));else if(c.version<o.version){if(c.size!==o.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(c.buffer,o,l),c.version=o.version}}return{get:r,remove:s,update:a}}var Toe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Aoe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Coe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,Eoe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Roe=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,Poe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Ioe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Doe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Noe=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,Loe=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,koe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,Ooe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,zoe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,Uoe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Foe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Boe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,Hoe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,joe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Voe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Goe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Woe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,qoe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,Xoe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,Yoe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,$oe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Koe=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Zoe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Qoe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Joe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,ele=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,tle="gl_FragColor = linearToOutputTexel( gl_FragColor );",nle=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,ile=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,rle=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,sle=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,ale=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,ole=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,lle=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,cle=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,ule=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,hle=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,dle=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,fle=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,ple=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,mle=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,gle=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,xle=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,yle=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,vle=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,ble=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,_le=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Sle=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,wle=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 uv = vec2( roughness, dotNV );
	return texture2D( dfgLUT, uv ).rg;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = DFGApprox( vec3(0.0, 0.0, 1.0), vec3(sqrt(1.0 - dotNV * dotNV), 0.0, dotNV), material.roughness );
	vec2 dfgL = DFGApprox( vec3(0.0, 0.0, 1.0), vec3(sqrt(1.0 - dotNL * dotNL), 0.0, dotNL), material.roughness );
	vec3 FssEss_V = material.specularColor * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColor * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColor + ( 1.0 - material.specularColor ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Mle=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Tle=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Ale=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,Cle=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Ele=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Rle=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Ple=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,Ile=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Dle=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Nle=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Lle=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,kle=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Ole=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,zle=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,Ule=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Fle=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Ble=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,Hle=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,jle=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Vle=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Gle=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Wle=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,qle=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Xle=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Yle=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,$le=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Kle=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Zle=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Qle=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Jle=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,ece=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,tce=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,nce=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,ice=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,rce=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,sce=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,ace=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		float depth = unpackRGBAToDepth( texture2D( depths, uv ) );
		#ifdef USE_REVERSED_DEPTH_BUFFER
			return step( depth, compare );
		#else
			return step( compare, depth );
		#endif
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow( sampler2D shadow, vec2 uv, float compare ) {
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		#ifdef USE_REVERSED_DEPTH_BUFFER
			float hard_shadow = step( distribution.x, compare );
		#else
			float hard_shadow = step( compare, distribution.x );
		#endif
		if ( hard_shadow != 1.0 ) {
			float distance = compare - distribution.x;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,oce=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,lce=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,cce=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,uce=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,hce=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,dce=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,fce=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,pce=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,mce=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,gce=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,xce=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,yce=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,vce=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,bce=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,_ce=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Sce=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,wce=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Mce=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Tce=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Ace=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Cce=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Ece=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Rce=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Pce=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Ice=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,Dce=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Nce=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Lce=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,kce=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Oce=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,zce=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Uce=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Fce=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Bce=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Hce=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,jce=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Vce=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Gce=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Wce=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,qce=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Xce=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Yce=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,$ce=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Kce=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Zce=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Qce=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Jce=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,eue=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,tue=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,nue=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,iue=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Zt={alphahash_fragment:Toe,alphahash_pars_fragment:Aoe,alphamap_fragment:Coe,alphamap_pars_fragment:Eoe,alphatest_fragment:Roe,alphatest_pars_fragment:Poe,aomap_fragment:Ioe,aomap_pars_fragment:Doe,batching_pars_vertex:Noe,batching_vertex:Loe,begin_vertex:koe,beginnormal_vertex:Ooe,bsdfs:zoe,iridescence_fragment:Uoe,bumpmap_pars_fragment:Foe,clipping_planes_fragment:Boe,clipping_planes_pars_fragment:Hoe,clipping_planes_pars_vertex:joe,clipping_planes_vertex:Voe,color_fragment:Goe,color_pars_fragment:Woe,color_pars_vertex:qoe,color_vertex:Xoe,common:Yoe,cube_uv_reflection_fragment:$oe,defaultnormal_vertex:Koe,displacementmap_pars_vertex:Zoe,displacementmap_vertex:Qoe,emissivemap_fragment:Joe,emissivemap_pars_fragment:ele,colorspace_fragment:tle,colorspace_pars_fragment:nle,envmap_fragment:ile,envmap_common_pars_fragment:rle,envmap_pars_fragment:sle,envmap_pars_vertex:ale,envmap_physical_pars_fragment:xle,envmap_vertex:ole,fog_vertex:lle,fog_pars_vertex:cle,fog_fragment:ule,fog_pars_fragment:hle,gradientmap_pars_fragment:dle,lightmap_pars_fragment:fle,lights_lambert_fragment:ple,lights_lambert_pars_fragment:mle,lights_pars_begin:gle,lights_toon_fragment:yle,lights_toon_pars_fragment:vle,lights_phong_fragment:ble,lights_phong_pars_fragment:_le,lights_physical_fragment:Sle,lights_physical_pars_fragment:wle,lights_fragment_begin:Mle,lights_fragment_maps:Tle,lights_fragment_end:Ale,logdepthbuf_fragment:Cle,logdepthbuf_pars_fragment:Ele,logdepthbuf_pars_vertex:Rle,logdepthbuf_vertex:Ple,map_fragment:Ile,map_pars_fragment:Dle,map_particle_fragment:Nle,map_particle_pars_fragment:Lle,metalnessmap_fragment:kle,metalnessmap_pars_fragment:Ole,morphinstance_vertex:zle,morphcolor_vertex:Ule,morphnormal_vertex:Fle,morphtarget_pars_vertex:Ble,morphtarget_vertex:Hle,normal_fragment_begin:jle,normal_fragment_maps:Vle,normal_pars_fragment:Gle,normal_pars_vertex:Wle,normal_vertex:qle,normalmap_pars_fragment:Xle,clearcoat_normal_fragment_begin:Yle,clearcoat_normal_fragment_maps:$le,clearcoat_pars_fragment:Kle,iridescence_pars_fragment:Zle,opaque_fragment:Qle,packing:Jle,premultiplied_alpha_fragment:ece,project_vertex:tce,dithering_fragment:nce,dithering_pars_fragment:ice,roughnessmap_fragment:rce,roughnessmap_pars_fragment:sce,shadowmap_pars_fragment:ace,shadowmap_pars_vertex:oce,shadowmap_vertex:lce,shadowmask_pars_fragment:cce,skinbase_vertex:uce,skinning_pars_vertex:hce,skinning_vertex:dce,skinnormal_vertex:fce,specularmap_fragment:pce,specularmap_pars_fragment:mce,tonemapping_fragment:gce,tonemapping_pars_fragment:xce,transmission_fragment:yce,transmission_pars_fragment:vce,uv_pars_fragment:bce,uv_pars_vertex:_ce,uv_vertex:Sce,worldpos_vertex:wce,background_vert:Mce,background_frag:Tce,backgroundCube_vert:Ace,backgroundCube_frag:Cce,cube_vert:Ece,cube_frag:Rce,depth_vert:Pce,depth_frag:Ice,distanceRGBA_vert:Dce,distanceRGBA_frag:Nce,equirect_vert:Lce,equirect_frag:kce,linedashed_vert:Oce,linedashed_frag:zce,meshbasic_vert:Uce,meshbasic_frag:Fce,meshlambert_vert:Bce,meshlambert_frag:Hce,meshmatcap_vert:jce,meshmatcap_frag:Vce,meshnormal_vert:Gce,meshnormal_frag:Wce,meshphong_vert:qce,meshphong_frag:Xce,meshphysical_vert:Yce,meshphysical_frag:$ce,meshtoon_vert:Kce,meshtoon_frag:Zce,points_vert:Qce,points_frag:Jce,shadow_vert:eue,shadow_frag:tue,sprite_vert:nue,sprite_frag:iue},at={common:{diffuse:{value:new pt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new qt},alphaMap:{value:null},alphaMapTransform:{value:new qt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new qt}},envmap:{envMap:{value:null},envMapRotation:{value:new qt},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new qt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new qt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new qt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new qt},normalScale:{value:new Me(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new qt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new qt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new qt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new qt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new pt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new pt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new qt},alphaTest:{value:0},uvTransform:{value:new qt}},sprite:{diffuse:{value:new pt(16777215)},opacity:{value:1},center:{value:new Me(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new qt},alphaMap:{value:null},alphaMapTransform:{value:new qt},alphaTest:{value:0}}},ao={basic:{uniforms:Kr([at.common,at.specularmap,at.envmap,at.aomap,at.lightmap,at.fog]),vertexShader:Zt.meshbasic_vert,fragmentShader:Zt.meshbasic_frag},lambert:{uniforms:Kr([at.common,at.specularmap,at.envmap,at.aomap,at.lightmap,at.emissivemap,at.bumpmap,at.normalmap,at.displacementmap,at.fog,at.lights,{emissive:{value:new pt(0)}}]),vertexShader:Zt.meshlambert_vert,fragmentShader:Zt.meshlambert_frag},phong:{uniforms:Kr([at.common,at.specularmap,at.envmap,at.aomap,at.lightmap,at.emissivemap,at.bumpmap,at.normalmap,at.displacementmap,at.fog,at.lights,{emissive:{value:new pt(0)},specular:{value:new pt(1118481)},shininess:{value:30}}]),vertexShader:Zt.meshphong_vert,fragmentShader:Zt.meshphong_frag},standard:{uniforms:Kr([at.common,at.envmap,at.aomap,at.lightmap,at.emissivemap,at.bumpmap,at.normalmap,at.displacementmap,at.roughnessmap,at.metalnessmap,at.fog,at.lights,{emissive:{value:new pt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Zt.meshphysical_vert,fragmentShader:Zt.meshphysical_frag},toon:{uniforms:Kr([at.common,at.aomap,at.lightmap,at.emissivemap,at.bumpmap,at.normalmap,at.displacementmap,at.gradientmap,at.fog,at.lights,{emissive:{value:new pt(0)}}]),vertexShader:Zt.meshtoon_vert,fragmentShader:Zt.meshtoon_frag},matcap:{uniforms:Kr([at.common,at.bumpmap,at.normalmap,at.displacementmap,at.fog,{matcap:{value:null}}]),vertexShader:Zt.meshmatcap_vert,fragmentShader:Zt.meshmatcap_frag},points:{uniforms:Kr([at.points,at.fog]),vertexShader:Zt.points_vert,fragmentShader:Zt.points_frag},dashed:{uniforms:Kr([at.common,at.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Zt.linedashed_vert,fragmentShader:Zt.linedashed_frag},depth:{uniforms:Kr([at.common,at.displacementmap]),vertexShader:Zt.depth_vert,fragmentShader:Zt.depth_frag},normal:{uniforms:Kr([at.common,at.bumpmap,at.normalmap,at.displacementmap,{opacity:{value:1}}]),vertexShader:Zt.meshnormal_vert,fragmentShader:Zt.meshnormal_frag},sprite:{uniforms:Kr([at.sprite,at.fog]),vertexShader:Zt.sprite_vert,fragmentShader:Zt.sprite_frag},background:{uniforms:{uvTransform:{value:new qt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Zt.background_vert,fragmentShader:Zt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new qt}},vertexShader:Zt.backgroundCube_vert,fragmentShader:Zt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Zt.cube_vert,fragmentShader:Zt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Zt.equirect_vert,fragmentShader:Zt.equirect_frag},distanceRGBA:{uniforms:Kr([at.common,at.displacementmap,{referencePosition:{value:new K},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Zt.distanceRGBA_vert,fragmentShader:Zt.distanceRGBA_frag},shadow:{uniforms:Kr([at.lights,at.fog,{color:{value:new pt(0)},opacity:{value:1}}]),vertexShader:Zt.shadow_vert,fragmentShader:Zt.shadow_frag}};ao.physical={uniforms:Kr([ao.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new qt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new qt},clearcoatNormalScale:{value:new Me(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new qt},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new qt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new qt},sheen:{value:0},sheenColor:{value:new pt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new qt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new qt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new qt},transmissionSamplerSize:{value:new Me},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new qt},attenuationDistance:{value:0},attenuationColor:{value:new pt(0)},specularColor:{value:new pt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new qt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new qt},anisotropyVector:{value:new Me},anisotropyMap:{value:null},anisotropyMapTransform:{value:new qt}}]),vertexShader:Zt.meshphysical_vert,fragmentShader:Zt.meshphysical_frag};const J1={r:0,b:0,g:0},vh=new la,rue=new Bt;function sue(i,e,t,n,r,s,a){const o=new pt(0);let l=s===!0?0:1,c,u,d=null,p=0,m=null;function g(w){let T=w.isScene===!0?w.background:null;return T&&T.isTexture&&(T=(w.backgroundBlurriness>0?t:e).get(T)),T}function y(w){let T=!1;const C=g(w);C===null?_(o,l):C&&C.isColor&&(_(C,1),T=!0);const E=i.xr.getEnvironmentBlendMode();E==="additive"?n.buffers.color.setClear(0,0,0,1,a):E==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,a),(i.autoClear||T)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function x(w,T){const C=g(T);C&&(C.isCubeTexture||C.mapping===N0)?(u===void 0&&(u=new Bi(new pd(1,1,1),new Ps({name:"BackgroundCubeMaterial",uniforms:m0(ao.backgroundCube.uniforms),vertexShader:ao.backgroundCube.vertexShader,fragmentShader:ao.backgroundCube.fragmentShader,side:as,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(E,D,O){this.matrixWorld.copyPosition(O.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),vh.copy(T.backgroundRotation),vh.x*=-1,vh.y*=-1,vh.z*=-1,C.isCubeTexture&&C.isRenderTargetTexture===!1&&(vh.y*=-1,vh.z*=-1),u.material.uniforms.envMap.value=C,u.material.uniforms.flipEnvMap.value=C.isCubeTexture&&C.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=T.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=T.backgroundIntensity,u.material.uniforms.backgroundRotation.value.setFromMatrix4(rue.makeRotationFromEuler(vh)),u.material.toneMapped=fn.getTransfer(C.colorSpace)!==Pn,(d!==C||p!==C.version||m!==i.toneMapping)&&(u.material.needsUpdate=!0,d=C,p=C.version,m=i.toneMapping),u.layers.enableAll(),w.unshift(u,u.geometry,u.material,0,0,null)):C&&C.isTexture&&(c===void 0&&(c=new Bi(new k0(2,2),new Ps({name:"BackgroundMaterial",uniforms:m0(ao.background.uniforms),vertexShader:ao.background.vertexShader,fragmentShader:ao.background.fragmentShader,side:hc,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=C,c.material.uniforms.backgroundIntensity.value=T.backgroundIntensity,c.material.toneMapped=fn.getTransfer(C.colorSpace)!==Pn,C.matrixAutoUpdate===!0&&C.updateMatrix(),c.material.uniforms.uvTransform.value.copy(C.matrix),(d!==C||p!==C.version||m!==i.toneMapping)&&(c.material.needsUpdate=!0,d=C,p=C.version,m=i.toneMapping),c.layers.enableAll(),w.unshift(c,c.geometry,c.material,0,0,null))}function _(w,T){w.getRGB(J1,PB(i)),n.buffers.color.setClear(J1.r,J1.g,J1.b,T,a)}function S(){u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0),c!==void 0&&(c.geometry.dispose(),c.material.dispose(),c=void 0)}return{getClearColor:function(){return o},setClearColor:function(w,T=1){o.set(w),l=T,_(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(w){l=w,_(o,l)},render:y,addToRenderList:x,dispose:S}}function aue(i,e){const t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},r=p(null);let s=r,a=!1;function o(P,L,V,j,B){let J=!1;const U=d(j,V,L);s!==U&&(s=U,c(s.object)),J=m(P,j,V,B),J&&g(P,j,V,B),B!==null&&e.update(B,i.ELEMENT_ARRAY_BUFFER),(J||a)&&(a=!1,T(P,L,V,j),B!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(B).buffer))}function l(){return i.createVertexArray()}function c(P){return i.bindVertexArray(P)}function u(P){return i.deleteVertexArray(P)}function d(P,L,V){const j=V.wireframe===!0;let B=n[P.id];B===void 0&&(B={},n[P.id]=B);let J=B[L.id];J===void 0&&(J={},B[L.id]=J);let U=J[j];return U===void 0&&(U=p(l()),J[j]=U),U}function p(P){const L=[],V=[],j=[];for(let B=0;B<t;B++)L[B]=0,V[B]=0,j[B]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:L,enabledAttributes:V,attributeDivisors:j,object:P,attributes:{},index:null}}function m(P,L,V,j){const B=s.attributes,J=L.attributes;let U=0;const X=V.getAttributes();for(const $ in X)if(X[$].location>=0){const se=B[$];let ye=J[$];if(ye===void 0&&($==="instanceMatrix"&&P.instanceMatrix&&(ye=P.instanceMatrix),$==="instanceColor"&&P.instanceColor&&(ye=P.instanceColor)),se===void 0||se.attribute!==ye||ye&&se.data!==ye.data)return!0;U++}return s.attributesNum!==U||s.index!==j}function g(P,L,V,j){const B={},J=L.attributes;let U=0;const X=V.getAttributes();for(const $ in X)if(X[$].location>=0){let se=J[$];se===void 0&&($==="instanceMatrix"&&P.instanceMatrix&&(se=P.instanceMatrix),$==="instanceColor"&&P.instanceColor&&(se=P.instanceColor));const ye={};ye.attribute=se,se&&se.data&&(ye.data=se.data),B[$]=ye,U++}s.attributes=B,s.attributesNum=U,s.index=j}function y(){const P=s.newAttributes;for(let L=0,V=P.length;L<V;L++)P[L]=0}function x(P){_(P,0)}function _(P,L){const V=s.newAttributes,j=s.enabledAttributes,B=s.attributeDivisors;V[P]=1,j[P]===0&&(i.enableVertexAttribArray(P),j[P]=1),B[P]!==L&&(i.vertexAttribDivisor(P,L),B[P]=L)}function S(){const P=s.newAttributes,L=s.enabledAttributes;for(let V=0,j=L.length;V<j;V++)L[V]!==P[V]&&(i.disableVertexAttribArray(V),L[V]=0)}function w(P,L,V,j,B,J,U){U===!0?i.vertexAttribIPointer(P,L,V,B,J):i.vertexAttribPointer(P,L,V,j,B,J)}function T(P,L,V,j){y();const B=j.attributes,J=V.getAttributes(),U=L.defaultAttributeValues;for(const X in J){const $=J[X];if($.location>=0){let Q=B[X];if(Q===void 0&&(X==="instanceMatrix"&&P.instanceMatrix&&(Q=P.instanceMatrix),X==="instanceColor"&&P.instanceColor&&(Q=P.instanceColor)),Q!==void 0){const se=Q.normalized,ye=Q.itemSize,we=e.get(Q);if(we===void 0)continue;const He=we.buffer,De=we.type,Oe=we.bytesPerElement,fe=De===i.INT||De===i.UNSIGNED_INT||Q.gpuType===i2;if(Q.isInterleavedBufferAttribute){const ge=Q.data,Ne=ge.stride,Qe=Q.offset;if(ge.isInstancedInterleavedBuffer){for(let et=0;et<$.locationSize;et++)_($.location+et,ge.meshPerAttribute);P.isInstancedMesh!==!0&&j._maxInstanceCount===void 0&&(j._maxInstanceCount=ge.meshPerAttribute*ge.count)}else for(let et=0;et<$.locationSize;et++)x($.location+et);i.bindBuffer(i.ARRAY_BUFFER,He);for(let et=0;et<$.locationSize;et++)w($.location+et,ye/$.locationSize,De,se,Ne*Oe,(Qe+ye/$.locationSize*et)*Oe,fe)}else{if(Q.isInstancedBufferAttribute){for(let ge=0;ge<$.locationSize;ge++)_($.location+ge,Q.meshPerAttribute);P.isInstancedMesh!==!0&&j._maxInstanceCount===void 0&&(j._maxInstanceCount=Q.meshPerAttribute*Q.count)}else for(let ge=0;ge<$.locationSize;ge++)x($.location+ge);i.bindBuffer(i.ARRAY_BUFFER,He);for(let ge=0;ge<$.locationSize;ge++)w($.location+ge,ye/$.locationSize,De,se,ye*Oe,ye/$.locationSize*ge*Oe,fe)}}else if(U!==void 0){const se=U[X];if(se!==void 0)switch(se.length){case 2:i.vertexAttrib2fv($.location,se);break;case 3:i.vertexAttrib3fv($.location,se);break;case 4:i.vertexAttrib4fv($.location,se);break;default:i.vertexAttrib1fv($.location,se)}}}}S()}function C(){O();for(const P in n){const L=n[P];for(const V in L){const j=L[V];for(const B in j)u(j[B].object),delete j[B];delete L[V]}delete n[P]}}function E(P){if(n[P.id]===void 0)return;const L=n[P.id];for(const V in L){const j=L[V];for(const B in j)u(j[B].object),delete j[B];delete L[V]}delete n[P.id]}function D(P){for(const L in n){const V=n[L];if(V[P.id]===void 0)continue;const j=V[P.id];for(const B in j)u(j[B].object),delete j[B];delete V[P.id]}}function O(){R(),a=!0,s!==r&&(s=r,c(s.object))}function R(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:o,reset:O,resetDefaultState:R,dispose:C,releaseStatesOfGeometry:E,releaseStatesOfProgram:D,initAttributes:y,enableAttribute:x,disableUnusedAttributes:S}}function oue(i,e,t){let n;function r(c){n=c}function s(c,u){i.drawArrays(n,c,u),t.update(u,n,1)}function a(c,u,d){d!==0&&(i.drawArraysInstanced(n,c,u,d),t.update(u,n,d))}function o(c,u,d){if(d===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,c,0,u,0,d);let m=0;for(let g=0;g<d;g++)m+=u[g];t.update(m,n,1)}function l(c,u,d,p){if(d===0)return;const m=e.get("WEBGL_multi_draw");if(m===null)for(let g=0;g<c.length;g++)a(c[g],u[g],p[g]);else{m.multiDrawArraysInstancedWEBGL(n,c,0,u,0,p,0,d);let g=0;for(let y=0;y<d;y++)g+=u[y]*p[y];t.update(g,n,1)}}this.setMode=r,this.render=s,this.renderInstances=a,this.renderMultiDraw=o,this.renderMultiDrawInstances=l}function lue(i,e,t,n){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const D=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(D.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function a(D){return!(D!==Fr&&n.convert(D)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function o(D){const O=D===bc&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(D!==za&&n.convert(D)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&D!==ns&&!O)}function l(D){if(D==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";D="mediump"}return D==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=t.precision!==void 0?t.precision:"highp";const u=l(c);u!==c&&(lt("WebGLRenderer:",c,"not supported, using",u,"instead."),c=u);const d=t.logarithmicDepthBuffer===!0,p=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),m=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),g=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),y=i.getParameter(i.MAX_TEXTURE_SIZE),x=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),_=i.getParameter(i.MAX_VERTEX_ATTRIBS),S=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),w=i.getParameter(i.MAX_VARYING_VECTORS),T=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),C=g>0,E=i.getParameter(i.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:a,textureTypeReadable:o,precision:c,logarithmicDepthBuffer:d,reversedDepthBuffer:p,maxTextures:m,maxVertexTextures:g,maxTextureSize:y,maxCubemapSize:x,maxAttributes:_,maxVertexUniforms:S,maxVaryings:w,maxFragmentUniforms:T,vertexTextures:C,maxSamples:E}}function cue(i){const e=this;let t=null,n=0,r=!1,s=!1;const a=new Wl,o=new qt,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,p){const m=d.length!==0||p||n!==0||r;return r=p,n=d.length,m},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,p){t=u(d,p,0)},this.setState=function(d,p,m){const g=d.clippingPlanes,y=d.clipIntersection,x=d.clipShadows,_=i.get(d);if(!r||g===null||g.length===0||s&&!x)s?u(null):c();else{const S=s?0:n,w=S*4;let T=_.clippingState||null;l.value=T,T=u(g,p,w,m);for(let C=0;C!==w;++C)T[C]=t[C];_.clippingState=T,this.numIntersection=y?this.numPlanes:0,this.numPlanes+=S}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function u(d,p,m,g){const y=d!==null?d.length:0;let x=null;if(y!==0){if(x=l.value,g!==!0||x===null){const _=m+y*4,S=p.matrixWorldInverse;o.getNormalMatrix(S),(x===null||x.length<_)&&(x=new Float32Array(_));for(let w=0,T=m;w!==y;++w,T+=4)a.copy(d[w]).applyMatrix4(S,o),a.normal.toArray(x,T),x[T+3]=a.constant}l.value=x,l.needsUpdate=!0}return e.numPlanes=y,e.numIntersection=0,x}}function uue(i){let e=new WeakMap;function t(a,o){return o===Xm?a.mapping=dc:o===Ym&&(a.mapping=xu),a}function n(a){if(a&&a.isTexture){const o=a.mapping;if(o===Xm||o===Ym)if(e.has(a)){const l=e.get(a).texture;return t(l,a.mapping)}else{const l=a.image;if(l&&l.height>0){const c=new DB(l.height);return c.fromEquirectangularTexture(i,a),e.set(a,c),a.addEventListener("dispose",r),t(c.texture,a.mapping)}else return null}}return a}function r(a){const o=a.target;o.removeEventListener("dispose",r);const l=e.get(o);l!==void 0&&(e.delete(o),l.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}const ru=4,rP=[.125,.215,.35,.446,.526,.582],Dh=20,hue=256,Up=new uu,sP=new pt;let c4=null,u4=0,h4=0,d4=!1;const due=new K;class I5{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,n=.1,r=100,s={}){const{size:a=256,position:o=due}=s;c4=this._renderer.getRenderTarget(),u4=this._renderer.getActiveCubeFace(),h4=this._renderer.getActiveMipmapLevel(),d4=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,n,r,l,o),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=lP(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=oP(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(c4,u4,h4),this._renderer.xr.enabled=d4,e.scissorTest=!1,vf(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===dc||e.mapping===xu?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),c4=this._renderer.getRenderTarget(),u4=this._renderer.getActiveCubeFace(),h4=this._renderer.getActiveMipmapLevel(),d4=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Jn,minFilter:Jn,generateMipmaps:!1,type:bc,format:Fr,colorSpace:yu,depthBuffer:!1},r=aP(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=aP(e,t,n);const{_lodMax:s}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=fue(s)),this._blurMaterial=mue(s,e,t),this._ggxMaterial=pue(s,e,t)}return r}_compileMaterial(e){const t=new Bi(new Yt,e);this._renderer.compile(t,Up)}_sceneToCubeUV(e,t,n,r,s){const l=new Pi(90,1,t,n),c=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],d=this._renderer,p=d.autoClear,m=d.toneMapping;d.getClearColor(sP),d.toneMapping=$o,d.autoClear=!1,d.state.buffers.depth.getReversed()&&(d.setRenderTarget(r),d.clearDepth(),d.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new Bi(new pd,new Lu({name:"PMREM.Background",side:as,depthWrite:!1,depthTest:!1})));const y=this._backgroundBox,x=y.material;let _=!1;const S=e.background;S?S.isColor&&(x.color.copy(S),e.background=null,_=!0):(x.color.copy(sP),_=!0);for(let w=0;w<6;w++){const T=w%3;T===0?(l.up.set(0,c[w],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x+u[w],s.y,s.z)):T===1?(l.up.set(0,0,c[w]),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y+u[w],s.z)):(l.up.set(0,c[w],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y,s.z+u[w]));const C=this._cubeSize;vf(r,T*C,w>2?C:0,C,C),d.setRenderTarget(r),_&&d.render(y,l),d.render(e,l)}d.toneMapping=m,d.autoClear=p,e.background=S}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===dc||e.mapping===xu;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=lP()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=oP());const s=r?this._cubemapMaterial:this._equirectMaterial,a=this._lodMeshes[0];a.material=s;const o=s.uniforms;o.envMap.value=e;const l=this._cubeSize;vf(t,0,0,3*l,2*l),n.setRenderTarget(t),n.render(a,Up)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodMeshes.length;for(let s=1;s<r;s++)this._applyGGXFilter(e,s-1,s);t.autoClear=n}_applyGGXFilter(e,t,n){const r=this._renderer,s=this._pingPongRenderTarget,a=this._ggxMaterial,o=this._lodMeshes[n];o.material=a;const l=a.uniforms,c=n/(this._lodMeshes.length-1),u=t/(this._lodMeshes.length-1),d=Math.sqrt(c*c-u*u),p=.05+c*.95,m=d*p,{_lodMax:g}=this,y=this._sizeLods[n],x=3*y*(n>g-ru?n-g+ru:0),_=4*(this._cubeSize-y);l.envMap.value=e.texture,l.roughness.value=m,l.mipInt.value=g-t,vf(s,x,_,3*y,2*y),r.setRenderTarget(s),r.render(o,Up),l.envMap.value=s.texture,l.roughness.value=0,l.mipInt.value=g-n,vf(e,x,_,3*y,2*y),r.setRenderTarget(e),r.render(o,Up)}_blur(e,t,n,r,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",s),this._halfBlur(a,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,a,o){const l=this._renderer,c=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&Vt("blur direction must be either latitudinal or longitudinal!");const u=3,d=this._lodMeshes[r];d.material=c;const p=c.uniforms,m=this._sizeLods[n]-1,g=isFinite(s)?Math.PI/(2*m):2*Math.PI/(2*Dh-1),y=s/g,x=isFinite(s)?1+Math.floor(u*y):Dh;x>Dh&&lt(`sigmaRadians, ${s}, is too large and will clip, as it requested ${x} samples when the maximum is set to ${Dh}`);const _=[];let S=0;for(let D=0;D<Dh;++D){const O=D/y,R=Math.exp(-O*O/2);_.push(R),D===0?S+=R:D<x&&(S+=2*R)}for(let D=0;D<_.length;D++)_[D]=_[D]/S;p.envMap.value=e.texture,p.samples.value=x,p.weights.value=_,p.latitudinal.value=a==="latitudinal",o&&(p.poleAxis.value=o);const{_lodMax:w}=this;p.dTheta.value=g,p.mipInt.value=w-n;const T=this._sizeLods[r],C=3*T*(r>w-ru?r-w+ru:0),E=4*(this._cubeSize-T);vf(t,C,E,3*T,2*T),l.setRenderTarget(t),l.render(d,Up)}}function fue(i){const e=[],t=[],n=[];let r=i;const s=i-ru+1+rP.length;for(let a=0;a<s;a++){const o=Math.pow(2,r);e.push(o);let l=1/o;a>i-ru?l=rP[a-i+ru-1]:a===0&&(l=0),t.push(l);const c=1/(o-2),u=-c,d=1+c,p=[u,u,d,u,d,d,u,u,d,d,u,d],m=6,g=6,y=3,x=2,_=1,S=new Float32Array(y*g*m),w=new Float32Array(x*g*m),T=new Float32Array(_*g*m);for(let E=0;E<m;E++){const D=E%3*2/3-1,O=E>2?0:-1,R=[D,O,0,D+2/3,O,0,D+2/3,O+1,0,D,O,0,D+2/3,O+1,0,D,O+1,0];S.set(R,y*g*E),w.set(p,x*g*E);const P=[E,E,E,E,E,E];T.set(P,_*g*E)}const C=new Yt;C.setAttribute("position",new kn(S,y)),C.setAttribute("uv",new kn(w,x)),C.setAttribute("faceIndex",new kn(T,_)),n.push(new Bi(C,null)),r>ru&&r--}return{lodMeshes:n,sizeLods:e,sigmas:t}}function aP(i,e,t){const n=new go(i,e,t);return n.texture.mapping=N0,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function vf(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function pue(i,e,t){return new Ps({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:hue,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:k2(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:Yo,depthTest:!1,depthWrite:!1})}function mue(i,e,t){const n=new Float32Array(Dh),r=new K(0,1,0);return new Ps({name:"SphericalGaussianBlur",defines:{n:Dh,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:k2(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Yo,depthTest:!1,depthWrite:!1})}function oP(){return new Ps({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:k2(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Yo,depthTest:!1,depthWrite:!1})}function lP(){return new Ps({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:k2(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Yo,depthTest:!1,depthWrite:!1})}function k2(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function gue(i){let e=new WeakMap,t=null;function n(o){if(o&&o.isTexture){const l=o.mapping,c=l===Xm||l===Ym,u=l===dc||l===xu;if(c||u){let d=e.get(o);const p=d!==void 0?d.texture.pmremVersion:0;if(o.isRenderTargetTexture&&o.pmremVersion!==p)return t===null&&(t=new I5(i)),d=c?t.fromEquirectangular(o,d):t.fromCubemap(o,d),d.texture.pmremVersion=o.pmremVersion,e.set(o,d),d.texture;if(d!==void 0)return d.texture;{const m=o.image;return c&&m&&m.height>0||u&&m&&r(m)?(t===null&&(t=new I5(i)),d=c?t.fromEquirectangular(o):t.fromCubemap(o),d.texture.pmremVersion=o.pmremVersion,e.set(o,d),o.addEventListener("dispose",s),d.texture):null}}}return o}function r(o){let l=0;const c=6;for(let u=0;u<c;u++)o[u]!==void 0&&l++;return l===c}function s(o){const l=o.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function a(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:a}}function xue(i){const e={};function t(n){if(e[n]!==void 0)return e[n];const r=i.getExtension(n);return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const r=t(n);return r===null&&d0("WebGLRenderer: "+n+" extension not supported."),r}}}function yue(i,e,t,n){const r={},s=new WeakMap;function a(d){const p=d.target;p.index!==null&&e.remove(p.index);for(const g in p.attributes)e.remove(p.attributes[g]);p.removeEventListener("dispose",a),delete r[p.id];const m=s.get(p);m&&(e.remove(m),s.delete(p)),n.releaseStatesOfGeometry(p),p.isInstancedBufferGeometry===!0&&delete p._maxInstanceCount,t.memory.geometries--}function o(d,p){return r[p.id]===!0||(p.addEventListener("dispose",a),r[p.id]=!0,t.memory.geometries++),p}function l(d){const p=d.attributes;for(const m in p)e.update(p[m],i.ARRAY_BUFFER)}function c(d){const p=[],m=d.index,g=d.attributes.position;let y=0;if(m!==null){const S=m.array;y=m.version;for(let w=0,T=S.length;w<T;w+=3){const C=S[w+0],E=S[w+1],D=S[w+2];p.push(C,E,E,D,D,C)}}else if(g!==void 0){const S=g.array;y=g.version;for(let w=0,T=S.length/3-1;w<T;w+=3){const C=w+0,E=w+1,D=w+2;p.push(C,E,E,D,D,C)}}else return;const x=new(AB(p)?aA:sA)(p,1);x.version=y;const _=s.get(d);_&&e.remove(_),s.set(d,x)}function u(d){const p=s.get(d);if(p){const m=d.index;m!==null&&p.version<m.version&&c(d)}else c(d);return s.get(d)}return{get:o,update:l,getWireframeAttribute:u}}function vue(i,e,t){let n;function r(p){n=p}let s,a;function o(p){s=p.type,a=p.bytesPerElement}function l(p,m){i.drawElements(n,m,s,p*a),t.update(m,n,1)}function c(p,m,g){g!==0&&(i.drawElementsInstanced(n,m,s,p*a,g),t.update(m,n,g))}function u(p,m,g){if(g===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,m,0,s,p,0,g);let x=0;for(let _=0;_<g;_++)x+=m[_];t.update(x,n,1)}function d(p,m,g,y){if(g===0)return;const x=e.get("WEBGL_multi_draw");if(x===null)for(let _=0;_<p.length;_++)c(p[_]/a,m[_],y[_]);else{x.multiDrawElementsInstancedWEBGL(n,m,0,s,p,0,y,0,g);let _=0;for(let S=0;S<g;S++)_+=m[S]*y[S];t.update(_,n,1)}}this.setMode=r,this.setIndex=o,this.render=l,this.renderInstances=c,this.renderMultiDraw=u,this.renderMultiDrawInstances=d}function bue(i){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,a,o){switch(t.calls++,a){case i.TRIANGLES:t.triangles+=o*(s/3);break;case i.LINES:t.lines+=o*(s/2);break;case i.LINE_STRIP:t.lines+=o*(s-1);break;case i.LINE_LOOP:t.lines+=o*s;break;case i.POINTS:t.points+=o*s;break;default:Vt("WebGLInfo: Unknown draw mode:",a);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}function _ue(i,e,t){const n=new WeakMap,r=new sn;function s(a,o,l){const c=a.morphTargetInfluences,u=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,d=u!==void 0?u.length:0;let p=n.get(o);if(p===void 0||p.count!==d){let R=function(){D.dispose(),n.delete(o),o.removeEventListener("dispose",R)};p!==void 0&&p.texture.dispose();const m=o.morphAttributes.position!==void 0,g=o.morphAttributes.normal!==void 0,y=o.morphAttributes.color!==void 0,x=o.morphAttributes.position||[],_=o.morphAttributes.normal||[],S=o.morphAttributes.color||[];let w=0;m===!0&&(w=1),g===!0&&(w=2),y===!0&&(w=3);let T=o.attributes.position.count*w,C=1;T>e.maxTextureSize&&(C=Math.ceil(T/e.maxTextureSize),T=e.maxTextureSize);const E=new Float32Array(T*C*4*d),D=new u2(E,T,C,d);D.type=ns,D.needsUpdate=!0;const O=w*4;for(let P=0;P<d;P++){const L=x[P],V=_[P],j=S[P],B=T*C*4*P;for(let J=0;J<L.count;J++){const U=J*O;m===!0&&(r.fromBufferAttribute(L,J),E[B+U+0]=r.x,E[B+U+1]=r.y,E[B+U+2]=r.z,E[B+U+3]=0),g===!0&&(r.fromBufferAttribute(V,J),E[B+U+4]=r.x,E[B+U+5]=r.y,E[B+U+6]=r.z,E[B+U+7]=0),y===!0&&(r.fromBufferAttribute(j,J),E[B+U+8]=r.x,E[B+U+9]=r.y,E[B+U+10]=r.z,E[B+U+11]=j.itemSize===4?r.w:1)}}p={count:d,texture:D,size:new Me(T,C)},n.set(o,p),o.addEventListener("dispose",R)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)l.getUniforms().setValue(i,"morphTexture",a.morphTexture,t);else{let m=0;for(let y=0;y<c.length;y++)m+=c[y];const g=o.morphTargetsRelative?1:1-m;l.getUniforms().setValue(i,"morphTargetBaseInfluence",g),l.getUniforms().setValue(i,"morphTargetInfluences",c)}l.getUniforms().setValue(i,"morphTargetsTexture",p.texture,t),l.getUniforms().setValue(i,"morphTargetsTextureSize",p.size)}return{update:s}}function Sue(i,e,t,n){let r=new WeakMap;function s(l){const c=n.render.frame,u=l.geometry,d=e.get(l,u);if(r.get(d)!==c&&(e.update(d),r.set(d,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),r.get(l)!==c&&(t.update(l.instanceMatrix,i.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,i.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){const p=l.skeleton;r.get(p)!==c&&(p.update(),r.set(p,c))}return d}function a(){r=new WeakMap}function o(l){const c=l.target;c.removeEventListener("dispose",o),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:s,dispose:a}}const PH=new ri,cP=new v2(1,1),IH=new u2,DH=new h2,NH=new Xg,uP=[],hP=[],dP=new Float32Array(16),fP=new Float32Array(9),pP=new Float32Array(4);function O0(i,e,t){const n=i[0];if(n<=0||n>0)return i;const r=e*t;let s=uP[r];if(s===void 0&&(s=new Float32Array(r),uP[r]=s),e!==0){n.toArray(s,0);for(let a=1,o=0;a!==e;++a)o+=t,i[a].toArray(s,o)}return s}function $i(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function Ki(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function O2(i,e){let t=hP[e];t===void 0&&(t=new Int32Array(e),hP[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function wue(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function Mue(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if($i(t,e))return;i.uniform2fv(this.addr,e),Ki(t,e)}}function Tue(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if($i(t,e))return;i.uniform3fv(this.addr,e),Ki(t,e)}}function Aue(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if($i(t,e))return;i.uniform4fv(this.addr,e),Ki(t,e)}}function Cue(i,e){const t=this.cache,n=e.elements;if(n===void 0){if($i(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),Ki(t,e)}else{if($i(t,n))return;pP.set(n),i.uniformMatrix2fv(this.addr,!1,pP),Ki(t,n)}}function Eue(i,e){const t=this.cache,n=e.elements;if(n===void 0){if($i(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),Ki(t,e)}else{if($i(t,n))return;fP.set(n),i.uniformMatrix3fv(this.addr,!1,fP),Ki(t,n)}}function Rue(i,e){const t=this.cache,n=e.elements;if(n===void 0){if($i(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),Ki(t,e)}else{if($i(t,n))return;dP.set(n),i.uniformMatrix4fv(this.addr,!1,dP),Ki(t,n)}}function Pue(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function Iue(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if($i(t,e))return;i.uniform2iv(this.addr,e),Ki(t,e)}}function Due(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if($i(t,e))return;i.uniform3iv(this.addr,e),Ki(t,e)}}function Nue(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if($i(t,e))return;i.uniform4iv(this.addr,e),Ki(t,e)}}function Lue(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function kue(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if($i(t,e))return;i.uniform2uiv(this.addr,e),Ki(t,e)}}function Oue(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if($i(t,e))return;i.uniform3uiv(this.addr,e),Ki(t,e)}}function zue(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if($i(t,e))return;i.uniform4uiv(this.addr,e),Ki(t,e)}}function Uue(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r);let s;this.type===i.SAMPLER_2D_SHADOW?(cP.compareFunction=tA,s=cP):s=PH,t.setTexture2D(e||s,r)}function Fue(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||DH,r)}function Bue(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||NH,r)}function Hue(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||IH,r)}function jue(i){switch(i){case 5126:return wue;case 35664:return Mue;case 35665:return Tue;case 35666:return Aue;case 35674:return Cue;case 35675:return Eue;case 35676:return Rue;case 5124:case 35670:return Pue;case 35667:case 35671:return Iue;case 35668:case 35672:return Due;case 35669:case 35673:return Nue;case 5125:return Lue;case 36294:return kue;case 36295:return Oue;case 36296:return zue;case 35678:case 36198:case 36298:case 36306:case 35682:return Uue;case 35679:case 36299:case 36307:return Fue;case 35680:case 36300:case 36308:case 36293:return Bue;case 36289:case 36303:case 36311:case 36292:return Hue}}function Vue(i,e){i.uniform1fv(this.addr,e)}function Gue(i,e){const t=O0(e,this.size,2);i.uniform2fv(this.addr,t)}function Wue(i,e){const t=O0(e,this.size,3);i.uniform3fv(this.addr,t)}function que(i,e){const t=O0(e,this.size,4);i.uniform4fv(this.addr,t)}function Xue(i,e){const t=O0(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function Yue(i,e){const t=O0(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function $ue(i,e){const t=O0(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function Kue(i,e){i.uniform1iv(this.addr,e)}function Zue(i,e){i.uniform2iv(this.addr,e)}function Que(i,e){i.uniform3iv(this.addr,e)}function Jue(i,e){i.uniform4iv(this.addr,e)}function ehe(i,e){i.uniform1uiv(this.addr,e)}function the(i,e){i.uniform2uiv(this.addr,e)}function nhe(i,e){i.uniform3uiv(this.addr,e)}function ihe(i,e){i.uniform4uiv(this.addr,e)}function rhe(i,e,t){const n=this.cache,r=e.length,s=O2(t,r);$i(n,s)||(i.uniform1iv(this.addr,s),Ki(n,s));for(let a=0;a!==r;++a)t.setTexture2D(e[a]||PH,s[a])}function she(i,e,t){const n=this.cache,r=e.length,s=O2(t,r);$i(n,s)||(i.uniform1iv(this.addr,s),Ki(n,s));for(let a=0;a!==r;++a)t.setTexture3D(e[a]||DH,s[a])}function ahe(i,e,t){const n=this.cache,r=e.length,s=O2(t,r);$i(n,s)||(i.uniform1iv(this.addr,s),Ki(n,s));for(let a=0;a!==r;++a)t.setTextureCube(e[a]||NH,s[a])}function ohe(i,e,t){const n=this.cache,r=e.length,s=O2(t,r);$i(n,s)||(i.uniform1iv(this.addr,s),Ki(n,s));for(let a=0;a!==r;++a)t.setTexture2DArray(e[a]||IH,s[a])}function lhe(i){switch(i){case 5126:return Vue;case 35664:return Gue;case 35665:return Wue;case 35666:return que;case 35674:return Xue;case 35675:return Yue;case 35676:return $ue;case 5124:case 35670:return Kue;case 35667:case 35671:return Zue;case 35668:case 35672:return Que;case 35669:case 35673:return Jue;case 5125:return ehe;case 36294:return the;case 36295:return nhe;case 36296:return ihe;case 35678:case 36198:case 36298:case 36306:case 35682:return rhe;case 35679:case 36299:case 36307:return she;case 35680:case 36300:case 36308:case 36293:return ahe;case 36289:case 36303:case 36311:case 36292:return ohe}}class che{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=jue(t.type)}}class uhe{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=lhe(t.type)}}class hhe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let s=0,a=r.length;s!==a;++s){const o=r[s];o.setValue(e,t[o.id],n)}}}const f4=/(\w+)(\])?(\[|\.)?/g;function mP(i,e){i.seq.push(e),i.map[e.id]=e}function dhe(i,e,t){const n=i.name,r=n.length;for(f4.lastIndex=0;;){const s=f4.exec(n),a=f4.lastIndex;let o=s[1];const l=s[2]==="]",c=s[3];if(l&&(o=o|0),c===void 0||c==="["&&a+2===r){mP(t,c===void 0?new che(o,i,e):new uhe(o,i,e));break}else{let d=t.map[o];d===void 0&&(d=new hhe(o),mP(t,d)),t=d}}}class ky{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const s=e.getActiveUniform(t,r),a=e.getUniformLocation(t,s.name);dhe(s,a,this)}}setValue(e,t,n,r){const s=this.map[t];s!==void 0&&s.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,a=t.length;s!==a;++s){const o=t[s],l=n[o.id];l.needsUpdate!==!1&&o.setValue(e,l.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,s=e.length;r!==s;++r){const a=e[r];a.id in t&&n.push(a)}return n}}function gP(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}const fhe=37297;let phe=0;function mhe(i,e){const t=i.split(`
`),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let a=r;a<s;a++){const o=a+1;n.push(`${o===e?">":" "} ${o}: ${t[a]}`)}return n.join(`
`)}const xP=new qt;function ghe(i){fn._getMatrix(xP,fn.workingColorSpace,i);const e=`mat3( ${xP.elements.map(t=>t.toFixed(4))} )`;switch(fn.getTransfer(i)){case Jm:return[e,"LinearTransferOETF"];case Pn:return[e,"sRGBTransferOETF"];default:return lt("WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}function yP(i,e,t){const n=i.getShaderParameter(e,i.COMPILE_STATUS),s=(i.getShaderInfoLog(e)||"").trim();if(n&&s==="")return"";const a=/ERROR: 0:(\d+)/.exec(s);if(a){const o=parseInt(a[1]);return t.toUpperCase()+`

`+s+`

`+mhe(i.getShaderSource(e),o)}else return s}function xhe(i,e){const t=ghe(e);return[`vec4 ${i}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function yhe(i,e){let t;switch(e){case aB:t="Linear";break;case oB:t="Reinhard";break;case lB:t="Cineon";break;case qT:t="ACESFilmic";break;case uB:t="AgX";break;case hB:t="Neutral";break;case cB:t="Custom";break;default:lt("WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const ey=new K;function vhe(){fn.getLuminanceCoefficients(ey);const i=ey.x.toFixed(4),e=ey.y.toFixed(4),t=ey.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function bhe(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(tm).join(`
`)}function _he(i){const e=[];for(const t in i){const n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function She(i,e){const t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const s=i.getActiveAttrib(e,r),a=s.name;let o=1;s.type===i.FLOAT_MAT2&&(o=2),s.type===i.FLOAT_MAT3&&(o=3),s.type===i.FLOAT_MAT4&&(o=4),t[a]={type:s.type,location:i.getAttribLocation(e,a),locationSize:o}}return t}function tm(i){return i!==""}function vP(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function bP(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const whe=/^[ \t]*#include +<([\w\d./]+)>/gm;function D5(i){return i.replace(whe,The)}const Mhe=new Map;function The(i,e){let t=Zt[e];if(t===void 0){const n=Mhe.get(e);if(n!==void 0)t=Zt[n],lt('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return D5(t)}const Ahe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function _P(i){return i.replace(Ahe,Che)}function Che(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function SP(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Ehe(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===t2?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===fm?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===io&&(e="SHADOWMAP_TYPE_VSM"),e}function Rhe(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case dc:case xu:e="ENVMAP_TYPE_CUBE";break;case N0:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Phe(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case xu:e="ENVMAP_MODE_REFRACTION";break}return e}function Ihe(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case Gg:e="ENVMAP_BLENDING_MULTIPLY";break;case rB:e="ENVMAP_BLENDING_MIX";break;case sB:e="ENVMAP_BLENDING_ADD";break}return e}function Dhe(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}function Nhe(i,e,t,n){const r=i.getContext(),s=t.defines;let a=t.vertexShader,o=t.fragmentShader;const l=Ehe(t),c=Rhe(t),u=Phe(t),d=Ihe(t),p=Dhe(t),m=bhe(t),g=_he(s),y=r.createProgram();let x,_,S=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(x=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g].filter(tm).join(`
`),x.length>0&&(x+=`
`),_=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g].filter(tm).join(`
`),_.length>0&&(_+=`
`)):(x=[SP(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(tm).join(`
`),_=[SP(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==$o?"#define TONE_MAPPING":"",t.toneMapping!==$o?Zt.tonemapping_pars_fragment:"",t.toneMapping!==$o?yhe("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Zt.colorspace_pars_fragment,xhe("linearToOutputTexel",t.outputColorSpace),vhe(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(tm).join(`
`)),a=D5(a),a=vP(a,t),a=bP(a,t),o=D5(o),o=vP(o,t),o=bP(o,t),a=_P(a),o=_P(o),t.isRawShaderMaterial!==!0&&(S=`#version 300 es
`,x=[m,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+x,_=["#define varying in",t.glslVersion===S5?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===S5?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+_);const w=S+x+a,T=S+_+o,C=gP(r,r.VERTEX_SHADER,w),E=gP(r,r.FRAGMENT_SHADER,T);r.attachShader(y,C),r.attachShader(y,E),t.index0AttributeName!==void 0?r.bindAttribLocation(y,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(y,0,"position"),r.linkProgram(y);function D(L){if(i.debug.checkShaderErrors){const V=r.getProgramInfoLog(y)||"",j=r.getShaderInfoLog(C)||"",B=r.getShaderInfoLog(E)||"",J=V.trim(),U=j.trim(),X=B.trim();let $=!0,Q=!0;if(r.getProgramParameter(y,r.LINK_STATUS)===!1)if($=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(r,y,C,E);else{const se=yP(r,C,"vertex"),ye=yP(r,E,"fragment");Vt("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(y,r.VALIDATE_STATUS)+`

Material Name: `+L.name+`
Material Type: `+L.type+`

Program Info Log: `+J+`
`+se+`
`+ye)}else J!==""?lt("WebGLProgram: Program Info Log:",J):(U===""||X==="")&&(Q=!1);Q&&(L.diagnostics={runnable:$,programLog:J,vertexShader:{log:U,prefix:x},fragmentShader:{log:X,prefix:_}})}r.deleteShader(C),r.deleteShader(E),O=new ky(r,y),R=She(r,y)}let O;this.getUniforms=function(){return O===void 0&&D(this),O};let R;this.getAttributes=function(){return R===void 0&&D(this),R};let P=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return P===!1&&(P=r.getProgramParameter(y,fhe)),P},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(y),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=phe++,this.cacheKey=e,this.usedTimes=1,this.program=y,this.vertexShader=C,this.fragmentShader=E,this}let Lhe=0;class khe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return a.has(r)===!1&&(a.add(r),r.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new Ohe(e),t.set(e,n)),n}}class Ohe{constructor(e){this.id=Lhe++,this.code=e,this.usedTimes=0}}function zhe(i,e,t,n,r,s,a){const o=new p0,l=new khe,c=new Set,u=[],d=r.logarithmicDepthBuffer,p=r.vertexTextures;let m=r.precision;const g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function y(R){return c.add(R),R===0?"uv":`uv${R}`}function x(R,P,L,V,j){const B=V.fog,J=j.geometry,U=R.isMeshStandardMaterial?V.environment:null,X=(R.isMeshStandardMaterial?t:e).get(R.envMap||U),$=X&&X.mapping===N0?X.image.height:null,Q=g[R.type];R.precision!==null&&(m=r.getMaxPrecision(R.precision),m!==R.precision&&lt("WebGLProgram.getParameters:",R.precision,"not supported, using",m,"instead."));const se=J.morphAttributes.position||J.morphAttributes.normal||J.morphAttributes.color,ye=se!==void 0?se.length:0;let we=0;J.morphAttributes.position!==void 0&&(we=1),J.morphAttributes.normal!==void 0&&(we=2),J.morphAttributes.color!==void 0&&(we=3);let He,De,Oe,fe;if(Q){const tn=ao[Q];He=tn.vertexShader,De=tn.fragmentShader}else He=R.vertexShader,De=R.fragmentShader,l.update(R),Oe=l.getVertexShaderID(R),fe=l.getFragmentShaderID(R);const ge=i.getRenderTarget(),Ne=i.state.buffers.depth.getReversed(),Qe=j.isInstancedMesh===!0,et=j.isBatchedMesh===!0,Nt=!!R.map,Gt=!!R.matcap,vt=!!X,Te=!!R.aoMap,Y=!!R.lightMap,Ee=!!R.bumpMap,Ie=!!R.normalMap,Ge=!!R.displacementMap,Le=!!R.emissiveMap,ot=!!R.metalnessMap,it=!!R.roughnessMap,ft=R.anisotropy>0,Z=R.clearcoat>0,H=R.dispersion>0,ue=R.iridescence>0,Se=R.sheen>0,Re=R.transmission>0,_e=ft&&!!R.anisotropyMap,Mt=Z&&!!R.clearcoatMap,st=Z&&!!R.clearcoatNormalMap,At=Z&&!!R.clearcoatRoughnessMap,bt=ue&&!!R.iridescenceMap,Pe=ue&&!!R.iridescenceThicknessMap,Xe=Se&&!!R.sheenColorMap,Rt=Se&&!!R.sheenRoughnessMap,ie=!!R.specularMap,pe=!!R.specularColorMap,Fe=!!R.specularIntensityMap,te=Re&&!!R.transmissionMap,je=Re&&!!R.thicknessMap,We=!!R.gradientMap,Je=!!R.alphaMap,Be=R.alphaTest>0,Ce=!!R.alphaHash,ct=!!R.extensions;let Ct=$o;R.toneMapped&&(ge===null||ge.isXRRenderTarget===!0)&&(Ct=i.toneMapping);const an={shaderID:Q,shaderType:R.type,shaderName:R.name,vertexShader:He,fragmentShader:De,defines:R.defines,customVertexShaderID:Oe,customFragmentShaderID:fe,isRawShaderMaterial:R.isRawShaderMaterial===!0,glslVersion:R.glslVersion,precision:m,batching:et,batchingColor:et&&j._colorsTexture!==null,instancing:Qe,instancingColor:Qe&&j.instanceColor!==null,instancingMorph:Qe&&j.morphTexture!==null,supportsVertexTextures:p,outputColorSpace:ge===null?i.outputColorSpace:ge.isXRRenderTarget===!0?ge.texture.colorSpace:yu,alphaToCoverage:!!R.alphaToCoverage,map:Nt,matcap:Gt,envMap:vt,envMapMode:vt&&X.mapping,envMapCubeUVHeight:$,aoMap:Te,lightMap:Y,bumpMap:Ee,normalMap:Ie,displacementMap:p&&Ge,emissiveMap:Le,normalMapObjectSpace:Ie&&R.normalMapType===yB,normalMapTangentSpace:Ie&&R.normalMapType===Nu,metalnessMap:ot,roughnessMap:it,anisotropy:ft,anisotropyMap:_e,clearcoat:Z,clearcoatMap:Mt,clearcoatNormalMap:st,clearcoatRoughnessMap:At,dispersion:H,iridescence:ue,iridescenceMap:bt,iridescenceThicknessMap:Pe,sheen:Se,sheenColorMap:Xe,sheenRoughnessMap:Rt,specularMap:ie,specularColorMap:pe,specularIntensityMap:Fe,transmission:Re,transmissionMap:te,thicknessMap:je,gradientMap:We,opaque:R.transparent===!1&&R.blending===Gh&&R.alphaToCoverage===!1,alphaMap:Je,alphaTest:Be,alphaHash:Ce,combine:R.combine,mapUv:Nt&&y(R.map.channel),aoMapUv:Te&&y(R.aoMap.channel),lightMapUv:Y&&y(R.lightMap.channel),bumpMapUv:Ee&&y(R.bumpMap.channel),normalMapUv:Ie&&y(R.normalMap.channel),displacementMapUv:Ge&&y(R.displacementMap.channel),emissiveMapUv:Le&&y(R.emissiveMap.channel),metalnessMapUv:ot&&y(R.metalnessMap.channel),roughnessMapUv:it&&y(R.roughnessMap.channel),anisotropyMapUv:_e&&y(R.anisotropyMap.channel),clearcoatMapUv:Mt&&y(R.clearcoatMap.channel),clearcoatNormalMapUv:st&&y(R.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:At&&y(R.clearcoatRoughnessMap.channel),iridescenceMapUv:bt&&y(R.iridescenceMap.channel),iridescenceThicknessMapUv:Pe&&y(R.iridescenceThicknessMap.channel),sheenColorMapUv:Xe&&y(R.sheenColorMap.channel),sheenRoughnessMapUv:Rt&&y(R.sheenRoughnessMap.channel),specularMapUv:ie&&y(R.specularMap.channel),specularColorMapUv:pe&&y(R.specularColorMap.channel),specularIntensityMapUv:Fe&&y(R.specularIntensityMap.channel),transmissionMapUv:te&&y(R.transmissionMap.channel),thicknessMapUv:je&&y(R.thicknessMap.channel),alphaMapUv:Je&&y(R.alphaMap.channel),vertexTangents:!!J.attributes.tangent&&(Ie||ft),vertexColors:R.vertexColors,vertexAlphas:R.vertexColors===!0&&!!J.attributes.color&&J.attributes.color.itemSize===4,pointsUvs:j.isPoints===!0&&!!J.attributes.uv&&(Nt||Je),fog:!!B,useFog:R.fog===!0,fogExp2:!!B&&B.isFogExp2,flatShading:R.flatShading===!0&&R.wireframe===!1,sizeAttenuation:R.sizeAttenuation===!0,logarithmicDepthBuffer:d,reversedDepthBuffer:Ne,skinning:j.isSkinnedMesh===!0,morphTargets:J.morphAttributes.position!==void 0,morphNormals:J.morphAttributes.normal!==void 0,morphColors:J.morphAttributes.color!==void 0,morphTargetsCount:ye,morphTextureStride:we,numDirLights:P.directional.length,numPointLights:P.point.length,numSpotLights:P.spot.length,numSpotLightMaps:P.spotLightMap.length,numRectAreaLights:P.rectArea.length,numHemiLights:P.hemi.length,numDirLightShadows:P.directionalShadowMap.length,numPointLightShadows:P.pointShadowMap.length,numSpotLightShadows:P.spotShadowMap.length,numSpotLightShadowsWithMaps:P.numSpotLightShadowsWithMaps,numLightProbes:P.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:R.dithering,shadowMapEnabled:i.shadowMap.enabled&&L.length>0,shadowMapType:i.shadowMap.type,toneMapping:Ct,decodeVideoTexture:Nt&&R.map.isVideoTexture===!0&&fn.getTransfer(R.map.colorSpace)===Pn,decodeVideoTextureEmissive:Le&&R.emissiveMap.isVideoTexture===!0&&fn.getTransfer(R.emissiveMap.colorSpace)===Pn,premultipliedAlpha:R.premultipliedAlpha,doubleSided:R.side===co,flipSided:R.side===as,useDepthPacking:R.depthPacking>=0,depthPacking:R.depthPacking||0,index0AttributeName:R.index0AttributeName,extensionClipCullDistance:ct&&R.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(ct&&R.extensions.multiDraw===!0||et)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:R.customProgramCacheKey()};return an.vertexUv1s=c.has(1),an.vertexUv2s=c.has(2),an.vertexUv3s=c.has(3),c.clear(),an}function _(R){const P=[];if(R.shaderID?P.push(R.shaderID):(P.push(R.customVertexShaderID),P.push(R.customFragmentShaderID)),R.defines!==void 0)for(const L in R.defines)P.push(L),P.push(R.defines[L]);return R.isRawShaderMaterial===!1&&(S(P,R),w(P,R),P.push(i.outputColorSpace)),P.push(R.customProgramCacheKey),P.join()}function S(R,P){R.push(P.precision),R.push(P.outputColorSpace),R.push(P.envMapMode),R.push(P.envMapCubeUVHeight),R.push(P.mapUv),R.push(P.alphaMapUv),R.push(P.lightMapUv),R.push(P.aoMapUv),R.push(P.bumpMapUv),R.push(P.normalMapUv),R.push(P.displacementMapUv),R.push(P.emissiveMapUv),R.push(P.metalnessMapUv),R.push(P.roughnessMapUv),R.push(P.anisotropyMapUv),R.push(P.clearcoatMapUv),R.push(P.clearcoatNormalMapUv),R.push(P.clearcoatRoughnessMapUv),R.push(P.iridescenceMapUv),R.push(P.iridescenceThicknessMapUv),R.push(P.sheenColorMapUv),R.push(P.sheenRoughnessMapUv),R.push(P.specularMapUv),R.push(P.specularColorMapUv),R.push(P.specularIntensityMapUv),R.push(P.transmissionMapUv),R.push(P.thicknessMapUv),R.push(P.combine),R.push(P.fogExp2),R.push(P.sizeAttenuation),R.push(P.morphTargetsCount),R.push(P.morphAttributeCount),R.push(P.numDirLights),R.push(P.numPointLights),R.push(P.numSpotLights),R.push(P.numSpotLightMaps),R.push(P.numHemiLights),R.push(P.numRectAreaLights),R.push(P.numDirLightShadows),R.push(P.numPointLightShadows),R.push(P.numSpotLightShadows),R.push(P.numSpotLightShadowsWithMaps),R.push(P.numLightProbes),R.push(P.shadowMapType),R.push(P.toneMapping),R.push(P.numClippingPlanes),R.push(P.numClipIntersection),R.push(P.depthPacking)}function w(R,P){o.disableAll(),P.supportsVertexTextures&&o.enable(0),P.instancing&&o.enable(1),P.instancingColor&&o.enable(2),P.instancingMorph&&o.enable(3),P.matcap&&o.enable(4),P.envMap&&o.enable(5),P.normalMapObjectSpace&&o.enable(6),P.normalMapTangentSpace&&o.enable(7),P.clearcoat&&o.enable(8),P.iridescence&&o.enable(9),P.alphaTest&&o.enable(10),P.vertexColors&&o.enable(11),P.vertexAlphas&&o.enable(12),P.vertexUv1s&&o.enable(13),P.vertexUv2s&&o.enable(14),P.vertexUv3s&&o.enable(15),P.vertexTangents&&o.enable(16),P.anisotropy&&o.enable(17),P.alphaHash&&o.enable(18),P.batching&&o.enable(19),P.dispersion&&o.enable(20),P.batchingColor&&o.enable(21),P.gradientMap&&o.enable(22),R.push(o.mask),o.disableAll(),P.fog&&o.enable(0),P.useFog&&o.enable(1),P.flatShading&&o.enable(2),P.logarithmicDepthBuffer&&o.enable(3),P.reversedDepthBuffer&&o.enable(4),P.skinning&&o.enable(5),P.morphTargets&&o.enable(6),P.morphNormals&&o.enable(7),P.morphColors&&o.enable(8),P.premultipliedAlpha&&o.enable(9),P.shadowMapEnabled&&o.enable(10),P.doubleSided&&o.enable(11),P.flipSided&&o.enable(12),P.useDepthPacking&&o.enable(13),P.dithering&&o.enable(14),P.transmission&&o.enable(15),P.sheen&&o.enable(16),P.opaque&&o.enable(17),P.pointsUvs&&o.enable(18),P.decodeVideoTexture&&o.enable(19),P.decodeVideoTextureEmissive&&o.enable(20),P.alphaToCoverage&&o.enable(21),R.push(o.mask)}function T(R){const P=g[R.type];let L;if(P){const V=ao[P];L=ig.clone(V.uniforms)}else L=R.uniforms;return L}function C(R,P){let L;for(let V=0,j=u.length;V<j;V++){const B=u[V];if(B.cacheKey===P){L=B,++L.usedTimes;break}}return L===void 0&&(L=new Nhe(i,P,R,s),u.push(L)),L}function E(R){if(--R.usedTimes===0){const P=u.indexOf(R);u[P]=u[u.length-1],u.pop(),R.destroy()}}function D(R){l.remove(R)}function O(){l.dispose()}return{getParameters:x,getProgramCacheKey:_,getUniforms:T,acquireProgram:C,releaseProgram:E,releaseShaderCache:D,programs:u,dispose:O}}function Uhe(){let i=new WeakMap;function e(a){return i.has(a)}function t(a){let o=i.get(a);return o===void 0&&(o={},i.set(a,o)),o}function n(a){i.delete(a)}function r(a,o,l){i.get(a)[o]=l}function s(){i=new WeakMap}return{has:e,get:t,remove:n,update:r,dispose:s}}function Fhe(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function wP(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function MP(){const i=[];let e=0;const t=[],n=[],r=[];function s(){e=0,t.length=0,n.length=0,r.length=0}function a(d,p,m,g,y,x){let _=i[e];return _===void 0?(_={id:d.id,object:d,geometry:p,material:m,groupOrder:g,renderOrder:d.renderOrder,z:y,group:x},i[e]=_):(_.id=d.id,_.object=d,_.geometry=p,_.material=m,_.groupOrder=g,_.renderOrder=d.renderOrder,_.z=y,_.group=x),e++,_}function o(d,p,m,g,y,x){const _=a(d,p,m,g,y,x);m.transmission>0?n.push(_):m.transparent===!0?r.push(_):t.push(_)}function l(d,p,m,g,y,x){const _=a(d,p,m,g,y,x);m.transmission>0?n.unshift(_):m.transparent===!0?r.unshift(_):t.unshift(_)}function c(d,p){t.length>1&&t.sort(d||Fhe),n.length>1&&n.sort(p||wP),r.length>1&&r.sort(p||wP)}function u(){for(let d=e,p=i.length;d<p;d++){const m=i[d];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:t,transmissive:n,transparent:r,init:s,push:o,unshift:l,finish:u,sort:c}}function Bhe(){let i=new WeakMap;function e(n,r){const s=i.get(n);let a;return s===void 0?(a=new MP,i.set(n,[a])):r>=s.length?(a=new MP,s.push(a)):a=s[r],a}function t(){i=new WeakMap}return{get:e,dispose:t}}function Hhe(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new K,color:new pt};break;case"SpotLight":t={position:new K,direction:new K,color:new pt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new K,color:new pt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new K,skyColor:new pt,groundColor:new pt};break;case"RectAreaLight":t={color:new pt,position:new K,halfWidth:new K,halfHeight:new K};break}return i[e.id]=t,t}}}function jhe(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Me};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Me};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Me,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}let Vhe=0;function Ghe(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function Whe(i){const e=new Hhe,t=jhe(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)n.probe.push(new K);const r=new K,s=new Bt,a=new Bt;function o(c){let u=0,d=0,p=0;for(let R=0;R<9;R++)n.probe[R].set(0,0,0);let m=0,g=0,y=0,x=0,_=0,S=0,w=0,T=0,C=0,E=0,D=0;c.sort(Ghe);for(let R=0,P=c.length;R<P;R++){const L=c[R],V=L.color,j=L.intensity,B=L.distance,J=L.shadow&&L.shadow.map?L.shadow.map.texture:null;if(L.isAmbientLight)u+=V.r*j,d+=V.g*j,p+=V.b*j;else if(L.isLightProbe){for(let U=0;U<9;U++)n.probe[U].addScaledVector(L.sh.coefficients[U],j);D++}else if(L.isDirectionalLight){const U=e.get(L);if(U.color.copy(L.color).multiplyScalar(L.intensity),L.castShadow){const X=L.shadow,$=t.get(L);$.shadowIntensity=X.intensity,$.shadowBias=X.bias,$.shadowNormalBias=X.normalBias,$.shadowRadius=X.radius,$.shadowMapSize=X.mapSize,n.directionalShadow[m]=$,n.directionalShadowMap[m]=J,n.directionalShadowMatrix[m]=L.shadow.matrix,S++}n.directional[m]=U,m++}else if(L.isSpotLight){const U=e.get(L);U.position.setFromMatrixPosition(L.matrixWorld),U.color.copy(V).multiplyScalar(j),U.distance=B,U.coneCos=Math.cos(L.angle),U.penumbraCos=Math.cos(L.angle*(1-L.penumbra)),U.decay=L.decay,n.spot[y]=U;const X=L.shadow;if(L.map&&(n.spotLightMap[C]=L.map,C++,X.updateMatrices(L),L.castShadow&&E++),n.spotLightMatrix[y]=X.matrix,L.castShadow){const $=t.get(L);$.shadowIntensity=X.intensity,$.shadowBias=X.bias,$.shadowNormalBias=X.normalBias,$.shadowRadius=X.radius,$.shadowMapSize=X.mapSize,n.spotShadow[y]=$,n.spotShadowMap[y]=J,T++}y++}else if(L.isRectAreaLight){const U=e.get(L);U.color.copy(V).multiplyScalar(j),U.halfWidth.set(L.width*.5,0,0),U.halfHeight.set(0,L.height*.5,0),n.rectArea[x]=U,x++}else if(L.isPointLight){const U=e.get(L);if(U.color.copy(L.color).multiplyScalar(L.intensity),U.distance=L.distance,U.decay=L.decay,L.castShadow){const X=L.shadow,$=t.get(L);$.shadowIntensity=X.intensity,$.shadowBias=X.bias,$.shadowNormalBias=X.normalBias,$.shadowRadius=X.radius,$.shadowMapSize=X.mapSize,$.shadowCameraNear=X.camera.near,$.shadowCameraFar=X.camera.far,n.pointShadow[g]=$,n.pointShadowMap[g]=J,n.pointShadowMatrix[g]=L.shadow.matrix,w++}n.point[g]=U,g++}else if(L.isHemisphereLight){const U=e.get(L);U.skyColor.copy(L.color).multiplyScalar(j),U.groundColor.copy(L.groundColor).multiplyScalar(j),n.hemi[_]=U,_++}}x>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=at.LTC_FLOAT_1,n.rectAreaLTC2=at.LTC_FLOAT_2):(n.rectAreaLTC1=at.LTC_HALF_1,n.rectAreaLTC2=at.LTC_HALF_2)),n.ambient[0]=u,n.ambient[1]=d,n.ambient[2]=p;const O=n.hash;(O.directionalLength!==m||O.pointLength!==g||O.spotLength!==y||O.rectAreaLength!==x||O.hemiLength!==_||O.numDirectionalShadows!==S||O.numPointShadows!==w||O.numSpotShadows!==T||O.numSpotMaps!==C||O.numLightProbes!==D)&&(n.directional.length=m,n.spot.length=y,n.rectArea.length=x,n.point.length=g,n.hemi.length=_,n.directionalShadow.length=S,n.directionalShadowMap.length=S,n.pointShadow.length=w,n.pointShadowMap.length=w,n.spotShadow.length=T,n.spotShadowMap.length=T,n.directionalShadowMatrix.length=S,n.pointShadowMatrix.length=w,n.spotLightMatrix.length=T+C-E,n.spotLightMap.length=C,n.numSpotLightShadowsWithMaps=E,n.numLightProbes=D,O.directionalLength=m,O.pointLength=g,O.spotLength=y,O.rectAreaLength=x,O.hemiLength=_,O.numDirectionalShadows=S,O.numPointShadows=w,O.numSpotShadows=T,O.numSpotMaps=C,O.numLightProbes=D,n.version=Vhe++)}function l(c,u){let d=0,p=0,m=0,g=0,y=0;const x=u.matrixWorldInverse;for(let _=0,S=c.length;_<S;_++){const w=c[_];if(w.isDirectionalLight){const T=n.directional[d];T.direction.setFromMatrixPosition(w.matrixWorld),r.setFromMatrixPosition(w.target.matrixWorld),T.direction.sub(r),T.direction.transformDirection(x),d++}else if(w.isSpotLight){const T=n.spot[m];T.position.setFromMatrixPosition(w.matrixWorld),T.position.applyMatrix4(x),T.direction.setFromMatrixPosition(w.matrixWorld),r.setFromMatrixPosition(w.target.matrixWorld),T.direction.sub(r),T.direction.transformDirection(x),m++}else if(w.isRectAreaLight){const T=n.rectArea[g];T.position.setFromMatrixPosition(w.matrixWorld),T.position.applyMatrix4(x),a.identity(),s.copy(w.matrixWorld),s.premultiply(x),a.extractRotation(s),T.halfWidth.set(w.width*.5,0,0),T.halfHeight.set(0,w.height*.5,0),T.halfWidth.applyMatrix4(a),T.halfHeight.applyMatrix4(a),g++}else if(w.isPointLight){const T=n.point[p];T.position.setFromMatrixPosition(w.matrixWorld),T.position.applyMatrix4(x),p++}else if(w.isHemisphereLight){const T=n.hemi[y];T.direction.setFromMatrixPosition(w.matrixWorld),T.direction.transformDirection(x),y++}}}return{setup:o,setupView:l,state:n}}function TP(i){const e=new Whe(i),t=[],n=[];function r(u){c.camera=u,t.length=0,n.length=0}function s(u){t.push(u)}function a(u){n.push(u)}function o(){e.setup(t)}function l(u){e.setupView(t,u)}const c={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:c,setupLights:o,setupLightsView:l,pushLight:s,pushShadow:a}}function qhe(i){let e=new WeakMap;function t(r,s=0){const a=e.get(r);let o;return a===void 0?(o=new TP(i),e.set(r,[o])):s>=a.length?(o=new TP(i),a.push(o)):o=a[s],o}function n(){e=new WeakMap}return{get:t,dispose:n}}const Xhe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Yhe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function $he(i,e,t){let n=new L0;const r=new Me,s=new Me,a=new sn,o=new bA({depthPacking:xB}),l=new _A,c={},u=t.maxTextureSize,d={[hc]:as,[as]:hc,[co]:co},p=new Ps({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Me},radius:{value:4}},vertexShader:Xhe,fragmentShader:Yhe}),m=p.clone();m.defines.HORIZONTAL_PASS=1;const g=new Yt;g.setAttribute("position",new kn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const y=new Bi(g,p),x=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=t2;let _=this.type;this.render=function(E,D,O){if(x.enabled===!1||x.autoUpdate===!1&&x.needsUpdate===!1||E.length===0)return;const R=i.getRenderTarget(),P=i.getActiveCubeFace(),L=i.getActiveMipmapLevel(),V=i.state;V.setBlending(Yo),V.buffers.depth.getReversed()===!0?V.buffers.color.setClear(0,0,0,0):V.buffers.color.setClear(1,1,1,1),V.buffers.depth.setTest(!0),V.setScissorTest(!1);const j=_!==io&&this.type===io,B=_===io&&this.type!==io;for(let J=0,U=E.length;J<U;J++){const X=E[J],$=X.shadow;if($===void 0){lt("WebGLShadowMap:",X,"has no shadow.");continue}if($.autoUpdate===!1&&$.needsUpdate===!1)continue;r.copy($.mapSize);const Q=$.getFrameExtents();if(r.multiply(Q),s.copy($.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/Q.x),r.x=s.x*Q.x,$.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/Q.y),r.y=s.y*Q.y,$.mapSize.y=s.y)),$.map===null||j===!0||B===!0){const ye=this.type!==io?{minFilter:qi,magFilter:qi}:{};$.map!==null&&$.map.dispose(),$.map=new go(r.x,r.y,ye),$.map.texture.name=X.name+".shadowMap",$.camera.updateProjectionMatrix()}i.setRenderTarget($.map),i.clear();const se=$.getViewportCount();for(let ye=0;ye<se;ye++){const we=$.getViewport(ye);a.set(s.x*we.x,s.y*we.y,s.x*we.z,s.y*we.w),V.viewport(a),$.updateMatrices(X,ye),n=$.getFrustum(),T(D,O,$.camera,X,this.type)}$.isPointLightShadow!==!0&&this.type===io&&S($,O),$.needsUpdate=!1}_=this.type,x.needsUpdate=!1,i.setRenderTarget(R,P,L)};function S(E,D){const O=e.update(y);p.defines.VSM_SAMPLES!==E.blurSamples&&(p.defines.VSM_SAMPLES=E.blurSamples,m.defines.VSM_SAMPLES=E.blurSamples,p.needsUpdate=!0,m.needsUpdate=!0),E.mapPass===null&&(E.mapPass=new go(r.x,r.y)),p.uniforms.shadow_pass.value=E.map.texture,p.uniforms.resolution.value=E.mapSize,p.uniforms.radius.value=E.radius,i.setRenderTarget(E.mapPass),i.clear(),i.renderBufferDirect(D,null,O,p,y,null),m.uniforms.shadow_pass.value=E.mapPass.texture,m.uniforms.resolution.value=E.mapSize,m.uniforms.radius.value=E.radius,i.setRenderTarget(E.map),i.clear(),i.renderBufferDirect(D,null,O,m,y,null)}function w(E,D,O,R){let P=null;const L=O.isPointLight===!0?E.customDistanceMaterial:E.customDepthMaterial;if(L!==void 0)P=L;else if(P=O.isPointLight===!0?l:o,i.localClippingEnabled&&D.clipShadows===!0&&Array.isArray(D.clippingPlanes)&&D.clippingPlanes.length!==0||D.displacementMap&&D.displacementScale!==0||D.alphaMap&&D.alphaTest>0||D.map&&D.alphaTest>0||D.alphaToCoverage===!0){const V=P.uuid,j=D.uuid;let B=c[V];B===void 0&&(B={},c[V]=B);let J=B[j];J===void 0&&(J=P.clone(),B[j]=J,D.addEventListener("dispose",C)),P=J}if(P.visible=D.visible,P.wireframe=D.wireframe,R===io?P.side=D.shadowSide!==null?D.shadowSide:D.side:P.side=D.shadowSide!==null?D.shadowSide:d[D.side],P.alphaMap=D.alphaMap,P.alphaTest=D.alphaToCoverage===!0?.5:D.alphaTest,P.map=D.map,P.clipShadows=D.clipShadows,P.clippingPlanes=D.clippingPlanes,P.clipIntersection=D.clipIntersection,P.displacementMap=D.displacementMap,P.displacementScale=D.displacementScale,P.displacementBias=D.displacementBias,P.wireframeLinewidth=D.wireframeLinewidth,P.linewidth=D.linewidth,O.isPointLight===!0&&P.isMeshDistanceMaterial===!0){const V=i.properties.get(P);V.light=O}return P}function T(E,D,O,R,P){if(E.visible===!1)return;if(E.layers.test(D.layers)&&(E.isMesh||E.isLine||E.isPoints)&&(E.castShadow||E.receiveShadow&&P===io)&&(!E.frustumCulled||n.intersectsObject(E))){E.modelViewMatrix.multiplyMatrices(O.matrixWorldInverse,E.matrixWorld);const j=e.update(E),B=E.material;if(Array.isArray(B)){const J=j.groups;for(let U=0,X=J.length;U<X;U++){const $=J[U],Q=B[$.materialIndex];if(Q&&Q.visible){const se=w(E,Q,R,P);E.onBeforeShadow(i,E,D,O,j,se,$),i.renderBufferDirect(O,null,j,se,E,$),E.onAfterShadow(i,E,D,O,j,se,$)}}}else if(B.visible){const J=w(E,B,R,P);E.onBeforeShadow(i,E,D,O,j,J,null),i.renderBufferDirect(O,null,j,J,E,null),E.onAfterShadow(i,E,D,O,j,J,null)}}const V=E.children;for(let j=0,B=V.length;j<B;j++)T(V[j],D,O,R,P)}function C(E){E.target.removeEventListener("dispose",C);for(const O in c){const R=c[O],P=E.target.uuid;P in R&&(R[P].dispose(),delete R[P])}}}const Khe={[uv]:hv,[dv]:mv,[fv]:gv,[Jh]:pv,[hv]:uv,[mv]:dv,[gv]:fv,[pv]:Jh};function Zhe(i,e){function t(){let te=!1;const je=new sn;let We=null;const Je=new sn(0,0,0,0);return{setMask:function(Be){We!==Be&&!te&&(i.colorMask(Be,Be,Be,Be),We=Be)},setLocked:function(Be){te=Be},setClear:function(Be,Ce,ct,Ct,an){an===!0&&(Be*=Ct,Ce*=Ct,ct*=Ct),je.set(Be,Ce,ct,Ct),Je.equals(je)===!1&&(i.clearColor(Be,Ce,ct,Ct),Je.copy(je))},reset:function(){te=!1,We=null,Je.set(-1,0,0,0)}}}function n(){let te=!1,je=!1,We=null,Je=null,Be=null;return{setReversed:function(Ce){if(je!==Ce){const ct=e.get("EXT_clip_control");Ce?ct.clipControlEXT(ct.LOWER_LEFT_EXT,ct.ZERO_TO_ONE_EXT):ct.clipControlEXT(ct.LOWER_LEFT_EXT,ct.NEGATIVE_ONE_TO_ONE_EXT),je=Ce;const Ct=Be;Be=null,this.setClear(Ct)}},getReversed:function(){return je},setTest:function(Ce){Ce?ge(i.DEPTH_TEST):Ne(i.DEPTH_TEST)},setMask:function(Ce){We!==Ce&&!te&&(i.depthMask(Ce),We=Ce)},setFunc:function(Ce){if(je&&(Ce=Khe[Ce]),Je!==Ce){switch(Ce){case uv:i.depthFunc(i.NEVER);break;case hv:i.depthFunc(i.ALWAYS);break;case dv:i.depthFunc(i.LESS);break;case Jh:i.depthFunc(i.LEQUAL);break;case fv:i.depthFunc(i.EQUAL);break;case pv:i.depthFunc(i.GEQUAL);break;case mv:i.depthFunc(i.GREATER);break;case gv:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}Je=Ce}},setLocked:function(Ce){te=Ce},setClear:function(Ce){Be!==Ce&&(je&&(Ce=1-Ce),i.clearDepth(Ce),Be=Ce)},reset:function(){te=!1,We=null,Je=null,Be=null,je=!1}}}function r(){let te=!1,je=null,We=null,Je=null,Be=null,Ce=null,ct=null,Ct=null,an=null;return{setTest:function(tn){te||(tn?ge(i.STENCIL_TEST):Ne(i.STENCIL_TEST))},setMask:function(tn){je!==tn&&!te&&(i.stencilMask(tn),je=tn)},setFunc:function(tn,ji,Vi){(We!==tn||Je!==ji||Be!==Vi)&&(i.stencilFunc(tn,ji,Vi),We=tn,Je=ji,Be=Vi)},setOp:function(tn,ji,Vi){(Ce!==tn||ct!==ji||Ct!==Vi)&&(i.stencilOp(tn,ji,Vi),Ce=tn,ct=ji,Ct=Vi)},setLocked:function(tn){te=tn},setClear:function(tn){an!==tn&&(i.clearStencil(tn),an=tn)},reset:function(){te=!1,je=null,We=null,Je=null,Be=null,Ce=null,ct=null,Ct=null,an=null}}}const s=new t,a=new n,o=new r,l=new WeakMap,c=new WeakMap;let u={},d={},p=new WeakMap,m=[],g=null,y=!1,x=null,_=null,S=null,w=null,T=null,C=null,E=null,D=new pt(0,0,0),O=0,R=!1,P=null,L=null,V=null,j=null,B=null;const J=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let U=!1,X=0;const $=i.getParameter(i.VERSION);$.indexOf("WebGL")!==-1?(X=parseFloat(/^WebGL (\d)/.exec($)[1]),U=X>=1):$.indexOf("OpenGL ES")!==-1&&(X=parseFloat(/^OpenGL ES (\d)/.exec($)[1]),U=X>=2);let Q=null,se={};const ye=i.getParameter(i.SCISSOR_BOX),we=i.getParameter(i.VIEWPORT),He=new sn().fromArray(ye),De=new sn().fromArray(we);function Oe(te,je,We,Je){const Be=new Uint8Array(4),Ce=i.createTexture();i.bindTexture(te,Ce),i.texParameteri(te,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(te,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let ct=0;ct<We;ct++)te===i.TEXTURE_3D||te===i.TEXTURE_2D_ARRAY?i.texImage3D(je,0,i.RGBA,1,1,Je,0,i.RGBA,i.UNSIGNED_BYTE,Be):i.texImage2D(je+ct,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,Be);return Ce}const fe={};fe[i.TEXTURE_2D]=Oe(i.TEXTURE_2D,i.TEXTURE_2D,1),fe[i.TEXTURE_CUBE_MAP]=Oe(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),fe[i.TEXTURE_2D_ARRAY]=Oe(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),fe[i.TEXTURE_3D]=Oe(i.TEXTURE_3D,i.TEXTURE_3D,1,1),s.setClear(0,0,0,1),a.setClear(1),o.setClear(0),ge(i.DEPTH_TEST),a.setFunc(Jh),Ee(!1),Ie(g5),ge(i.CULL_FACE),Te(Yo);function ge(te){u[te]!==!0&&(i.enable(te),u[te]=!0)}function Ne(te){u[te]!==!1&&(i.disable(te),u[te]=!1)}function Qe(te,je){return d[te]!==je?(i.bindFramebuffer(te,je),d[te]=je,te===i.DRAW_FRAMEBUFFER&&(d[i.FRAMEBUFFER]=je),te===i.FRAMEBUFFER&&(d[i.DRAW_FRAMEBUFFER]=je),!0):!1}function et(te,je){let We=m,Je=!1;if(te){We=p.get(je),We===void 0&&(We=[],p.set(je,We));const Be=te.textures;if(We.length!==Be.length||We[0]!==i.COLOR_ATTACHMENT0){for(let Ce=0,ct=Be.length;Ce<ct;Ce++)We[Ce]=i.COLOR_ATTACHMENT0+Ce;We.length=Be.length,Je=!0}}else We[0]!==i.BACK&&(We[0]=i.BACK,Je=!0);Je&&i.drawBuffers(We)}function Nt(te){return g!==te?(i.useProgram(te),g=te,!0):!1}const Gt={[Kc]:i.FUNC_ADD,[HF]:i.FUNC_SUBTRACT,[jF]:i.FUNC_REVERSE_SUBTRACT};Gt[VF]=i.MIN,Gt[GF]=i.MAX;const vt={[WF]:i.ZERO,[qF]:i.ONE,[XF]:i.SRC_COLOR,[lv]:i.SRC_ALPHA,[JF]:i.SRC_ALPHA_SATURATE,[ZF]:i.DST_COLOR,[$F]:i.DST_ALPHA,[YF]:i.ONE_MINUS_SRC_COLOR,[cv]:i.ONE_MINUS_SRC_ALPHA,[QF]:i.ONE_MINUS_DST_COLOR,[KF]:i.ONE_MINUS_DST_ALPHA,[eB]:i.CONSTANT_COLOR,[tB]:i.ONE_MINUS_CONSTANT_COLOR,[nB]:i.CONSTANT_ALPHA,[iB]:i.ONE_MINUS_CONSTANT_ALPHA};function Te(te,je,We,Je,Be,Ce,ct,Ct,an,tn){if(te===Yo){y===!0&&(Ne(i.BLEND),y=!1);return}if(y===!1&&(ge(i.BLEND),y=!0),te!==BF){if(te!==x||tn!==R){if((_!==Kc||T!==Kc)&&(i.blendEquation(i.FUNC_ADD),_=Kc,T=Kc),tn)switch(te){case Gh:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case x5:i.blendFunc(i.ONE,i.ONE);break;case y5:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case v5:i.blendFuncSeparate(i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ZERO,i.ONE);break;default:Vt("WebGLState: Invalid blending: ",te);break}else switch(te){case Gh:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case x5:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE,i.ONE,i.ONE);break;case y5:Vt("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case v5:Vt("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:Vt("WebGLState: Invalid blending: ",te);break}S=null,w=null,C=null,E=null,D.set(0,0,0),O=0,x=te,R=tn}return}Be=Be||je,Ce=Ce||We,ct=ct||Je,(je!==_||Be!==T)&&(i.blendEquationSeparate(Gt[je],Gt[Be]),_=je,T=Be),(We!==S||Je!==w||Ce!==C||ct!==E)&&(i.blendFuncSeparate(vt[We],vt[Je],vt[Ce],vt[ct]),S=We,w=Je,C=Ce,E=ct),(Ct.equals(D)===!1||an!==O)&&(i.blendColor(Ct.r,Ct.g,Ct.b,an),D.copy(Ct),O=an),x=te,R=!1}function Y(te,je){te.side===co?Ne(i.CULL_FACE):ge(i.CULL_FACE);let We=te.side===as;je&&(We=!We),Ee(We),te.blending===Gh&&te.transparent===!1?Te(Yo):Te(te.blending,te.blendEquation,te.blendSrc,te.blendDst,te.blendEquationAlpha,te.blendSrcAlpha,te.blendDstAlpha,te.blendColor,te.blendAlpha,te.premultipliedAlpha),a.setFunc(te.depthFunc),a.setTest(te.depthTest),a.setMask(te.depthWrite),s.setMask(te.colorWrite);const Je=te.stencilWrite;o.setTest(Je),Je&&(o.setMask(te.stencilWriteMask),o.setFunc(te.stencilFunc,te.stencilRef,te.stencilFuncMask),o.setOp(te.stencilFail,te.stencilZFail,te.stencilZPass)),Le(te.polygonOffset,te.polygonOffsetFactor,te.polygonOffsetUnits),te.alphaToCoverage===!0?ge(i.SAMPLE_ALPHA_TO_COVERAGE):Ne(i.SAMPLE_ALPHA_TO_COVERAGE)}function Ee(te){P!==te&&(te?i.frontFace(i.CW):i.frontFace(i.CCW),P=te)}function Ie(te){te!==zF?(ge(i.CULL_FACE),te!==L&&(te===g5?i.cullFace(i.BACK):te===UF?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):Ne(i.CULL_FACE),L=te}function Ge(te){te!==V&&(U&&i.lineWidth(te),V=te)}function Le(te,je,We){te?(ge(i.POLYGON_OFFSET_FILL),(j!==je||B!==We)&&(i.polygonOffset(je,We),j=je,B=We)):Ne(i.POLYGON_OFFSET_FILL)}function ot(te){te?ge(i.SCISSOR_TEST):Ne(i.SCISSOR_TEST)}function it(te){te===void 0&&(te=i.TEXTURE0+J-1),Q!==te&&(i.activeTexture(te),Q=te)}function ft(te,je,We){We===void 0&&(Q===null?We=i.TEXTURE0+J-1:We=Q);let Je=se[We];Je===void 0&&(Je={type:void 0,texture:void 0},se[We]=Je),(Je.type!==te||Je.texture!==je)&&(Q!==We&&(i.activeTexture(We),Q=We),i.bindTexture(te,je||fe[te]),Je.type=te,Je.texture=je)}function Z(){const te=se[Q];te!==void 0&&te.type!==void 0&&(i.bindTexture(te.type,null),te.type=void 0,te.texture=void 0)}function H(){try{i.compressedTexImage2D(...arguments)}catch(te){te("WebGLState:",te)}}function ue(){try{i.compressedTexImage3D(...arguments)}catch(te){te("WebGLState:",te)}}function Se(){try{i.texSubImage2D(...arguments)}catch(te){te("WebGLState:",te)}}function Re(){try{i.texSubImage3D(...arguments)}catch(te){te("WebGLState:",te)}}function _e(){try{i.compressedTexSubImage2D(...arguments)}catch(te){te("WebGLState:",te)}}function Mt(){try{i.compressedTexSubImage3D(...arguments)}catch(te){te("WebGLState:",te)}}function st(){try{i.texStorage2D(...arguments)}catch(te){te("WebGLState:",te)}}function At(){try{i.texStorage3D(...arguments)}catch(te){te("WebGLState:",te)}}function bt(){try{i.texImage2D(...arguments)}catch(te){te("WebGLState:",te)}}function Pe(){try{i.texImage3D(...arguments)}catch(te){te("WebGLState:",te)}}function Xe(te){He.equals(te)===!1&&(i.scissor(te.x,te.y,te.z,te.w),He.copy(te))}function Rt(te){De.equals(te)===!1&&(i.viewport(te.x,te.y,te.z,te.w),De.copy(te))}function ie(te,je){let We=c.get(je);We===void 0&&(We=new WeakMap,c.set(je,We));let Je=We.get(te);Je===void 0&&(Je=i.getUniformBlockIndex(je,te.name),We.set(te,Je))}function pe(te,je){const Je=c.get(je).get(te);l.get(je)!==Je&&(i.uniformBlockBinding(je,Je,te.__bindingPointIndex),l.set(je,Je))}function Fe(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),a.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),u={},Q=null,se={},d={},p=new WeakMap,m=[],g=null,y=!1,x=null,_=null,S=null,w=null,T=null,C=null,E=null,D=new pt(0,0,0),O=0,R=!1,P=null,L=null,V=null,j=null,B=null,He.set(0,0,i.canvas.width,i.canvas.height),De.set(0,0,i.canvas.width,i.canvas.height),s.reset(),a.reset(),o.reset()}return{buffers:{color:s,depth:a,stencil:o},enable:ge,disable:Ne,bindFramebuffer:Qe,drawBuffers:et,useProgram:Nt,setBlending:Te,setMaterial:Y,setFlipSided:Ee,setCullFace:Ie,setLineWidth:Ge,setPolygonOffset:Le,setScissorTest:ot,activeTexture:it,bindTexture:ft,unbindTexture:Z,compressedTexImage2D:H,compressedTexImage3D:ue,texImage2D:bt,texImage3D:Pe,updateUBOMapping:ie,uniformBlockBinding:pe,texStorage2D:st,texStorage3D:At,texSubImage2D:Se,texSubImage3D:Re,compressedTexSubImage2D:_e,compressedTexSubImage3D:Mt,scissor:Xe,viewport:Rt,reset:Fe}}function Qhe(i,e,t,n,r,s,a){const o=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new Me,u=new WeakMap;let d;const p=new WeakMap;let m=!1;try{m=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function g(Z,H){return m?new OffscreenCanvas(Z,H):tg("canvas")}function y(Z,H,ue){let Se=1;const Re=ft(Z);if((Re.width>ue||Re.height>ue)&&(Se=ue/Math.max(Re.width,Re.height)),Se<1)if(typeof HTMLImageElement<"u"&&Z instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Z instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Z instanceof ImageBitmap||typeof VideoFrame<"u"&&Z instanceof VideoFrame){const _e=Math.floor(Se*Re.width),Mt=Math.floor(Se*Re.height);d===void 0&&(d=g(_e,Mt));const st=H?g(_e,Mt):d;return st.width=_e,st.height=Mt,st.getContext("2d").drawImage(Z,0,0,_e,Mt),lt("WebGLRenderer: Texture has been resized from ("+Re.width+"x"+Re.height+") to ("+_e+"x"+Mt+")."),st}else return"data"in Z&&lt("WebGLRenderer: Image in DataTexture is too big ("+Re.width+"x"+Re.height+")."),Z;return Z}function x(Z){return Z.generateMipmaps}function _(Z){i.generateMipmap(Z)}function S(Z){return Z.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:Z.isWebGL3DRenderTarget?i.TEXTURE_3D:Z.isWebGLArrayRenderTarget||Z.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}function w(Z,H,ue,Se,Re=!1){if(Z!==null){if(i[Z]!==void 0)return i[Z];lt("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Z+"'")}let _e=H;if(H===i.RED&&(ue===i.FLOAT&&(_e=i.R32F),ue===i.HALF_FLOAT&&(_e=i.R16F),ue===i.UNSIGNED_BYTE&&(_e=i.R8)),H===i.RED_INTEGER&&(ue===i.UNSIGNED_BYTE&&(_e=i.R8UI),ue===i.UNSIGNED_SHORT&&(_e=i.R16UI),ue===i.UNSIGNED_INT&&(_e=i.R32UI),ue===i.BYTE&&(_e=i.R8I),ue===i.SHORT&&(_e=i.R16I),ue===i.INT&&(_e=i.R32I)),H===i.RG&&(ue===i.FLOAT&&(_e=i.RG32F),ue===i.HALF_FLOAT&&(_e=i.RG16F),ue===i.UNSIGNED_BYTE&&(_e=i.RG8)),H===i.RG_INTEGER&&(ue===i.UNSIGNED_BYTE&&(_e=i.RG8UI),ue===i.UNSIGNED_SHORT&&(_e=i.RG16UI),ue===i.UNSIGNED_INT&&(_e=i.RG32UI),ue===i.BYTE&&(_e=i.RG8I),ue===i.SHORT&&(_e=i.RG16I),ue===i.INT&&(_e=i.RG32I)),H===i.RGB_INTEGER&&(ue===i.UNSIGNED_BYTE&&(_e=i.RGB8UI),ue===i.UNSIGNED_SHORT&&(_e=i.RGB16UI),ue===i.UNSIGNED_INT&&(_e=i.RGB32UI),ue===i.BYTE&&(_e=i.RGB8I),ue===i.SHORT&&(_e=i.RGB16I),ue===i.INT&&(_e=i.RGB32I)),H===i.RGBA_INTEGER&&(ue===i.UNSIGNED_BYTE&&(_e=i.RGBA8UI),ue===i.UNSIGNED_SHORT&&(_e=i.RGBA16UI),ue===i.UNSIGNED_INT&&(_e=i.RGBA32UI),ue===i.BYTE&&(_e=i.RGBA8I),ue===i.SHORT&&(_e=i.RGBA16I),ue===i.INT&&(_e=i.RGBA32I)),H===i.RGB&&(ue===i.UNSIGNED_INT_5_9_9_9_REV&&(_e=i.RGB9_E5),ue===i.UNSIGNED_INT_10F_11F_11F_REV&&(_e=i.R11F_G11F_B10F)),H===i.RGBA){const Mt=Re?Jm:fn.getTransfer(Se);ue===i.FLOAT&&(_e=i.RGBA32F),ue===i.HALF_FLOAT&&(_e=i.RGBA16F),ue===i.UNSIGNED_BYTE&&(_e=Mt===Pn?i.SRGB8_ALPHA8:i.RGBA8),ue===i.UNSIGNED_SHORT_4_4_4_4&&(_e=i.RGBA4),ue===i.UNSIGNED_SHORT_5_5_5_1&&(_e=i.RGB5_A1)}return(_e===i.R16F||_e===i.R32F||_e===i.RG16F||_e===i.RG32F||_e===i.RGBA16F||_e===i.RGBA32F)&&e.get("EXT_color_buffer_float"),_e}function T(Z,H){let ue;return Z?H===null||H===fc||H===l0?ue=i.DEPTH24_STENCIL8:H===ns?ue=i.DEPTH32F_STENCIL8:H===o0&&(ue=i.DEPTH24_STENCIL8,lt("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):H===null||H===fc||H===l0?ue=i.DEPTH_COMPONENT24:H===ns?ue=i.DEPTH_COMPONENT32F:H===o0&&(ue=i.DEPTH_COMPONENT16),ue}function C(Z,H){return x(Z)===!0||Z.isFramebufferTexture&&Z.minFilter!==qi&&Z.minFilter!==Jn?Math.log2(Math.max(H.width,H.height))+1:Z.mipmaps!==void 0&&Z.mipmaps.length>0?Z.mipmaps.length:Z.isCompressedTexture&&Array.isArray(Z.image)?H.mipmaps.length:1}function E(Z){const H=Z.target;H.removeEventListener("dispose",E),O(H),H.isVideoTexture&&u.delete(H)}function D(Z){const H=Z.target;H.removeEventListener("dispose",D),P(H)}function O(Z){const H=n.get(Z);if(H.__webglInit===void 0)return;const ue=Z.source,Se=p.get(ue);if(Se){const Re=Se[H.__cacheKey];Re.usedTimes--,Re.usedTimes===0&&R(Z),Object.keys(Se).length===0&&p.delete(ue)}n.remove(Z)}function R(Z){const H=n.get(Z);i.deleteTexture(H.__webglTexture);const ue=Z.source,Se=p.get(ue);delete Se[H.__cacheKey],a.memory.textures--}function P(Z){const H=n.get(Z);if(Z.depthTexture&&(Z.depthTexture.dispose(),n.remove(Z.depthTexture)),Z.isWebGLCubeRenderTarget)for(let Se=0;Se<6;Se++){if(Array.isArray(H.__webglFramebuffer[Se]))for(let Re=0;Re<H.__webglFramebuffer[Se].length;Re++)i.deleteFramebuffer(H.__webglFramebuffer[Se][Re]);else i.deleteFramebuffer(H.__webglFramebuffer[Se]);H.__webglDepthbuffer&&i.deleteRenderbuffer(H.__webglDepthbuffer[Se])}else{if(Array.isArray(H.__webglFramebuffer))for(let Se=0;Se<H.__webglFramebuffer.length;Se++)i.deleteFramebuffer(H.__webglFramebuffer[Se]);else i.deleteFramebuffer(H.__webglFramebuffer);if(H.__webglDepthbuffer&&i.deleteRenderbuffer(H.__webglDepthbuffer),H.__webglMultisampledFramebuffer&&i.deleteFramebuffer(H.__webglMultisampledFramebuffer),H.__webglColorRenderbuffer)for(let Se=0;Se<H.__webglColorRenderbuffer.length;Se++)H.__webglColorRenderbuffer[Se]&&i.deleteRenderbuffer(H.__webglColorRenderbuffer[Se]);H.__webglDepthRenderbuffer&&i.deleteRenderbuffer(H.__webglDepthRenderbuffer)}const ue=Z.textures;for(let Se=0,Re=ue.length;Se<Re;Se++){const _e=n.get(ue[Se]);_e.__webglTexture&&(i.deleteTexture(_e.__webglTexture),a.memory.textures--),n.remove(ue[Se])}n.remove(Z)}let L=0;function V(){L=0}function j(){const Z=L;return Z>=r.maxTextures&&lt("WebGLTextures: Trying to use "+Z+" texture units while this GPU supports only "+r.maxTextures),L+=1,Z}function B(Z){const H=[];return H.push(Z.wrapS),H.push(Z.wrapT),H.push(Z.wrapR||0),H.push(Z.magFilter),H.push(Z.minFilter),H.push(Z.anisotropy),H.push(Z.internalFormat),H.push(Z.format),H.push(Z.type),H.push(Z.generateMipmaps),H.push(Z.premultiplyAlpha),H.push(Z.flipY),H.push(Z.unpackAlignment),H.push(Z.colorSpace),H.join()}function J(Z,H){const ue=n.get(Z);if(Z.isVideoTexture&&ot(Z),Z.isRenderTargetTexture===!1&&Z.isExternalTexture!==!0&&Z.version>0&&ue.__version!==Z.version){const Se=Z.image;if(Se===null)lt("WebGLRenderer: Texture marked for update but no image data found.");else if(Se.complete===!1)lt("WebGLRenderer: Texture marked for update but image is incomplete");else{fe(ue,Z,H);return}}else Z.isExternalTexture&&(ue.__webglTexture=Z.sourceTexture?Z.sourceTexture:null);t.bindTexture(i.TEXTURE_2D,ue.__webglTexture,i.TEXTURE0+H)}function U(Z,H){const ue=n.get(Z);if(Z.isRenderTargetTexture===!1&&Z.version>0&&ue.__version!==Z.version){fe(ue,Z,H);return}else Z.isExternalTexture&&(ue.__webglTexture=Z.sourceTexture?Z.sourceTexture:null);t.bindTexture(i.TEXTURE_2D_ARRAY,ue.__webglTexture,i.TEXTURE0+H)}function X(Z,H){const ue=n.get(Z);if(Z.isRenderTargetTexture===!1&&Z.version>0&&ue.__version!==Z.version){fe(ue,Z,H);return}t.bindTexture(i.TEXTURE_3D,ue.__webglTexture,i.TEXTURE0+H)}function $(Z,H){const ue=n.get(Z);if(Z.version>0&&ue.__version!==Z.version){ge(ue,Z,H);return}t.bindTexture(i.TEXTURE_CUBE_MAP,ue.__webglTexture,i.TEXTURE0+H)}const Q={[$m]:i.REPEAT,[or]:i.CLAMP_TO_EDGE,[Km]:i.MIRRORED_REPEAT},se={[qi]:i.NEAREST,[XT]:i.NEAREST_MIPMAP_NEAREST,[Lf]:i.NEAREST_MIPMAP_LINEAR,[Jn]:i.LINEAR,[pm]:i.LINEAR_MIPMAP_NEAREST,[Ho]:i.LINEAR_MIPMAP_LINEAR},ye={[vB]:i.NEVER,[TB]:i.ALWAYS,[bB]:i.LESS,[tA]:i.LEQUAL,[_B]:i.EQUAL,[MB]:i.GEQUAL,[SB]:i.GREATER,[wB]:i.NOTEQUAL};function we(Z,H){if(H.type===ns&&e.has("OES_texture_float_linear")===!1&&(H.magFilter===Jn||H.magFilter===pm||H.magFilter===Lf||H.magFilter===Ho||H.minFilter===Jn||H.minFilter===pm||H.minFilter===Lf||H.minFilter===Ho)&&lt("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(Z,i.TEXTURE_WRAP_S,Q[H.wrapS]),i.texParameteri(Z,i.TEXTURE_WRAP_T,Q[H.wrapT]),(Z===i.TEXTURE_3D||Z===i.TEXTURE_2D_ARRAY)&&i.texParameteri(Z,i.TEXTURE_WRAP_R,Q[H.wrapR]),i.texParameteri(Z,i.TEXTURE_MAG_FILTER,se[H.magFilter]),i.texParameteri(Z,i.TEXTURE_MIN_FILTER,se[H.minFilter]),H.compareFunction&&(i.texParameteri(Z,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(Z,i.TEXTURE_COMPARE_FUNC,ye[H.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(H.magFilter===qi||H.minFilter!==Lf&&H.minFilter!==Ho||H.type===ns&&e.has("OES_texture_float_linear")===!1)return;if(H.anisotropy>1||n.get(H).__currentAnisotropy){const ue=e.get("EXT_texture_filter_anisotropic");i.texParameterf(Z,ue.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(H.anisotropy,r.getMaxAnisotropy())),n.get(H).__currentAnisotropy=H.anisotropy}}}function He(Z,H){let ue=!1;Z.__webglInit===void 0&&(Z.__webglInit=!0,H.addEventListener("dispose",E));const Se=H.source;let Re=p.get(Se);Re===void 0&&(Re={},p.set(Se,Re));const _e=B(H);if(_e!==Z.__cacheKey){Re[_e]===void 0&&(Re[_e]={texture:i.createTexture(),usedTimes:0},a.memory.textures++,ue=!0),Re[_e].usedTimes++;const Mt=Re[Z.__cacheKey];Mt!==void 0&&(Re[Z.__cacheKey].usedTimes--,Mt.usedTimes===0&&R(H)),Z.__cacheKey=_e,Z.__webglTexture=Re[_e].texture}return ue}function De(Z,H,ue){return Math.floor(Math.floor(Z/ue)/H)}function Oe(Z,H,ue,Se){const _e=Z.updateRanges;if(_e.length===0)t.texSubImage2D(i.TEXTURE_2D,0,0,0,H.width,H.height,ue,Se,H.data);else{_e.sort((Pe,Xe)=>Pe.start-Xe.start);let Mt=0;for(let Pe=1;Pe<_e.length;Pe++){const Xe=_e[Mt],Rt=_e[Pe],ie=Xe.start+Xe.count,pe=De(Rt.start,H.width,4),Fe=De(Xe.start,H.width,4);Rt.start<=ie+1&&pe===Fe&&De(Rt.start+Rt.count-1,H.width,4)===pe?Xe.count=Math.max(Xe.count,Rt.start+Rt.count-Xe.start):(++Mt,_e[Mt]=Rt)}_e.length=Mt+1;const st=i.getParameter(i.UNPACK_ROW_LENGTH),At=i.getParameter(i.UNPACK_SKIP_PIXELS),bt=i.getParameter(i.UNPACK_SKIP_ROWS);i.pixelStorei(i.UNPACK_ROW_LENGTH,H.width);for(let Pe=0,Xe=_e.length;Pe<Xe;Pe++){const Rt=_e[Pe],ie=Math.floor(Rt.start/4),pe=Math.ceil(Rt.count/4),Fe=ie%H.width,te=Math.floor(ie/H.width),je=pe,We=1;i.pixelStorei(i.UNPACK_SKIP_PIXELS,Fe),i.pixelStorei(i.UNPACK_SKIP_ROWS,te),t.texSubImage2D(i.TEXTURE_2D,0,Fe,te,je,We,ue,Se,H.data)}Z.clearUpdateRanges(),i.pixelStorei(i.UNPACK_ROW_LENGTH,st),i.pixelStorei(i.UNPACK_SKIP_PIXELS,At),i.pixelStorei(i.UNPACK_SKIP_ROWS,bt)}}function fe(Z,H,ue){let Se=i.TEXTURE_2D;(H.isDataArrayTexture||H.isCompressedArrayTexture)&&(Se=i.TEXTURE_2D_ARRAY),H.isData3DTexture&&(Se=i.TEXTURE_3D);const Re=He(Z,H),_e=H.source;t.bindTexture(Se,Z.__webglTexture,i.TEXTURE0+ue);const Mt=n.get(_e);if(_e.version!==Mt.__version||Re===!0){t.activeTexture(i.TEXTURE0+ue);const st=fn.getPrimaries(fn.workingColorSpace),At=H.colorSpace===Yl?null:fn.getPrimaries(H.colorSpace),bt=H.colorSpace===Yl||st===At?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,H.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,H.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,H.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,bt);let Pe=y(H.image,!1,r.maxTextureSize);Pe=it(H,Pe);const Xe=s.convert(H.format,H.colorSpace),Rt=s.convert(H.type);let ie=w(H.internalFormat,Xe,Rt,H.colorSpace,H.isVideoTexture);we(Se,H);let pe;const Fe=H.mipmaps,te=H.isVideoTexture!==!0,je=Mt.__version===void 0||Re===!0,We=_e.dataReady,Je=C(H,Pe);if(H.isDepthTexture)ie=T(H.format===u0,H.type),je&&(te?t.texStorage2D(i.TEXTURE_2D,1,ie,Pe.width,Pe.height):t.texImage2D(i.TEXTURE_2D,0,ie,Pe.width,Pe.height,0,Xe,Rt,null));else if(H.isDataTexture)if(Fe.length>0){te&&je&&t.texStorage2D(i.TEXTURE_2D,Je,ie,Fe[0].width,Fe[0].height);for(let Be=0,Ce=Fe.length;Be<Ce;Be++)pe=Fe[Be],te?We&&t.texSubImage2D(i.TEXTURE_2D,Be,0,0,pe.width,pe.height,Xe,Rt,pe.data):t.texImage2D(i.TEXTURE_2D,Be,ie,pe.width,pe.height,0,Xe,Rt,pe.data);H.generateMipmaps=!1}else te?(je&&t.texStorage2D(i.TEXTURE_2D,Je,ie,Pe.width,Pe.height),We&&Oe(H,Pe,Xe,Rt)):t.texImage2D(i.TEXTURE_2D,0,ie,Pe.width,Pe.height,0,Xe,Rt,Pe.data);else if(H.isCompressedTexture)if(H.isCompressedArrayTexture){te&&je&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Je,ie,Fe[0].width,Fe[0].height,Pe.depth);for(let Be=0,Ce=Fe.length;Be<Ce;Be++)if(pe=Fe[Be],H.format!==Fr)if(Xe!==null)if(te){if(We)if(H.layerUpdates.size>0){const ct=P5(pe.width,pe.height,H.format,H.type);for(const Ct of H.layerUpdates){const an=pe.data.subarray(Ct*ct/pe.data.BYTES_PER_ELEMENT,(Ct+1)*ct/pe.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,Be,0,0,Ct,pe.width,pe.height,1,Xe,an)}H.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,Be,0,0,0,pe.width,pe.height,Pe.depth,Xe,pe.data)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,Be,ie,pe.width,pe.height,Pe.depth,0,pe.data,0,0);else lt("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else te?We&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,Be,0,0,0,pe.width,pe.height,Pe.depth,Xe,Rt,pe.data):t.texImage3D(i.TEXTURE_2D_ARRAY,Be,ie,pe.width,pe.height,Pe.depth,0,Xe,Rt,pe.data)}else{te&&je&&t.texStorage2D(i.TEXTURE_2D,Je,ie,Fe[0].width,Fe[0].height);for(let Be=0,Ce=Fe.length;Be<Ce;Be++)pe=Fe[Be],H.format!==Fr?Xe!==null?te?We&&t.compressedTexSubImage2D(i.TEXTURE_2D,Be,0,0,pe.width,pe.height,Xe,pe.data):t.compressedTexImage2D(i.TEXTURE_2D,Be,ie,pe.width,pe.height,0,pe.data):lt("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):te?We&&t.texSubImage2D(i.TEXTURE_2D,Be,0,0,pe.width,pe.height,Xe,Rt,pe.data):t.texImage2D(i.TEXTURE_2D,Be,ie,pe.width,pe.height,0,Xe,Rt,pe.data)}else if(H.isDataArrayTexture)if(te){if(je&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Je,ie,Pe.width,Pe.height,Pe.depth),We)if(H.layerUpdates.size>0){const Be=P5(Pe.width,Pe.height,H.format,H.type);for(const Ce of H.layerUpdates){const ct=Pe.data.subarray(Ce*Be/Pe.data.BYTES_PER_ELEMENT,(Ce+1)*Be/Pe.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,Ce,Pe.width,Pe.height,1,Xe,Rt,ct)}H.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,Pe.width,Pe.height,Pe.depth,Xe,Rt,Pe.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,ie,Pe.width,Pe.height,Pe.depth,0,Xe,Rt,Pe.data);else if(H.isData3DTexture)te?(je&&t.texStorage3D(i.TEXTURE_3D,Je,ie,Pe.width,Pe.height,Pe.depth),We&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,Pe.width,Pe.height,Pe.depth,Xe,Rt,Pe.data)):t.texImage3D(i.TEXTURE_3D,0,ie,Pe.width,Pe.height,Pe.depth,0,Xe,Rt,Pe.data);else if(H.isFramebufferTexture){if(je)if(te)t.texStorage2D(i.TEXTURE_2D,Je,ie,Pe.width,Pe.height);else{let Be=Pe.width,Ce=Pe.height;for(let ct=0;ct<Je;ct++)t.texImage2D(i.TEXTURE_2D,ct,ie,Be,Ce,0,Xe,Rt,null),Be>>=1,Ce>>=1}}else if(Fe.length>0){if(te&&je){const Be=ft(Fe[0]);t.texStorage2D(i.TEXTURE_2D,Je,ie,Be.width,Be.height)}for(let Be=0,Ce=Fe.length;Be<Ce;Be++)pe=Fe[Be],te?We&&t.texSubImage2D(i.TEXTURE_2D,Be,0,0,Xe,Rt,pe):t.texImage2D(i.TEXTURE_2D,Be,ie,Xe,Rt,pe);H.generateMipmaps=!1}else if(te){if(je){const Be=ft(Pe);t.texStorage2D(i.TEXTURE_2D,Je,ie,Be.width,Be.height)}We&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,Xe,Rt,Pe)}else t.texImage2D(i.TEXTURE_2D,0,ie,Xe,Rt,Pe);x(H)&&_(Se),Mt.__version=_e.version,H.onUpdate&&H.onUpdate(H)}Z.__version=H.version}function ge(Z,H,ue){if(H.image.length!==6)return;const Se=He(Z,H),Re=H.source;t.bindTexture(i.TEXTURE_CUBE_MAP,Z.__webglTexture,i.TEXTURE0+ue);const _e=n.get(Re);if(Re.version!==_e.__version||Se===!0){t.activeTexture(i.TEXTURE0+ue);const Mt=fn.getPrimaries(fn.workingColorSpace),st=H.colorSpace===Yl?null:fn.getPrimaries(H.colorSpace),At=H.colorSpace===Yl||Mt===st?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,H.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,H.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,H.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,At);const bt=H.isCompressedTexture||H.image[0].isCompressedTexture,Pe=H.image[0]&&H.image[0].isDataTexture,Xe=[];for(let Ce=0;Ce<6;Ce++)!bt&&!Pe?Xe[Ce]=y(H.image[Ce],!0,r.maxCubemapSize):Xe[Ce]=Pe?H.image[Ce].image:H.image[Ce],Xe[Ce]=it(H,Xe[Ce]);const Rt=Xe[0],ie=s.convert(H.format,H.colorSpace),pe=s.convert(H.type),Fe=w(H.internalFormat,ie,pe,H.colorSpace),te=H.isVideoTexture!==!0,je=_e.__version===void 0||Se===!0,We=Re.dataReady;let Je=C(H,Rt);we(i.TEXTURE_CUBE_MAP,H);let Be;if(bt){te&&je&&t.texStorage2D(i.TEXTURE_CUBE_MAP,Je,Fe,Rt.width,Rt.height);for(let Ce=0;Ce<6;Ce++){Be=Xe[Ce].mipmaps;for(let ct=0;ct<Be.length;ct++){const Ct=Be[ct];H.format!==Fr?ie!==null?te?We&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,ct,0,0,Ct.width,Ct.height,ie,Ct.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,ct,Fe,Ct.width,Ct.height,0,Ct.data):lt("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):te?We&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,ct,0,0,Ct.width,Ct.height,ie,pe,Ct.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,ct,Fe,Ct.width,Ct.height,0,ie,pe,Ct.data)}}}else{if(Be=H.mipmaps,te&&je){Be.length>0&&Je++;const Ce=ft(Xe[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,Je,Fe,Ce.width,Ce.height)}for(let Ce=0;Ce<6;Ce++)if(Pe){te?We&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,0,0,Xe[Ce].width,Xe[Ce].height,ie,pe,Xe[Ce].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,Fe,Xe[Ce].width,Xe[Ce].height,0,ie,pe,Xe[Ce].data);for(let ct=0;ct<Be.length;ct++){const an=Be[ct].image[Ce].image;te?We&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,ct+1,0,0,an.width,an.height,ie,pe,an.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,ct+1,Fe,an.width,an.height,0,ie,pe,an.data)}}else{te?We&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,0,0,ie,pe,Xe[Ce]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,Fe,ie,pe,Xe[Ce]);for(let ct=0;ct<Be.length;ct++){const Ct=Be[ct];te?We&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,ct+1,0,0,ie,pe,Ct.image[Ce]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,ct+1,Fe,ie,pe,Ct.image[Ce])}}}x(H)&&_(i.TEXTURE_CUBE_MAP),_e.__version=Re.version,H.onUpdate&&H.onUpdate(H)}Z.__version=H.version}function Ne(Z,H,ue,Se,Re,_e){const Mt=s.convert(ue.format,ue.colorSpace),st=s.convert(ue.type),At=w(ue.internalFormat,Mt,st,ue.colorSpace),bt=n.get(H),Pe=n.get(ue);if(Pe.__renderTarget=H,!bt.__hasExternalTextures){const Xe=Math.max(1,H.width>>_e),Rt=Math.max(1,H.height>>_e);Re===i.TEXTURE_3D||Re===i.TEXTURE_2D_ARRAY?t.texImage3D(Re,_e,At,Xe,Rt,H.depth,0,Mt,st,null):t.texImage2D(Re,_e,At,Xe,Rt,0,Mt,st,null)}t.bindFramebuffer(i.FRAMEBUFFER,Z),Le(H)?o.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Se,Re,Pe.__webglTexture,0,Ge(H)):(Re===i.TEXTURE_2D||Re>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&Re<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,Se,Re,Pe.__webglTexture,_e),t.bindFramebuffer(i.FRAMEBUFFER,null)}function Qe(Z,H,ue){if(i.bindRenderbuffer(i.RENDERBUFFER,Z),H.depthBuffer){const Se=H.depthTexture,Re=Se&&Se.isDepthTexture?Se.type:null,_e=T(H.stencilBuffer,Re),Mt=H.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,st=Ge(H);Le(H)?o.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,st,_e,H.width,H.height):ue?i.renderbufferStorageMultisample(i.RENDERBUFFER,st,_e,H.width,H.height):i.renderbufferStorage(i.RENDERBUFFER,_e,H.width,H.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,Mt,i.RENDERBUFFER,Z)}else{const Se=H.textures;for(let Re=0;Re<Se.length;Re++){const _e=Se[Re],Mt=s.convert(_e.format,_e.colorSpace),st=s.convert(_e.type),At=w(_e.internalFormat,Mt,st,_e.colorSpace),bt=Ge(H);ue&&Le(H)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,bt,At,H.width,H.height):Le(H)?o.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,bt,At,H.width,H.height):i.renderbufferStorage(i.RENDERBUFFER,At,H.width,H.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function et(Z,H){if(H&&H.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(i.FRAMEBUFFER,Z),!(H.depthTexture&&H.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Se=n.get(H.depthTexture);Se.__renderTarget=H,(!Se.__webglTexture||H.depthTexture.image.width!==H.width||H.depthTexture.image.height!==H.height)&&(H.depthTexture.image.width=H.width,H.depthTexture.image.height=H.height,H.depthTexture.needsUpdate=!0),J(H.depthTexture,0);const Re=Se.__webglTexture,_e=Ge(H);if(H.depthTexture.format===c0)Le(H)?o.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,Re,0,_e):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,Re,0);else if(H.depthTexture.format===u0)Le(H)?o.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,Re,0,_e):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,Re,0);else throw new Error("Unknown depthTexture format")}function Nt(Z){const H=n.get(Z),ue=Z.isWebGLCubeRenderTarget===!0;if(H.__boundDepthTexture!==Z.depthTexture){const Se=Z.depthTexture;if(H.__depthDisposeCallback&&H.__depthDisposeCallback(),Se){const Re=()=>{delete H.__boundDepthTexture,delete H.__depthDisposeCallback,Se.removeEventListener("dispose",Re)};Se.addEventListener("dispose",Re),H.__depthDisposeCallback=Re}H.__boundDepthTexture=Se}if(Z.depthTexture&&!H.__autoAllocateDepthBuffer){if(ue)throw new Error("target.depthTexture not supported in Cube render targets");const Se=Z.texture.mipmaps;Se&&Se.length>0?et(H.__webglFramebuffer[0],Z):et(H.__webglFramebuffer,Z)}else if(ue){H.__webglDepthbuffer=[];for(let Se=0;Se<6;Se++)if(t.bindFramebuffer(i.FRAMEBUFFER,H.__webglFramebuffer[Se]),H.__webglDepthbuffer[Se]===void 0)H.__webglDepthbuffer[Se]=i.createRenderbuffer(),Qe(H.__webglDepthbuffer[Se],Z,!1);else{const Re=Z.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,_e=H.__webglDepthbuffer[Se];i.bindRenderbuffer(i.RENDERBUFFER,_e),i.framebufferRenderbuffer(i.FRAMEBUFFER,Re,i.RENDERBUFFER,_e)}}else{const Se=Z.texture.mipmaps;if(Se&&Se.length>0?t.bindFramebuffer(i.FRAMEBUFFER,H.__webglFramebuffer[0]):t.bindFramebuffer(i.FRAMEBUFFER,H.__webglFramebuffer),H.__webglDepthbuffer===void 0)H.__webglDepthbuffer=i.createRenderbuffer(),Qe(H.__webglDepthbuffer,Z,!1);else{const Re=Z.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,_e=H.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,_e),i.framebufferRenderbuffer(i.FRAMEBUFFER,Re,i.RENDERBUFFER,_e)}}t.bindFramebuffer(i.FRAMEBUFFER,null)}function Gt(Z,H,ue){const Se=n.get(Z);H!==void 0&&Ne(Se.__webglFramebuffer,Z,Z.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),ue!==void 0&&Nt(Z)}function vt(Z){const H=Z.texture,ue=n.get(Z),Se=n.get(H);Z.addEventListener("dispose",D);const Re=Z.textures,_e=Z.isWebGLCubeRenderTarget===!0,Mt=Re.length>1;if(Mt||(Se.__webglTexture===void 0&&(Se.__webglTexture=i.createTexture()),Se.__version=H.version,a.memory.textures++),_e){ue.__webglFramebuffer=[];for(let st=0;st<6;st++)if(H.mipmaps&&H.mipmaps.length>0){ue.__webglFramebuffer[st]=[];for(let At=0;At<H.mipmaps.length;At++)ue.__webglFramebuffer[st][At]=i.createFramebuffer()}else ue.__webglFramebuffer[st]=i.createFramebuffer()}else{if(H.mipmaps&&H.mipmaps.length>0){ue.__webglFramebuffer=[];for(let st=0;st<H.mipmaps.length;st++)ue.__webglFramebuffer[st]=i.createFramebuffer()}else ue.__webglFramebuffer=i.createFramebuffer();if(Mt)for(let st=0,At=Re.length;st<At;st++){const bt=n.get(Re[st]);bt.__webglTexture===void 0&&(bt.__webglTexture=i.createTexture(),a.memory.textures++)}if(Z.samples>0&&Le(Z)===!1){ue.__webglMultisampledFramebuffer=i.createFramebuffer(),ue.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,ue.__webglMultisampledFramebuffer);for(let st=0;st<Re.length;st++){const At=Re[st];ue.__webglColorRenderbuffer[st]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,ue.__webglColorRenderbuffer[st]);const bt=s.convert(At.format,At.colorSpace),Pe=s.convert(At.type),Xe=w(At.internalFormat,bt,Pe,At.colorSpace,Z.isXRRenderTarget===!0),Rt=Ge(Z);i.renderbufferStorageMultisample(i.RENDERBUFFER,Rt,Xe,Z.width,Z.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+st,i.RENDERBUFFER,ue.__webglColorRenderbuffer[st])}i.bindRenderbuffer(i.RENDERBUFFER,null),Z.depthBuffer&&(ue.__webglDepthRenderbuffer=i.createRenderbuffer(),Qe(ue.__webglDepthRenderbuffer,Z,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(_e){t.bindTexture(i.TEXTURE_CUBE_MAP,Se.__webglTexture),we(i.TEXTURE_CUBE_MAP,H);for(let st=0;st<6;st++)if(H.mipmaps&&H.mipmaps.length>0)for(let At=0;At<H.mipmaps.length;At++)Ne(ue.__webglFramebuffer[st][At],Z,H,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+st,At);else Ne(ue.__webglFramebuffer[st],Z,H,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+st,0);x(H)&&_(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Mt){for(let st=0,At=Re.length;st<At;st++){const bt=Re[st],Pe=n.get(bt);let Xe=i.TEXTURE_2D;(Z.isWebGL3DRenderTarget||Z.isWebGLArrayRenderTarget)&&(Xe=Z.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(Xe,Pe.__webglTexture),we(Xe,bt),Ne(ue.__webglFramebuffer,Z,bt,i.COLOR_ATTACHMENT0+st,Xe,0),x(bt)&&_(Xe)}t.unbindTexture()}else{let st=i.TEXTURE_2D;if((Z.isWebGL3DRenderTarget||Z.isWebGLArrayRenderTarget)&&(st=Z.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(st,Se.__webglTexture),we(st,H),H.mipmaps&&H.mipmaps.length>0)for(let At=0;At<H.mipmaps.length;At++)Ne(ue.__webglFramebuffer[At],Z,H,i.COLOR_ATTACHMENT0,st,At);else Ne(ue.__webglFramebuffer,Z,H,i.COLOR_ATTACHMENT0,st,0);x(H)&&_(st),t.unbindTexture()}Z.depthBuffer&&Nt(Z)}function Te(Z){const H=Z.textures;for(let ue=0,Se=H.length;ue<Se;ue++){const Re=H[ue];if(x(Re)){const _e=S(Z),Mt=n.get(Re).__webglTexture;t.bindTexture(_e,Mt),_(_e),t.unbindTexture()}}}const Y=[],Ee=[];function Ie(Z){if(Z.samples>0){if(Le(Z)===!1){const H=Z.textures,ue=Z.width,Se=Z.height;let Re=i.COLOR_BUFFER_BIT;const _e=Z.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Mt=n.get(Z),st=H.length>1;if(st)for(let bt=0;bt<H.length;bt++)t.bindFramebuffer(i.FRAMEBUFFER,Mt.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+bt,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,Mt.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+bt,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,Mt.__webglMultisampledFramebuffer);const At=Z.texture.mipmaps;At&&At.length>0?t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Mt.__webglFramebuffer[0]):t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Mt.__webglFramebuffer);for(let bt=0;bt<H.length;bt++){if(Z.resolveDepthBuffer&&(Z.depthBuffer&&(Re|=i.DEPTH_BUFFER_BIT),Z.stencilBuffer&&Z.resolveStencilBuffer&&(Re|=i.STENCIL_BUFFER_BIT)),st){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,Mt.__webglColorRenderbuffer[bt]);const Pe=n.get(H[bt]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,Pe,0)}i.blitFramebuffer(0,0,ue,Se,0,0,ue,Se,Re,i.NEAREST),l===!0&&(Y.length=0,Ee.length=0,Y.push(i.COLOR_ATTACHMENT0+bt),Z.depthBuffer&&Z.resolveDepthBuffer===!1&&(Y.push(_e),Ee.push(_e),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,Ee)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,Y))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),st)for(let bt=0;bt<H.length;bt++){t.bindFramebuffer(i.FRAMEBUFFER,Mt.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+bt,i.RENDERBUFFER,Mt.__webglColorRenderbuffer[bt]);const Pe=n.get(H[bt]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,Mt.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+bt,i.TEXTURE_2D,Pe,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Mt.__webglMultisampledFramebuffer)}else if(Z.depthBuffer&&Z.resolveDepthBuffer===!1&&l){const H=Z.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[H])}}}function Ge(Z){return Math.min(r.maxSamples,Z.samples)}function Le(Z){const H=n.get(Z);return Z.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&H.__useRenderToTexture!==!1}function ot(Z){const H=a.render.frame;u.get(Z)!==H&&(u.set(Z,H),Z.update())}function it(Z,H){const ue=Z.colorSpace,Se=Z.format,Re=Z.type;return Z.isCompressedTexture===!0||Z.isVideoTexture===!0||ue!==yu&&ue!==Yl&&(fn.getTransfer(ue)===Pn?(Se!==Fr||Re!==za)&&lt("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):Vt("WebGLTextures: Unsupported texture color space:",ue)),H}function ft(Z){return typeof HTMLImageElement<"u"&&Z instanceof HTMLImageElement?(c.width=Z.naturalWidth||Z.width,c.height=Z.naturalHeight||Z.height):typeof VideoFrame<"u"&&Z instanceof VideoFrame?(c.width=Z.displayWidth,c.height=Z.displayHeight):(c.width=Z.width,c.height=Z.height),c}this.allocateTextureUnit=j,this.resetTextureUnits=V,this.setTexture2D=J,this.setTexture2DArray=U,this.setTexture3D=X,this.setTextureCube=$,this.rebindTextures=Gt,this.setupRenderTarget=vt,this.updateRenderTargetMipmap=Te,this.updateMultisampleRenderTarget=Ie,this.setupDepthRenderbuffer=Nt,this.setupFrameBufferTexture=Ne,this.useMultisampledRTT=Le}function LH(i,e){function t(n,r=Yl){let s;const a=fn.getTransfer(r);if(n===za)return i.UNSIGNED_BYTE;if(n===r2)return i.UNSIGNED_SHORT_4_4_4_4;if(n===s2)return i.UNSIGNED_SHORT_5_5_5_1;if(n===KT)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===ZT)return i.UNSIGNED_INT_10F_11F_11F_REV;if(n===YT)return i.BYTE;if(n===$T)return i.SHORT;if(n===o0)return i.UNSIGNED_SHORT;if(n===i2)return i.INT;if(n===fc)return i.UNSIGNED_INT;if(n===ns)return i.FLOAT;if(n===bc)return i.HALF_FLOAT;if(n===QT)return i.ALPHA;if(n===JT)return i.RGB;if(n===Fr)return i.RGBA;if(n===c0)return i.DEPTH_COMPONENT;if(n===u0)return i.DEPTH_STENCIL;if(n===Wg)return i.RED;if(n===qg)return i.RED_INTEGER;if(n===a2)return i.RG;if(n===o2)return i.RG_INTEGER;if(n===l2)return i.RGBA_INTEGER;if(n===mm||n===gm||n===xm||n===ym)if(a===Pn)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(n===mm)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===gm)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===xm)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===ym)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(n===mm)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===gm)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===xm)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===ym)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===xv||n===yv||n===vv||n===bv)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(n===xv)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===yv)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===vv)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===bv)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===_v||n===Sv||n===wv)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(n===_v||n===Sv)return a===Pn?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(n===wv)return a===Pn?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===Mv||n===Tv||n===Av||n===Cv||n===Ev||n===Rv||n===Pv||n===Iv||n===Dv||n===Nv||n===Lv||n===kv||n===Ov||n===zv)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(n===Mv)return a===Pn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Tv)return a===Pn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Av)return a===Pn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Cv)return a===Pn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===Ev)return a===Pn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Rv)return a===Pn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Pv)return a===Pn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===Iv)return a===Pn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===Dv)return a===Pn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===Nv)return a===Pn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===Lv)return a===Pn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===kv)return a===Pn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Ov)return a===Pn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===zv)return a===Pn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===Uv||n===Fv||n===Bv)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(n===Uv)return a===Pn?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===Fv)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Bv)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===Hv||n===jv||n===Vv||n===Gv)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(n===Hv)return s.COMPRESSED_RED_RGTC1_EXT;if(n===jv)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===Vv)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===Gv)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===l0?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}const Jhe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,ede=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class tde{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const n=new hA(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new Ps({vertexShader:Jhe,fragmentShader:ede,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Bi(new k0(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class nde extends ul{constructor(e,t){super();const n=this;let r=null,s=1,a=null,o="local-floor",l=1,c=null,u=null,d=null,p=null,m=null,g=null;const y=typeof XRWebGLBinding<"u",x=new tde,_={},S=t.getContextAttributes();let w=null,T=null;const C=[],E=[],D=new Me;let O=null;const R=new Pi;R.viewport=new sn;const P=new Pi;P.viewport=new sn;const L=[R,P],V=new SH;let j=null,B=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(fe){let ge=C[fe];return ge===void 0&&(ge=new Ly,C[fe]=ge),ge.getTargetRaySpace()},this.getControllerGrip=function(fe){let ge=C[fe];return ge===void 0&&(ge=new Ly,C[fe]=ge),ge.getGripSpace()},this.getHand=function(fe){let ge=C[fe];return ge===void 0&&(ge=new Ly,C[fe]=ge),ge.getHandSpace()};function J(fe){const ge=E.indexOf(fe.inputSource);if(ge===-1)return;const Ne=C[ge];Ne!==void 0&&(Ne.update(fe.inputSource,fe.frame,c||a),Ne.dispatchEvent({type:fe.type,data:fe.inputSource}))}function U(){r.removeEventListener("select",J),r.removeEventListener("selectstart",J),r.removeEventListener("selectend",J),r.removeEventListener("squeeze",J),r.removeEventListener("squeezestart",J),r.removeEventListener("squeezeend",J),r.removeEventListener("end",U),r.removeEventListener("inputsourceschange",X);for(let fe=0;fe<C.length;fe++){const ge=E[fe];ge!==null&&(E[fe]=null,C[fe].disconnect(ge))}j=null,B=null,x.reset();for(const fe in _)delete _[fe];e.setRenderTarget(w),m=null,p=null,d=null,r=null,T=null,Oe.stop(),n.isPresenting=!1,e.setPixelRatio(O),e.setSize(D.width,D.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(fe){s=fe,n.isPresenting===!0&&lt("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(fe){o=fe,n.isPresenting===!0&&lt("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||a},this.setReferenceSpace=function(fe){c=fe},this.getBaseLayer=function(){return p!==null?p:m},this.getBinding=function(){return d===null&&y&&(d=new XRWebGLBinding(r,t)),d},this.getFrame=function(){return g},this.getSession=function(){return r},this.setSession=async function(fe){if(r=fe,r!==null){if(w=e.getRenderTarget(),r.addEventListener("select",J),r.addEventListener("selectstart",J),r.addEventListener("selectend",J),r.addEventListener("squeeze",J),r.addEventListener("squeezestart",J),r.addEventListener("squeezeend",J),r.addEventListener("end",U),r.addEventListener("inputsourceschange",X),S.xrCompatible!==!0&&await t.makeXRCompatible(),O=e.getPixelRatio(),e.getSize(D),y&&"createProjectionLayer"in XRWebGLBinding.prototype){let Ne=null,Qe=null,et=null;S.depth&&(et=S.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Ne=S.stencil?u0:c0,Qe=S.stencil?l0:fc);const Nt={colorFormat:t.RGBA8,depthFormat:et,scaleFactor:s};d=this.getBinding(),p=d.createProjectionLayer(Nt),r.updateRenderState({layers:[p]}),e.setPixelRatio(1),e.setSize(p.textureWidth,p.textureHeight,!1),T=new go(p.textureWidth,p.textureHeight,{format:Fr,type:za,depthTexture:new v2(p.textureWidth,p.textureHeight,Qe,void 0,void 0,void 0,void 0,void 0,void 0,Ne),stencilBuffer:S.stencil,colorSpace:e.outputColorSpace,samples:S.antialias?4:0,resolveDepthBuffer:p.ignoreDepthValues===!1,resolveStencilBuffer:p.ignoreDepthValues===!1})}else{const Ne={antialias:S.antialias,alpha:!0,depth:S.depth,stencil:S.stencil,framebufferScaleFactor:s};m=new XRWebGLLayer(r,t,Ne),r.updateRenderState({baseLayer:m}),e.setPixelRatio(1),e.setSize(m.framebufferWidth,m.framebufferHeight,!1),T=new go(m.framebufferWidth,m.framebufferHeight,{format:Fr,type:za,colorSpace:e.outputColorSpace,stencilBuffer:S.stencil,resolveDepthBuffer:m.ignoreDepthValues===!1,resolveStencilBuffer:m.ignoreDepthValues===!1})}T.isXRRenderTarget=!0,this.setFoveation(l),c=null,a=await r.requestReferenceSpace(o),Oe.setContext(r),Oe.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return x.getDepthTexture()};function X(fe){for(let ge=0;ge<fe.removed.length;ge++){const Ne=fe.removed[ge],Qe=E.indexOf(Ne);Qe>=0&&(E[Qe]=null,C[Qe].disconnect(Ne))}for(let ge=0;ge<fe.added.length;ge++){const Ne=fe.added[ge];let Qe=E.indexOf(Ne);if(Qe===-1){for(let Nt=0;Nt<C.length;Nt++)if(Nt>=E.length){E.push(Ne),Qe=Nt;break}else if(E[Nt]===null){E[Nt]=Ne,Qe=Nt;break}if(Qe===-1)break}const et=C[Qe];et&&et.connect(Ne)}}const $=new K,Q=new K;function se(fe,ge,Ne){$.setFromMatrixPosition(ge.matrixWorld),Q.setFromMatrixPosition(Ne.matrixWorld);const Qe=$.distanceTo(Q),et=ge.projectionMatrix.elements,Nt=Ne.projectionMatrix.elements,Gt=et[14]/(et[10]-1),vt=et[14]/(et[10]+1),Te=(et[9]+1)/et[5],Y=(et[9]-1)/et[5],Ee=(et[8]-1)/et[0],Ie=(Nt[8]+1)/Nt[0],Ge=Gt*Ee,Le=Gt*Ie,ot=Qe/(-Ee+Ie),it=ot*-Ee;if(ge.matrixWorld.decompose(fe.position,fe.quaternion,fe.scale),fe.translateX(it),fe.translateZ(ot),fe.matrixWorld.compose(fe.position,fe.quaternion,fe.scale),fe.matrixWorldInverse.copy(fe.matrixWorld).invert(),et[10]===-1)fe.projectionMatrix.copy(ge.projectionMatrix),fe.projectionMatrixInverse.copy(ge.projectionMatrixInverse);else{const ft=Gt+ot,Z=vt+ot,H=Ge-it,ue=Le+(Qe-it),Se=Te*vt/Z*ft,Re=Y*vt/Z*ft;fe.projectionMatrix.makePerspective(H,ue,Se,Re,ft,Z),fe.projectionMatrixInverse.copy(fe.projectionMatrix).invert()}}function ye(fe,ge){ge===null?fe.matrixWorld.copy(fe.matrix):fe.matrixWorld.multiplyMatrices(ge.matrixWorld,fe.matrix),fe.matrixWorldInverse.copy(fe.matrixWorld).invert()}this.updateCamera=function(fe){if(r===null)return;let ge=fe.near,Ne=fe.far;x.texture!==null&&(x.depthNear>0&&(ge=x.depthNear),x.depthFar>0&&(Ne=x.depthFar)),V.near=P.near=R.near=ge,V.far=P.far=R.far=Ne,(j!==V.near||B!==V.far)&&(r.updateRenderState({depthNear:V.near,depthFar:V.far}),j=V.near,B=V.far),V.layers.mask=fe.layers.mask|6,R.layers.mask=V.layers.mask&3,P.layers.mask=V.layers.mask&5;const Qe=fe.parent,et=V.cameras;ye(V,Qe);for(let Nt=0;Nt<et.length;Nt++)ye(et[Nt],Qe);et.length===2?se(V,R,P):V.projectionMatrix.copy(R.projectionMatrix),we(fe,V,Qe)};function we(fe,ge,Ne){Ne===null?fe.matrix.copy(ge.matrixWorld):(fe.matrix.copy(Ne.matrixWorld),fe.matrix.invert(),fe.matrix.multiply(ge.matrixWorld)),fe.matrix.decompose(fe.position,fe.quaternion,fe.scale),fe.updateMatrixWorld(!0),fe.projectionMatrix.copy(ge.projectionMatrix),fe.projectionMatrixInverse.copy(ge.projectionMatrixInverse),fe.isPerspectiveCamera&&(fe.fov=f0*2*Math.atan(1/fe.projectionMatrix.elements[5]),fe.zoom=1)}this.getCamera=function(){return V},this.getFoveation=function(){if(!(p===null&&m===null))return l},this.setFoveation=function(fe){l=fe,p!==null&&(p.fixedFoveation=fe),m!==null&&m.fixedFoveation!==void 0&&(m.fixedFoveation=fe)},this.hasDepthSensing=function(){return x.texture!==null},this.getDepthSensingMesh=function(){return x.getMesh(V)},this.getCameraTexture=function(fe){return _[fe]};let He=null;function De(fe,ge){if(u=ge.getViewerPose(c||a),g=ge,u!==null){const Ne=u.views;m!==null&&(e.setRenderTargetFramebuffer(T,m.framebuffer),e.setRenderTarget(T));let Qe=!1;Ne.length!==V.cameras.length&&(V.cameras.length=0,Qe=!0);for(let vt=0;vt<Ne.length;vt++){const Te=Ne[vt];let Y=null;if(m!==null)Y=m.getViewport(Te);else{const Ie=d.getViewSubImage(p,Te);Y=Ie.viewport,vt===0&&(e.setRenderTargetTextures(T,Ie.colorTexture,Ie.depthStencilTexture),e.setRenderTarget(T))}let Ee=L[vt];Ee===void 0&&(Ee=new Pi,Ee.layers.enable(vt),Ee.viewport=new sn,L[vt]=Ee),Ee.matrix.fromArray(Te.transform.matrix),Ee.matrix.decompose(Ee.position,Ee.quaternion,Ee.scale),Ee.projectionMatrix.fromArray(Te.projectionMatrix),Ee.projectionMatrixInverse.copy(Ee.projectionMatrix).invert(),Ee.viewport.set(Y.x,Y.y,Y.width,Y.height),vt===0&&(V.matrix.copy(Ee.matrix),V.matrix.decompose(V.position,V.quaternion,V.scale)),Qe===!0&&V.cameras.push(Ee)}const et=r.enabledFeatures;if(et&&et.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&y){d=n.getBinding();const vt=d.getDepthInformation(Ne[0]);vt&&vt.isValid&&vt.texture&&x.init(vt,r.renderState)}if(et&&et.includes("camera-access")&&y){e.state.unbindTexture(),d=n.getBinding();for(let vt=0;vt<Ne.length;vt++){const Te=Ne[vt].camera;if(Te){let Y=_[Te];Y||(Y=new hA,_[Te]=Y);const Ee=d.getCameraImage(Te);Y.sourceTexture=Ee}}}}for(let Ne=0;Ne<C.length;Ne++){const Qe=E[Ne],et=C[Ne];Qe!==null&&et!==void 0&&et.update(Qe,ge,c||a)}He&&He(fe,ge),ge.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:ge}),g=null}const Oe=new RH;Oe.setAnimationLoop(De),this.setAnimationLoop=function(fe){He=fe},this.dispose=function(){}}}const bh=new la,ide=new Bt;function rde(i,e){function t(x,_){x.matrixAutoUpdate===!0&&x.updateMatrix(),_.value.copy(x.matrix)}function n(x,_){_.color.getRGB(x.fogColor.value,PB(i)),_.isFog?(x.fogNear.value=_.near,x.fogFar.value=_.far):_.isFogExp2&&(x.fogDensity.value=_.density)}function r(x,_,S,w,T){_.isMeshBasicMaterial||_.isMeshLambertMaterial?s(x,_):_.isMeshToonMaterial?(s(x,_),d(x,_)):_.isMeshPhongMaterial?(s(x,_),u(x,_)):_.isMeshStandardMaterial?(s(x,_),p(x,_),_.isMeshPhysicalMaterial&&m(x,_,T)):_.isMeshMatcapMaterial?(s(x,_),g(x,_)):_.isMeshDepthMaterial?s(x,_):_.isMeshDistanceMaterial?(s(x,_),y(x,_)):_.isMeshNormalMaterial?s(x,_):_.isLineBasicMaterial?(a(x,_),_.isLineDashedMaterial&&o(x,_)):_.isPointsMaterial?l(x,_,S,w):_.isSpriteMaterial?c(x,_):_.isShadowMaterial?(x.color.value.copy(_.color),x.opacity.value=_.opacity):_.isShaderMaterial&&(_.uniformsNeedUpdate=!1)}function s(x,_){x.opacity.value=_.opacity,_.color&&x.diffuse.value.copy(_.color),_.emissive&&x.emissive.value.copy(_.emissive).multiplyScalar(_.emissiveIntensity),_.map&&(x.map.value=_.map,t(_.map,x.mapTransform)),_.alphaMap&&(x.alphaMap.value=_.alphaMap,t(_.alphaMap,x.alphaMapTransform)),_.bumpMap&&(x.bumpMap.value=_.bumpMap,t(_.bumpMap,x.bumpMapTransform),x.bumpScale.value=_.bumpScale,_.side===as&&(x.bumpScale.value*=-1)),_.normalMap&&(x.normalMap.value=_.normalMap,t(_.normalMap,x.normalMapTransform),x.normalScale.value.copy(_.normalScale),_.side===as&&x.normalScale.value.negate()),_.displacementMap&&(x.displacementMap.value=_.displacementMap,t(_.displacementMap,x.displacementMapTransform),x.displacementScale.value=_.displacementScale,x.displacementBias.value=_.displacementBias),_.emissiveMap&&(x.emissiveMap.value=_.emissiveMap,t(_.emissiveMap,x.emissiveMapTransform)),_.specularMap&&(x.specularMap.value=_.specularMap,t(_.specularMap,x.specularMapTransform)),_.alphaTest>0&&(x.alphaTest.value=_.alphaTest);const S=e.get(_),w=S.envMap,T=S.envMapRotation;w&&(x.envMap.value=w,bh.copy(T),bh.x*=-1,bh.y*=-1,bh.z*=-1,w.isCubeTexture&&w.isRenderTargetTexture===!1&&(bh.y*=-1,bh.z*=-1),x.envMapRotation.value.setFromMatrix4(ide.makeRotationFromEuler(bh)),x.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,x.reflectivity.value=_.reflectivity,x.ior.value=_.ior,x.refractionRatio.value=_.refractionRatio),_.lightMap&&(x.lightMap.value=_.lightMap,x.lightMapIntensity.value=_.lightMapIntensity,t(_.lightMap,x.lightMapTransform)),_.aoMap&&(x.aoMap.value=_.aoMap,x.aoMapIntensity.value=_.aoMapIntensity,t(_.aoMap,x.aoMapTransform))}function a(x,_){x.diffuse.value.copy(_.color),x.opacity.value=_.opacity,_.map&&(x.map.value=_.map,t(_.map,x.mapTransform))}function o(x,_){x.dashSize.value=_.dashSize,x.totalSize.value=_.dashSize+_.gapSize,x.scale.value=_.scale}function l(x,_,S,w){x.diffuse.value.copy(_.color),x.opacity.value=_.opacity,x.size.value=_.size*S,x.scale.value=w*.5,_.map&&(x.map.value=_.map,t(_.map,x.uvTransform)),_.alphaMap&&(x.alphaMap.value=_.alphaMap,t(_.alphaMap,x.alphaMapTransform)),_.alphaTest>0&&(x.alphaTest.value=_.alphaTest)}function c(x,_){x.diffuse.value.copy(_.color),x.opacity.value=_.opacity,x.rotation.value=_.rotation,_.map&&(x.map.value=_.map,t(_.map,x.mapTransform)),_.alphaMap&&(x.alphaMap.value=_.alphaMap,t(_.alphaMap,x.alphaMapTransform)),_.alphaTest>0&&(x.alphaTest.value=_.alphaTest)}function u(x,_){x.specular.value.copy(_.specular),x.shininess.value=Math.max(_.shininess,1e-4)}function d(x,_){_.gradientMap&&(x.gradientMap.value=_.gradientMap)}function p(x,_){x.metalness.value=_.metalness,_.metalnessMap&&(x.metalnessMap.value=_.metalnessMap,t(_.metalnessMap,x.metalnessMapTransform)),x.roughness.value=_.roughness,_.roughnessMap&&(x.roughnessMap.value=_.roughnessMap,t(_.roughnessMap,x.roughnessMapTransform)),_.envMap&&(x.envMapIntensity.value=_.envMapIntensity)}function m(x,_,S){x.ior.value=_.ior,_.sheen>0&&(x.sheenColor.value.copy(_.sheenColor).multiplyScalar(_.sheen),x.sheenRoughness.value=_.sheenRoughness,_.sheenColorMap&&(x.sheenColorMap.value=_.sheenColorMap,t(_.sheenColorMap,x.sheenColorMapTransform)),_.sheenRoughnessMap&&(x.sheenRoughnessMap.value=_.sheenRoughnessMap,t(_.sheenRoughnessMap,x.sheenRoughnessMapTransform))),_.clearcoat>0&&(x.clearcoat.value=_.clearcoat,x.clearcoatRoughness.value=_.clearcoatRoughness,_.clearcoatMap&&(x.clearcoatMap.value=_.clearcoatMap,t(_.clearcoatMap,x.clearcoatMapTransform)),_.clearcoatRoughnessMap&&(x.clearcoatRoughnessMap.value=_.clearcoatRoughnessMap,t(_.clearcoatRoughnessMap,x.clearcoatRoughnessMapTransform)),_.clearcoatNormalMap&&(x.clearcoatNormalMap.value=_.clearcoatNormalMap,t(_.clearcoatNormalMap,x.clearcoatNormalMapTransform),x.clearcoatNormalScale.value.copy(_.clearcoatNormalScale),_.side===as&&x.clearcoatNormalScale.value.negate())),_.dispersion>0&&(x.dispersion.value=_.dispersion),_.iridescence>0&&(x.iridescence.value=_.iridescence,x.iridescenceIOR.value=_.iridescenceIOR,x.iridescenceThicknessMinimum.value=_.iridescenceThicknessRange[0],x.iridescenceThicknessMaximum.value=_.iridescenceThicknessRange[1],_.iridescenceMap&&(x.iridescenceMap.value=_.iridescenceMap,t(_.iridescenceMap,x.iridescenceMapTransform)),_.iridescenceThicknessMap&&(x.iridescenceThicknessMap.value=_.iridescenceThicknessMap,t(_.iridescenceThicknessMap,x.iridescenceThicknessMapTransform))),_.transmission>0&&(x.transmission.value=_.transmission,x.transmissionSamplerMap.value=S.texture,x.transmissionSamplerSize.value.set(S.width,S.height),_.transmissionMap&&(x.transmissionMap.value=_.transmissionMap,t(_.transmissionMap,x.transmissionMapTransform)),x.thickness.value=_.thickness,_.thicknessMap&&(x.thicknessMap.value=_.thicknessMap,t(_.thicknessMap,x.thicknessMapTransform)),x.attenuationDistance.value=_.attenuationDistance,x.attenuationColor.value.copy(_.attenuationColor)),_.anisotropy>0&&(x.anisotropyVector.value.set(_.anisotropy*Math.cos(_.anisotropyRotation),_.anisotropy*Math.sin(_.anisotropyRotation)),_.anisotropyMap&&(x.anisotropyMap.value=_.anisotropyMap,t(_.anisotropyMap,x.anisotropyMapTransform))),x.specularIntensity.value=_.specularIntensity,x.specularColor.value.copy(_.specularColor),_.specularColorMap&&(x.specularColorMap.value=_.specularColorMap,t(_.specularColorMap,x.specularColorMapTransform)),_.specularIntensityMap&&(x.specularIntensityMap.value=_.specularIntensityMap,t(_.specularIntensityMap,x.specularIntensityMapTransform))}function g(x,_){_.matcap&&(x.matcap.value=_.matcap)}function y(x,_){const S=e.get(_).light;x.referencePosition.value.setFromMatrixPosition(S.matrixWorld),x.nearDistance.value=S.shadow.camera.near,x.farDistance.value=S.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function sde(i,e,t,n){let r={},s={},a=[];const o=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function l(S,w){const T=w.program;n.uniformBlockBinding(S,T)}function c(S,w){let T=r[S.id];T===void 0&&(g(S),T=u(S),r[S.id]=T,S.addEventListener("dispose",x));const C=w.program;n.updateUBOMapping(S,C);const E=e.render.frame;s[S.id]!==E&&(p(S),s[S.id]=E)}function u(S){const w=d();S.__bindingPointIndex=w;const T=i.createBuffer(),C=S.__size,E=S.usage;return i.bindBuffer(i.UNIFORM_BUFFER,T),i.bufferData(i.UNIFORM_BUFFER,C,E),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,w,T),T}function d(){for(let S=0;S<o;S++)if(a.indexOf(S)===-1)return a.push(S),S;return Vt("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function p(S){const w=r[S.id],T=S.uniforms,C=S.__cache;i.bindBuffer(i.UNIFORM_BUFFER,w);for(let E=0,D=T.length;E<D;E++){const O=Array.isArray(T[E])?T[E]:[T[E]];for(let R=0,P=O.length;R<P;R++){const L=O[R];if(m(L,E,R,C)===!0){const V=L.__offset,j=Array.isArray(L.value)?L.value:[L.value];let B=0;for(let J=0;J<j.length;J++){const U=j[J],X=y(U);typeof U=="number"||typeof U=="boolean"?(L.__data[0]=U,i.bufferSubData(i.UNIFORM_BUFFER,V+B,L.__data)):U.isMatrix3?(L.__data[0]=U.elements[0],L.__data[1]=U.elements[1],L.__data[2]=U.elements[2],L.__data[3]=0,L.__data[4]=U.elements[3],L.__data[5]=U.elements[4],L.__data[6]=U.elements[5],L.__data[7]=0,L.__data[8]=U.elements[6],L.__data[9]=U.elements[7],L.__data[10]=U.elements[8],L.__data[11]=0):(U.toArray(L.__data,B),B+=X.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,V,L.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function m(S,w,T,C){const E=S.value,D=w+"_"+T;if(C[D]===void 0)return typeof E=="number"||typeof E=="boolean"?C[D]=E:C[D]=E.clone(),!0;{const O=C[D];if(typeof E=="number"||typeof E=="boolean"){if(O!==E)return C[D]=E,!0}else if(O.equals(E)===!1)return O.copy(E),!0}return!1}function g(S){const w=S.uniforms;let T=0;const C=16;for(let D=0,O=w.length;D<O;D++){const R=Array.isArray(w[D])?w[D]:[w[D]];for(let P=0,L=R.length;P<L;P++){const V=R[P],j=Array.isArray(V.value)?V.value:[V.value];for(let B=0,J=j.length;B<J;B++){const U=j[B],X=y(U),$=T%C,Q=$%X.boundary,se=$+Q;T+=Q,se!==0&&C-se<X.storage&&(T+=C-se),V.__data=new Float32Array(X.storage/Float32Array.BYTES_PER_ELEMENT),V.__offset=T,T+=X.storage}}}const E=T%C;return E>0&&(T+=C-E),S.__size=T,S.__cache={},this}function y(S){const w={boundary:0,storage:0};return typeof S=="number"||typeof S=="boolean"?(w.boundary=4,w.storage=4):S.isVector2?(w.boundary=8,w.storage=8):S.isVector3||S.isColor?(w.boundary=16,w.storage=12):S.isVector4?(w.boundary=16,w.storage=16):S.isMatrix3?(w.boundary=48,w.storage=48):S.isMatrix4?(w.boundary=64,w.storage=64):S.isTexture?lt("WebGLRenderer: Texture samplers can not be part of an uniforms group."):lt("WebGLRenderer: Unsupported uniform value type.",S),w}function x(S){const w=S.target;w.removeEventListener("dispose",x);const T=a.indexOf(w.__bindingPointIndex);a.splice(T,1),i.deleteBuffer(r[w.id]),delete r[w.id],delete s[w.id]}function _(){for(const S in r)i.deleteBuffer(r[S]);a=[],r={},s={}}return{bind:l,update:c,dispose:_}}const ade=new Uint16Array([11481,15204,11534,15171,11808,15015,12385,14843,12894,14716,13396,14600,13693,14483,13976,14366,14237,14171,14405,13961,14511,13770,14605,13598,14687,13444,14760,13305,14822,13066,14876,12857,14923,12675,14963,12517,14997,12379,15025,12230,15049,12023,15070,11843,15086,11687,15100,11551,15111,11433,15120,11330,15127,11217,15132,11060,15135,10922,15138,10801,15139,10695,15139,10600,13012,14923,13020,14917,13064,14886,13176,14800,13349,14666,13513,14526,13724,14398,13960,14230,14200,14020,14383,13827,14488,13651,14583,13491,14667,13348,14740,13132,14803,12908,14856,12713,14901,12542,14938,12394,14968,12241,14992,12017,15010,11822,15024,11654,15034,11507,15041,11380,15044,11269,15044,11081,15042,10913,15037,10764,15031,10635,15023,10520,15014,10419,15003,10330,13657,14676,13658,14673,13670,14660,13698,14622,13750,14547,13834,14442,13956,14317,14112,14093,14291,13889,14407,13704,14499,13538,14586,13389,14664,13201,14733,12966,14792,12758,14842,12577,14882,12418,14915,12272,14940,12033,14959,11826,14972,11646,14980,11490,14983,11355,14983,11212,14979,11008,14971,10830,14961,10675,14950,10540,14936,10420,14923,10315,14909,10204,14894,10041,14089,14460,14090,14459,14096,14452,14112,14431,14141,14388,14186,14305,14252,14130,14341,13941,14399,13756,14467,13585,14539,13430,14610,13272,14677,13026,14737,12808,14790,12617,14833,12449,14869,12303,14896,12065,14916,11845,14929,11655,14937,11490,14939,11347,14936,11184,14930,10970,14921,10783,14912,10621,14900,10480,14885,10356,14867,10247,14848,10062,14827,9894,14805,9745,14400,14208,14400,14206,14402,14198,14406,14174,14415,14122,14427,14035,14444,13913,14469,13767,14504,13613,14548,13463,14598,13324,14651,13082,14704,12858,14752,12658,14795,12483,14831,12330,14860,12106,14881,11875,14895,11675,14903,11501,14905,11351,14903,11178,14900,10953,14892,10757,14880,10589,14865,10442,14847,10313,14827,10162,14805,9965,14782,9792,14757,9642,14731,9507,14562,13883,14562,13883,14563,13877,14566,13862,14570,13830,14576,13773,14584,13689,14595,13582,14613,13461,14637,13336,14668,13120,14704,12897,14741,12695,14776,12516,14808,12358,14835,12150,14856,11910,14870,11701,14878,11519,14882,11361,14884,11187,14880,10951,14871,10748,14858,10572,14842,10418,14823,10286,14801,10099,14777,9897,14751,9722,14725,9567,14696,9430,14666,9309,14702,13604,14702,13604,14702,13600,14703,13591,14705,13570,14707,13533,14709,13477,14712,13400,14718,13305,14727,13106,14743,12907,14762,12716,14784,12539,14807,12380,14827,12190,14844,11943,14855,11727,14863,11539,14870,11376,14871,11204,14868,10960,14858,10748,14845,10565,14829,10406,14809,10269,14786,10058,14761,9852,14734,9671,14705,9512,14674,9374,14641,9253,14608,9076,14821,13366,14821,13365,14821,13364,14821,13358,14821,13344,14821,13320,14819,13252,14817,13145,14815,13011,14814,12858,14817,12698,14823,12539,14832,12389,14841,12214,14850,11968,14856,11750,14861,11558,14866,11390,14867,11226,14862,10972,14853,10754,14840,10565,14823,10401,14803,10259,14780,10032,14754,9820,14725,9635,14694,9473,14661,9333,14627,9203,14593,8988,14557,8798,14923,13014,14922,13014,14922,13012,14922,13004,14920,12987,14919,12957,14915,12907,14909,12834,14902,12738,14894,12623,14888,12498,14883,12370,14880,12203,14878,11970,14875,11759,14873,11569,14874,11401,14872,11243,14865,10986,14855,10762,14842,10568,14825,10401,14804,10255,14781,10017,14754,9799,14725,9611,14692,9445,14658,9301,14623,9139,14587,8920,14548,8729,14509,8562,15008,12672,15008,12672,15008,12671,15007,12667,15005,12656,15001,12637,14997,12605,14989,12556,14978,12490,14966,12407,14953,12313,14940,12136,14927,11934,14914,11742,14903,11563,14896,11401,14889,11247,14879,10992,14866,10767,14851,10570,14833,10400,14812,10252,14789,10007,14761,9784,14731,9592,14698,9424,14663,9279,14627,9088,14588,8868,14548,8676,14508,8508,14467,8360,15080,12386,15080,12386,15079,12385,15078,12383,15076,12378,15072,12367,15066,12347,15057,12315,15045,12253,15030,12138,15012,11998,14993,11845,14972,11685,14951,11530,14935,11383,14920,11228,14904,10981,14887,10762,14870,10567,14850,10397,14827,10248,14803,9997,14774,9771,14743,9578,14710,9407,14674,9259,14637,9048,14596,8826,14555,8632,14514,8464,14471,8317,14427,8182,15139,12008,15139,12008,15138,12008,15137,12007,15135,12003,15130,11990,15124,11969,15115,11929,15102,11872,15086,11794,15064,11693,15041,11581,15013,11459,14987,11336,14966,11170,14944,10944,14921,10738,14898,10552,14875,10387,14850,10239,14824,9983,14794,9758,14762,9563,14728,9392,14692,9244,14653,9014,14611,8791,14569,8597,14526,8427,14481,8281,14436,8110,14391,7885,15188,11617,15188,11617,15187,11617,15186,11618,15183,11617,15179,11612,15173,11601,15163,11581,15150,11546,15133,11495,15110,11427,15083,11346,15051,11246,15024,11057,14996,10868,14967,10687,14938,10517,14911,10362,14882,10206,14853,9956,14821,9737,14787,9543,14752,9375,14715,9228,14675,8980,14632,8760,14589,8565,14544,8395,14498,8248,14451,8049,14404,7824,14357,7630,15228,11298,15228,11298,15227,11299,15226,11301,15223,11303,15219,11302,15213,11299,15204,11290,15191,11271,15174,11217,15150,11129,15119,11015,15087,10886,15057,10744,15024,10599,14990,10455,14957,10318,14924,10143,14891,9911,14856,9701,14820,9516,14782,9352,14744,9200,14703,8946,14659,8725,14615,8533,14568,8366,14521,8220,14472,7992,14423,7770,14374,7578,14315,7408,15260,10819,15260,10819,15259,10822,15258,10826,15256,10832,15251,10836,15246,10841,15237,10838,15225,10821,15207,10788,15183,10734,15151,10660,15120,10571,15087,10469,15049,10359,15012,10249,14974,10041,14937,9837,14900,9647,14860,9475,14820,9320,14779,9147,14736,8902,14691,8688,14646,8499,14598,8335,14549,8189,14499,7940,14448,7720,14397,7529,14347,7363,14256,7218,15285,10410,15285,10411,15285,10413,15284,10418,15282,10425,15278,10434,15272,10442,15264,10449,15252,10445,15235,10433,15210,10403,15179,10358,15149,10301,15113,10218,15073,10059,15033,9894,14991,9726,14951,9565,14909,9413,14865,9273,14822,9073,14777,8845,14730,8641,14682,8459,14633,8300,14583,8129,14531,7883,14479,7670,14426,7482,14373,7321,14305,7176,14201,6939,15305,9939,15305,9940,15305,9945,15304,9955,15302,9967,15298,9989,15293,10010,15286,10033,15274,10044,15258,10045,15233,10022,15205,9975,15174,9903,15136,9808,15095,9697,15053,9578,15009,9451,14965,9327,14918,9198,14871,8973,14825,8766,14775,8579,14725,8408,14675,8259,14622,8058,14569,7821,14515,7615,14460,7435,14405,7276,14350,7108,14256,6866,14149,6653,15321,9444,15321,9445,15321,9448,15320,9458,15317,9470,15314,9490,15310,9515,15302,9540,15292,9562,15276,9579,15251,9577,15226,9559,15195,9519,15156,9463,15116,9389,15071,9304,15025,9208,14978,9023,14927,8838,14878,8661,14827,8496,14774,8344,14722,8206,14667,7973,14612,7749,14556,7555,14499,7382,14443,7229,14385,7025,14322,6791,14210,6588,14100,6409,15333,8920,15333,8921,15332,8927,15332,8943,15329,8965,15326,9002,15322,9048,15316,9106,15307,9162,15291,9204,15267,9221,15244,9221,15212,9196,15175,9134,15133,9043,15088,8930,15040,8801,14990,8665,14938,8526,14886,8391,14830,8261,14775,8087,14719,7866,14661,7664,14603,7482,14544,7322,14485,7178,14426,6936,14367,6713,14281,6517,14166,6348,14054,6198,15341,8360,15341,8361,15341,8366,15341,8379,15339,8399,15336,8431,15332,8473,15326,8527,15318,8585,15302,8632,15281,8670,15258,8690,15227,8690,15191,8664,15149,8612,15104,8543,15055,8456,15001,8360,14948,8259,14892,8122,14834,7923,14776,7734,14716,7558,14656,7397,14595,7250,14534,7070,14472,6835,14410,6628,14350,6443,14243,6283,14125,6135,14010,5889,15348,7715,15348,7717,15348,7725,15347,7745,15345,7780,15343,7836,15339,7905,15334,8e3,15326,8103,15310,8193,15293,8239,15270,8270,15240,8287,15204,8283,15163,8260,15118,8223,15067,8143,15014,8014,14958,7873,14899,7723,14839,7573,14778,7430,14715,7293,14652,7164,14588,6931,14524,6720,14460,6531,14396,6362,14330,6210,14207,6015,14086,5781,13969,5576,15352,7114,15352,7116,15352,7128,15352,7159,15350,7195,15348,7237,15345,7299,15340,7374,15332,7457,15317,7544,15301,7633,15280,7703,15251,7754,15216,7775,15176,7767,15131,7733,15079,7670,15026,7588,14967,7492,14906,7387,14844,7278,14779,7171,14714,6965,14648,6770,14581,6587,14515,6420,14448,6269,14382,6123,14299,5881,14172,5665,14049,5477,13929,5310,15355,6329,15355,6330,15355,6339,15355,6362,15353,6410,15351,6472,15349,6572,15344,6688,15337,6835,15323,6985,15309,7142,15287,7220,15260,7277,15226,7310,15188,7326,15142,7318,15090,7285,15036,7239,14976,7177,14914,7045,14849,6892,14782,6736,14714,6581,14645,6433,14576,6293,14506,6164,14438,5946,14369,5733,14270,5540,14140,5369,14014,5216,13892,5043,15357,5483,15357,5484,15357,5496,15357,5528,15356,5597,15354,5692,15351,5835,15347,6011,15339,6195,15328,6317,15314,6446,15293,6566,15268,6668,15235,6746,15197,6796,15152,6811,15101,6790,15046,6748,14985,6673,14921,6583,14854,6479,14785,6371,14714,6259,14643,6149,14571,5946,14499,5750,14428,5567,14358,5401,14242,5250,14109,5111,13980,4870,13856,4657,15359,4555,15359,4557,15358,4573,15358,4633,15357,4715,15355,4841,15353,5061,15349,5216,15342,5391,15331,5577,15318,5770,15299,5967,15274,6150,15243,6223,15206,6280,15161,6310,15111,6317,15055,6300,14994,6262,14928,6208,14860,6141,14788,5994,14715,5838,14641,5684,14566,5529,14492,5384,14418,5247,14346,5121,14216,4892,14079,4682,13948,4496,13822,4330,15359,3498,15359,3501,15359,3520,15359,3598,15358,3719,15356,3860,15355,4137,15351,4305,15344,4563,15334,4809,15321,5116,15303,5273,15280,5418,15250,5547,15214,5653,15170,5722,15120,5761,15064,5763,15002,5733,14935,5673,14865,5597,14792,5504,14716,5400,14640,5294,14563,5185,14486,5041,14410,4841,14335,4655,14191,4482,14051,4325,13918,4183,13790,4012,15360,2282,15360,2285,15360,2306,15360,2401,15359,2547,15357,2748,15355,3103,15352,3349,15345,3675,15336,4020,15324,4272,15307,4496,15285,4716,15255,4908,15220,5086,15178,5170,15128,5214,15072,5234,15010,5231,14943,5206,14871,5166,14796,5102,14718,4971,14639,4833,14559,4687,14480,4541,14402,4401,14315,4268,14167,4142,14025,3958,13888,3747,13759,3556,15360,923,15360,925,15360,946,15360,1052,15359,1214,15357,1494,15356,1892,15352,2274,15346,2663,15338,3099,15326,3393,15309,3679,15288,3980,15260,4183,15226,4325,15185,4437,15136,4517,15080,4570,15018,4591,14950,4581,14877,4545,14800,4485,14720,4411,14638,4325,14556,4231,14475,4136,14395,3988,14297,3803,14145,3628,13999,3465,13861,3314,13729,3177,15360,263,15360,264,15360,272,15360,325,15359,407,15358,548,15356,780,15352,1144,15347,1580,15339,2099,15328,2425,15312,2795,15292,3133,15264,3329,15232,3517,15191,3689,15143,3819,15088,3923,15025,3978,14956,3999,14882,3979,14804,3931,14722,3855,14639,3756,14554,3645,14470,3529,14388,3409,14279,3289,14124,3173,13975,3055,13834,2848,13701,2658,15360,49,15360,49,15360,52,15360,75,15359,111,15358,201,15356,283,15353,519,15348,726,15340,1045,15329,1415,15314,1795,15295,2173,15269,2410,15237,2649,15197,2866,15150,3054,15095,3140,15032,3196,14963,3228,14888,3236,14808,3224,14725,3191,14639,3146,14553,3088,14466,2976,14382,2836,14262,2692,14103,2549,13952,2409,13808,2278,13674,2154,15360,4,15360,4,15360,4,15360,13,15359,33,15358,59,15357,112,15353,199,15348,302,15341,456,15331,628,15316,827,15297,1082,15272,1332,15241,1601,15202,1851,15156,2069,15101,2172,15039,2256,14970,2314,14894,2348,14813,2358,14728,2344,14640,2311,14551,2263,14463,2203,14376,2133,14247,2059,14084,1915,13930,1761,13784,1609,13648,1464,15360,0,15360,0,15360,0,15360,3,15359,18,15358,26,15357,53,15354,80,15348,97,15341,165,15332,238,15318,326,15299,427,15275,529,15245,654,15207,771,15161,885,15108,994,15046,1089,14976,1170,14900,1229,14817,1266,14731,1284,14641,1282,14550,1260,14460,1223,14370,1174,14232,1116,14066,1050,13909,981,13761,910,13623,839]);let Ol=null;function ode(){return Ol===null&&(Ol=new Oa(ade,32,32,a2,bc),Ol.minFilter=Jn,Ol.magFilter=Jn,Ol.wrapS=or,Ol.wrapT=or,Ol.generateMipmaps=!1,Ol.needsUpdate=!0),Ol}class kH{constructor(e={}){const{canvas:t=CB(),context:n=null,depth:r=!0,stencil:s=!1,alpha:a=!1,antialias:o=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:d=!1,reversedDepthBuffer:p=!1}=e;this.isWebGLRenderer=!0;let m;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");m=n.getContextAttributes().alpha}else m=a;const g=new Set([l2,o2,qg]),y=new Set([za,fc,o0,l0,r2,s2]),x=new Uint32Array(4),_=new Int32Array(4);let S=null,w=null;const T=[],C=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=$o,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const E=this;let D=!1;this._outputColorSpace=Mr;let O=0,R=0,P=null,L=-1,V=null;const j=new sn,B=new sn;let J=null;const U=new pt(0);let X=0,$=t.width,Q=t.height,se=1,ye=null,we=null;const He=new sn(0,0,$,Q),De=new sn(0,0,$,Q);let Oe=!1;const fe=new L0;let ge=!1,Ne=!1;const Qe=new Bt,et=new K,Nt=new sn,Gt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let vt=!1;function Te(){return P===null?se:1}let Y=n;function Ee(G,oe){return t.getContext(G,oe)}try{const G={alpha:!0,depth:r,stencil:s,antialias:o,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Vg}`),t.addEventListener("webglcontextlost",Be,!1),t.addEventListener("webglcontextrestored",Ce,!1),t.addEventListener("webglcontextcreationerror",ct,!1),Y===null){const oe="webgl2";if(Y=Ee(oe,G),Y===null)throw Ee(oe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(G){throw G("WebGLRenderer: "+G.message),G}let Ie,Ge,Le,ot,it,ft,Z,H,ue,Se,Re,_e,Mt,st,At,bt,Pe,Xe,Rt,ie,pe,Fe,te,je;function We(){Ie=new xue(Y),Ie.init(),Fe=new LH(Y,Ie),Ge=new lue(Y,Ie,e,Fe),Le=new Zhe(Y,Ie),Ge.reversedDepthBuffer&&p&&Le.buffers.depth.setReversed(!0),ot=new bue(Y),it=new Uhe,ft=new Qhe(Y,Ie,Le,it,Ge,Fe,ot),Z=new uue(E),H=new gue(E),ue=new Moe(Y),te=new aue(Y,ue),Se=new yue(Y,ue,ot,te),Re=new Sue(Y,Se,ue,ot),Rt=new _ue(Y,Ge,ft),bt=new cue(it),_e=new zhe(E,Z,H,Ie,Ge,te,bt),Mt=new rde(E,it),st=new Bhe,At=new qhe(Ie),Xe=new sue(E,Z,H,Le,Re,m,l),Pe=new $he(E,Re,Ge),je=new sde(Y,ot,Ge,Le),ie=new oue(Y,Ie,ot),pe=new vue(Y,Ie,ot),ot.programs=_e.programs,E.capabilities=Ge,E.extensions=Ie,E.properties=it,E.renderLists=st,E.shadowMap=Pe,E.state=Le,E.info=ot}We();const Je=new nde(E,Y);this.xr=Je,this.getContext=function(){return Y},this.getContextAttributes=function(){return Y.getContextAttributes()},this.forceContextLoss=function(){const G=Ie.get("WEBGL_lose_context");G&&G.loseContext()},this.forceContextRestore=function(){const G=Ie.get("WEBGL_lose_context");G&&G.restoreContext()},this.getPixelRatio=function(){return se},this.setPixelRatio=function(G){G!==void 0&&(se=G,this.setSize($,Q,!1))},this.getSize=function(G){return G.set($,Q)},this.setSize=function(G,oe,xe=!0){if(Je.isPresenting){lt("WebGLRenderer: Can't change size while VR device is presenting.");return}$=G,Q=oe,t.width=Math.floor(G*se),t.height=Math.floor(oe*se),xe===!0&&(t.style.width=G+"px",t.style.height=oe+"px"),this.setViewport(0,0,G,oe)},this.getDrawingBufferSize=function(G){return G.set($*se,Q*se).floor()},this.setDrawingBufferSize=function(G,oe,xe){$=G,Q=oe,se=xe,t.width=Math.floor(G*xe),t.height=Math.floor(oe*xe),this.setViewport(0,0,G,oe)},this.getCurrentViewport=function(G){return G.copy(j)},this.getViewport=function(G){return G.copy(He)},this.setViewport=function(G,oe,xe,be){G.isVector4?He.set(G.x,G.y,G.z,G.w):He.set(G,oe,xe,be),Le.viewport(j.copy(He).multiplyScalar(se).round())},this.getScissor=function(G){return G.copy(De)},this.setScissor=function(G,oe,xe,be){G.isVector4?De.set(G.x,G.y,G.z,G.w):De.set(G,oe,xe,be),Le.scissor(B.copy(De).multiplyScalar(se).round())},this.getScissorTest=function(){return Oe},this.setScissorTest=function(G){Le.setScissorTest(Oe=G)},this.setOpaqueSort=function(G){ye=G},this.setTransparentSort=function(G){we=G},this.getClearColor=function(G){return G.copy(Xe.getClearColor())},this.setClearColor=function(){Xe.setClearColor(...arguments)},this.getClearAlpha=function(){return Xe.getClearAlpha()},this.setClearAlpha=function(){Xe.setClearAlpha(...arguments)},this.clear=function(G=!0,oe=!0,xe=!0){let be=0;if(G){let le=!1;if(P!==null){const tt=P.texture.format;le=g.has(tt)}if(le){const tt=P.texture.type,ut=y.has(tt),St=Xe.getClearColor(),yt=Xe.getClearAlpha(),Lt=St.r,Ut=St.g,Pt=St.b;ut?(x[0]=Lt,x[1]=Ut,x[2]=Pt,x[3]=yt,Y.clearBufferuiv(Y.COLOR,0,x)):(_[0]=Lt,_[1]=Ut,_[2]=Pt,_[3]=yt,Y.clearBufferiv(Y.COLOR,0,_))}else be|=Y.COLOR_BUFFER_BIT}oe&&(be|=Y.DEPTH_BUFFER_BIT),xe&&(be|=Y.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Y.clear(be)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Be,!1),t.removeEventListener("webglcontextrestored",Ce,!1),t.removeEventListener("webglcontextcreationerror",ct,!1),Xe.dispose(),st.dispose(),At.dispose(),it.dispose(),Z.dispose(),H.dispose(),Re.dispose(),te.dispose(),je.dispose(),_e.dispose(),Je.dispose(),Je.removeEventListener("sessionstart",_d),Je.removeEventListener("sessionend",Sd),Cr.stop()};function Be(G){G.preventDefault(),ng("WebGLRenderer: Context Lost."),D=!0}function Ce(){ng("WebGLRenderer: Context Restored."),D=!1;const G=ot.autoReset,oe=Pe.enabled,xe=Pe.autoUpdate,be=Pe.needsUpdate,le=Pe.type;We(),ot.autoReset=G,Pe.enabled=oe,Pe.autoUpdate=xe,Pe.needsUpdate=be,Pe.type=le}function ct(G){Vt("WebGLRenderer: A WebGL context could not be created. Reason: ",G.statusMessage)}function Ct(G){const oe=G.target;oe.removeEventListener("dispose",Ct),an(oe)}function an(G){tn(G),it.remove(G)}function tn(G){const oe=it.get(G).programs;oe!==void 0&&(oe.forEach(function(xe){_e.releaseProgram(xe)}),G.isShaderMaterial&&_e.releaseShaderCache(G))}this.renderBufferDirect=function(G,oe,xe,be,le,tt){oe===null&&(oe=Gt);const ut=le.isMesh&&le.matrixWorld.determinant()<0,St=dx(G,oe,xe,be,le);Le.setMaterial(be,ut);let yt=xe.index,Lt=1;if(be.wireframe===!0){if(yt=Se.getWireframeAttribute(xe),yt===void 0)return;Lt=2}const Ut=xe.drawRange,Pt=xe.attributes.position;let nn=Ut.start*Lt,Mn=(Ut.start+Ut.count)*Lt;tt!==null&&(nn=Math.max(nn,tt.start*Lt),Mn=Math.min(Mn,(tt.start+tt.count)*Lt)),yt!==null?(nn=Math.max(nn,0),Mn=Math.min(Mn,yt.count)):Pt!=null&&(nn=Math.max(nn,0),Mn=Math.min(Mn,Pt.count));const Vn=Mn-nn;if(Vn<0||Vn===1/0)return;te.setup(le,be,St,xe,yt);let $n,En=ie;if(yt!==null&&($n=ue.get(yt),En=pe,En.setIndex($n)),le.isMesh)be.wireframe===!0?(Le.setLineWidth(be.wireframeLinewidth*Te()),En.setMode(Y.LINES)):En.setMode(Y.TRIANGLES);else if(le.isLine){let Dt=be.linewidth;Dt===void 0&&(Dt=1),Le.setLineWidth(Dt*Te()),le.isLineSegments?En.setMode(Y.LINES):le.isLineLoop?En.setMode(Y.LINE_LOOP):En.setMode(Y.LINE_STRIP)}else le.isPoints?En.setMode(Y.POINTS):le.isSprite&&En.setMode(Y.TRIANGLES);if(le.isBatchedMesh)if(le._multiDrawInstances!==null)d0("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),En.renderMultiDrawInstances(le._multiDrawStarts,le._multiDrawCounts,le._multiDrawCount,le._multiDrawInstances);else if(Ie.get("WEBGL_multi_draw"))En.renderMultiDraw(le._multiDrawStarts,le._multiDrawCounts,le._multiDrawCount);else{const Dt=le._multiDrawStarts,Gn=le._multiDrawCounts,dn=le._multiDrawCount,gr=yt?ue.get(yt).bytesPerElement:1,gl=it.get(be).currentProgram.getUniforms();for(let Rr=0;Rr<dn;Rr++)gl.setValue(Y,"_gl_DrawID",Rr),En.render(Dt[Rr]/gr,Gn[Rr])}else if(le.isInstancedMesh)En.renderInstances(nn,Vn,le.count);else if(xe.isInstancedBufferGeometry){const Dt=xe._maxInstanceCount!==void 0?xe._maxInstanceCount:1/0,Gn=Math.min(xe.instanceCount,Dt);En.renderInstances(nn,Vn,Gn)}else En.render(nn,Vn)};function ji(G,oe,xe){G.transparent===!0&&G.side===co&&G.forceSinglePass===!1?(G.side=as,G.needsUpdate=!0,Sc(G,oe,xe),G.side=hc,G.needsUpdate=!0,Sc(G,oe,xe),G.side=co):Sc(G,oe,xe)}this.compile=function(G,oe,xe=null){xe===null&&(xe=G),w=At.get(xe),w.init(oe),C.push(w),xe.traverseVisible(function(le){le.isLight&&le.layers.test(oe.layers)&&(w.pushLight(le),le.castShadow&&w.pushShadow(le))}),G!==xe&&G.traverseVisible(function(le){le.isLight&&le.layers.test(oe.layers)&&(w.pushLight(le),le.castShadow&&w.pushShadow(le))}),w.setupLights();const be=new Set;return G.traverse(function(le){if(!(le.isMesh||le.isPoints||le.isLine||le.isSprite))return;const tt=le.material;if(tt)if(Array.isArray(tt))for(let ut=0;ut<tt.length;ut++){const St=tt[ut];ji(St,xe,le),be.add(St)}else ji(tt,xe,le),be.add(tt)}),w=C.pop(),be},this.compileAsync=function(G,oe,xe=null){const be=this.compile(G,oe,xe);return new Promise(le=>{function tt(){if(be.forEach(function(ut){it.get(ut).currentProgram.isReady()&&be.delete(ut)}),be.size===0){le(G);return}setTimeout(tt,10)}Ie.get("KHR_parallel_shader_compile")!==null?tt():setTimeout(tt,10)})};let Vi=null;function hx(G){Vi&&Vi(G)}function _d(){Cr.stop()}function Sd(){Cr.start()}const Cr=new RH;Cr.setAnimationLoop(hx),typeof self<"u"&&Cr.setContext(self),this.setAnimationLoop=function(G){Vi=G,Je.setAnimationLoop(G),G===null?Cr.stop():Cr.start()},Je.addEventListener("sessionstart",_d),Je.addEventListener("sessionend",Sd),this.render=function(G,oe){if(oe!==void 0&&oe.isCamera!==!0){Vt("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(D===!0)return;if(G.matrixWorldAutoUpdate===!0&&G.updateMatrixWorld(),oe.parent===null&&oe.matrixWorldAutoUpdate===!0&&oe.updateMatrixWorld(),Je.enabled===!0&&Je.isPresenting===!0&&(Je.cameraAutoUpdate===!0&&Je.updateCamera(oe),oe=Je.getCamera()),G.isScene===!0&&G.onBeforeRender(E,G,oe,P),w=At.get(G,C.length),w.init(oe),C.push(w),Qe.multiplyMatrices(oe.projectionMatrix,oe.matrixWorldInverse),fe.setFromProjectionMatrix(Qe,Js,oe.reversedDepth),Ne=this.localClippingEnabled,ge=bt.init(this.clippingPlanes,Ne),S=st.get(G,T.length),S.init(),T.push(S),Je.enabled===!0&&Je.isPresenting===!0){const tt=E.xr.getDepthSensingMesh();tt!==null&&wd(tt,oe,-1/0,E.sortObjects)}wd(G,oe,0,E.sortObjects),S.finish(),E.sortObjects===!0&&S.sort(ye,we),vt=Je.enabled===!1||Je.isPresenting===!1||Je.hasDepthSensing()===!1,vt&&Xe.addToRenderList(S,G),this.info.render.frame++,ge===!0&&bt.beginShadows();const xe=w.state.shadowsArray;Pe.render(xe,G,oe),ge===!0&&bt.endShadows(),this.info.autoReset===!0&&this.info.reset();const be=S.opaque,le=S.transmissive;if(w.setupLights(),oe.isArrayCamera){const tt=oe.cameras;if(le.length>0)for(let ut=0,St=tt.length;ut<St;ut++){const yt=tt[ut];pa(be,le,G,yt)}vt&&Xe.render(G);for(let ut=0,St=tt.length;ut<St;ut++){const yt=tt[ut];qa(S,G,yt,yt.viewport)}}else le.length>0&&pa(be,le,G,oe),vt&&Xe.render(G),qa(S,G,oe);P!==null&&R===0&&(ft.updateMultisampleRenderTarget(P),ft.updateRenderTargetMipmap(P)),G.isScene===!0&&G.onAfterRender(E,G,oe),te.resetDefaultState(),L=-1,V=null,C.pop(),C.length>0?(w=C[C.length-1],ge===!0&&bt.setGlobalState(E.clippingPlanes,w.state.camera)):w=null,T.pop(),T.length>0?S=T[T.length-1]:S=null};function wd(G,oe,xe,be){if(G.visible===!1)return;if(G.layers.test(oe.layers)){if(G.isGroup)xe=G.renderOrder;else if(G.isLOD)G.autoUpdate===!0&&G.update(oe);else if(G.isLight)w.pushLight(G),G.castShadow&&w.pushShadow(G);else if(G.isSprite){if(!G.frustumCulled||fe.intersectsSprite(G)){be&&Nt.setFromMatrixPosition(G.matrixWorld).applyMatrix4(Qe);const ut=Re.update(G),St=G.material;St.visible&&S.push(G,ut,St,xe,Nt.z,null)}}else if((G.isMesh||G.isLine||G.isPoints)&&(!G.frustumCulled||fe.intersectsObject(G))){const ut=Re.update(G),St=G.material;if(be&&(G.boundingSphere!==void 0?(G.boundingSphere===null&&G.computeBoundingSphere(),Nt.copy(G.boundingSphere.center)):(ut.boundingSphere===null&&ut.computeBoundingSphere(),Nt.copy(ut.boundingSphere.center)),Nt.applyMatrix4(G.matrixWorld).applyMatrix4(Qe)),Array.isArray(St)){const yt=ut.groups;for(let Lt=0,Ut=yt.length;Lt<Ut;Lt++){const Pt=yt[Lt],nn=St[Pt.materialIndex];nn&&nn.visible&&S.push(G,ut,nn,xe,Nt.z,Pt)}}else St.visible&&S.push(G,ut,St,xe,Nt.z,null)}}const tt=G.children;for(let ut=0,St=tt.length;ut<St;ut++)wd(tt[ut],oe,xe,be)}function qa(G,oe,xe,be){const{opaque:le,transmissive:tt,transparent:ut}=G;w.setupLightsView(xe),ge===!0&&bt.setGlobalState(E.clippingPlanes,xe),be&&Le.viewport(j.copy(be)),le.length>0&&ml(le,oe,xe),tt.length>0&&ml(tt,oe,xe),ut.length>0&&ml(ut,oe,xe),Le.buffers.depth.setTest(!0),Le.buffers.depth.setMask(!0),Le.buffers.color.setMask(!0),Le.setPolygonOffset(!1)}function pa(G,oe,xe,be){if((xe.isScene===!0?xe.overrideMaterial:null)!==null)return;w.state.transmissionRenderTarget[be.id]===void 0&&(w.state.transmissionRenderTarget[be.id]=new go(1,1,{generateMipmaps:!0,type:Ie.has("EXT_color_buffer_half_float")||Ie.has("EXT_color_buffer_float")?bc:za,minFilter:Ho,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:fn.workingColorSpace}));const tt=w.state.transmissionRenderTarget[be.id],ut=be.viewport||j;tt.setSize(ut.z*E.transmissionResolutionScale,ut.w*E.transmissionResolutionScale);const St=E.getRenderTarget(),yt=E.getActiveCubeFace(),Lt=E.getActiveMipmapLevel();E.setRenderTarget(tt),E.getClearColor(U),X=E.getClearAlpha(),X<1&&E.setClearColor(16777215,.5),E.clear(),vt&&Xe.render(xe);const Ut=E.toneMapping;E.toneMapping=$o;const Pt=be.viewport;if(be.viewport!==void 0&&(be.viewport=void 0),w.setupLightsView(be),ge===!0&&bt.setGlobalState(E.clippingPlanes,be),ml(G,xe,be),ft.updateMultisampleRenderTarget(tt),ft.updateRenderTargetMipmap(tt),Ie.has("WEBGL_multisampled_render_to_texture")===!1){let nn=!1;for(let Mn=0,Vn=oe.length;Mn<Vn;Mn++){const $n=oe[Mn],{object:En,geometry:Dt,material:Gn,group:dn}=$n;if(Gn.side===co&&En.layers.test(be.layers)){const gr=Gn.side;Gn.side=as,Gn.needsUpdate=!0,ti(En,xe,be,Dt,Gn,dn),Gn.side=gr,Gn.needsUpdate=!0,nn=!0}}nn===!0&&(ft.updateMultisampleRenderTarget(tt),ft.updateRenderTargetMipmap(tt))}E.setRenderTarget(St,yt,Lt),E.setClearColor(U,X),Pt!==void 0&&(be.viewport=Pt),E.toneMapping=Ut}function ml(G,oe,xe){const be=oe.isScene===!0?oe.overrideMaterial:null;for(let le=0,tt=G.length;le<tt;le++){const ut=G[le],{object:St,geometry:yt,group:Lt}=ut;let Ut=ut.material;Ut.allowOverride===!0&&be!==null&&(Ut=be),St.layers.test(xe.layers)&&ti(St,oe,xe,yt,Ut,Lt)}}function ti(G,oe,xe,be,le,tt){G.onBeforeRender(E,oe,xe,be,le,tt),G.modelViewMatrix.multiplyMatrices(xe.matrixWorldInverse,G.matrixWorld),G.normalMatrix.getNormalMatrix(G.modelViewMatrix),le.onBeforeRender(E,oe,xe,be,G,tt),le.transparent===!0&&le.side===co&&le.forceSinglePass===!1?(le.side=as,le.needsUpdate=!0,E.renderBufferDirect(xe,oe,be,le,G,tt),le.side=hc,le.needsUpdate=!0,E.renderBufferDirect(xe,oe,be,le,G,tt),le.side=co):E.renderBufferDirect(xe,oe,be,le,G,tt),G.onAfterRender(E,oe,xe,be,le,tt)}function Sc(G,oe,xe){oe.isScene!==!0&&(oe=Gt);const be=it.get(G),le=w.state.lights,tt=w.state.shadowsArray,ut=le.state.version,St=_e.getParameters(G,le.state,tt,oe,xe),yt=_e.getProgramCacheKey(St);let Lt=be.programs;be.environment=G.isMeshStandardMaterial?oe.environment:null,be.fog=oe.fog,be.envMap=(G.isMeshStandardMaterial?H:Z).get(G.envMap||be.environment),be.envMapRotation=be.environment!==null&&G.envMap===null?oe.environmentRotation:G.envMapRotation,Lt===void 0&&(G.addEventListener("dispose",Ct),Lt=new Map,be.programs=Lt);let Ut=Lt.get(yt);if(Ut!==void 0){if(be.currentProgram===Ut&&be.lightsStateVersion===ut)return W0(G,St),Ut}else St.uniforms=_e.getUniforms(G),G.onBeforeCompile(St,E),Ut=_e.acquireProgram(St,yt),Lt.set(yt,Ut),be.uniforms=St.uniforms;const Pt=be.uniforms;return(!G.isShaderMaterial&&!G.isRawShaderMaterial||G.clipping===!0)&&(Pt.clippingPlanes=bt.uniform),W0(G,St),be.needsLights=q0(G),be.lightsStateVersion=ut,be.needsLights&&(Pt.ambientLightColor.value=le.state.ambient,Pt.lightProbe.value=le.state.probe,Pt.directionalLights.value=le.state.directional,Pt.directionalLightShadows.value=le.state.directionalShadow,Pt.spotLights.value=le.state.spot,Pt.spotLightShadows.value=le.state.spotShadow,Pt.rectAreaLights.value=le.state.rectArea,Pt.ltc_1.value=le.state.rectAreaLTC1,Pt.ltc_2.value=le.state.rectAreaLTC2,Pt.pointLights.value=le.state.point,Pt.pointLightShadows.value=le.state.pointShadow,Pt.hemisphereLights.value=le.state.hemi,Pt.directionalShadowMap.value=le.state.directionalShadowMap,Pt.directionalShadowMatrix.value=le.state.directionalShadowMatrix,Pt.spotShadowMap.value=le.state.spotShadowMap,Pt.spotLightMatrix.value=le.state.spotLightMatrix,Pt.spotLightMap.value=le.state.spotLightMap,Pt.pointShadowMap.value=le.state.pointShadowMap,Pt.pointShadowMatrix.value=le.state.pointShadowMatrix),be.currentProgram=Ut,be.uniformsList=null,Ut}function Md(G){if(G.uniformsList===null){const oe=G.currentProgram.getUniforms();G.uniformsList=ky.seqWithValue(oe.seq,G.uniforms)}return G.uniformsList}function W0(G,oe){const xe=it.get(G);xe.outputColorSpace=oe.outputColorSpace,xe.batching=oe.batching,xe.batchingColor=oe.batchingColor,xe.instancing=oe.instancing,xe.instancingColor=oe.instancingColor,xe.instancingMorph=oe.instancingMorph,xe.skinning=oe.skinning,xe.morphTargets=oe.morphTargets,xe.morphNormals=oe.morphNormals,xe.morphColors=oe.morphColors,xe.morphTargetsCount=oe.morphTargetsCount,xe.numClippingPlanes=oe.numClippingPlanes,xe.numIntersection=oe.numClipIntersection,xe.vertexAlphas=oe.vertexAlphas,xe.vertexTangents=oe.vertexTangents,xe.toneMapping=oe.toneMapping}function dx(G,oe,xe,be,le){oe.isScene!==!0&&(oe=Gt),ft.resetTextureUnits();const tt=oe.fog,ut=be.isMeshStandardMaterial?oe.environment:null,St=P===null?E.outputColorSpace:P.isXRRenderTarget===!0?P.texture.colorSpace:yu,yt=(be.isMeshStandardMaterial?H:Z).get(be.envMap||ut),Lt=be.vertexColors===!0&&!!xe.attributes.color&&xe.attributes.color.itemSize===4,Ut=!!xe.attributes.tangent&&(!!be.normalMap||be.anisotropy>0),Pt=!!xe.morphAttributes.position,nn=!!xe.morphAttributes.normal,Mn=!!xe.morphAttributes.color;let Vn=$o;be.toneMapped&&(P===null||P.isXRRenderTarget===!0)&&(Vn=E.toneMapping);const $n=xe.morphAttributes.position||xe.morphAttributes.normal||xe.morphAttributes.color,En=$n!==void 0?$n.length:0,Dt=it.get(be),Gn=w.state.lights;if(ge===!0&&(Ne===!0||G!==V)){const Qi=G===V&&be.id===L;bt.setState(be,G,Qi)}let dn=!1;be.version===Dt.__version?(Dt.needsLights&&Dt.lightsStateVersion!==Gn.state.version||Dt.outputColorSpace!==St||le.isBatchedMesh&&Dt.batching===!1||!le.isBatchedMesh&&Dt.batching===!0||le.isBatchedMesh&&Dt.batchingColor===!0&&le.colorTexture===null||le.isBatchedMesh&&Dt.batchingColor===!1&&le.colorTexture!==null||le.isInstancedMesh&&Dt.instancing===!1||!le.isInstancedMesh&&Dt.instancing===!0||le.isSkinnedMesh&&Dt.skinning===!1||!le.isSkinnedMesh&&Dt.skinning===!0||le.isInstancedMesh&&Dt.instancingColor===!0&&le.instanceColor===null||le.isInstancedMesh&&Dt.instancingColor===!1&&le.instanceColor!==null||le.isInstancedMesh&&Dt.instancingMorph===!0&&le.morphTexture===null||le.isInstancedMesh&&Dt.instancingMorph===!1&&le.morphTexture!==null||Dt.envMap!==yt||be.fog===!0&&Dt.fog!==tt||Dt.numClippingPlanes!==void 0&&(Dt.numClippingPlanes!==bt.numPlanes||Dt.numIntersection!==bt.numIntersection)||Dt.vertexAlphas!==Lt||Dt.vertexTangents!==Ut||Dt.morphTargets!==Pt||Dt.morphNormals!==nn||Dt.morphColors!==Mn||Dt.toneMapping!==Vn||Dt.morphTargetsCount!==En)&&(dn=!0):(dn=!0,Dt.__version=be.version);let gr=Dt.currentProgram;dn===!0&&(gr=Sc(be,oe,le));let gl=!1,Rr=!1,wc=!1;const Wn=gr.getUniforms(),xr=Dt.uniforms;if(Le.useProgram(gr.program)&&(gl=!0,Rr=!0,wc=!0),be.id!==L&&(L=be.id,Rr=!0),gl||V!==G){Le.buffers.depth.getReversed()&&G.reversedDepth!==!0&&(G._reversedDepth=!0,G.updateProjectionMatrix()),Wn.setValue(Y,"projectionMatrix",G.projectionMatrix),Wn.setValue(Y,"viewMatrix",G.matrixWorldInverse);const Ci=Wn.map.cameraPosition;Ci!==void 0&&Ci.setValue(Y,et.setFromMatrixPosition(G.matrixWorld)),Ge.logarithmicDepthBuffer&&Wn.setValue(Y,"logDepthBufFC",2/(Math.log(G.far+1)/Math.LN2)),(be.isMeshPhongMaterial||be.isMeshToonMaterial||be.isMeshLambertMaterial||be.isMeshBasicMaterial||be.isMeshStandardMaterial||be.isShaderMaterial)&&Wn.setValue(Y,"isOrthographic",G.isOrthographicCamera===!0),V!==G&&(V=G,Rr=!0,wc=!0)}if(le.isSkinnedMesh){Wn.setOptional(Y,le,"bindMatrix"),Wn.setOptional(Y,le,"bindMatrixInverse");const Qi=le.skeleton;Qi&&(Qi.boneTexture===null&&Qi.computeBoneTexture(),Wn.setValue(Y,"boneTexture",Qi.boneTexture,ft))}le.isBatchedMesh&&(Wn.setOptional(Y,le,"batchingTexture"),Wn.setValue(Y,"batchingTexture",le._matricesTexture,ft),Wn.setOptional(Y,le,"batchingIdTexture"),Wn.setValue(Y,"batchingIdTexture",le._indirectTexture,ft),Wn.setOptional(Y,le,"batchingColorTexture"),le._colorsTexture!==null&&Wn.setValue(Y,"batchingColorTexture",le._colorsTexture,ft));const cs=xe.morphAttributes;if((cs.position!==void 0||cs.normal!==void 0||cs.color!==void 0)&&Rt.update(le,xe,gr),(Rr||Dt.receiveShadow!==le.receiveShadow)&&(Dt.receiveShadow=le.receiveShadow,Wn.setValue(Y,"receiveShadow",le.receiveShadow)),be.isMeshGouraudMaterial&&be.envMap!==null&&(xr.envMap.value=yt,xr.flipEnvMap.value=yt.isCubeTexture&&yt.isRenderTargetTexture===!1?-1:1),be.isMeshStandardMaterial&&be.envMap===null&&oe.environment!==null&&(xr.envMapIntensity.value=oe.environmentIntensity),xr.dfgLUT!==void 0&&(xr.dfgLUT.value=ode()),Rr&&(Wn.setValue(Y,"toneMappingExposure",E.toneMappingExposure),Dt.needsLights&&m_(xr,wc),tt&&be.fog===!0&&Mt.refreshFogUniforms(xr,tt),Mt.refreshMaterialUniforms(xr,be,se,Q,w.state.transmissionRenderTarget[G.id]),ky.upload(Y,Md(Dt),xr,ft)),be.isShaderMaterial&&be.uniformsNeedUpdate===!0&&(ky.upload(Y,Md(Dt),xr,ft),be.uniformsNeedUpdate=!1),be.isSpriteMaterial&&Wn.setValue(Y,"center",le.center),Wn.setValue(Y,"modelViewMatrix",le.modelViewMatrix),Wn.setValue(Y,"normalMatrix",le.normalMatrix),Wn.setValue(Y,"modelMatrix",le.matrixWorld),be.isShaderMaterial||be.isRawShaderMaterial){const Qi=be.uniformsGroups;for(let Ci=0,Td=Qi.length;Ci<Td;Ci++){const ma=Qi[Ci];je.update(ma,gr),je.bind(ma,gr)}}return gr}function m_(G,oe){G.ambientLightColor.needsUpdate=oe,G.lightProbe.needsUpdate=oe,G.directionalLights.needsUpdate=oe,G.directionalLightShadows.needsUpdate=oe,G.pointLights.needsUpdate=oe,G.pointLightShadows.needsUpdate=oe,G.spotLights.needsUpdate=oe,G.spotLightShadows.needsUpdate=oe,G.rectAreaLights.needsUpdate=oe,G.hemisphereLights.needsUpdate=oe}function q0(G){return G.isMeshLambertMaterial||G.isMeshToonMaterial||G.isMeshPhongMaterial||G.isMeshStandardMaterial||G.isShadowMaterial||G.isShaderMaterial&&G.lights===!0}this.getActiveCubeFace=function(){return O},this.getActiveMipmapLevel=function(){return R},this.getRenderTarget=function(){return P},this.setRenderTargetTextures=function(G,oe,xe){const be=it.get(G);be.__autoAllocateDepthBuffer=G.resolveDepthBuffer===!1,be.__autoAllocateDepthBuffer===!1&&(be.__useRenderToTexture=!1),it.get(G.texture).__webglTexture=oe,it.get(G.depthTexture).__webglTexture=be.__autoAllocateDepthBuffer?void 0:xe,be.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(G,oe){const xe=it.get(G);xe.__webglFramebuffer=oe,xe.__useDefaultFramebuffer=oe===void 0};const X0=Y.createFramebuffer();this.setRenderTarget=function(G,oe=0,xe=0){P=G,O=oe,R=xe;let be=!0,le=null,tt=!1,ut=!1;if(G){const yt=it.get(G);if(yt.__useDefaultFramebuffer!==void 0)Le.bindFramebuffer(Y.FRAMEBUFFER,null),be=!1;else if(yt.__webglFramebuffer===void 0)ft.setupRenderTarget(G);else if(yt.__hasExternalTextures)ft.rebindTextures(G,it.get(G.texture).__webglTexture,it.get(G.depthTexture).__webglTexture);else if(G.depthBuffer){const Pt=G.depthTexture;if(yt.__boundDepthTexture!==Pt){if(Pt!==null&&it.has(Pt)&&(G.width!==Pt.image.width||G.height!==Pt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");ft.setupDepthRenderbuffer(G)}}const Lt=G.texture;(Lt.isData3DTexture||Lt.isDataArrayTexture||Lt.isCompressedArrayTexture)&&(ut=!0);const Ut=it.get(G).__webglFramebuffer;G.isWebGLCubeRenderTarget?(Array.isArray(Ut[oe])?le=Ut[oe][xe]:le=Ut[oe],tt=!0):G.samples>0&&ft.useMultisampledRTT(G)===!1?le=it.get(G).__webglMultisampledFramebuffer:Array.isArray(Ut)?le=Ut[xe]:le=Ut,j.copy(G.viewport),B.copy(G.scissor),J=G.scissorTest}else j.copy(He).multiplyScalar(se).floor(),B.copy(De).multiplyScalar(se).floor(),J=Oe;if(xe!==0&&(le=X0),Le.bindFramebuffer(Y.FRAMEBUFFER,le)&&be&&Le.drawBuffers(G,le),Le.viewport(j),Le.scissor(B),Le.setScissorTest(J),tt){const yt=it.get(G.texture);Y.framebufferTexture2D(Y.FRAMEBUFFER,Y.COLOR_ATTACHMENT0,Y.TEXTURE_CUBE_MAP_POSITIVE_X+oe,yt.__webglTexture,xe)}else if(ut){const yt=oe;for(let Lt=0;Lt<G.textures.length;Lt++){const Ut=it.get(G.textures[Lt]);Y.framebufferTextureLayer(Y.FRAMEBUFFER,Y.COLOR_ATTACHMENT0+Lt,Ut.__webglTexture,xe,yt)}}else if(G!==null&&xe!==0){const yt=it.get(G.texture);Y.framebufferTexture2D(Y.FRAMEBUFFER,Y.COLOR_ATTACHMENT0,Y.TEXTURE_2D,yt.__webglTexture,xe)}L=-1},this.readRenderTargetPixels=function(G,oe,xe,be,le,tt,ut,St=0){if(!(G&&G.isWebGLRenderTarget)){Vt("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let yt=it.get(G).__webglFramebuffer;if(G.isWebGLCubeRenderTarget&&ut!==void 0&&(yt=yt[ut]),yt){Le.bindFramebuffer(Y.FRAMEBUFFER,yt);try{const Lt=G.textures[St],Ut=Lt.format,Pt=Lt.type;if(!Ge.textureFormatReadable(Ut)){Vt("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Ge.textureTypeReadable(Pt)){Vt("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}oe>=0&&oe<=G.width-be&&xe>=0&&xe<=G.height-le&&(G.textures.length>1&&Y.readBuffer(Y.COLOR_ATTACHMENT0+St),Y.readPixels(oe,xe,be,le,Fe.convert(Ut),Fe.convert(Pt),tt))}finally{const Lt=P!==null?it.get(P).__webglFramebuffer:null;Le.bindFramebuffer(Y.FRAMEBUFFER,Lt)}}},this.readRenderTargetPixelsAsync=async function(G,oe,xe,be,le,tt,ut,St=0){if(!(G&&G.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let yt=it.get(G).__webglFramebuffer;if(G.isWebGLCubeRenderTarget&&ut!==void 0&&(yt=yt[ut]),yt)if(oe>=0&&oe<=G.width-be&&xe>=0&&xe<=G.height-le){Le.bindFramebuffer(Y.FRAMEBUFFER,yt);const Lt=G.textures[St],Ut=Lt.format,Pt=Lt.type;if(!Ge.textureFormatReadable(Ut))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Ge.textureTypeReadable(Pt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const nn=Y.createBuffer();Y.bindBuffer(Y.PIXEL_PACK_BUFFER,nn),Y.bufferData(Y.PIXEL_PACK_BUFFER,tt.byteLength,Y.STREAM_READ),G.textures.length>1&&Y.readBuffer(Y.COLOR_ATTACHMENT0+St),Y.readPixels(oe,xe,be,le,Fe.convert(Ut),Fe.convert(Pt),0);const Mn=P!==null?it.get(P).__webglFramebuffer:null;Le.bindFramebuffer(Y.FRAMEBUFFER,Mn);const Vn=Y.fenceSync(Y.SYNC_GPU_COMMANDS_COMPLETE,0);return Y.flush(),await Ere(Y,Vn,4),Y.bindBuffer(Y.PIXEL_PACK_BUFFER,nn),Y.getBufferSubData(Y.PIXEL_PACK_BUFFER,0,tt),Y.deleteBuffer(nn),Y.deleteSync(Vn),tt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(G,oe=null,xe=0){const be=Math.pow(2,-xe),le=Math.floor(G.image.width*be),tt=Math.floor(G.image.height*be),ut=oe!==null?oe.x:0,St=oe!==null?oe.y:0;ft.setTexture2D(G,0),Y.copyTexSubImage2D(Y.TEXTURE_2D,xe,0,0,ut,St,le,tt),Le.unbindTexture()};const Y0=Y.createFramebuffer(),Er=Y.createFramebuffer();this.copyTextureToTexture=function(G,oe,xe=null,be=null,le=0,tt=null){tt===null&&(le!==0?(d0("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),tt=le,le=0):tt=0);let ut,St,yt,Lt,Ut,Pt,nn,Mn,Vn;const $n=G.isCompressedTexture?G.mipmaps[tt]:G.image;if(xe!==null)ut=xe.max.x-xe.min.x,St=xe.max.y-xe.min.y,yt=xe.isBox3?xe.max.z-xe.min.z:1,Lt=xe.min.x,Ut=xe.min.y,Pt=xe.isBox3?xe.min.z:0;else{const cs=Math.pow(2,-le);ut=Math.floor($n.width*cs),St=Math.floor($n.height*cs),G.isDataArrayTexture?yt=$n.depth:G.isData3DTexture?yt=Math.floor($n.depth*cs):yt=1,Lt=0,Ut=0,Pt=0}be!==null?(nn=be.x,Mn=be.y,Vn=be.z):(nn=0,Mn=0,Vn=0);const En=Fe.convert(oe.format),Dt=Fe.convert(oe.type);let Gn;oe.isData3DTexture?(ft.setTexture3D(oe,0),Gn=Y.TEXTURE_3D):oe.isDataArrayTexture||oe.isCompressedArrayTexture?(ft.setTexture2DArray(oe,0),Gn=Y.TEXTURE_2D_ARRAY):(ft.setTexture2D(oe,0),Gn=Y.TEXTURE_2D),Y.pixelStorei(Y.UNPACK_FLIP_Y_WEBGL,oe.flipY),Y.pixelStorei(Y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,oe.premultiplyAlpha),Y.pixelStorei(Y.UNPACK_ALIGNMENT,oe.unpackAlignment);const dn=Y.getParameter(Y.UNPACK_ROW_LENGTH),gr=Y.getParameter(Y.UNPACK_IMAGE_HEIGHT),gl=Y.getParameter(Y.UNPACK_SKIP_PIXELS),Rr=Y.getParameter(Y.UNPACK_SKIP_ROWS),wc=Y.getParameter(Y.UNPACK_SKIP_IMAGES);Y.pixelStorei(Y.UNPACK_ROW_LENGTH,$n.width),Y.pixelStorei(Y.UNPACK_IMAGE_HEIGHT,$n.height),Y.pixelStorei(Y.UNPACK_SKIP_PIXELS,Lt),Y.pixelStorei(Y.UNPACK_SKIP_ROWS,Ut),Y.pixelStorei(Y.UNPACK_SKIP_IMAGES,Pt);const Wn=G.isDataArrayTexture||G.isData3DTexture,xr=oe.isDataArrayTexture||oe.isData3DTexture;if(G.isDepthTexture){const cs=it.get(G),Qi=it.get(oe),Ci=it.get(cs.__renderTarget),Td=it.get(Qi.__renderTarget);Le.bindFramebuffer(Y.READ_FRAMEBUFFER,Ci.__webglFramebuffer),Le.bindFramebuffer(Y.DRAW_FRAMEBUFFER,Td.__webglFramebuffer);for(let ma=0;ma<yt;ma++)Wn&&(Y.framebufferTextureLayer(Y.READ_FRAMEBUFFER,Y.COLOR_ATTACHMENT0,it.get(G).__webglTexture,le,Pt+ma),Y.framebufferTextureLayer(Y.DRAW_FRAMEBUFFER,Y.COLOR_ATTACHMENT0,it.get(oe).__webglTexture,tt,Vn+ma)),Y.blitFramebuffer(Lt,Ut,ut,St,nn,Mn,ut,St,Y.DEPTH_BUFFER_BIT,Y.NEAREST);Le.bindFramebuffer(Y.READ_FRAMEBUFFER,null),Le.bindFramebuffer(Y.DRAW_FRAMEBUFFER,null)}else if(le!==0||G.isRenderTargetTexture||it.has(G)){const cs=it.get(G),Qi=it.get(oe);Le.bindFramebuffer(Y.READ_FRAMEBUFFER,Y0),Le.bindFramebuffer(Y.DRAW_FRAMEBUFFER,Er);for(let Ci=0;Ci<yt;Ci++)Wn?Y.framebufferTextureLayer(Y.READ_FRAMEBUFFER,Y.COLOR_ATTACHMENT0,cs.__webglTexture,le,Pt+Ci):Y.framebufferTexture2D(Y.READ_FRAMEBUFFER,Y.COLOR_ATTACHMENT0,Y.TEXTURE_2D,cs.__webglTexture,le),xr?Y.framebufferTextureLayer(Y.DRAW_FRAMEBUFFER,Y.COLOR_ATTACHMENT0,Qi.__webglTexture,tt,Vn+Ci):Y.framebufferTexture2D(Y.DRAW_FRAMEBUFFER,Y.COLOR_ATTACHMENT0,Y.TEXTURE_2D,Qi.__webglTexture,tt),le!==0?Y.blitFramebuffer(Lt,Ut,ut,St,nn,Mn,ut,St,Y.COLOR_BUFFER_BIT,Y.NEAREST):xr?Y.copyTexSubImage3D(Gn,tt,nn,Mn,Vn+Ci,Lt,Ut,ut,St):Y.copyTexSubImage2D(Gn,tt,nn,Mn,Lt,Ut,ut,St);Le.bindFramebuffer(Y.READ_FRAMEBUFFER,null),Le.bindFramebuffer(Y.DRAW_FRAMEBUFFER,null)}else xr?G.isDataTexture||G.isData3DTexture?Y.texSubImage3D(Gn,tt,nn,Mn,Vn,ut,St,yt,En,Dt,$n.data):oe.isCompressedArrayTexture?Y.compressedTexSubImage3D(Gn,tt,nn,Mn,Vn,ut,St,yt,En,$n.data):Y.texSubImage3D(Gn,tt,nn,Mn,Vn,ut,St,yt,En,Dt,$n):G.isDataTexture?Y.texSubImage2D(Y.TEXTURE_2D,tt,nn,Mn,ut,St,En,Dt,$n.data):G.isCompressedTexture?Y.compressedTexSubImage2D(Y.TEXTURE_2D,tt,nn,Mn,$n.width,$n.height,En,$n.data):Y.texSubImage2D(Y.TEXTURE_2D,tt,nn,Mn,ut,St,En,Dt,$n);Y.pixelStorei(Y.UNPACK_ROW_LENGTH,dn),Y.pixelStorei(Y.UNPACK_IMAGE_HEIGHT,gr),Y.pixelStorei(Y.UNPACK_SKIP_PIXELS,gl),Y.pixelStorei(Y.UNPACK_SKIP_ROWS,Rr),Y.pixelStorei(Y.UNPACK_SKIP_IMAGES,wc),tt===0&&oe.generateMipmaps&&Y.generateMipmap(Gn),Le.unbindTexture()},this.initRenderTarget=function(G){it.get(G).__webglFramebuffer===void 0&&ft.setupRenderTarget(G)},this.initTexture=function(G){G.isCubeTexture?ft.setTextureCube(G,0):G.isData3DTexture?ft.setTexture3D(G,0):G.isDataArrayTexture||G.isCompressedArrayTexture?ft.setTexture2DArray(G,0):ft.setTexture2D(G,0),Le.unbindTexture()},this.resetState=function(){O=0,R=0,P=null,Le.reset(),te.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Js}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=fn._getDrawingBufferColorSpace(e),t.unpackColorSpace=fn._getUnpackColorSpace()}}const lde=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:qT,AddEquation:Kc,AddOperation:sB,AdditiveAnimationBlendMode:eA,AdditiveBlending:x5,AgXToneMapping:uB,AlphaFormat:QT,AlwaysCompare:TB,AlwaysDepth:hv,AlwaysStencilFunc:_5,AmbientLight:xH,AnimationAction:TH,AnimationClip:cg,AnimationLoader:xae,AnimationMixer:qae,AnimationObjectGroup:Gae,AnimationUtils:fae,ArcCurve:VB,ArrayCamera:SH,ArrowHelper:moe,AttachedBindMode:b5,Audio:wH,AudioAnalyser:Lae,AudioContext:EA,AudioListener:Iae,AudioLoader:Eae,AxesHelper:goe,BackSide:as,BasicDepthPacking:gB,BasicShadowMap:FF,BatchedMesh:UB,Bone:cA,BooleanKeyframeTrack:md,Box2:eoe,Box3:Xi,Box3Helper:foe,BoxGeometry:pd,BoxHelper:doe,BufferAttribute:kn,BufferGeometry:Yt,BufferGeometryLoader:_H,ByteType:YT,Cache:jo,Camera:d2,CameraHelper:hoe,CanvasTexture:Ose,CapsuleGeometry:b2,CatmullRomCurve3:GB,CineonToneMapping:lB,CircleGeometry:_2,ClampToEdgeWrapping:or,Clock:RA,Color:pt,ColorKeyframeTrack:MA,ColorManagement:fn,CompressedArrayTexture:Lse,CompressedCubeTexture:kse,CompressedTexture:y2,CompressedTextureLoader:yae,ConeGeometry:$g,ConstantAlphaFactor:nB,ConstantColorFactor:eB,Controls:yoe,CubeCamera:IB,CubeReflectionMapping:dc,CubeRefractionMapping:xu,CubeTexture:Xg,CubeTextureLoader:vae,CubeUVReflectionMapping:N0,CubicBezierCurve:fA,CubicBezierCurve3:WB,CubicInterpolant:cH,CullFaceBack:g5,CullFaceFront:UF,CullFaceFrontBack:jie,CullFaceNone:zF,Curve:bo,CurvePath:XB,CustomBlending:BF,CustomToneMapping:cB,CylinderGeometry:Yg,Cylindrical:Jae,Data3DTexture:h2,DataArrayTexture:u2,DataTexture:Oa,DataTextureLoader:bae,DataUtils:sse,DecrementStencilOp:nre,DecrementWrapStencilOp:rre,DefaultLoadingManager:dH,DepthFormat:c0,DepthStencilFormat:u0,DepthTexture:v2,DetachedBindMode:dB,DirectionalLight:gH,DirectionalLightHelper:uoe,DiscreteInterpolant:uH,DodecahedronGeometry:S2,DoubleSide:co,DstAlphaFactor:$F,DstColorFactor:ZF,DynamicCopyUsage:vre,DynamicDrawUsage:fre,DynamicReadUsage:gre,EdgesGeometry:jB,EllipseCurve:w2,EqualCompare:_B,EqualDepth:fv,EqualStencilFunc:lre,EquirectangularReflectionMapping:Xm,EquirectangularRefractionMapping:Ym,Euler:la,EventDispatcher:ul,ExternalTexture:hA,ExtrudeGeometry:M2,FileLoader:pc,Float16BufferAttribute:dse,Float32BufferAttribute:_t,FloatType:ns,Fog:p2,FogExp2:f2,FramebufferTexture:Nse,FrontSide:hc,Frustum:L0,FrustumArray:x2,GLBufferAttribute:Kae,GLSL1:_re,GLSL3:S5,GreaterCompare:SB,GreaterDepth:mv,GreaterEqualCompare:MB,GreaterEqualDepth:pv,GreaterEqualStencilFunc:dre,GreaterStencilFunc:ure,GridHelper:loe,Group:Of,HalfFloatType:bc,HemisphereLight:fH,HemisphereLightHelper:ooe,IcosahedronGeometry:T2,ImageBitmapLoader:Cae,ImageLoader:ug,ImageUtils:EB,IncrementStencilOp:tre,IncrementWrapStencilOp:ire,InstancedBufferAttribute:g0,InstancedBufferGeometry:CA,InstancedInterleavedBuffer:Kv,InstancedMesh:zB,Int16BufferAttribute:use,Int32BufferAttribute:hse,Int8BufferAttribute:ose,IntType:i2,InterleavedBuffer:m2,InterleavedBufferAttribute:ea,Interpolant:Qg,InterpolateDiscrete:Zm,InterpolateLinear:Wv,InterpolateSmooth:Ny,InterpolationSamplingMode:Mre,InterpolationSamplingType:wre,InvertStencilOp:sre,KeepStencilOp:Ph,KeyframeTrack:Ga,LOD:kB,LatheGeometry:A2,Layers:p0,LessCompare:bB,LessDepth:dv,LessEqualCompare:tA,LessEqualDepth:Jh,LessEqualStencilFunc:cre,LessStencilFunc:ore,Light:Ou,LightProbe:bH,Line:bu,Line3:CH,LineBasicMaterial:os,LineCurve:pA,LineCurve3:qB,LineDashedMaterial:aH,LineLoop:FB,LineSegments:hl,LinearFilter:Jn,LinearInterpolant:wA,LinearMipMapLinearFilter:qie,LinearMipMapNearestFilter:Wie,LinearMipmapLinearFilter:Ho,LinearMipmapNearestFilter:pm,LinearSRGBColorSpace:yu,LinearToneMapping:aB,LinearTransfer:Jm,Loader:Ns,LoaderUtils:C5,LoadingManager:TA,LoopOnce:fB,LoopPingPong:mB,LoopRepeat:pB,MOUSE:Vl,Material:Wr,MaterialLoader:N2,MathUtils:iA,Matrix2:DA,Matrix3:qt,Matrix4:Bt,MaxEquation:GF,Mesh:Bi,MeshBasicMaterial:Lu,MeshDepthMaterial:bA,MeshDistanceMaterial:_A,MeshLambertMaterial:rH,MeshMatcapMaterial:sH,MeshNormalMaterial:iH,MeshPhongMaterial:tH,MeshPhysicalMaterial:eH,MeshStandardMaterial:vA,MeshToonMaterial:nH,MinEquation:VF,MirroredRepeatWrapping:Km,MixOperation:rB,MultiplyBlending:v5,MultiplyOperation:Gg,NearestFilter:qi,NearestMipMapLinearFilter:Gie,NearestMipMapNearestFilter:Vie,NearestMipmapLinearFilter:Lf,NearestMipmapNearestFilter:XT,NeutralToneMapping:hB,NeverCompare:vB,NeverDepth:uv,NeverStencilFunc:are,NoBlending:Yo,NoColorSpace:Yl,NoToneMapping:$o,NormalAnimationBlendMode:c2,NormalBlending:Gh,NotEqualCompare:wB,NotEqualDepth:gv,NotEqualStencilFunc:hre,NumberKeyframeTrack:og,Object3D:xn,ObjectLoader:Tae,ObjectSpaceNormalMap:yB,OctahedronGeometry:Kg,OneFactor:qF,OneMinusConstantAlphaFactor:iB,OneMinusConstantColorFactor:tB,OneMinusDstAlphaFactor:KF,OneMinusDstColorFactor:QF,OneMinusSrcAlphaFactor:cv,OneMinusSrcColorFactor:YF,OrthographicCamera:uu,PCFShadowMap:t2,PCFSoftShadowMap:fm,PMREMGenerator:I5,Path:$v,PerspectiveCamera:Pi,Plane:Wl,PlaneGeometry:k0,PlaneHelper:poe,PointLight:mH,PointLightHelper:soe,Points:BB,PointsMaterial:uA,PolarGridHelper:coe,PolyhedronGeometry:ku,PositionalAudio:Nae,PropertyBinding:gn,PropertyMixer:MH,QuadraticBezierCurve:mA,QuadraticBezierCurve3:gA,Quaternion:Vr,QuaternionKeyframeTrack:Jg,QuaternionLinearInterpolant:hH,RED_GREEN_RGTC2_Format:Vv,RED_RGTC1_Format:Hv,REVISION:Vg,RGBADepthPacking:xB,RGBAFormat:Fr,RGBAIntegerFormat:l2,RGBA_ASTC_10x10_Format:kv,RGBA_ASTC_10x5_Format:Dv,RGBA_ASTC_10x6_Format:Nv,RGBA_ASTC_10x8_Format:Lv,RGBA_ASTC_12x10_Format:Ov,RGBA_ASTC_12x12_Format:zv,RGBA_ASTC_4x4_Format:Mv,RGBA_ASTC_5x4_Format:Tv,RGBA_ASTC_5x5_Format:Av,RGBA_ASTC_6x5_Format:Cv,RGBA_ASTC_6x6_Format:Ev,RGBA_ASTC_8x5_Format:Rv,RGBA_ASTC_8x6_Format:Pv,RGBA_ASTC_8x8_Format:Iv,RGBA_BPTC_Format:Uv,RGBA_ETC2_EAC_Format:wv,RGBA_PVRTC_2BPPV1_Format:bv,RGBA_PVRTC_4BPPV1_Format:vv,RGBA_S3TC_DXT1_Format:gm,RGBA_S3TC_DXT3_Format:xm,RGBA_S3TC_DXT5_Format:ym,RGBDepthPacking:Zie,RGBFormat:JT,RGBIntegerFormat:Xie,RGB_BPTC_SIGNED_Format:Fv,RGB_BPTC_UNSIGNED_Format:Bv,RGB_ETC1_Format:_v,RGB_ETC2_Format:Sv,RGB_PVRTC_2BPPV1_Format:yv,RGB_PVRTC_4BPPV1_Format:xv,RGB_S3TC_DXT1_Format:mm,RGDepthPacking:Qie,RGFormat:a2,RGIntegerFormat:o2,RawShaderMaterial:JB,Ray:fd,Raycaster:AH,RectAreaLight:yH,RedFormat:Wg,RedIntegerFormat:qg,ReinhardToneMapping:oB,RenderTarget:rA,RenderTarget3D:Xae,RepeatWrapping:$m,ReplaceStencilOp:ere,ReverseSubtractEquation:jF,RingGeometry:C2,SIGNED_RED_GREEN_RGTC2_Format:Gv,SIGNED_RED_RGTC1_Format:jv,SRGBColorSpace:Mr,SRGBTransfer:Pn,Scene:oA,ShaderChunk:Zt,ShaderLib:ao,ShaderMaterial:Ps,ShadowMaterial:QB,Shape:qh,ShapeGeometry:E2,ShapePath:xoe,ShapeUtils:ho,ShortType:$T,Skeleton:g2,SkeletonHelper:roe,SkinnedMesh:OB,Source:iu,Sphere:Yi,SphereGeometry:Zg,Spherical:R5,SphericalHarmonics3:vH,SplineCurve:xA,SpotLight:pH,SpotLightHelper:ioe,Sprite:LB,SpriteMaterial:lA,SrcAlphaFactor:lv,SrcAlphaSaturateFactor:JF,SrcColorFactor:XF,StaticCopyUsage:yre,StaticDrawUsage:eg,StaticReadUsage:mre,StereoCamera:Rae,StreamCopyUsage:bre,StreamDrawUsage:pre,StreamReadUsage:xre,StringKeyframeTrack:gd,SubtractEquation:HF,SubtractiveBlending:y5,TOUCH:Gl,TangentSpaceNormalMap:Nu,TetrahedronGeometry:R2,Texture:ri,TextureLoader:_ae,TextureUtils:woe,Timer:Zae,TimestampQuery:Sre,TorusGeometry:P2,TorusKnotGeometry:I2,Triangle:Ss,TriangleFanDrawMode:Kie,TriangleStripDrawMode:$ie,TrianglesDrawMode:Yie,TubeGeometry:D2,UVMapping:n2,Uint16BufferAttribute:sA,Uint32BufferAttribute:aA,Uint8BufferAttribute:lse,Uint8ClampedBufferAttribute:cse,Uniform:L2,UniformsGroup:$ae,UniformsLib:at,UniformsUtils:ig,UnsignedByteType:za,UnsignedInt101111Type:ZT,UnsignedInt248Type:l0,UnsignedInt5999Type:KT,UnsignedIntType:fc,UnsignedShort4444Type:r2,UnsignedShort5551Type:s2,UnsignedShortType:o0,VSMShadowMap:io,Vector2:Me,Vector3:K,Vector4:sn,VectorKeyframeTrack:lg,VideoFrameTexture:Dse,VideoTexture:HB,WebGL3DRenderTarget:$re,WebGLArrayRenderTarget:Yre,WebGLCoordinateSystem:Js,WebGLCubeRenderTarget:DB,WebGLRenderTarget:go,WebGLRenderer:kH,WebGLUtils:LH,WebGPUCoordinateSystem:h0,WebXRController:Ly,WireframeGeometry:yA,WrapAroundEnding:Qm,ZeroCurvatureEnding:kh,ZeroFactor:WF,ZeroSlopeEnding:Oh,ZeroStencilOp:Jie,createCanvasElement:CB,error:Vt,getConsoleFunction:Cre,log:ng,setConsoleFunction:Are,warn:lt,warnOnce:d0},Symbol.toStringTag,{value:"Module"})),{useSyncExternalStoreWithSelector:cde}=dY,ude=i=>i;function hde(i,e=ude,t){const n=cde(i.subscribe,i.getState,i.getInitialState,e,t);return sm.useDebugValue(n),n}const AP=(i,e)=>{const t=IY(i),n=(r,s=e)=>hde(t,r,s);return Object.assign(n,t),n},dde=((i,e)=>i?AP(i,e):AP);var p4={exports:{}},m4={};var CP;function fde(){return CP||(CP=1,(function(i){function e(U,X){var $=U.length;U.push(X);e:for(;0<$;){var Q=$-1>>>1,se=U[Q];if(0<r(se,X))U[Q]=X,U[$]=se,$=Q;else break e}}function t(U){return U.length===0?null:U[0]}function n(U){if(U.length===0)return null;var X=U[0],$=U.pop();if($!==X){U[0]=$;e:for(var Q=0,se=U.length,ye=se>>>1;Q<ye;){var we=2*(Q+1)-1,He=U[we],De=we+1,Oe=U[De];if(0>r(He,$))De<se&&0>r(Oe,He)?(U[Q]=Oe,U[De]=$,Q=De):(U[Q]=He,U[we]=$,Q=we);else if(De<se&&0>r(Oe,$))U[Q]=Oe,U[De]=$,Q=De;else break e}}return X}function r(U,X){var $=U.sortIndex-X.sortIndex;return $!==0?$:U.id-X.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();i.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,p=3,m=!1,g=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function w(U){for(var X=t(c);X!==null;){if(X.callback===null)n(c);else if(X.startTime<=U)n(c),X.sortIndex=X.expirationTime,e(l,X);else break;X=t(c)}}function T(U){if(y=!1,w(U),!g)if(t(l)!==null)g=!0,B();else{var X=t(c);X!==null&&J(T,X.startTime-U)}}var C=!1,E=-1,D=5,O=-1;function R(){return!(i.unstable_now()-O<D)}function P(){if(C){var U=i.unstable_now();O=U;var X=!0;try{e:{g=!1,y&&(y=!1,_(E),E=-1),m=!0;var $=p;try{t:{for(w(U),d=t(l);d!==null&&!(d.expirationTime>U&&R());){var Q=d.callback;if(typeof Q=="function"){d.callback=null,p=d.priorityLevel;var se=Q(d.expirationTime<=U);if(U=i.unstable_now(),typeof se=="function"){d.callback=se,w(U),X=!0;break t}d===t(l)&&n(l),w(U)}else n(l);d=t(l)}if(d!==null)X=!0;else{var ye=t(c);ye!==null&&J(T,ye.startTime-U),X=!1}}break e}finally{d=null,p=$,m=!1}X=void 0}}finally{X?L():C=!1}}}var L;if(typeof S=="function")L=function(){S(P)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,j=V.port2;V.port1.onmessage=P,L=function(){j.postMessage(null)}}else L=function(){x(P,0)};function B(){C||(C=!0,L())}function J(U,X){E=x(function(){U(i.unstable_now())},X)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(U){U.callback=null},i.unstable_continueExecution=function(){g||m||(g=!0,B())},i.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<U?Math.floor(1e3/U):5},i.unstable_getCurrentPriorityLevel=function(){return p},i.unstable_getFirstCallbackNode=function(){return t(l)},i.unstable_next=function(U){switch(p){case 1:case 2:case 3:var X=3;break;default:X=p}var $=p;p=X;try{return U()}finally{p=$}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(U,X){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var $=p;p=U;try{return X()}finally{p=$}},i.unstable_scheduleCallback=function(U,X,$){var Q=i.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?Q+$:Q):$=Q,U){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=$+se,U={id:u++,callback:X,priorityLevel:U,startTime:$,expirationTime:se,sortIndex:-1},$>Q?(U.sortIndex=$,e(c,U),t(l)===null&&U===t(c)&&(y?(_(E),E=-1):y=!0,J(T,$-Q))):(U.sortIndex=se,e(l,U),g||m||(g=!0,B())),U},i.unstable_shouldYield=R,i.unstable_wrapCallback=function(U){var X=p;return function(){var $=p;p=X;try{return U.apply(this,arguments)}finally{p=$}}}})(m4)),m4}var EP;function pde(){return EP||(EP=1,p4.exports=fde()),p4.exports}var RP=pde();function OH(i){let e=i.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const zH=i=>i&&i.isOrthographicCamera,mde=i=>i&&i.hasOwnProperty("current"),gde=i=>i!=null&&(typeof i=="string"||typeof i=="number"||i.isColor),ex=((i,e)=>typeof window<"u"&&(((i=window.document)==null?void 0:i.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?z.useLayoutEffect:z.useEffect;function UH(i){const e=z.useRef(i);return ex(()=>void(e.current=i),[i]),e}function xde(){const i=nz(),e=iz();return z.useMemo(()=>({children:t})=>{const r=!!uT(i,!0,s=>s.type===z.StrictMode)?z.StrictMode:z.Fragment;return v.jsx(r,{children:v.jsx(e,{children:t})})},[i,e])}function yde({set:i}){return ex(()=>(i(new Promise(()=>null)),()=>i(!1)),[i]),null}const vde=(i=>(i=class extends z.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},i.getDerivedStateFromError=()=>({error:!0}),i))();function FH(i){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(i)?Math.min(Math.max(i[0],t),i[1]):i}function bf(i){var e;return(e=i.__r3f)==null?void 0:e.root.getState()}const ci={obj:i=>i===Object(i)&&!ci.arr(i)&&typeof i!="function",fun:i=>typeof i=="function",str:i=>typeof i=="string",num:i=>typeof i=="number",boo:i=>typeof i=="boolean",und:i=>i===void 0,nul:i=>i===null,arr:i=>Array.isArray(i),equ(i,e,{arrays:t="shallow",objects:n="reference",strict:r=!0}={}){if(typeof i!=typeof e||!!i!=!!e)return!1;if(ci.str(i)||ci.num(i)||ci.boo(i))return i===e;const s=ci.obj(i);if(s&&n==="reference")return i===e;const a=ci.arr(i);if(a&&t==="reference")return i===e;if((a||s)&&i===e)return!0;let o;for(o in i)if(!(o in e))return!1;if(s&&t==="shallow"&&n==="shallow"){for(o in r?e:i)if(!ci.equ(i[o],e[o],{strict:r,objects:"reference"}))return!1}else for(o in r?e:i)if(i[o]!==e[o])return!1;if(ci.und(o)){if(a&&i.length===0&&e.length===0||s&&Object.keys(i).length===0&&Object.keys(e).length===0)return!0;if(i!==e)return!1}return!0}};function bde(i){i.type!=="Scene"&&(i.dispose==null||i.dispose());for(const e in i){const t=i[e];t?.type!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const BH=["children","key","ref"];function _de(i){const e={};for(const t in i)BH.includes(t)||(e[t]=i[t]);return e}function Zv(i,e,t,n){const r=i;let s=r?.__r3f;return s||(s={root:e,type:t,parent:null,children:[],props:_de(n),object:r,eventCount:0,handlers:{},isHidden:!1},r&&(r.__r3f=s)),s}function hg(i,e){if(!e.includes("-"))return{root:i,key:e,target:i[e]};if(e in i)return{root:i,key:e,target:i[e]};let t=i;const n=e.split("-");for(const r of n){if(typeof t!="object"||t===null){if(t!==void 0){const s=n.slice(n.indexOf(r)).join("-");return{root:t,key:s,target:void 0}}return{root:i,key:e,target:void 0}}e=r,i=t,t=t[e]}return{root:i,key:e,target:t}}const PP=/-\d+$/;function Qv(i,e){if(ci.str(e.props.attach)){if(PP.test(e.props.attach)){const r=e.props.attach.replace(PP,""),{root:s,key:a}=hg(i.object,r);Array.isArray(s[a])||(s[a]=[])}const{root:t,key:n}=hg(i.object,e.props.attach);e.previousAttach=t[n],t[n]=e.object}else ci.fun(e.props.attach)&&(e.previousAttach=e.props.attach(i.object,e.object))}function Jv(i,e){if(ci.str(e.props.attach)){const{root:t,key:n}=hg(i.object,e.props.attach),r=e.previousAttach;r===void 0?delete t[n]:t[n]=r}else e.previousAttach==null||e.previousAttach(i.object,e.object);delete e.previousAttach}const N5=[...BH,"args","dispose","attach","object","onUpdate","dispose"],IP=new Map;function Sde(i){let e=IP.get(i.constructor);try{e||(e=new i.constructor,IP.set(i.constructor,e))}catch{}return e}function wde(i,e){const t={};for(const n in e)if(!N5.includes(n)&&!ci.equ(e[n],i.props[n])){t[n]=e[n];for(const r in e)r.startsWith(`${n}-`)&&(t[r]=e[r])}for(const n in i.props){if(N5.includes(n)||e.hasOwnProperty(n))continue;const{root:r,key:s}=hg(i.object,n);if(r.constructor&&r.constructor.length===0){const a=Sde(r);ci.und(a)||(t[s]=a[s])}else t[s]=0}return t}const Mde=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],Tde=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function Zc(i,e){var t;const n=i.__r3f,r=n&&OH(n).getState(),s=n?.eventCount;for(const o in e){let l=e[o];if(N5.includes(o))continue;if(n&&Tde.test(o)){typeof l=="function"?n.handlers[o]=l:delete n.handlers[o],n.eventCount=Object.keys(n.handlers).length;continue}if(l===void 0)continue;let{root:c,key:u,target:d}=hg(i,o);if(d===void 0&&(typeof c!="object"||c===null))throw Error(`R3F: Cannot set "${o}". Ensure it is an object before setting "${u}".`);if(d instanceof p0&&l instanceof p0)d.mask=l.mask;else if(d instanceof pt&&gde(l))d.set(l);else if(d!==null&&typeof d=="object"&&typeof d.set=="function"&&typeof d.copy=="function"&&l!=null&&l.constructor&&d.constructor===l.constructor)d.copy(l);else if(d!==null&&typeof d=="object"&&typeof d.set=="function"&&Array.isArray(l))typeof d.fromArray=="function"?d.fromArray(l):d.set(...l);else if(d!==null&&typeof d=="object"&&typeof d.set=="function"&&typeof l=="number")typeof d.setScalar=="function"?d.setScalar(l):d.set(l);else{var a;c[u]=l,r&&!r.linear&&Mde.includes(u)&&(a=c[u])!=null&&a.isTexture&&c[u].format===Fr&&c[u].type===za&&(c[u].colorSpace=Mr)}}if(n!=null&&n.parent&&r!=null&&r.internal&&(t=n.object)!=null&&t.isObject3D&&s!==n.eventCount){const o=n.object,l=r.internal.interaction.indexOf(o);l>-1&&r.internal.interaction.splice(l,1),n.eventCount&&o.raycast!==null&&r.internal.interaction.push(o)}return n&&n.props.attach===void 0&&(n.object.isBufferGeometry?n.props.attach="geometry":n.object.isMaterial&&(n.props.attach="material")),n&&z0(n),i}function z0(i){var e;if(!i.parent)return;i.props.onUpdate==null||i.props.onUpdate(i.object);const t=(e=i.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function Ade(i,e){i.manual||(zH(i)?(i.left=e.width/-2,i.right=e.width/2,i.top=e.height/2,i.bottom=e.height/-2):i.aspect=e.width/e.height,i.updateProjectionMatrix())}const xs=i=>i?.isObject3D;function ty(i){return(i.eventObject||i.object).uuid+"/"+i.index+i.instanceId}function HH(i,e,t,n){const r=t.get(e);r&&(t.delete(e),t.size===0&&(i.delete(n),r.target.releasePointerCapture(n)))}function Cde(i,e){const{internal:t}=i.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,r)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(r)}),t.capturedMap.forEach((n,r)=>{HH(t.capturedMap,e,n,r)})}function Ede(i){function e(l){const{internal:c}=i.getState(),u=l.offsetX-c.initialClick[0],d=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(u*u+d*d))}function t(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(u=>{var d;return(d=c.__r3f)==null?void 0:d.handlers["onPointer"+u]}))}function n(l,c){const u=i.getState(),d=new Set,p=[],m=c?c(u.internal.interaction):u.internal.interaction;for(let _=0;_<m.length;_++){const S=bf(m[_]);S&&(S.raycaster.camera=void 0)}u.previousRoot||u.events.compute==null||u.events.compute(l,u);function g(_){const S=bf(_);if(!S||!S.events.enabled||S.raycaster.camera===null)return[];if(S.raycaster.camera===void 0){var w;S.events.compute==null||S.events.compute(l,S,(w=S.previousRoot)==null?void 0:w.getState()),S.raycaster.camera===void 0&&(S.raycaster.camera=null)}return S.raycaster.camera?S.raycaster.intersectObject(_,!0):[]}let y=m.flatMap(g).sort((_,S)=>{const w=bf(_.object),T=bf(S.object);return!w||!T?_.distance-S.distance:T.events.priority-w.events.priority||_.distance-S.distance}).filter(_=>{const S=ty(_);return d.has(S)?!1:(d.add(S),!0)});u.events.filter&&(y=u.events.filter(y,u));for(const _ of y){let S=_.object;for(;S;){var x;(x=S.__r3f)!=null&&x.eventCount&&p.push({..._,eventObject:S}),S=S.parent}}if("pointerId"in l&&u.internal.capturedMap.has(l.pointerId))for(let _ of u.internal.capturedMap.get(l.pointerId).values())d.has(ty(_.intersection))||p.push(_.intersection);return p}function r(l,c,u,d){if(l.length){const p={stopped:!1};for(const m of l){let g=bf(m.object);if(g||m.object.traverseAncestors(y=>{const x=bf(y);if(x)return g=x,!1}),g){const{raycaster:y,pointer:x,camera:_,internal:S}=g,w=new K(x.x,x.y,0).unproject(_),T=R=>{var P,L;return(P=(L=S.capturedMap.get(R))==null?void 0:L.has(m.eventObject))!=null?P:!1},C=R=>{const P={intersection:m,target:c.target};S.capturedMap.has(R)?S.capturedMap.get(R).set(m.eventObject,P):S.capturedMap.set(R,new Map([[m.eventObject,P]])),c.target.setPointerCapture(R)},E=R=>{const P=S.capturedMap.get(R);P&&HH(S.capturedMap,m.eventObject,P,R)};let D={};for(let R in c){let P=c[R];typeof P!="function"&&(D[R]=P)}let O={...m,...D,pointer:x,intersections:l,stopped:p.stopped,delta:u,unprojectedPoint:w,ray:y.ray,camera:_,stopPropagation(){const R="pointerId"in c&&S.capturedMap.get(c.pointerId);if((!R||R.has(m.eventObject))&&(O.stopped=p.stopped=!0,S.hovered.size&&Array.from(S.hovered.values()).find(P=>P.eventObject===m.eventObject))){const P=l.slice(0,l.indexOf(m));s([...P,m])}},target:{hasPointerCapture:T,setPointerCapture:C,releasePointerCapture:E},currentTarget:{hasPointerCapture:T,setPointerCapture:C,releasePointerCapture:E},nativeEvent:c};if(d(O),p.stopped===!0)break}}}return l}function s(l){const{internal:c}=i.getState();for(const u of c.hovered.values())if(!l.length||!l.find(d=>d.object===u.object&&d.index===u.index&&d.instanceId===u.instanceId)){const p=u.eventObject.__r3f;if(c.hovered.delete(ty(u)),p!=null&&p.eventCount){const m=p.handlers,g={...u,intersections:l};m.onPointerOut==null||m.onPointerOut(g),m.onPointerLeave==null||m.onPointerLeave(g)}}}function a(l,c){for(let u=0;u<c.length;u++){const d=c[u].__r3f;d==null||d.handlers.onPointerMissed==null||d.handlers.onPointerMissed(l)}}function o(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return c=>{const{internal:u}=i.getState();"pointerId"in c&&u.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{u.capturedMap.has(c.pointerId)&&(u.capturedMap.delete(c.pointerId),s([]))})}}return function(u){const{onPointerMissed:d,internal:p}=i.getState();p.lastEvent.current=u;const m=l==="onPointerMove",g=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",x=n(u,m?t:void 0),_=g?e(u):0;l==="onPointerDown"&&(p.initialClick=[u.offsetX,u.offsetY],p.initialHits=x.map(w=>w.eventObject)),g&&!x.length&&_<=2&&(a(u,p.interaction),d&&d(u)),m&&s(x);function S(w){const T=w.eventObject,C=T.__r3f;if(!(C!=null&&C.eventCount))return;const E=C.handlers;if(m){if(E.onPointerOver||E.onPointerEnter||E.onPointerOut||E.onPointerLeave){const D=ty(w),O=p.hovered.get(D);O?O.stopped&&w.stopPropagation():(p.hovered.set(D,w),E.onPointerOver==null||E.onPointerOver(w),E.onPointerEnter==null||E.onPointerEnter(w))}E.onPointerMove==null||E.onPointerMove(w)}else{const D=E[l];D?(!g||p.initialHits.includes(T))&&(a(u,p.interaction.filter(O=>!p.initialHits.includes(O))),D(w)):g&&p.initialHits.includes(T)&&a(u,p.interaction.filter(O=>!p.initialHits.includes(O)))}}r(x,u,_,S)}}return{handlePointer:o}}const DP=i=>!!(i!=null&&i.render),jH=z.createContext(null),Rde=(i,e)=>{const t=dde((o,l)=>{const c=new K,u=new K,d=new K;function p(_=l().camera,S=u,w=l().size){const{width:T,height:C,top:E,left:D}=w,O=T/C;S.isVector3?d.copy(S):d.set(...S);const R=_.getWorldPosition(c).distanceTo(d);if(zH(_))return{width:T/_.zoom,height:C/_.zoom,top:E,left:D,factor:1,distance:R,aspect:O};{const P=_.fov*Math.PI/180,L=2*Math.tan(P/2)*R,V=L*(T/C);return{width:V,height:L,top:E,left:D,factor:T/V,distance:R,aspect:O}}}let m;const g=_=>o(S=>({performance:{...S.performance,current:_}})),y=new Me;return{set:o,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(_=1)=>i(l(),_),advance:(_,S)=>e(_,S,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new RA,pointer:y,mouse:y,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const _=l();m&&clearTimeout(m),_.performance.current!==_.performance.min&&g(_.performance.min),m=setTimeout(()=>g(l().performance.max),_.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:p},setEvents:_=>o(S=>({...S,events:{...S.events,..._}})),setSize:(_,S,w=0,T=0)=>{const C=l().camera,E={width:_,height:S,top:w,left:T};o(D=>({size:E,viewport:{...D.viewport,...p(C,u,E)}}))},setDpr:_=>o(S=>{const w=FH(_);return{viewport:{...S.viewport,dpr:w,initialDpr:S.viewport.initialDpr||w}}}),setFrameloop:(_="always")=>{const S=l().clock;S.stop(),S.elapsedTime=0,_!=="never"&&(S.start(),S.elapsedTime=0),o(()=>({frameloop:_}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:z.createRef(),active:!1,frames:0,priority:0,subscribe:(_,S,w)=>{const T=l().internal;return T.priority=T.priority+(S>0?1:0),T.subscribers.push({ref:_,priority:S,store:w}),T.subscribers=T.subscribers.sort((C,E)=>C.priority-E.priority),()=>{const C=l().internal;C!=null&&C.subscribers&&(C.priority=C.priority-(S>0?1:0),C.subscribers=C.subscribers.filter(E=>E.ref!==_))}}}}}),n=t.getState();let r=n.size,s=n.viewport.dpr,a=n.camera;return t.subscribe(()=>{const{camera:o,size:l,viewport:c,gl:u,set:d}=t.getState();if(l.width!==r.width||l.height!==r.height||c.dpr!==s){r=l,s=c.dpr,Ade(o,l),c.dpr>0&&u.setPixelRatio(c.dpr);const p=typeof HTMLCanvasElement<"u"&&u.domElement instanceof HTMLCanvasElement;u.setSize(l.width,l.height,p)}o!==a&&(a=o,d(p=>({viewport:{...p.viewport,...p.viewport.getCurrentViewport(o)}})))}),t.subscribe(o=>i(o)),t};function VH(){const i=z.useContext(jH);if(!i)throw new Error("R3F: Hooks can only be used within the Canvas component!");return i}function Qr(i=t=>t,e){return VH()(i,e)}function NA(i,e=0){const t=VH(),n=t.getState().internal.subscribe,r=UH(i);return ex(()=>n(r,e,t),[e,n,t]),null}var Pde={version:"9.4.2"};function Ide(i){const e=NU(i);return e.injectIntoDevTools(),e}const GH=0,y0={},Dde=/^three(?=[A-Z])/,z2=i=>`${i[0].toUpperCase()}${i.slice(1)}`;let Nde=0;const Lde=i=>typeof i=="function";function WH(i){if(Lde(i)){const e=`${Nde++}`;return y0[e]=i,e}else Object.assign(y0,i)}function qH(i,e){const t=z2(i),n=y0[t];if(i!=="primitive"&&!n)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(i==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function kde(i,e,t){var n;return i=z2(i)in y0?i:i.replace(Dde,""),qH(i,e),i==="primitive"&&(n=e.object)!=null&&n.__r3f&&delete e.object.__r3f,Zv(e.object,t,i,e)}function Ode(i){if(!i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?Jv(i.parent,i):xs(i.object)&&(i.object.visible=!1),i.isHidden=!0,z0(i)}}function XH(i){if(i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?Qv(i.parent,i):xs(i.object)&&i.props.visible!==!1&&(i.object.visible=!0),i.isHidden=!1,z0(i)}}function LA(i,e,t){const n=e.root.getState();if(!(!i.parent&&i.object!==n.scene)){if(!e.object){var r,s;const a=y0[z2(e.type)];e.object=(r=e.props.object)!=null?r:new a(...(s=e.props.args)!=null?s:[]),e.object.__r3f=e}if(Zc(e.object,e.props),e.props.attach)Qv(i,e);else if(xs(e.object)&&xs(i.object)){const a=i.object.children.indexOf(t?.object);if(t&&a!==-1){const o=i.object.children.indexOf(e.object);if(o!==-1){i.object.children.splice(o,1);const l=o<a?a-1:a;i.object.children.splice(l,0,e.object)}else e.object.parent=i.object,i.object.children.splice(a,0,e.object),e.object.dispatchEvent({type:"added"}),i.object.dispatchEvent({type:"childadded",child:e.object})}else i.object.add(e.object)}for(const a of e.children)LA(e,a);z0(e)}}function g4(i,e){e&&(e.parent=i,i.children.push(e),LA(i,e))}function NP(i,e,t){if(!e||!t)return;e.parent=i;const n=i.children.indexOf(t);n!==-1?i.children.splice(n,0,e):i.children.push(e),LA(i,e,t)}function YH(i){if(typeof i.dispose=="function"){const e=()=>{try{i.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():RP.unstable_scheduleCallback(RP.unstable_IdlePriority,e)}}function L5(i,e,t){if(!e)return;e.parent=null;const n=i.children.indexOf(e);n!==-1&&i.children.splice(n,1),e.props.attach?Jv(i,e):xs(e.object)&&xs(i.object)&&(i.object.remove(e.object),Cde(OH(e),e.object));const r=e.props.dispose!==null&&t!==!1;for(let s=e.children.length-1;s>=0;s--){const a=e.children[s];L5(e,a,r)}e.children.length=0,delete e.object.__r3f,r&&e.type!=="primitive"&&e.object.type!=="Scene"&&YH(e.object),t===void 0&&z0(e)}function zde(i,e){for(const t of[i,i.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const n=t.ref(e);typeof n=="function"&&(t.refCleanup=n)}else t.ref&&(t.ref.current=e)}const Oy=[];function Ude(){for(const[t]of Oy){const n=t.parent;if(n){t.props.attach?Jv(n,t):xs(t.object)&&xs(n.object)&&n.object.remove(t.object);for(const r of t.children)r.props.attach?Jv(t,r):xs(r.object)&&xs(t.object)&&t.object.remove(r.object)}t.isHidden&&XH(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&YH(t.object)}for(const[t,n,r]of Oy){t.props=n;const s=t.parent;if(s){var i,e;const a=y0[z2(t.type)];t.object=(i=t.props.object)!=null?i:new a(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,zde(r,t.object),Zc(t.object,t.props),t.props.attach?Qv(s,t):xs(t.object)&&xs(s.object)&&s.object.add(t.object);for(const o of t.children)o.props.attach?Qv(t,o):xs(o.object)&&xs(t.object)&&t.object.add(o.object);z0(t)}}Oy.length=0}const x4=()=>{},LP={};let ny=GH;const Fde=0,Bde=4,k5=Ide({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:kde,removeChild:L5,appendChild:g4,appendInitialChild:g4,insertBefore:NP,appendChildToContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||g4(t,e)},removeChildFromContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||L5(t,e)},insertInContainerBefore(i,e,t){const n=i.getState().scene.__r3f;!e||!t||!n||NP(n,e,t)},getRootHostContext:()=>LP,getChildHostContext:()=>LP,commitUpdate(i,e,t,n,r){var s,a,o;qH(e,n);let l=!1;if((i.type==="primitive"&&t.object!==n.object||((s=n.args)==null?void 0:s.length)!==((a=t.args)==null?void 0:a.length)||(o=n.args)!=null&&o.some((u,d)=>{var p;return u!==((p=t.args)==null?void 0:p[d])}))&&(l=!0),l)Oy.push([i,{...n},r]);else{const u=wde(i,n);Object.keys(u).length&&(Object.assign(i.props,u),Zc(i.object,u))}(r.sibling===null||(r.flags&Bde)===Fde)&&Ude()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:i=>i?.object,prepareForCommit:()=>null,preparePortalMount:i=>Zv(i.getState().scene,i,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:Ode,unhideInstance:XH,createTextInstance:x4,hideTextInstance:x4,unhideTextInstance:x4,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:z.createContext(null),setCurrentUpdatePriority(i){ny=i},getCurrentUpdatePriority(){return ny},resolveUpdatePriority(){var i;if(ny!==GH)return ny;switch(typeof window<"u"&&((i=window.event)==null?void 0:i.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Fo.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Fo.ContinuousEventPriority;default:return Fo.DefaultEventPriority}},resetFormInstance(){},rendererPackageName:"@react-three/fiber",rendererVersion:Pde.version}),td=new Map,_f={objects:"shallow",strict:!1};function Hde(i,e){if(!e&&typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&i.parentElement){const{width:t,height:n,top:r,left:s}=i.parentElement.getBoundingClientRect();return{width:t,height:n,top:r,left:s}}else if(!e&&typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas)return{width:i.width,height:i.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function jde(i){const e=td.get(i),t=e?.fiber,n=e?.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=n||Rde(U5,OP),a=t||k5.createContainer(s,Fo.ConcurrentRoot,null,!1,null,"",r,r,r,null);e||td.set(i,{fiber:a,store:s});let o,l,c=!1,u=null;return{async configure(d={}){let p;u=new Promise(ye=>p=ye);let{gl:m,size:g,scene:y,events:x,onCreated:_,shadows:S=!1,linear:w=!1,flat:T=!1,legacy:C=!1,orthographic:E=!1,frameloop:D="always",dpr:O=[1,2],performance:R,raycaster:P,camera:L,onPointerMissed:V}=d,j=s.getState(),B=j.gl;if(!j.gl){const ye={canvas:i,powerPreference:"high-performance",antialias:!0,alpha:!0},we=typeof m=="function"?await m(ye):m;DP(we)?B=we:B=new kH({...ye,...m}),j.set({gl:B})}let J=j.raycaster;J||j.set({raycaster:J=new AH});const{params:U,...X}=P||{};if(ci.equ(X,J,_f)||Zc(J,{...X}),ci.equ(U,J.params,_f)||Zc(J,{params:{...J.params,...U}}),!j.camera||j.camera===l&&!ci.equ(l,L,_f)){l=L;const ye=L?.isCamera,we=ye?L:E?new uu(0,0,0,0,.1,1e3):new Pi(75,0,.1,1e3);ye||(we.position.z=5,L&&(Zc(we,L),we.manual||("aspect"in L||"left"in L||"right"in L||"bottom"in L||"top"in L)&&(we.manual=!0,we.updateProjectionMatrix())),!j.camera&&!(L!=null&&L.rotation)&&we.lookAt(0,0,0)),j.set({camera:we}),J.camera=we}if(!j.scene){let ye;y!=null&&y.isScene?(ye=y,Zv(ye,s,"",{})):(ye=new oA,Zv(ye,s,"",{}),y&&Zc(ye,y)),j.set({scene:ye})}x&&!j.events.handlers&&j.set({events:x(s)});const $=Hde(i,g);if(ci.equ($,j.size,_f)||j.setSize($.width,$.height,$.top,$.left),O&&j.viewport.dpr!==FH(O)&&j.setDpr(O),j.frameloop!==D&&j.setFrameloop(D),j.onPointerMissed||j.set({onPointerMissed:V}),R&&!ci.equ(R,j.performance,_f)&&j.set(ye=>({performance:{...ye.performance,...R}})),!j.xr){var Q;const ye=(De,Oe)=>{const fe=s.getState();fe.frameloop!=="never"&&OP(De,!0,fe,Oe)},we=()=>{const De=s.getState();De.gl.xr.enabled=De.gl.xr.isPresenting,De.gl.xr.setAnimationLoop(De.gl.xr.isPresenting?ye:null),De.gl.xr.isPresenting||U5(De)},He={connect(){const De=s.getState().gl;De.xr.addEventListener("sessionstart",we),De.xr.addEventListener("sessionend",we)},disconnect(){const De=s.getState().gl;De.xr.removeEventListener("sessionstart",we),De.xr.removeEventListener("sessionend",we)}};typeof((Q=B.xr)==null?void 0:Q.addEventListener)=="function"&&He.connect(),j.set({xr:He})}if(B.shadowMap){const ye=B.shadowMap.enabled,we=B.shadowMap.type;if(B.shadowMap.enabled=!!S,ci.boo(S))B.shadowMap.type=fm;else if(ci.str(S)){var se;const He={basic:FF,percentage:t2,soft:fm,variance:io};B.shadowMap.type=(se=He[S])!=null?se:fm}else ci.obj(S)&&Object.assign(B.shadowMap,S);(ye!==B.shadowMap.enabled||we!==B.shadowMap.type)&&(B.shadowMap.needsUpdate=!0)}return fn.enabled=!C,c||(B.outputColorSpace=w?yu:Mr,B.toneMapping=T?$o:qT),j.legacy!==C&&j.set(()=>({legacy:C})),j.linear!==w&&j.set(()=>({linear:w})),j.flat!==T&&j.set(()=>({flat:T})),m&&!ci.fun(m)&&!DP(m)&&!ci.equ(m,B,_f)&&Zc(B,m),o=_,c=!0,p(),this},render(d){return!c&&!u&&this.configure(),u.then(()=>{k5.updateContainer(v.jsx(Vde,{store:s,children:d,onCreated:o,rootElement:i}),a,null,()=>{})}),s},unmount(){$H(i)}}}function Vde({store:i,children:e,onCreated:t,rootElement:n}){return ex(()=>{const r=i.getState();r.set(s=>({internal:{...s.internal,active:!0}})),t&&t(r),i.getState().events.connected||r.events.connect==null||r.events.connect(n)},[]),v.jsx(jH.Provider,{value:i,children:e})}function $H(i,e){const t=td.get(i),n=t?.fiber;if(n){const r=t?.store.getState();r&&(r.internal.active=!1),k5.updateContainer(null,n,null,()=>{r&&setTimeout(()=>{try{var s,a,o,l;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(a=s.renderLists)==null||a.dispose==null||a.dispose(),(o=r.gl)==null||o.forceContextLoss==null||o.forceContextLoss(),(l=r.gl)!=null&&l.xr&&r.xr.disconnect(),bde(r.scene),td.delete(i)}catch{}},500)})}}const Gde=new Set,Wde=new Set,qde=new Set;function y4(i,e){if(i.size)for(const{callback:t}of i.values())t(e)}function Sm(i,e){switch(i){case"before":return y4(Gde,e);case"after":return y4(Wde,e);case"tail":return y4(qde,e)}}let v4,b4;function O5(i,e,t){let n=e.clock.getDelta();e.frameloop==="never"&&typeof i=="number"&&(n=i-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=i),v4=e.internal.subscribers;for(let r=0;r<v4.length;r++)b4=v4[r],b4.ref.current(b4.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let eb=!1,z5=!1,_4,kP,Sf;function KH(i){kP=requestAnimationFrame(KH),eb=!0,_4=0,Sm("before",i),z5=!0;for(const t of td.values()){var e;Sf=t.store.getState(),Sf.internal.active&&(Sf.frameloop==="always"||Sf.internal.frames>0)&&!((e=Sf.gl.xr)!=null&&e.isPresenting)&&(_4+=O5(i,Sf))}if(z5=!1,Sm("after",i),_4===0)return Sm("tail",i),eb=!1,cancelAnimationFrame(kP)}function U5(i,e=1){var t;if(!i)return td.forEach(n=>U5(n.store.getState(),e));(t=i.gl.xr)!=null&&t.isPresenting||!i.internal.active||i.frameloop==="never"||(e>1?i.internal.frames=Math.min(60,i.internal.frames+e):z5?i.internal.frames=2:i.internal.frames=1,eb||(eb=!0,requestAnimationFrame(KH)))}function OP(i,e=!0,t,n){if(e&&Sm("before",i),t)O5(i,t,n);else for(const r of td.values())O5(i,r.store.getState());e&&Sm("after",i)}const S4={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Xde(i){const{handlePointer:e}=Ede(i);return{priority:1,enabled:!0,compute(t,n,r){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(S4).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:r}=i.getState();(t=r.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{const{set:n,events:r}=i.getState();if(r.disconnect==null||r.disconnect(),n(s=>({events:{...s.events,connected:t}})),r.handlers)for(const s in r.handlers){const a=r.handlers[s],[o,l]=S4[s];t.addEventListener(o,a,{passive:l})}},disconnect:()=>{const{set:t,events:n}=i.getState();if(n.connected){if(n.handlers)for(const r in n.handlers){const s=n.handlers[r],[a]=S4[r];n.connected.removeEventListener(a,s)}t(r=>({events:{...r.events,connected:void 0}}))}}}}function zP(i,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>i(...n),e)}}function ZH({debounce:i,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const r=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,a]=z.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),o=z.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),l=i?typeof i=="number"?i:i.scroll:null,c=i?typeof i=="number"?i:i.resize:null,u=z.useRef(!1);z.useEffect(()=>(u.current=!0,()=>void(u.current=!1)));const[d,p,m]=z.useMemo(()=>{const _=()=>{if(!o.current.element)return;const{left:S,top:w,width:T,height:C,bottom:E,right:D,x:O,y:R}=o.current.element.getBoundingClientRect(),P={left:S,top:w,width:T,height:C,bottom:E,right:D,x:O,y:R};o.current.element instanceof HTMLElement&&n&&(P.height=o.current.element.offsetHeight,P.width=o.current.element.offsetWidth),Object.freeze(P),u.current&&!Zde(o.current.lastBounds,P)&&a(o.current.lastBounds=P)};return[_,c?zP(_,c):_,l?zP(_,l):_]},[a,n,l,c]);function g(){o.current.scrollContainers&&(o.current.scrollContainers.forEach(_=>_.removeEventListener("scroll",m,!0)),o.current.scrollContainers=null),o.current.resizeObserver&&(o.current.resizeObserver.disconnect(),o.current.resizeObserver=null),o.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",o.current.orientationHandler))}function y(){o.current.element&&(o.current.resizeObserver=new r(m),o.current.resizeObserver.observe(o.current.element),e&&o.current.scrollContainers&&o.current.scrollContainers.forEach(_=>_.addEventListener("scroll",m,{capture:!0,passive:!0})),o.current.orientationHandler=()=>{m()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",o.current.orientationHandler))}const x=_=>{!_||_===o.current.element||(g(),o.current.element=_,o.current.scrollContainers=QH(_),y())};return $de(m,!!e),Yde(p),z.useEffect(()=>{g(),y()},[e,m,p]),z.useEffect(()=>g,[]),[x,s,d]}function Yde(i){z.useEffect(()=>{const e=i;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[i])}function $de(i,e){z.useEffect(()=>{if(e){const t=i;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[i,e])}function QH(i){const e=[];if(!i||i===document.body)return e;const{overflow:t,overflowX:n,overflowY:r}=window.getComputedStyle(i);return[t,n,r].some(s=>s==="auto"||s==="scroll")&&e.push(i),[...e,...QH(i.parentElement)]}const Kde=["x","y","top","bottom","left","right","width","height"],Zde=(i,e)=>Kde.every(t=>i[t]===e[t]);function Qde({ref:i,children:e,fallback:t,resize:n,style:r,gl:s,events:a=Xde,eventSource:o,eventPrefix:l,shadows:c,linear:u,flat:d,legacy:p,orthographic:m,frameloop:g,dpr:y,performance:x,raycaster:_,camera:S,scene:w,onPointerMissed:T,onCreated:C,...E}){z.useMemo(()=>WH(lde),[]);const D=xde(),[O,R]=ZH({scroll:!0,debounce:{scroll:50,resize:0},...n}),P=z.useRef(null),L=z.useRef(null);z.useImperativeHandle(i,()=>P.current);const V=UH(T),[j,B]=z.useState(!1),[J,U]=z.useState(!1);if(j)throw j;if(J)throw J;const X=z.useRef(null);ex(()=>{const Q=P.current;if(R.width>0&&R.height>0&&Q){X.current||(X.current=jde(Q));async function se(){await X.current.configure({gl:s,scene:w,events:a,shadows:c,linear:u,flat:d,legacy:p,orthographic:m,frameloop:g,dpr:y,performance:x,raycaster:_,camera:S,size:R,onPointerMissed:(...ye)=>V.current==null?void 0:V.current(...ye),onCreated:ye=>{ye.events.connect==null||ye.events.connect(o?mde(o)?o.current:o:L.current),l&&ye.setEvents({compute:(we,He)=>{const De=we[l+"X"],Oe=we[l+"Y"];He.pointer.set(De/He.size.width*2-1,-(Oe/He.size.height)*2+1),He.raycaster.setFromCamera(He.pointer,He.camera)}}),C?.(ye)}}),X.current.render(v.jsx(D,{children:v.jsx(vde,{set:U,children:v.jsx(z.Suspense,{fallback:v.jsx(yde,{set:B}),children:e??null})})}))}se()}}),z.useEffect(()=>{const Q=P.current;if(Q)return()=>$H(Q)},[]);const $=o?"none":"auto";return v.jsx("div",{ref:L,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:$,...r},...E,children:v.jsx("div",{ref:O,style:{width:"100%",height:"100%"},children:v.jsx("canvas",{ref:P,style:{display:"block"},children:t})})})}function JH(i){return v.jsx(dT,{children:v.jsx(Qde,{...i})})}function Jde(i,e,t){return Math.max(e,Math.min(i,t))}const Br={toVector(i,e){return i===void 0&&(i=e),Array.isArray(i)?i:[i,i]},add(i,e){return[i[0]+e[0],i[1]+e[1]]},sub(i,e){return[i[0]-e[0],i[1]-e[1]]},addTo(i,e){i[0]+=e[0],i[1]+=e[1]},subTo(i,e){i[0]-=e[0],i[1]-=e[1]}};function UP(i,e,t){return e===0||Math.abs(e)===1/0?Math.pow(i,t*5):i*e*t/(e+t*i)}function FP(i,e,t,n=.15){return n===0?Jde(i,e,t):i<e?-UP(e-i,t-e,n)+e:i>t?+UP(i-t,t-e,n)+t:i}function efe(i,[e,t],[n,r]){const[[s,a],[o,l]]=i;return[FP(e,s,a,n),FP(t,o,l,r)]}function tfe(i,e){if(typeof i!="object"||i===null)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function nfe(i){var e=tfe(i,"string");return typeof e=="symbol"?e:String(e)}function gs(i,e,t){return e=nfe(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function BP(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function gi(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?BP(Object(t),!0).forEach(function(n){gs(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):BP(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}const ej={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function HP(i){return i?i[0].toUpperCase()+i.slice(1):""}const ife=["enter","leave"];function rfe(i=!1,e){return i&&!ife.includes(e)}function sfe(i,e="",t=!1){const n=ej[i],r=n&&n[e]||e;return"on"+HP(i)+HP(r)+(rfe(t,r)?"Capture":"")}const afe=["gotpointercapture","lostpointercapture"];function ofe(i){let e=i.substring(2).toLowerCase();const t=!!~e.indexOf("passive");t&&(e=e.replace("passive",""));const n=afe.includes(e)?"capturecapture":"capture",r=!!~e.indexOf(n);return r&&(e=e.replace("capture","")),{device:e,capture:r,passive:t}}function lfe(i,e=""){const t=ej[i],n=t&&t[e]||e;return i+n}function U2(i){return"touches"in i}function tj(i){return U2(i)?"touch":"pointerType"in i?i.pointerType:"mouse"}function cfe(i){return Array.from(i.touches).filter(e=>{var t,n;return e.target===i.currentTarget||((t=i.currentTarget)===null||t===void 0||(n=t.contains)===null||n===void 0?void 0:n.call(t,e.target))})}function ufe(i){return i.type==="touchend"||i.type==="touchcancel"?i.changedTouches:i.targetTouches}function nj(i){return U2(i)?ufe(i)[0]:i}function hfe(i){return cfe(i).map(e=>e.identifier)}function w4(i){const e=nj(i);return U2(i)?e.identifier:e.pointerId}function jP(i){const e=nj(i);return[e.clientX,e.clientY]}function dfe(i){const e={};if("buttons"in i&&(e.buttons=i.buttons),"shiftKey"in i){const{shiftKey:t,altKey:n,metaKey:r,ctrlKey:s}=i;Object.assign(e,{shiftKey:t,altKey:n,metaKey:r,ctrlKey:s})}return e}function tb(i,...e){return typeof i=="function"?i(...e):i}function ffe(){}function pfe(...i){return i.length===0?ffe:i.length===1?i[0]:function(){let e;for(const t of i)e=t.apply(this,arguments)||e;return e}}function VP(i,e){return Object.assign({},e,i||{})}const mfe=32;class gfe{constructor(e,t,n){this.ctrl=e,this.args=t,this.key=n,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:e,shared:t,ingKey:n,args:r}=this;t[n]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=r,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){const t=this.state,n=this.config;t._active||(this.reset(),this.computeInitial(),t._active=!0,t.target=e.target,t.currentTarget=e.currentTarget,t.lastOffset=n.from?tb(n.from,t):t.offset,t.offset=t.lastOffset,t.startTime=t.timeStamp=e.timeStamp)}computeValues(e){const t=this.state;t._values=e,t.values=this.config.transform(e)}computeInitial(){const e=this.state;e._initial=e._values,e.initial=e.values}compute(e){const{state:t,config:n,shared:r}=this;t.args=this.args;let s=0;if(e&&(t.event=e,n.preventDefault&&e.cancelable&&t.event.preventDefault(),t.type=e.type,r.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,r.locked=!!document.pointerLockElement,Object.assign(r,dfe(e)),r.down=r.pressed=r.buttons%2===1||r.touches>0,s=e.timeStamp-t.timeStamp,t.timeStamp=e.timeStamp,t.elapsedTime=t.timeStamp-t.startTime),t._active){const E=t._delta.map(Math.abs);Br.addTo(t._distance,E)}this.axisIntent&&this.axisIntent(e);const[a,o]=t._movement,[l,c]=n.threshold,{_step:u,values:d}=t;if(n.hasCustomTransform?(u[0]===!1&&(u[0]=Math.abs(a)>=l&&d[0]),u[1]===!1&&(u[1]=Math.abs(o)>=c&&d[1])):(u[0]===!1&&(u[0]=Math.abs(a)>=l&&Math.sign(a)*l),u[1]===!1&&(u[1]=Math.abs(o)>=c&&Math.sign(o)*c)),t.intentional=u[0]!==!1||u[1]!==!1,!t.intentional)return;const p=[0,0];if(n.hasCustomTransform){const[E,D]=d;p[0]=u[0]!==!1?E-u[0]:0,p[1]=u[1]!==!1?D-u[1]:0}else p[0]=u[0]!==!1?a-u[0]:0,p[1]=u[1]!==!1?o-u[1]:0;this.restrictToAxis&&!t._blocked&&this.restrictToAxis(p);const m=t.offset,g=t._active&&!t._blocked||t.active;g&&(t.first=t._active&&!t.active,t.last=!t._active&&t.active,t.active=r[this.ingKey]=t._active,e&&(t.first&&("bounds"in n&&(t._bounds=tb(n.bounds,t)),this.setup&&this.setup()),t.movement=p,this.computeOffset()));const[y,x]=t.offset,[[_,S],[w,T]]=t._bounds;t.overflow=[y<_?-1:y>S?1:0,x<w?-1:x>T?1:0],t._movementBound[0]=t.overflow[0]?t._movementBound[0]===!1?t._movement[0]:t._movementBound[0]:!1,t._movementBound[1]=t.overflow[1]?t._movementBound[1]===!1?t._movement[1]:t._movementBound[1]:!1;const C=t._active?n.rubberband||[0,0]:[0,0];if(t.offset=efe(t._bounds,t.offset,C),t.delta=Br.sub(t.offset,m),this.computeMovement(),g&&(!t.last||s>mfe)){t.delta=Br.sub(t.offset,m);const E=t.delta.map(Math.abs);Br.addTo(t.distance,E),t.direction=t.delta.map(Math.sign),t._direction=t._delta.map(Math.sign),!t.first&&s>0&&(t.velocity=[E[0]/s,E[1]/s],t.timeDelta=s)}}emit(){const e=this.state,t=this.shared,n=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!n.triggerAllEvents)return;const r=this.handler(gi(gi(gi({},t),e),{},{[this.aliasKey]:e.values}));r!==void 0&&(e.memo=r)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function xfe([i,e],t){const n=Math.abs(i),r=Math.abs(e);if(n>r&&n>t)return"x";if(r>n&&r>t)return"y"}class yfe extends gfe{constructor(...e){super(...e),gs(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=Br.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=Br.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){const t=this.state,n=this.config;if(!t.axis&&e){const r=typeof n.axisThreshold=="object"?n.axisThreshold[tj(e)]:n.axisThreshold;t.axis=xfe(t._movement,r)}t._blocked=(n.lockDirection||!!n.axis)&&!t.axis||!!n.axis&&n.axis!==t.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0;break}}}const vfe=i=>i,GP=.15,ij={enabled(i=!0){return i},eventOptions(i,e,t){return gi(gi({},t.shared.eventOptions),i)},preventDefault(i=!1){return i},triggerAllEvents(i=!1){return i},rubberband(i=0){switch(i){case!0:return[GP,GP];case!1:return[0,0];default:return Br.toVector(i)}},from(i){if(typeof i=="function")return i;if(i!=null)return Br.toVector(i)},transform(i,e,t){const n=i||t.shared.transform;return this.hasCustomTransform=!!n,n||vfe},threshold(i){return Br.toVector(i,0)}},bfe=0,tx=gi(gi({},ij),{},{axis(i,e,{axis:t}){if(this.lockDirection=t==="lock",!this.lockDirection)return t},axisThreshold(i=bfe){return i},bounds(i={}){if(typeof i=="function")return s=>tx.bounds(i(s));if("current"in i)return()=>i.current;if(typeof HTMLElement=="function"&&i instanceof HTMLElement)return i;const{left:e=-1/0,right:t=1/0,top:n=-1/0,bottom:r=1/0}=i;return[[e,t],[n,r]]}}),WP={ArrowRight:(i,e=1)=>[i*e,0],ArrowLeft:(i,e=1)=>[-1*i*e,0],ArrowUp:(i,e=1)=>[0,-1*i*e],ArrowDown:(i,e=1)=>[0,i*e]};class _fe extends yfe{constructor(...e){super(...e),gs(this,"ingKey","dragging")}reset(){super.reset();const e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){const e=this.state;if(e._bounds instanceof HTMLElement){const t=e._bounds.getBoundingClientRect(),n=e.currentTarget.getBoundingClientRect(),r={left:t.left-n.left+e.offset[0],right:t.right-n.right+e.offset[0],top:t.top-n.top+e.offset[1],bottom:t.bottom-n.bottom+e.offset[1]};e._bounds=tx.bounds(r)}}cancel(){const e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){const t=this.config,n=this.state;if(e.buttons!=null&&(Array.isArray(t.pointerButtons)?!t.pointerButtons.includes(e.buttons):t.pointerButtons!==-1&&t.pointerButtons!==e.buttons))return;const r=this.ctrl.setEventIds(e);t.pointerCapture&&e.target.setPointerCapture(e.pointerId),!(r&&r.size>1&&n._pointerActive)&&(this.start(e),this.setupPointer(e),n._pointerId=w4(e),n._pointerActive=!0,this.computeValues(jP(e)),this.computeInitial(),t.preventScrollAxis&&tj(e)!=="mouse"?(n._active=!1,this.setupScrollPrevention(e)):t.delay>0?(this.setupDelayTrigger(e),t.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){const t=this.state;t._active=!0,t._preventScroll=!0,t._delayed=!1,this.compute(e),this.emit()}pointerMove(e){const t=this.state,n=this.config;if(!t._pointerActive)return;const r=w4(e);if(t._pointerId!==void 0&&r!==t._pointerId)return;const s=jP(e);if(document.pointerLockElement===e.target?t._delta=[e.movementX,e.movementY]:(t._delta=Br.sub(s,t._values),this.computeValues(s)),Br.addTo(t._movement,t._delta),this.compute(e),t._delayed&&t.intentional){this.timeoutStore.remove("dragDelay"),t.active=!1,this.startPointerDrag(e);return}if(n.preventScrollAxis&&!t._preventScroll)if(t.axis)if(t.axis===n.preventScrollAxis||n.preventScrollAxis==="xy"){t._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(e);return}else return;this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch{}const t=this.state,n=this.config;if(!t._active||!t._pointerActive)return;const r=w4(e);if(t._pointerId!==void 0&&r!==t._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);const[s,a]=t._distance;if(t.tap=s<=n.tapsThreshold&&a<=n.tapsThreshold,t.tap&&n.filterTaps)t._force=!0;else{const[o,l]=t._delta,[c,u]=t._movement,[d,p]=n.swipe.velocity,[m,g]=n.swipe.distance,y=n.swipe.duration;if(t.elapsedTime<y){const x=Math.abs(o/t.timeDelta),_=Math.abs(l/t.timeDelta);x>d&&Math.abs(c)>m&&(t.swipe[0]=Math.sign(o)),_>p&&Math.abs(u)>g&&(t.swipe[1]=Math.sign(l))}}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){const t=this.config,n=t.device;t.pointerLock&&e.currentTarget.requestPointerLock(),t.pointerCapture||(this.eventStore.add(this.sharedConfig.window,n,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,n,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,n,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,Sfe(e);const t=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",t),this.eventStore.add(this.sharedConfig.window,"touch","cancel",t),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(e)},this.config.delay)}keyDown(e){const t=WP[e.key];if(t){const n=this.state,r=e.shiftKey?10:e.altKey?.1:1;this.start(e),n._delta=t(this.config.keyboardDisplacement,r),n._keyboardActive=!0,Br.addTo(n._movement,n._delta),this.compute(e),this.emit()}}keyUp(e){e.key in WP&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){const t=this.config.device;e(t,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(t,"change",this.pointerMove.bind(this)),e(t,"end",this.pointerUp.bind(this)),e(t,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}function Sfe(i){"persist"in i&&typeof i.persist=="function"&&i.persist()}const nx=typeof window<"u"&&window.document&&window.document.createElement;function rj(){return nx&&"ontouchstart"in window}function wfe(){return rj()||nx&&window.navigator.maxTouchPoints>1}function Mfe(){return nx&&"onpointerdown"in window}function Tfe(){return nx&&"exitPointerLock"in window.document}function Afe(){try{return"constructor"in GestureEvent}catch{return!1}}const Aa={isBrowser:nx,gesture:Afe(),touch:rj(),touchscreen:wfe(),pointer:Mfe(),pointerLock:Tfe()},Cfe=250,Efe=180,Rfe=.5,Pfe=50,Ife=250,Dfe=10,qP={mouse:0,touch:0,pen:8},Nfe=gi(gi({},tx),{},{device(i,e,{pointer:{touch:t=!1,lock:n=!1,mouse:r=!1}={}}){return this.pointerLock=n&&Aa.pointerLock,Aa.touch&&t?"touch":this.pointerLock?"mouse":Aa.pointer&&!r?"pointer":Aa.touch?"touch":"mouse"},preventScrollAxis(i,e,{preventScroll:t}){if(this.preventScrollDelay=typeof t=="number"?t:t||t===void 0&&i?Cfe:void 0,!(!Aa.touchscreen||t===!1))return i||(t!==void 0?"y":void 0)},pointerCapture(i,e,{pointer:{capture:t=!0,buttons:n=1,keys:r=!0}={}}){return this.pointerButtons=n,this.keys=r,!this.pointerLock&&this.device==="pointer"&&t},threshold(i,e,{filterTaps:t=!1,tapsThreshold:n=3,axis:r=void 0}){const s=Br.toVector(i,t?n:r?1:0);return this.filterTaps=t,this.tapsThreshold=n,s},swipe({velocity:i=Rfe,distance:e=Pfe,duration:t=Ife}={}){return{velocity:this.transform(Br.toVector(i)),distance:this.transform(Br.toVector(e)),duration:t}},delay(i=0){switch(i){case!0:return Efe;case!1:return 0;default:return i}},axisThreshold(i){return i?gi(gi({},qP),i):qP},keyboardDisplacement(i=Dfe){return i}});gi(gi({},ij),{},{device(i,e,{shared:t,pointer:{touch:n=!1}={}}){if(t.target&&!Aa.touch&&Aa.gesture)return"gesture";if(Aa.touch&&n)return"touch";if(Aa.touchscreen){if(Aa.pointer)return"pointer";if(Aa.touch)return"touch"}},bounds(i,e,{scaleBounds:t={},angleBounds:n={}}){const r=a=>{const o=VP(tb(t,a),{min:-1/0,max:1/0});return[o.min,o.max]},s=a=>{const o=VP(tb(n,a),{min:-1/0,max:1/0});return[o.min,o.max]};return typeof t!="function"&&typeof n!="function"?[r(),s()]:a=>[r(a),s(a)]},threshold(i,e,t){return this.lockDirection=t.axis==="lock",Br.toVector(i,this.lockDirection?[.1,3]:0)},modifierKey(i){return i===void 0?"ctrlKey":i},pinchOnWheel(i=!0){return i}});gi(gi({},tx),{},{mouseOnly:(i=!0)=>i});gi(gi({},tx),{},{mouseOnly:(i=!0)=>i});const sj=new Map,F5=new Map;function Lfe(i){sj.set(i.key,i.engine),F5.set(i.key,i.resolver)}const kfe={key:"drag",engine:_fe,resolver:Nfe};function Ofe(i,e){if(i==null)return{};var t={},n=Object.keys(i),r,s;for(s=0;s<n.length;s++)r=n[s],!(e.indexOf(r)>=0)&&(t[r]=i[r]);return t}function zfe(i,e){if(i==null)return{};var t=Ofe(i,e),n,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);for(r=0;r<s.length;r++)n=s[r],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(i,n)&&(t[n]=i[n])}return t}const Ufe={target(i){if(i)return()=>"current"in i?i.current:i},enabled(i=!0){return i},window(i=Aa.isBrowser?window:void 0){return i},eventOptions({passive:i=!0,capture:e=!1}={}){return{passive:i,capture:e}},transform(i){return i}},Ffe=["target","eventOptions","window","enabled","transform"];function zy(i={},e){const t={};for(const[n,r]of Object.entries(e))switch(typeof r){case"function":t[n]=r.call(t,i[n],n,i);break;case"object":t[n]=zy(i[n],r);break;case"boolean":r&&(t[n]=i[n]);break}return t}function Bfe(i,e,t={}){const n=i,{target:r,eventOptions:s,window:a,enabled:o,transform:l}=n,c=zfe(n,Ffe);if(t.shared=zy({target:r,eventOptions:s,window:a,enabled:o,transform:l},Ufe),e){const u=F5.get(e);t[e]=zy(gi({shared:t.shared},c),u)}else for(const u in c){const d=F5.get(u);d&&(t[u]=zy(gi({shared:t.shared},c[u]),d))}return t}class aj{constructor(e,t){gs(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=t}add(e,t,n,r,s){const a=this._listeners,o=lfe(t,n),l=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},c=gi(gi({},l),s);e.addEventListener(o,r,c);const u=()=>{e.removeEventListener(o,r,c),a.delete(u)};return a.add(u),u}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}}class Hfe{constructor(){gs(this,"_timeouts",new Map)}add(e,t,n=140,...r){this.remove(e),this._timeouts.set(e,window.setTimeout(t,n,...r))}remove(e){const t=this._timeouts.get(e);t&&window.clearTimeout(t)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}}let jfe=class{constructor(e){gs(this,"gestures",new Set),gs(this,"_targetEventStore",new aj(this)),gs(this,"gestureEventStores",{}),gs(this,"gestureTimeoutStores",{}),gs(this,"handlers",{}),gs(this,"config",{}),gs(this,"pointerIds",new Set),gs(this,"touchIds",new Set),gs(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),Vfe(this,e)}setEventIds(e){if(U2(e))return this.touchIds=new Set(hfe(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,t){this.handlers=e,this.nativeHandlers=t}applyConfig(e,t){this.config=Bfe(e,t,this.config)}clean(){this._targetEventStore.clean();for(const e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){const t=this.config.shared,n={};let r;if(!(t.target&&(r=t.target(),!r))){if(t.enabled){for(const a of this.gestures){const o=this.config[a],l=XP(n,o.eventOptions,!!r);if(o.enabled){const c=sj.get(a);new c(this,e,a).bind(l)}}const s=XP(n,t.eventOptions,!!r);for(const a in this.nativeHandlers)s(a,"",o=>this.nativeHandlers[a](gi(gi({},this.state.shared),{},{event:o,args:e})),void 0,!0)}for(const s in n)n[s]=pfe(...n[s]);if(!r)return n;for(const s in n){const{device:a,capture:o,passive:l}=ofe(s);this._targetEventStore.add(r,a,"",n[s],{capture:o,passive:l})}}}};function wf(i,e){i.gestures.add(e),i.gestureEventStores[e]=new aj(i,e),i.gestureTimeoutStores[e]=new Hfe}function Vfe(i,e){e.drag&&wf(i,"drag"),e.wheel&&wf(i,"wheel"),e.scroll&&wf(i,"scroll"),e.move&&wf(i,"move"),e.pinch&&wf(i,"pinch"),e.hover&&wf(i,"hover")}const XP=(i,e,t)=>(n,r,s,a={},o=!1)=>{var l,c;const u=(l=a.capture)!==null&&l!==void 0?l:e.capture,d=(c=a.passive)!==null&&c!==void 0?c:e.passive;let p=o?n:sfe(n,r,u);t&&d&&(p+="Passive"),i[p]=i[p]||[],i[p].push(s)};function Gfe(i,e={},t,n){const r=sm.useMemo(()=>new jfe(i),[]);if(r.applyHandlers(i,n),r.applyConfig(e,t),sm.useEffect(r.effect.bind(r)),sm.useEffect(()=>r.clean.bind(r),[]),e.target===void 0)return r.bind.bind(r)}function Fp(i,e){return Lfe(kfe),Gfe({drag:i},{},"drag")}const oj=parseInt(Vg.replace(/\D+/g,"")),lj=oj>=125?"uv1":"uv2";var Wfe=Object.defineProperty,qfe=(i,e,t)=>e in i?Wfe(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Xfe=(i,e,t)=>(qfe(i,e+"",t),t);class Yfe{constructor(){Xfe(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,e);e.target=null}}}var $fe=Object.defineProperty,Kfe=(i,e,t)=>e in i?$fe(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,kt=(i,e,t)=>(Kfe(i,typeof e!="symbol"?e+"":e,t),t);const iy=new fd,YP=new Wl,Zfe=Math.cos(70*(Math.PI/180)),$P=(i,e)=>(i%e+e)%e;class Qfe extends Yfe{constructor(e,t){super(),kt(this,"object"),kt(this,"domElement"),kt(this,"enabled",!0),kt(this,"target",new K),kt(this,"minDistance",0),kt(this,"maxDistance",1/0),kt(this,"minZoom",0),kt(this,"maxZoom",1/0),kt(this,"minPolarAngle",0),kt(this,"maxPolarAngle",Math.PI),kt(this,"minAzimuthAngle",-1/0),kt(this,"maxAzimuthAngle",1/0),kt(this,"enableDamping",!1),kt(this,"dampingFactor",.05),kt(this,"enableZoom",!0),kt(this,"zoomSpeed",1),kt(this,"enableRotate",!0),kt(this,"rotateSpeed",1),kt(this,"enablePan",!0),kt(this,"panSpeed",1),kt(this,"screenSpacePanning",!0),kt(this,"keyPanSpeed",7),kt(this,"zoomToCursor",!1),kt(this,"autoRotate",!1),kt(this,"autoRotateSpeed",2),kt(this,"reverseOrbit",!1),kt(this,"reverseHorizontalOrbit",!1),kt(this,"reverseVerticalOrbit",!1),kt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),kt(this,"mouseButtons",{LEFT:Vl.ROTATE,MIDDLE:Vl.DOLLY,RIGHT:Vl.PAN}),kt(this,"touches",{ONE:Gl.ROTATE,TWO:Gl.DOLLY_PAN}),kt(this,"target0"),kt(this,"position0"),kt(this,"zoom0"),kt(this,"_domElementKeyEvents",null),kt(this,"getPolarAngle"),kt(this,"getAzimuthalAngle"),kt(this,"setPolarAngle"),kt(this,"setAzimuthalAngle"),kt(this,"getDistance"),kt(this,"getZoomScale"),kt(this,"listenToKeyEvents"),kt(this,"stopListenToKeyEvents"),kt(this,"saveState"),kt(this,"reset"),kt(this,"update"),kt(this,"connect"),kt(this,"dispose"),kt(this,"dollyIn"),kt(this,"dollyOut"),kt(this,"getScale"),kt(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>u.phi,this.getAzimuthalAngle=()=>u.theta,this.setPolarAngle=ie=>{let pe=$P(ie,2*Math.PI),Fe=u.phi;Fe<0&&(Fe+=2*Math.PI),pe<0&&(pe+=2*Math.PI);let te=Math.abs(pe-Fe);2*Math.PI-te<te&&(pe<Fe?pe+=2*Math.PI:Fe+=2*Math.PI),d.phi=pe-Fe,n.update()},this.setAzimuthalAngle=ie=>{let pe=$P(ie,2*Math.PI),Fe=u.theta;Fe<0&&(Fe+=2*Math.PI),pe<0&&(pe+=2*Math.PI);let te=Math.abs(pe-Fe);2*Math.PI-te<te&&(pe<Fe?pe+=2*Math.PI:Fe+=2*Math.PI),d.theta=pe-Fe,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=ie=>{ie.addEventListener("keydown",_e),this._domElementKeyEvents=ie},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",_e),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(r),n.update(),l=o.NONE},this.update=(()=>{const ie=new K,pe=new K(0,1,0),Fe=new Vr().setFromUnitVectors(e.up,pe),te=Fe.clone().invert(),je=new K,We=new Vr,Je=2*Math.PI;return function(){const Ce=n.object.position;Fe.setFromUnitVectors(e.up,pe),te.copy(Fe).invert(),ie.copy(Ce).sub(n.target),ie.applyQuaternion(Fe),u.setFromVector3(ie),n.autoRotate&&l===o.NONE&&B(V()),n.enableDamping?(u.theta+=d.theta*n.dampingFactor,u.phi+=d.phi*n.dampingFactor):(u.theta+=d.theta,u.phi+=d.phi);let ct=n.minAzimuthAngle,Ct=n.maxAzimuthAngle;isFinite(ct)&&isFinite(Ct)&&(ct<-Math.PI?ct+=Je:ct>Math.PI&&(ct-=Je),Ct<-Math.PI?Ct+=Je:Ct>Math.PI&&(Ct-=Je),ct<=Ct?u.theta=Math.max(ct,Math.min(Ct,u.theta)):u.theta=u.theta>(ct+Ct)/2?Math.max(ct,u.theta):Math.min(Ct,u.theta)),u.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,u.phi)),u.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(m,n.dampingFactor):n.target.add(m),n.zoomToCursor&&R||n.object.isOrthographicCamera?u.radius=He(u.radius):u.radius=He(u.radius*p),ie.setFromSpherical(u),ie.applyQuaternion(te),Ce.copy(n.target).add(ie),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(d.theta*=1-n.dampingFactor,d.phi*=1-n.dampingFactor,m.multiplyScalar(1-n.dampingFactor)):(d.set(0,0,0),m.set(0,0,0));let an=!1;if(n.zoomToCursor&&R){let tn=null;if(n.object instanceof Pi&&n.object.isPerspectiveCamera){const ji=ie.length();tn=He(ji*p);const Vi=ji-tn;n.object.position.addScaledVector(D,Vi),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const ji=new K(O.x,O.y,0);ji.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/p)),n.object.updateProjectionMatrix(),an=!0;const Vi=new K(O.x,O.y,0);Vi.unproject(n.object),n.object.position.sub(Vi).add(ji),n.object.updateMatrixWorld(),tn=ie.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;tn!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(tn).add(n.object.position):(iy.origin.copy(n.object.position),iy.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(iy.direction))<Zfe?e.lookAt(n.target):(YP.setFromNormalAndCoplanarPoint(n.object.up,n.target),iy.intersectPlane(YP,n.target))))}else n.object instanceof uu&&n.object.isOrthographicCamera&&(an=p!==1,an&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/p)),n.object.updateProjectionMatrix()));return p=1,R=!1,an||je.distanceToSquared(n.object.position)>c||8*(1-We.dot(n.object.quaternion))>c?(n.dispatchEvent(r),je.copy(n.object.position),We.copy(n.object.quaternion),an=!1,!0):!1}})(),this.connect=ie=>{n.domElement=ie,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",At),n.domElement.addEventListener("pointerdown",ft),n.domElement.addEventListener("pointercancel",H),n.domElement.addEventListener("wheel",Re)},this.dispose=()=>{var ie,pe,Fe,te,je,We;n.domElement&&(n.domElement.style.touchAction="auto"),(ie=n.domElement)==null||ie.removeEventListener("contextmenu",At),(pe=n.domElement)==null||pe.removeEventListener("pointerdown",ft),(Fe=n.domElement)==null||Fe.removeEventListener("pointercancel",H),(te=n.domElement)==null||te.removeEventListener("wheel",Re),(je=n.domElement)==null||je.ownerDocument.removeEventListener("pointermove",Z),(We=n.domElement)==null||We.ownerDocument.removeEventListener("pointerup",H),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",_e)};const n=this,r={type:"change"},s={type:"start"},a={type:"end"},o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=o.NONE;const c=1e-6,u=new R5,d=new R5;let p=1;const m=new K,g=new Me,y=new Me,x=new Me,_=new Me,S=new Me,w=new Me,T=new Me,C=new Me,E=new Me,D=new K,O=new Me;let R=!1;const P=[],L={};function V(){return 2*Math.PI/60/60*n.autoRotateSpeed}function j(){return Math.pow(.95,n.zoomSpeed)}function B(ie){n.reverseOrbit||n.reverseHorizontalOrbit?d.theta+=ie:d.theta-=ie}function J(ie){n.reverseOrbit||n.reverseVerticalOrbit?d.phi+=ie:d.phi-=ie}const U=(()=>{const ie=new K;return function(Fe,te){ie.setFromMatrixColumn(te,0),ie.multiplyScalar(-Fe),m.add(ie)}})(),X=(()=>{const ie=new K;return function(Fe,te){n.screenSpacePanning===!0?ie.setFromMatrixColumn(te,1):(ie.setFromMatrixColumn(te,0),ie.crossVectors(n.object.up,ie)),ie.multiplyScalar(Fe),m.add(ie)}})(),$=(()=>{const ie=new K;return function(Fe,te){const je=n.domElement;if(je&&n.object instanceof Pi&&n.object.isPerspectiveCamera){const We=n.object.position;ie.copy(We).sub(n.target);let Je=ie.length();Je*=Math.tan(n.object.fov/2*Math.PI/180),U(2*Fe*Je/je.clientHeight,n.object.matrix),X(2*te*Je/je.clientHeight,n.object.matrix)}else je&&n.object instanceof uu&&n.object.isOrthographicCamera?(U(Fe*(n.object.right-n.object.left)/n.object.zoom/je.clientWidth,n.object.matrix),X(te*(n.object.top-n.object.bottom)/n.object.zoom/je.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function Q(ie){n.object instanceof Pi&&n.object.isPerspectiveCamera||n.object instanceof uu&&n.object.isOrthographicCamera?p=ie:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function se(ie){Q(p/ie)}function ye(ie){Q(p*ie)}function we(ie){if(!n.zoomToCursor||!n.domElement)return;R=!0;const pe=n.domElement.getBoundingClientRect(),Fe=ie.clientX-pe.left,te=ie.clientY-pe.top,je=pe.width,We=pe.height;O.x=Fe/je*2-1,O.y=-(te/We)*2+1,D.set(O.x,O.y,1).unproject(n.object).sub(n.object.position).normalize()}function He(ie){return Math.max(n.minDistance,Math.min(n.maxDistance,ie))}function De(ie){g.set(ie.clientX,ie.clientY)}function Oe(ie){we(ie),T.set(ie.clientX,ie.clientY)}function fe(ie){_.set(ie.clientX,ie.clientY)}function ge(ie){y.set(ie.clientX,ie.clientY),x.subVectors(y,g).multiplyScalar(n.rotateSpeed);const pe=n.domElement;pe&&(B(2*Math.PI*x.x/pe.clientHeight),J(2*Math.PI*x.y/pe.clientHeight)),g.copy(y),n.update()}function Ne(ie){C.set(ie.clientX,ie.clientY),E.subVectors(C,T),E.y>0?se(j()):E.y<0&&ye(j()),T.copy(C),n.update()}function Qe(ie){S.set(ie.clientX,ie.clientY),w.subVectors(S,_).multiplyScalar(n.panSpeed),$(w.x,w.y),_.copy(S),n.update()}function et(ie){we(ie),ie.deltaY<0?ye(j()):ie.deltaY>0&&se(j()),n.update()}function Nt(ie){let pe=!1;switch(ie.code){case n.keys.UP:$(0,n.keyPanSpeed),pe=!0;break;case n.keys.BOTTOM:$(0,-n.keyPanSpeed),pe=!0;break;case n.keys.LEFT:$(n.keyPanSpeed,0),pe=!0;break;case n.keys.RIGHT:$(-n.keyPanSpeed,0),pe=!0;break}pe&&(ie.preventDefault(),n.update())}function Gt(){if(P.length==1)g.set(P[0].pageX,P[0].pageY);else{const ie=.5*(P[0].pageX+P[1].pageX),pe=.5*(P[0].pageY+P[1].pageY);g.set(ie,pe)}}function vt(){if(P.length==1)_.set(P[0].pageX,P[0].pageY);else{const ie=.5*(P[0].pageX+P[1].pageX),pe=.5*(P[0].pageY+P[1].pageY);_.set(ie,pe)}}function Te(){const ie=P[0].pageX-P[1].pageX,pe=P[0].pageY-P[1].pageY,Fe=Math.sqrt(ie*ie+pe*pe);T.set(0,Fe)}function Y(){n.enableZoom&&Te(),n.enablePan&&vt()}function Ee(){n.enableZoom&&Te(),n.enableRotate&&Gt()}function Ie(ie){if(P.length==1)y.set(ie.pageX,ie.pageY);else{const Fe=Rt(ie),te=.5*(ie.pageX+Fe.x),je=.5*(ie.pageY+Fe.y);y.set(te,je)}x.subVectors(y,g).multiplyScalar(n.rotateSpeed);const pe=n.domElement;pe&&(B(2*Math.PI*x.x/pe.clientHeight),J(2*Math.PI*x.y/pe.clientHeight)),g.copy(y)}function Ge(ie){if(P.length==1)S.set(ie.pageX,ie.pageY);else{const pe=Rt(ie),Fe=.5*(ie.pageX+pe.x),te=.5*(ie.pageY+pe.y);S.set(Fe,te)}w.subVectors(S,_).multiplyScalar(n.panSpeed),$(w.x,w.y),_.copy(S)}function Le(ie){const pe=Rt(ie),Fe=ie.pageX-pe.x,te=ie.pageY-pe.y,je=Math.sqrt(Fe*Fe+te*te);C.set(0,je),E.set(0,Math.pow(C.y/T.y,n.zoomSpeed)),se(E.y),T.copy(C)}function ot(ie){n.enableZoom&&Le(ie),n.enablePan&&Ge(ie)}function it(ie){n.enableZoom&&Le(ie),n.enableRotate&&Ie(ie)}function ft(ie){var pe,Fe;n.enabled!==!1&&(P.length===0&&((pe=n.domElement)==null||pe.ownerDocument.addEventListener("pointermove",Z),(Fe=n.domElement)==null||Fe.ownerDocument.addEventListener("pointerup",H)),bt(ie),ie.pointerType==="touch"?Mt(ie):ue(ie))}function Z(ie){n.enabled!==!1&&(ie.pointerType==="touch"?st(ie):Se(ie))}function H(ie){var pe,Fe,te;Pe(ie),P.length===0&&((pe=n.domElement)==null||pe.releasePointerCapture(ie.pointerId),(Fe=n.domElement)==null||Fe.ownerDocument.removeEventListener("pointermove",Z),(te=n.domElement)==null||te.ownerDocument.removeEventListener("pointerup",H)),n.dispatchEvent(a),l=o.NONE}function ue(ie){let pe;switch(ie.button){case 0:pe=n.mouseButtons.LEFT;break;case 1:pe=n.mouseButtons.MIDDLE;break;case 2:pe=n.mouseButtons.RIGHT;break;default:pe=-1}switch(pe){case Vl.DOLLY:if(n.enableZoom===!1)return;Oe(ie),l=o.DOLLY;break;case Vl.ROTATE:if(ie.ctrlKey||ie.metaKey||ie.shiftKey){if(n.enablePan===!1)return;fe(ie),l=o.PAN}else{if(n.enableRotate===!1)return;De(ie),l=o.ROTATE}break;case Vl.PAN:if(ie.ctrlKey||ie.metaKey||ie.shiftKey){if(n.enableRotate===!1)return;De(ie),l=o.ROTATE}else{if(n.enablePan===!1)return;fe(ie),l=o.PAN}break;default:l=o.NONE}l!==o.NONE&&n.dispatchEvent(s)}function Se(ie){if(n.enabled!==!1)switch(l){case o.ROTATE:if(n.enableRotate===!1)return;ge(ie);break;case o.DOLLY:if(n.enableZoom===!1)return;Ne(ie);break;case o.PAN:if(n.enablePan===!1)return;Qe(ie);break}}function Re(ie){n.enabled===!1||n.enableZoom===!1||l!==o.NONE&&l!==o.ROTATE||(ie.preventDefault(),n.dispatchEvent(s),et(ie),n.dispatchEvent(a))}function _e(ie){n.enabled===!1||n.enablePan===!1||Nt(ie)}function Mt(ie){switch(Xe(ie),P.length){case 1:switch(n.touches.ONE){case Gl.ROTATE:if(n.enableRotate===!1)return;Gt(),l=o.TOUCH_ROTATE;break;case Gl.PAN:if(n.enablePan===!1)return;vt(),l=o.TOUCH_PAN;break;default:l=o.NONE}break;case 2:switch(n.touches.TWO){case Gl.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Y(),l=o.TOUCH_DOLLY_PAN;break;case Gl.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Ee(),l=o.TOUCH_DOLLY_ROTATE;break;default:l=o.NONE}break;default:l=o.NONE}l!==o.NONE&&n.dispatchEvent(s)}function st(ie){switch(Xe(ie),l){case o.TOUCH_ROTATE:if(n.enableRotate===!1)return;Ie(ie),n.update();break;case o.TOUCH_PAN:if(n.enablePan===!1)return;Ge(ie),n.update();break;case o.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;ot(ie),n.update();break;case o.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;it(ie),n.update();break;default:l=o.NONE}}function At(ie){n.enabled!==!1&&ie.preventDefault()}function bt(ie){P.push(ie)}function Pe(ie){delete L[ie.pointerId];for(let pe=0;pe<P.length;pe++)if(P[pe].pointerId==ie.pointerId){P.splice(pe,1);return}}function Xe(ie){let pe=L[ie.pointerId];pe===void 0&&(pe=new Me,L[ie.pointerId]=pe),pe.set(ie.pageX,ie.pageY)}function Rt(ie){const pe=ie.pointerId===P[0].pointerId?P[1]:P[0];return L[pe.pointerId]}this.dollyIn=(ie=j())=>{ye(ie),n.update()},this.dollyOut=(ie=j())=>{se(ie),n.update()},this.getScale=()=>p,this.setScale=ie=>{Q(ie),n.update()},this.getZoomScale=()=>j(),t!==void 0&&this.connect(t),this.update()}}let Jfe=class extends Qfe{constructor(e,t){super(e,t),this.screenSpacePanning=!1,this.mouseButtons.LEFT=Vl.PAN,this.mouseButtons.RIGHT=Vl.ROTATE,this.touches.ONE=Gl.PAN,this.touches.TWO=Gl.DOLLY_ROTATE}};const KP=new Xi,ry=new K;class kA extends CA{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],t=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],n=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(n),this.setAttribute("position",new _t(e,3)),this.setAttribute("uv",new _t(t,2))}applyMatrix4(e){const t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return t!==void 0&&(t.applyMatrix4(e),n.applyMatrix4(e),t.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new Kv(t,6,1);return this.setAttribute("instanceStart",new ea(n,3,0)),this.setAttribute("instanceEnd",new ea(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e,t=3){let n;e instanceof Float32Array?n=e:Array.isArray(e)&&(n=new Float32Array(e));const r=new Kv(n,t*2,1);return this.setAttribute("instanceColorStart",new ea(r,t,0)),this.setAttribute("instanceColorEnd",new ea(r,t,t)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new yA(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Xi);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;e!==void 0&&t!==void 0&&(this.boundingBox.setFromBufferAttribute(e),KP.setFromBufferAttribute(t),this.boundingBox.union(KP))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Yi),this.boundingBox===null&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(e!==void 0&&t!==void 0){const n=this.boundingSphere.center;this.boundingBox.getCenter(n);let r=0;for(let s=0,a=e.count;s<a;s++)ry.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(ry)),ry.fromBufferAttribute(t,s),r=Math.max(r,n.distanceToSquared(ry));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}class cj extends kA{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,n=new Float32Array(2*t);for(let r=0;r<t;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return super.setPositions(n),this}setColors(e,t=3){const n=e.length-t,r=new Float32Array(2*n);if(t===3)for(let s=0;s<n;s+=t)r[2*s]=e[s],r[2*s+1]=e[s+1],r[2*s+2]=e[s+2],r[2*s+3]=e[s+3],r[2*s+4]=e[s+4],r[2*s+5]=e[s+5];else for(let s=0;s<n;s+=t)r[2*s]=e[s],r[2*s+1]=e[s+1],r[2*s+2]=e[s+2],r[2*s+3]=e[s+3],r[2*s+4]=e[s+4],r[2*s+5]=e[s+5],r[2*s+6]=e[s+6],r[2*s+7]=e[s+7];return super.setColors(r,t),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}class OA extends Ps{constructor(e){super({type:"LineMaterial",uniforms:ig.clone(ig.merge([at.common,at.fog,{worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Me(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}}])),vertexShader:`
				#include <common>
				#include <fog_pars_vertex>
				#include <logdepthbuf_pars_vertex>
				#include <clipping_planes_pars_vertex>

				uniform float linewidth;
				uniform vec2 resolution;

				attribute vec3 instanceStart;
				attribute vec3 instanceEnd;

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
						attribute vec4 instanceColorStart;
						attribute vec4 instanceColorEnd;
					#else
						varying vec3 vLineColor;
						attribute vec3 instanceColorStart;
						attribute vec3 instanceColorEnd;
					#endif
				#endif

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#ifdef USE_DASH

					uniform float dashScale;
					attribute float instanceDistanceStart;
					attribute float instanceDistanceEnd;
					varying float vLineDistance;

				#endif

				void trimSegment( const in vec4 start, inout vec4 end ) {

					// trim end segment so it terminates between the camera plane and the near plane

					// conservative estimate of the near plane
					float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
					float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
					float nearEstimate = - 0.5 * b / a;

					float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

					end.xyz = mix( start.xyz, end.xyz, alpha );

				}

				void main() {

					#ifdef USE_COLOR

						vLineColor = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

					#endif

					#ifdef USE_DASH

						vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
						vUv = uv;

					#endif

					float aspect = resolution.x / resolution.y;

					// camera space
					vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
					vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

					#ifdef WORLD_UNITS

						worldStart = start.xyz;
						worldEnd = end.xyz;

					#else

						vUv = uv;

					#endif

					// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
					// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
					// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
					// perhaps there is a more elegant solution -- WestLangley

					bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

					if ( perspective ) {

						if ( start.z < 0.0 && end.z >= 0.0 ) {

							trimSegment( start, end );

						} else if ( end.z < 0.0 && start.z >= 0.0 ) {

							trimSegment( end, start );

						}

					}

					// clip space
					vec4 clipStart = projectionMatrix * start;
					vec4 clipEnd = projectionMatrix * end;

					// ndc space
					vec3 ndcStart = clipStart.xyz / clipStart.w;
					vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

					// direction
					vec2 dir = ndcEnd.xy - ndcStart.xy;

					// account for clip-space aspect ratio
					dir.x *= aspect;
					dir = normalize( dir );

					#ifdef WORLD_UNITS

						// get the offset direction as perpendicular to the view vector
						vec3 worldDir = normalize( end.xyz - start.xyz );
						vec3 offset;
						if ( position.y < 0.5 ) {

							offset = normalize( cross( start.xyz, worldDir ) );

						} else {

							offset = normalize( cross( end.xyz, worldDir ) );

						}

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

						// don't extend the line if we're rendering dashes because we
						// won't be rendering the endcaps
						#ifndef USE_DASH

							// extend the line bounds to encompass  endcaps
							start.xyz += - worldDir * linewidth * 0.5;
							end.xyz += worldDir * linewidth * 0.5;

							// shift the position of the quad so it hugs the forward edge of the line
							offset.xy -= dir * forwardOffset;
							offset.z += 0.5;

						#endif

						// endcaps
						if ( position.y > 1.0 || position.y < 0.0 ) {

							offset.xy += dir * 2.0 * forwardOffset;

						}

						// adjust for linewidth
						offset *= linewidth * 0.5;

						// set the world position
						worldPos = ( position.y < 0.5 ) ? start : end;
						worldPos.xyz += offset;

						// project the worldpos
						vec4 clip = projectionMatrix * worldPos;

						// shift the depth of the projected points so the line
						// segments overlap neatly
						vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
						clip.z = clipPose.z * clip.w;

					#else

						vec2 offset = vec2( dir.y, - dir.x );
						// undo aspect ratio adjustment
						dir.x /= aspect;
						offset.x /= aspect;

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						// endcaps
						if ( position.y < 0.0 ) {

							offset += - dir;

						} else if ( position.y > 1.0 ) {

							offset += dir;

						}

						// adjust for linewidth
						offset *= linewidth;

						// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
						offset /= resolution.y;

						// select end
						vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

						// back to clip space
						offset *= clip.w;

						clip.xy += offset;

					#endif

					gl_Position = clip;

					vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

					#include <logdepthbuf_vertex>
					#include <clipping_planes_vertex>
					#include <fog_vertex>

				}
			`,fragmentShader:`
				uniform vec3 diffuse;
				uniform float opacity;
				uniform float linewidth;

				#ifdef USE_DASH

					uniform float dashOffset;
					uniform float dashSize;
					uniform float gapSize;

				#endif

				varying float vLineDistance;

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#include <common>
				#include <fog_pars_fragment>
				#include <logdepthbuf_pars_fragment>
				#include <clipping_planes_pars_fragment>

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
					#else
						varying vec3 vLineColor;
					#endif
				#endif

				vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

					float mua;
					float mub;

					vec3 p13 = p1 - p3;
					vec3 p43 = p4 - p3;

					vec3 p21 = p2 - p1;

					float d1343 = dot( p13, p43 );
					float d4321 = dot( p43, p21 );
					float d1321 = dot( p13, p21 );
					float d4343 = dot( p43, p43 );
					float d2121 = dot( p21, p21 );

					float denom = d2121 * d4343 - d4321 * d4321;

					float numer = d1343 * d4321 - d1321 * d4343;

					mua = numer / denom;
					mua = clamp( mua, 0.0, 1.0 );
					mub = ( d1343 + d4321 * ( mua ) ) / d4343;
					mub = clamp( mub, 0.0, 1.0 );

					return vec2( mua, mub );

				}

				void main() {

					#include <clipping_planes_fragment>

					#ifdef USE_DASH

						if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

						if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

					#endif

					float alpha = opacity;

					#ifdef WORLD_UNITS

						// Find the closest points on the view ray and the line segment
						vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
						vec3 lineDir = worldEnd - worldStart;
						vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

						vec3 p1 = worldStart + lineDir * params.x;
						vec3 p2 = rayEnd * params.y;
						vec3 delta = p1 - p2;
						float len = length( delta );
						float norm = len / linewidth;

						#ifndef USE_DASH

							#ifdef USE_ALPHA_TO_COVERAGE

								float dnorm = fwidth( norm );
								alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

							#else

								if ( norm > 0.5 ) {

									discard;

								}

							#endif

						#endif

					#else

						#ifdef USE_ALPHA_TO_COVERAGE

							// artifacts appear on some hardware if a derivative is taken within a conditional
							float a = vUv.x;
							float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
							float len2 = a * a + b * b;
							float dlen = fwidth( len2 );

							if ( abs( vUv.y ) > 1.0 ) {

								alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

							}

						#else

							if ( abs( vUv.y ) > 1.0 ) {

								float a = vUv.x;
								float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
								float len2 = a * a + b * b;

								if ( len2 > 1.0 ) discard;

							}

						#endif

					#endif

					vec4 diffuseColor = vec4( diffuse, alpha );
					#ifdef USE_COLOR
						#ifdef USE_LINE_COLOR_ALPHA
							diffuseColor *= vLineColor;
						#else
							diffuseColor.rgb *= vLineColor;
						#endif
					#endif

					#include <logdepthbuf_fragment>

					gl_FragColor = diffuseColor;

					#include <tonemapping_fragment>
					#include <${oj>=154?"colorspace_fragment":"encodings_fragment"}>
					#include <fog_fragment>
					#include <premultiplied_alpha_fragment>

				}
			`,clipping:!0}),this.isLineMaterial=!0,this.onBeforeCompile=function(){this.transparent?this.defines.USE_LINE_COLOR_ALPHA="1":delete this.defines.USE_LINE_COLOR_ALPHA},Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(t){this.uniforms.diffuse.value=t}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(t){t===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(t){this.uniforms.linewidth.value=t}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(t){!!t!="USE_DASH"in this.defines&&(this.needsUpdate=!0),t===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(t){this.uniforms.dashScale.value=t}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(t){this.uniforms.dashSize.value=t}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(t){this.uniforms.dashOffset.value=t}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(t){this.uniforms.gapSize.value=t}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}},alphaToCoverage:{enumerable:!0,get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(t){!!t!="USE_ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),t===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(e)}}const M4=new sn,ZP=new K,QP=new K,br=new sn,_r=new sn,Co=new sn,T4=new K,A4=new Bt,Sr=new CH,JP=new K,sy=new Xi,ay=new Yi,Eo=new sn;let Uo,Xh;function eI(i,e,t){return Eo.set(0,0,-e,1).applyMatrix4(i.projectionMatrix),Eo.multiplyScalar(1/Eo.w),Eo.x=Xh/t.width,Eo.y=Xh/t.height,Eo.applyMatrix4(i.projectionMatrixInverse),Eo.multiplyScalar(1/Eo.w),Math.abs(Math.max(Eo.x,Eo.y))}function e0e(i,e){const t=i.matrixWorld,n=i.geometry,r=n.attributes.instanceStart,s=n.attributes.instanceEnd,a=Math.min(n.instanceCount,r.count);for(let o=0,l=a;o<l;o++){Sr.start.fromBufferAttribute(r,o),Sr.end.fromBufferAttribute(s,o),Sr.applyMatrix4(t);const c=new K,u=new K;Uo.distanceSqToSegment(Sr.start,Sr.end,u,c),u.distanceTo(c)<Xh*.5&&e.push({point:u,pointOnLine:c,distance:Uo.origin.distanceTo(u),object:i,face:null,faceIndex:o,uv:null,[lj]:null})}}function t0e(i,e,t){const n=e.projectionMatrix,s=i.material.resolution,a=i.matrixWorld,o=i.geometry,l=o.attributes.instanceStart,c=o.attributes.instanceEnd,u=Math.min(o.instanceCount,l.count),d=-e.near;Uo.at(1,Co),Co.w=1,Co.applyMatrix4(e.matrixWorldInverse),Co.applyMatrix4(n),Co.multiplyScalar(1/Co.w),Co.x*=s.x/2,Co.y*=s.y/2,Co.z=0,T4.copy(Co),A4.multiplyMatrices(e.matrixWorldInverse,a);for(let p=0,m=u;p<m;p++){if(br.fromBufferAttribute(l,p),_r.fromBufferAttribute(c,p),br.w=1,_r.w=1,br.applyMatrix4(A4),_r.applyMatrix4(A4),br.z>d&&_r.z>d)continue;if(br.z>d){const w=br.z-_r.z,T=(br.z-d)/w;br.lerp(_r,T)}else if(_r.z>d){const w=_r.z-br.z,T=(_r.z-d)/w;_r.lerp(br,T)}br.applyMatrix4(n),_r.applyMatrix4(n),br.multiplyScalar(1/br.w),_r.multiplyScalar(1/_r.w),br.x*=s.x/2,br.y*=s.y/2,_r.x*=s.x/2,_r.y*=s.y/2,Sr.start.copy(br),Sr.start.z=0,Sr.end.copy(_r),Sr.end.z=0;const y=Sr.closestPointToPointParameter(T4,!0);Sr.at(y,JP);const x=iA.lerp(br.z,_r.z,y),_=x>=-1&&x<=1,S=T4.distanceTo(JP)<Xh*.5;if(_&&S){Sr.start.fromBufferAttribute(l,p),Sr.end.fromBufferAttribute(c,p),Sr.start.applyMatrix4(a),Sr.end.applyMatrix4(a);const w=new K,T=new K;Uo.distanceSqToSegment(Sr.start,Sr.end,T,w),t.push({point:T,pointOnLine:w,distance:Uo.origin.distanceTo(T),object:i,face:null,faceIndex:p,uv:null,[lj]:null})}}}class uj extends Bi{constructor(e=new kA,t=new OA({color:Math.random()*16777215})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,n=e.attributes.instanceEnd,r=new Float32Array(2*t.count);for(let a=0,o=0,l=t.count;a<l;a++,o+=2)ZP.fromBufferAttribute(t,a),QP.fromBufferAttribute(n,a),r[o]=o===0?0:r[o-1],r[o+1]=r[o]+ZP.distanceTo(QP);const s=new Kv(r,2,1);return e.setAttribute("instanceDistanceStart",new ea(s,1,0)),e.setAttribute("instanceDistanceEnd",new ea(s,1,1)),this}raycast(e,t){const n=this.material.worldUnits,r=e.camera;r===null&&!n&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const s=e.params.Line2!==void 0&&e.params.Line2.threshold||0;Uo=e.ray;const a=this.matrixWorld,o=this.geometry,l=this.material;Xh=l.linewidth+s,o.boundingSphere===null&&o.computeBoundingSphere(),ay.copy(o.boundingSphere).applyMatrix4(a);let c;if(n)c=Xh*.5;else{const d=Math.max(r.near,ay.distanceToPoint(Uo.origin));c=eI(r,d,l.resolution)}if(ay.radius+=c,Uo.intersectsSphere(ay)===!1)return;o.boundingBox===null&&o.computeBoundingBox(),sy.copy(o.boundingBox).applyMatrix4(a);let u;if(n)u=Xh*.5;else{const d=Math.max(r.near,sy.distanceToPoint(Uo.origin));u=eI(r,d,l.resolution)}sy.expandByScalar(u),Uo.intersectsBox(sy)!==!1&&(n?e0e(this,t):t0e(this,r,t))}onBeforeRender(e){const t=this.material.uniforms;t&&t.resolution&&(e.getViewport(M4),this.material.uniforms.resolution.value.set(M4.z,M4.w))}}class n0e extends uj{constructor(e=new cj,t=new OA({color:Math.random()*16777215})){super(e,t),this.isLine2=!0,this.type="Line2"}}const zA=z.forwardRef(function({points:e,color:t=16777215,vertexColors:n,linewidth:r,lineWidth:s,segments:a,dashed:o,...l},c){var u,d;const p=Qr(_=>_.size),m=z.useMemo(()=>a?new uj:new n0e,[a]),[g]=z.useState(()=>new OA),y=(n==null||(u=n[0])==null?void 0:u.length)===4?4:3,x=z.useMemo(()=>{const _=a?new kA:new cj,S=e.map(w=>{const T=Array.isArray(w);return w instanceof K||w instanceof sn?[w.x,w.y,w.z]:w instanceof Me?[w.x,w.y,0]:T&&w.length===3?[w[0],w[1],w[2]]:T&&w.length===2?[w[0],w[1],0]:w});if(_.setPositions(S.flat()),n){t=16777215;const w=n.map(T=>T instanceof pt?T.toArray():T);_.setColors(w.flat(),y)}return _},[e,a,n,y]);return z.useLayoutEffect(()=>{m.computeLineDistances()},[e,m]),z.useLayoutEffect(()=>{o?g.defines.USE_DASH="":delete g.defines.USE_DASH,g.needsUpdate=!0},[o,g]),z.useEffect(()=>()=>{x.dispose(),g.dispose()},[x]),z.createElement("primitive",Kh({object:m,ref:c},l),z.createElement("primitive",{object:x,attach:"geometry"}),z.createElement("primitive",Kh({object:g,attach:"material",color:t,vertexColors:!!n,resolution:[p.width,p.height],linewidth:(d=r??s)!==null&&d!==void 0?d:1,dashed:o,transparent:y===4},l)))});function i0e(i,e,t,n){var r;return r=class extends Ps{constructor(s){super({vertexShader:e,fragmentShader:t,...s});for(const a in i)this.uniforms[a]=new L2(i[a]),Object.defineProperty(this,a,{get(){return this.uniforms[a].value},set(o){this.uniforms[a].value=o}});this.uniforms=ig.clone(this.uniforms)}},r.key=iA.generateUUID(),r}function r0e(i,e,t){const n=Qr(m=>m.size),r=Qr(m=>m.viewport),s=typeof i=="number"?i:n.width*r.dpr,a=n.height*r.dpr,o=(typeof i=="number"?t:i)||{},{samples:l=0,depth:c,...u}=o,d=c??o.depthBuffer,p=z.useMemo(()=>{const m=new go(s,a,{minFilter:Jn,magFilter:Jn,type:bc,...u});return d&&(m.depthTexture=new v2(s,a,ns)),m.samples=l,m},[]);return z.useLayoutEffect(()=>{p.setSize(s,a),l&&(p.samples=l)},[l,p,s,a]),z.useEffect(()=>()=>p.dispose(),[]),p}const s0e=i=>typeof i=="function",hj=z.forwardRef(({envMap:i,resolution:e=256,frames:t=1/0,children:n,makeDefault:r,...s},a)=>{const o=Qr(({set:x})=>x),l=Qr(({camera:x})=>x),c=Qr(({size:x})=>x),u=z.useRef(null);z.useImperativeHandle(a,()=>u.current,[]);const d=z.useRef(null),p=r0e(e);z.useLayoutEffect(()=>{s.manual||u.current.updateProjectionMatrix()},[c,s]),z.useLayoutEffect(()=>{u.current.updateProjectionMatrix()}),z.useLayoutEffect(()=>{if(r){const x=l;return o(()=>({camera:u.current})),()=>o(()=>({camera:x}))}},[u,r,o]);let m=0,g=null;const y=s0e(n);return NA(x=>{y&&(t===1/0||m<t)&&(d.current.visible=!1,x.gl.setRenderTarget(p),g=x.scene.background,i&&(x.scene.background=i),x.gl.render(x.scene,u.current),x.scene.background=g,x.gl.setRenderTarget(null),d.current.visible=!0,m++)}),z.createElement(z.Fragment,null,z.createElement("orthographicCamera",Kh({left:c.width/-2,right:c.width/2,top:c.height/2,bottom:c.height/-2,ref:u},s),!y&&n),z.createElement("group",{ref:d},y&&n(p.texture)))}),a0e=z.forwardRef((i={enableDamping:!0},e)=>{const{domElement:t,camera:n,makeDefault:r,onChange:s,onStart:a,onEnd:o,...l}=i,c=Qr(S=>S.invalidate),u=Qr(S=>S.camera),d=Qr(S=>S.gl),p=Qr(S=>S.events),m=Qr(S=>S.set),g=Qr(S=>S.get),y=t||p.connected||d.domElement,x=n||u,_=z.useMemo(()=>new Jfe(x),[x]);return z.useEffect(()=>{_.connect(y);const S=w=>{c(),s&&s(w)};return _.addEventListener("change",S),a&&_.addEventListener("start",a),o&&_.addEventListener("end",o),()=>{_.dispose(),_.removeEventListener("change",S),a&&_.removeEventListener("start",a),o&&_.removeEventListener("end",o)}},[s,a,o,_,c,y]),z.useEffect(()=>{if(r){const S=g().controls;return m({controls:_}),()=>m({controls:S})}},[r,_]),NA(()=>_.update(),-1),z.createElement("primitive",Kh({ref:e,object:_,enableDamping:!0},l))});function o0e(i,e){const t=i+"Geometry";return z.forwardRef(({args:n,children:r,...s},a)=>{const o=z.useRef(null);return z.useImperativeHandle(a,()=>o.current),z.useLayoutEffect(()=>void e?.(o.current)),z.createElement("mesh",Kh({ref:o},s),z.createElement(t,{attach:"geometry",args:n}),r)})}const tI=o0e("circle"),dj=z.memo(function({buffer:e,width:t,height:n,dx:r,dy:s,vmin:a,vmax:o,isVisible:l}){const c=z.useRef(null),u=z.useMemo(()=>{const m=new Uint16Array(e),g=new Oa(m,t,n,Wg,bc);return g.minFilter=qi,g.magFilter=qi,g.wrapS=or,g.wrapT=or,g.flipY=!0,g.needsUpdate=!0,g},[e,t,n]);if(z.useEffect(()=>()=>{u.dispose()},[u]),z.useEffect(()=>{c.current&&(c.current.uniforms.uVmin.value=a,c.current.uniforms.uVmax.value=o)},[a,o]),!l)return null;const d=r+t/2,p=-s-n/2;return v.jsxs("mesh",{position:[d,p,0],children:[v.jsx("planeGeometry",{args:[t,n]}),v.jsx("grismMaterial",{ref:c,uTexture:u})]})}),l0e=z.memo(function({x:e,y:t,width:n,height:r,strokeColor:s="#ff0000",strokeWidth:a=2,dashed:o=!1}){const l=e,c=-t,u=z.useMemo(()=>[[0,0,0],[n,0,0],[n,-r,0],[0,-r,0],[0,0,0]],[n,r]);return v.jsx("group",{position:[l,c,10],children:v.jsx(zA,{points:u,color:s,lineWidth:a,dashed:o,dashSize:10,gapSize:5})})});function c0e({x:i,y:e,width:t,height:n,dx:r=0,dy:s=0}){const{camera:a}=Qr();return z.useLayoutEffect(()=>{const o=r+i+t/2,l=-(s+e+n/2);a.position.set(o,l,100),a.left=-t/2,a.right=t/2,a.top=n/2,a.bottom=-n/2,a.updateProjectionMatrix(),a.updateMatrixWorld()},[i,e,t,n,r,s,a]),null}function u0e({dx:i=0,dy:e=0,lineColor:t="#00aaaa",lineWidth:n=2,dashed:r=!1}){const{camera:s,size:a}=Qr(),{roiState:o,roiCollapseWindow:l,setRoiCollapseWindow:c}=un(Tt(D=>({roiState:D.roiState,roiCollapseWindow:D.roiCollapseWindow,setRoiCollapseWindow:D.setRoiCollapseWindow}))),u=z.useMemo(()=>{const{waveMin:D,waveMax:O,spatialMin:R,spatialMax:P}=l,L=O-D,V=P-R;if(L<=0||V<=0)return null;const j=i+o.x+D,B=-(e+o.y+R);return{groupX:j,groupY:B,rectWidth:L,rectHeight:V}},[o.x,o.y,l,i,e]),d=z.useMemo(()=>u?[[0,0,0],[u.rectWidth,0,0],[u.rectWidth,-u.rectHeight,0],[0,-u.rectHeight,0],[0,0,0]]:[],[u]),[p,m]=z.useState(!1),g=(D,O,R)=>{const[P,L]=D;m(!R);const V=s,j=Math.abs(V.top-V.bottom)/V.zoom,J=Math.abs(V.right-V.left)/V.zoom/a.width,U=j/a.height,X=P*J,$=L*U,{spatialMax:Q,spatialMin:se,waveMax:ye,waveMin:we}=l,He=o.height,De=o.width,Oe=5;let fe=se,ge=Q,Ne=we,Qe=ye;if(O==="move"||O==="top"||O==="bottom")if(O==="move"){if(fe+=$,ge+=$,fe<0){const et=-fe;fe+=et,ge+=et}if(ge>=He){const et=ge-He;fe-=et,ge-=et}}else O==="top"?(fe+=$,fe<0&&(fe=0),ge-fe<Oe&&(fe=ge-Oe)):O==="bottom"&&(ge+=$,ge>He&&(ge=He),ge-fe<Oe&&(ge=fe+Oe));if(O==="move"||O==="left"||O==="right")if(O==="move"){if(Ne+=X,Qe+=X,Ne<0){const et=-Ne;Ne+=et,Qe+=et}if(Qe>=De){const et=Qe-De;Ne-=et,Qe-=et}}else O==="left"?(Ne+=X,Ne<0&&(Ne=0),Qe-Ne<Oe&&(Ne=Qe-Oe)):O==="right"&&(Qe+=X,Qe>De&&(Qe=De),Qe-Ne<Oe&&(Qe=Ne+Oe));R&&(fe=Math.round(fe),ge=Math.round(ge),Ne=Math.round(Ne),Qe=Math.round(Qe)),c({spatialMin:fe,spatialMax:ge,waveMin:Ne,waveMax:Qe})},y=Fp(({delta:D,last:O,event:R})=>{R.stopPropagation(),g(D,"move",O)}),x=Fp(({delta:D,last:O,event:R})=>{R.stopPropagation(),g(D,"top",O)}),_=Fp(({delta:D,last:O,event:R})=>{R.stopPropagation(),g(D,"bottom",O)}),S=Fp(({delta:D,last:O,event:R})=>{R.stopPropagation(),g(D,"left",O)}),w=Fp(({delta:D,last:O,event:R})=>{R.stopPropagation(),g(D,"right",O)}),[T,C]=z.useState(null);if(z.useEffect(()=>{if(!p)return T==="move"?document.body.style.cursor="grab":T==="ns-edge"?document.body.style.cursor="ns-resize":T==="ew-edge"?document.body.style.cursor="ew-resize":document.body.style.cursor="auto",()=>{document.body.style.cursor="auto"}},[T,p]),!u)return null;const E=4;return v.jsxs("group",{position:[u.groupX,u.groupY,2],children:[v.jsx("mesh",{children:v.jsx(zA,{points:d,color:t,lineWidth:n,dashed:r,dashSize:10,gapSize:5,depthTest:!1,renderOrder:999,raycast:()=>null})}),v.jsxs("mesh",{...y(),position:[u.rectWidth/2,-u.rectHeight/2,0],onPointerOver:()=>C("move"),onPointerOut:()=>C(null),children:[v.jsx("planeGeometry",{args:[Math.max(0,u.rectWidth-E),Math.max(0,u.rectHeight-E)]}),v.jsx("meshBasicMaterial",{opacity:0,transparent:!0,depthWrite:!1})]}),v.jsxs("mesh",{...x(),position:[u.rectWidth/2,0,.01],onPointerOver:()=>C("ns-edge"),onPointerOut:()=>C(null),children:[v.jsx("planeGeometry",{args:[Math.max(0,u.rectWidth-E),E]}),v.jsx("meshBasicMaterial",{opacity:0,transparent:!0,depthWrite:!1})]}),v.jsxs("mesh",{..._(),position:[u.rectWidth/2,-u.rectHeight,.01],onPointerOver:()=>C("ns-edge"),onPointerOut:()=>C(null),children:[v.jsx("planeGeometry",{args:[Math.max(0,u.rectWidth-E),E]}),v.jsx("meshBasicMaterial",{opacity:0,transparent:!0,depthWrite:!1})]}),v.jsxs("mesh",{...S(),position:[0,-u.rectHeight/2,.01],onPointerOver:()=>C("ew-edge"),onPointerOut:()=>C(null),children:[v.jsx("planeGeometry",{args:[E,Math.max(0,u.rectHeight-E)]}),v.jsx("meshBasicMaterial",{opacity:0,transparent:!0,depthWrite:!1})]}),v.jsxs("mesh",{...w(),position:[u.rectWidth,-u.rectHeight/2,.01],onPointerOver:()=>C("ew-edge"),onPointerOut:()=>C(null),children:[v.jsx("planeGeometry",{args:[E,Math.max(0,u.rectHeight-E)]}),v.jsx("meshBasicMaterial",{opacity:0,transparent:!0,depthWrite:!1})]})]})}var C4={exports:{}};var nI;function h0e(){return nI||(nI=1,(function(i){(function(){var e={}.hasOwnProperty;function t(){for(var s="",a=0;a<arguments.length;a++){var o=arguments[a];o&&(s=r(s,n(o)))}return s}function n(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return t.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var a="";for(var o in s)e.call(s,o)&&s[o]&&(a=r(a,o));return a}function r(s,a){return a?s?s+" "+a:s+a:s}i.exports?(t.default=t,i.exports=t):window.classNames=t})()})(C4)),C4.exports}var d0e=h0e();const ca=od(d0e);function xd(i){let{top:e=0,left:t=0,transform:n,className:r,children:s,innerRef:a,...o}=i;return v.jsx("g",{ref:a,className:ca("visx-group",r),transform:n||`translate(${t}, ${e})`,...o,children:s})}function Uy(i,e){return i==null||e==null?NaN:i<e?-1:i>e?1:i>=e?0:NaN}function f0e(i,e){return i==null||e==null?NaN:e<i?-1:e>i?1:e>=i?0:NaN}function fj(i){let e,t,n;i.length!==2?(e=Uy,t=(o,l)=>Uy(i(o),l),n=(o,l)=>i(o)-l):(e=i===Uy||i===f0e?i:p0e,t=i,n=i);function r(o,l,c=0,u=o.length){if(c<u){if(e(l,l)!==0)return u;do{const d=c+u>>>1;t(o[d],l)<0?c=d+1:u=d}while(c<u)}return c}function s(o,l,c=0,u=o.length){if(c<u){if(e(l,l)!==0)return u;do{const d=c+u>>>1;t(o[d],l)<=0?c=d+1:u=d}while(c<u)}return c}function a(o,l,c=0,u=o.length){const d=r(o,l,c,u-1);return d>c&&n(o[d-1],l)>-n(o[d],l)?d-1:d}return{left:r,center:a,right:s}}function p0e(){return 0}function m0e(i){return i===null?NaN:+i}const g0e=fj(Uy),x0e=g0e.right;fj(m0e).center;var B5=Math.sqrt(50),H5=Math.sqrt(10),j5=Math.sqrt(2);function y0e(i,e,t){var n,r=-1,s,a,o;if(e=+e,i=+i,t=+t,i===e&&t>0)return[i];if((n=e<i)&&(s=i,i=e,e=s),(o=pj(i,e,t))===0||!isFinite(o))return[];if(o>0){let l=Math.round(i/o),c=Math.round(e/o);for(l*o<i&&++l,c*o>e&&--c,a=new Array(s=c-l+1);++r<s;)a[r]=(l+r)*o}else{o=-o;let l=Math.round(i*o),c=Math.round(e*o);for(l/o<i&&++l,c/o>e&&--c,a=new Array(s=c-l+1);++r<s;)a[r]=(l+r)/o}return n&&a.reverse(),a}function pj(i,e,t){var n=(e-i)/Math.max(0,t),r=Math.floor(Math.log(n)/Math.LN10),s=n/Math.pow(10,r);return r>=0?(s>=B5?10:s>=H5?5:s>=j5?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(s>=B5?10:s>=H5?5:s>=j5?2:1)}function v0e(i,e,t){var n=Math.abs(e-i)/Math.max(0,t),r=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),s=n/r;return s>=B5?r*=10:s>=H5?r*=5:s>=j5&&(r*=2),e<i?-r:r}function b0e(i,e){switch(arguments.length){case 0:break;case 1:this.range(i);break;default:this.range(e).domain(i);break}return this}function U0(i,e,t){i.prototype=e.prototype=t,t.constructor=i}function ix(i,e){var t=Object.create(i.prototype);for(var n in e)t[n]=e[n];return t}function zu(){}var nd=.7,v0=1/nd,Wf="\\s*([+-]?\\d+)\\s*",dg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ko="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",_0e=/^#([0-9a-f]{3,8})$/,S0e=new RegExp(`^rgb\\(${Wf},${Wf},${Wf}\\)$`),w0e=new RegExp(`^rgb\\(${Ko},${Ko},${Ko}\\)$`),M0e=new RegExp(`^rgba\\(${Wf},${Wf},${Wf},${dg}\\)$`),T0e=new RegExp(`^rgba\\(${Ko},${Ko},${Ko},${dg}\\)$`),A0e=new RegExp(`^hsl\\(${dg},${Ko},${Ko}\\)$`),C0e=new RegExp(`^hsla\\(${dg},${Ko},${Ko},${dg}\\)$`),iI={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};U0(zu,fg,{copy(i){return Object.assign(new this.constructor,this,i)},displayable(){return this.rgb().displayable()},hex:rI,formatHex:rI,formatHex8:E0e,formatHsl:R0e,formatRgb:sI,toString:sI});function rI(){return this.rgb().formatHex()}function E0e(){return this.rgb().formatHex8()}function R0e(){return mj(this).formatHsl()}function sI(){return this.rgb().formatRgb()}function fg(i){var e,t;return i=(i+"").trim().toLowerCase(),(e=_0e.exec(i))?(t=e[1].length,e=parseInt(e[1],16),t===6?aI(e):t===3?new lr(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?oy(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?oy(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=S0e.exec(i))?new lr(e[1],e[2],e[3],1):(e=w0e.exec(i))?new lr(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=M0e.exec(i))?oy(e[1],e[2],e[3],e[4]):(e=T0e.exec(i))?oy(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=A0e.exec(i))?cI(e[1],e[2]/100,e[3]/100,1):(e=C0e.exec(i))?cI(e[1],e[2]/100,e[3]/100,e[4]):iI.hasOwnProperty(i)?aI(iI[i]):i==="transparent"?new lr(NaN,NaN,NaN,0):null}function aI(i){return new lr(i>>16&255,i>>8&255,i&255,1)}function oy(i,e,t,n){return n<=0&&(i=e=t=NaN),new lr(i,e,t,n)}function UA(i){return i instanceof zu||(i=fg(i)),i?(i=i.rgb(),new lr(i.r,i.g,i.b,i.opacity)):new lr}function V5(i,e,t,n){return arguments.length===1?UA(i):new lr(i,e,t,n??1)}function lr(i,e,t,n){this.r=+i,this.g=+e,this.b=+t,this.opacity=+n}U0(lr,V5,ix(zu,{brighter(i){return i=i==null?v0:Math.pow(v0,i),new lr(this.r*i,this.g*i,this.b*i,this.opacity)},darker(i){return i=i==null?nd:Math.pow(nd,i),new lr(this.r*i,this.g*i,this.b*i,this.opacity)},rgb(){return this},clamp(){return new lr(Yh(this.r),Yh(this.g),Yh(this.b),nb(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:oI,formatHex:oI,formatHex8:P0e,formatRgb:lI,toString:lI}));function oI(){return`#${Uh(this.r)}${Uh(this.g)}${Uh(this.b)}`}function P0e(){return`#${Uh(this.r)}${Uh(this.g)}${Uh(this.b)}${Uh((isNaN(this.opacity)?1:this.opacity)*255)}`}function lI(){const i=nb(this.opacity);return`${i===1?"rgb(":"rgba("}${Yh(this.r)}, ${Yh(this.g)}, ${Yh(this.b)}${i===1?")":`, ${i})`}`}function nb(i){return isNaN(i)?1:Math.max(0,Math.min(1,i))}function Yh(i){return Math.max(0,Math.min(255,Math.round(i)||0))}function Uh(i){return i=Yh(i),(i<16?"0":"")+i.toString(16)}function cI(i,e,t,n){return n<=0?i=e=t=NaN:t<=0||t>=1?i=e=NaN:e<=0&&(i=NaN),new uo(i,e,t,n)}function mj(i){if(i instanceof uo)return new uo(i.h,i.s,i.l,i.opacity);if(i instanceof zu||(i=fg(i)),!i)return new uo;if(i instanceof uo)return i;i=i.rgb();var e=i.r/255,t=i.g/255,n=i.b/255,r=Math.min(e,t,n),s=Math.max(e,t,n),a=NaN,o=s-r,l=(s+r)/2;return o?(e===s?a=(t-n)/o+(t<n)*6:t===s?a=(n-e)/o+2:a=(e-t)/o+4,o/=l<.5?s+r:2-s-r,a*=60):o=l>0&&l<1?0:a,new uo(a,o,l,i.opacity)}function G5(i,e,t,n){return arguments.length===1?mj(i):new uo(i,e,t,n??1)}function uo(i,e,t,n){this.h=+i,this.s=+e,this.l=+t,this.opacity=+n}U0(uo,G5,ix(zu,{brighter(i){return i=i==null?v0:Math.pow(v0,i),new uo(this.h,this.s,this.l*i,this.opacity)},darker(i){return i=i==null?nd:Math.pow(nd,i),new uo(this.h,this.s,this.l*i,this.opacity)},rgb(){var i=this.h%360+(this.h<0)*360,e=isNaN(i)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*e,r=2*t-n;return new lr(E4(i>=240?i-240:i+120,r,n),E4(i,r,n),E4(i<120?i+240:i-120,r,n),this.opacity)},clamp(){return new uo(uI(this.h),ly(this.s),ly(this.l),nb(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const i=nb(this.opacity);return`${i===1?"hsl(":"hsla("}${uI(this.h)}, ${ly(this.s)*100}%, ${ly(this.l)*100}%${i===1?")":`, ${i})`}`}}));function uI(i){return i=(i||0)%360,i<0?i+360:i}function ly(i){return Math.max(0,Math.min(1,i||0))}function E4(i,e,t){return(i<60?e+(t-e)*i/60:i<180?t:i<240?e+(t-e)*(240-i)/60:e)*255}const gj=Math.PI/180,xj=180/Math.PI,ib=18,yj=.96422,vj=1,bj=.82521,_j=4/29,qf=6/29,Sj=3*qf*qf,I0e=qf*qf*qf;function wj(i){if(i instanceof Zo)return new Zo(i.l,i.a,i.b,i.opacity);if(i instanceof Zl)return Mj(i);i instanceof lr||(i=UA(i));var e=D4(i.r),t=D4(i.g),n=D4(i.b),r=R4((.2225045*e+.7168786*t+.0606169*n)/vj),s,a;return e===t&&t===n?s=a=r:(s=R4((.4360747*e+.3850649*t+.1430804*n)/yj),a=R4((.0139322*e+.0971045*t+.7141733*n)/bj)),new Zo(116*r-16,500*(s-r),200*(r-a),i.opacity)}function W5(i,e,t,n){return arguments.length===1?wj(i):new Zo(i,e,t,n??1)}function Zo(i,e,t,n){this.l=+i,this.a=+e,this.b=+t,this.opacity=+n}U0(Zo,W5,ix(zu,{brighter(i){return new Zo(this.l+ib*(i??1),this.a,this.b,this.opacity)},darker(i){return new Zo(this.l-ib*(i??1),this.a,this.b,this.opacity)},rgb(){var i=(this.l+16)/116,e=isNaN(this.a)?i:i+this.a/500,t=isNaN(this.b)?i:i-this.b/200;return e=yj*P4(e),i=vj*P4(i),t=bj*P4(t),new lr(I4(3.1338561*e-1.6168667*i-.4906146*t),I4(-.9787684*e+1.9161415*i+.033454*t),I4(.0719453*e-.2289914*i+1.4052427*t),this.opacity)}}));function R4(i){return i>I0e?Math.pow(i,1/3):i/Sj+_j}function P4(i){return i>qf?i*i*i:Sj*(i-_j)}function I4(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function D4(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function D0e(i){if(i instanceof Zl)return new Zl(i.h,i.c,i.l,i.opacity);if(i instanceof Zo||(i=wj(i)),i.a===0&&i.b===0)return new Zl(NaN,0<i.l&&i.l<100?0:NaN,i.l,i.opacity);var e=Math.atan2(i.b,i.a)*xj;return new Zl(e<0?e+360:e,Math.sqrt(i.a*i.a+i.b*i.b),i.l,i.opacity)}function q5(i,e,t,n){return arguments.length===1?D0e(i):new Zl(i,e,t,n??1)}function Zl(i,e,t,n){this.h=+i,this.c=+e,this.l=+t,this.opacity=+n}function Mj(i){if(isNaN(i.h))return new Zo(i.l,0,0,i.opacity);var e=i.h*gj;return new Zo(i.l,Math.cos(e)*i.c,Math.sin(e)*i.c,i.opacity)}U0(Zl,q5,ix(zu,{brighter(i){return new Zl(this.h,this.c,this.l+ib*(i??1),this.opacity)},darker(i){return new Zl(this.h,this.c,this.l-ib*(i??1),this.opacity)},rgb(){return Mj(this).rgb()}}));var Tj=-.14861,FA=1.78277,BA=-.29227,F2=-.90649,pg=1.97294,hI=pg*F2,dI=pg*FA,fI=FA*BA-F2*Tj;function N0e(i){if(i instanceof $h)return new $h(i.h,i.s,i.l,i.opacity);i instanceof lr||(i=UA(i));var e=i.r/255,t=i.g/255,n=i.b/255,r=(fI*n+hI*e-dI*t)/(fI+hI-dI),s=n-r,a=(pg*(t-r)-BA*s)/F2,o=Math.sqrt(a*a+s*s)/(pg*r*(1-r)),l=o?Math.atan2(a,s)*xj-120:NaN;return new $h(l<0?l+360:l,o,r,i.opacity)}function X5(i,e,t,n){return arguments.length===1?N0e(i):new $h(i,e,t,n??1)}function $h(i,e,t,n){this.h=+i,this.s=+e,this.l=+t,this.opacity=+n}U0($h,X5,ix(zu,{brighter(i){return i=i==null?v0:Math.pow(v0,i),new $h(this.h,this.s,this.l*i,this.opacity)},darker(i){return i=i==null?nd:Math.pow(nd,i),new $h(this.h,this.s,this.l*i,this.opacity)},rgb(){var i=isNaN(this.h)?0:(this.h+120)*gj,e=+this.l,t=isNaN(this.s)?0:this.s*e*(1-e),n=Math.cos(i),r=Math.sin(i);return new lr(255*(e+t*(Tj*n+FA*r)),255*(e+t*(BA*n+F2*r)),255*(e+t*(pg*n)),this.opacity)}}));const B2=i=>()=>i;function Aj(i,e){return function(t){return i+t*e}}function L0e(i,e,t){return i=Math.pow(i,t),e=Math.pow(e,t)-i,t=1/t,function(n){return Math.pow(i+n*e,t)}}function HA(i,e){var t=e-i;return t?Aj(i,t>180||t<-180?t-360*Math.round(t/360):t):B2(isNaN(i)?e:i)}function k0e(i){return(i=+i)==1?cr:function(e,t){return t-e?L0e(e,t,i):B2(isNaN(e)?t:e)}}function cr(i,e){var t=e-i;return t?Aj(i,t):B2(isNaN(i)?e:i)}const Y5=(function i(e){var t=k0e(e);function n(r,s){var a=t((r=V5(r)).r,(s=V5(s)).r),o=t(r.g,s.g),l=t(r.b,s.b),c=cr(r.opacity,s.opacity);return function(u){return r.r=a(u),r.g=o(u),r.b=l(u),r.opacity=c(u),r+""}}return n.gamma=i,n})(1);function O0e(i,e){e||(e=[]);var t=i?Math.min(e.length,i.length):0,n=e.slice(),r;return function(s){for(r=0;r<t;++r)n[r]=i[r]*(1-s)+e[r]*s;return n}}function z0e(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function U0e(i,e){var t=e?e.length:0,n=i?Math.min(t,i.length):0,r=new Array(n),s=new Array(t),a;for(a=0;a<n;++a)r[a]=jA(i[a],e[a]);for(;a<t;++a)s[a]=e[a];return function(o){for(a=0;a<n;++a)s[a]=r[a](o);return s}}function F0e(i,e){var t=new Date;return i=+i,e=+e,function(n){return t.setTime(i*(1-n)+e*n),t}}function rb(i,e){return i=+i,e=+e,function(t){return i*(1-t)+e*t}}function B0e(i,e){var t={},n={},r;(i===null||typeof i!="object")&&(i={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in i?t[r]=jA(i[r],e[r]):n[r]=e[r];return function(s){for(r in t)n[r]=t[r](s);return n}}var $5=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,N4=new RegExp($5.source,"g");function H0e(i){return function(){return i}}function j0e(i){return function(e){return i(e)+""}}function V0e(i,e){var t=$5.lastIndex=N4.lastIndex=0,n,r,s,a=-1,o=[],l=[];for(i=i+"",e=e+"";(n=$5.exec(i))&&(r=N4.exec(e));)(s=r.index)>t&&(s=e.slice(t,s),o[a]?o[a]+=s:o[++a]=s),(n=n[0])===(r=r[0])?o[a]?o[a]+=r:o[++a]=r:(o[++a]=null,l.push({i:a,x:rb(n,r)})),t=N4.lastIndex;return t<e.length&&(s=e.slice(t),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?j0e(l[0].x):H0e(e):(e=l.length,function(c){for(var u=0,d;u<e;++u)o[(d=l[u]).i]=d.x(c);return o.join("")})}function jA(i,e){var t=typeof e,n;return e==null||t==="boolean"?B2(e):(t==="number"?rb:t==="string"?(n=fg(e))?(e=n,Y5):V0e:e instanceof fg?Y5:e instanceof Date?F0e:z0e(e)?O0e:Array.isArray(e)?U0e:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?B0e:rb)(i,e)}function Cj(i,e){return i=+i,e=+e,function(t){return Math.round(i*(1-t)+e*t)}}function Ej(i){return function(e,t){var n=i((e=G5(e)).h,(t=G5(t)).h),r=cr(e.s,t.s),s=cr(e.l,t.l),a=cr(e.opacity,t.opacity);return function(o){return e.h=n(o),e.s=r(o),e.l=s(o),e.opacity=a(o),e+""}}}const G0e=Ej(HA);var W0e=Ej(cr);function q0e(i,e){var t=cr((i=W5(i)).l,(e=W5(e)).l),n=cr(i.a,e.a),r=cr(i.b,e.b),s=cr(i.opacity,e.opacity);return function(a){return i.l=t(a),i.a=n(a),i.b=r(a),i.opacity=s(a),i+""}}function Rj(i){return function(e,t){var n=i((e=q5(e)).h,(t=q5(t)).h),r=cr(e.c,t.c),s=cr(e.l,t.l),a=cr(e.opacity,t.opacity);return function(o){return e.h=n(o),e.c=r(o),e.l=s(o),e.opacity=a(o),e+""}}}const X0e=Rj(HA);var Y0e=Rj(cr);function Pj(i){return(function e(t){t=+t;function n(r,s){var a=i((r=X5(r)).h,(s=X5(s)).h),o=cr(r.s,s.s),l=cr(r.l,s.l),c=cr(r.opacity,s.opacity);return function(u){return r.h=a(u),r.s=o(u),r.l=l(Math.pow(u,t)),r.opacity=c(u),r+""}}return n.gamma=e,n})(1)}const $0e=Pj(HA);var K0e=Pj(cr);function Z0e(i){return function(){return i}}function Q0e(i){return+i}var pI=[0,1];function zf(i){return i}function K5(i,e){return(e-=i=+i)?function(t){return(t-i)/e}:Z0e(isNaN(e)?NaN:.5)}function J0e(i,e){var t;return i>e&&(t=i,i=e,e=t),function(n){return Math.max(i,Math.min(e,n))}}function epe(i,e,t){var n=i[0],r=i[1],s=e[0],a=e[1];return r<n?(n=K5(r,n),s=t(a,s)):(n=K5(n,r),s=t(s,a)),function(o){return s(n(o))}}function tpe(i,e,t){var n=Math.min(i.length,e.length)-1,r=new Array(n),s=new Array(n),a=-1;for(i[n]<i[0]&&(i=i.slice().reverse(),e=e.slice().reverse());++a<n;)r[a]=K5(i[a],i[a+1]),s[a]=t(e[a],e[a+1]);return function(o){var l=x0e(i,o,1,n)-1;return s[l](r[l](o))}}function npe(i,e){return e.domain(i.domain()).range(i.range()).interpolate(i.interpolate()).clamp(i.clamp()).unknown(i.unknown())}function ipe(){var i=pI,e=pI,t=jA,n,r,s,a=zf,o,l,c;function u(){var p=Math.min(i.length,e.length);return a!==zf&&(a=J0e(i[0],i[p-1])),o=p>2?tpe:epe,l=c=null,d}function d(p){return p==null||isNaN(p=+p)?s:(l||(l=o(i.map(n),e,t)))(n(a(p)))}return d.invert=function(p){return a(r((c||(c=o(e,i.map(n),rb)))(p)))},d.domain=function(p){return arguments.length?(i=Array.from(p,Q0e),u()):i.slice()},d.range=function(p){return arguments.length?(e=Array.from(p),u()):e.slice()},d.rangeRound=function(p){return e=Array.from(p),t=Cj,u()},d.clamp=function(p){return arguments.length?(a=p?!0:zf,u()):a!==zf},d.interpolate=function(p){return arguments.length?(t=p,u()):t},d.unknown=function(p){return arguments.length?(s=p,d):s},function(p,m){return n=p,r=m,u()}}function rpe(){return ipe()(zf,zf)}function spe(i){return Math.abs(i=Math.round(i))>=1e21?i.toLocaleString("en").replace(/,/g,""):i.toString(10)}function sb(i,e){if((t=(i=e?i.toExponential(e-1):i.toExponential()).indexOf("e"))<0)return null;var t,n=i.slice(0,t);return[n.length>1?n[0]+n.slice(2):n,+i.slice(t+1)]}function b0(i){return i=sb(Math.abs(i)),i?i[1]:NaN}function ape(i,e){return function(t,n){for(var r=t.length,s=[],a=0,o=i[0],l=0;r>0&&o>0&&(l+o+1>n&&(o=Math.max(1,n-l)),s.push(t.substring(r-=o,r+o)),!((l+=o+1)>n));)o=i[a=(a+1)%i.length];return s.reverse().join(e)}}function ope(i){return function(e){return e.replace(/[0-9]/g,function(t){return i[+t]})}}var lpe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ab(i){if(!(e=lpe.exec(i)))throw new Error("invalid format: "+i);var e;return new VA({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}ab.prototype=VA.prototype;function VA(i){this.fill=i.fill===void 0?" ":i.fill+"",this.align=i.align===void 0?">":i.align+"",this.sign=i.sign===void 0?"-":i.sign+"",this.symbol=i.symbol===void 0?"":i.symbol+"",this.zero=!!i.zero,this.width=i.width===void 0?void 0:+i.width,this.comma=!!i.comma,this.precision=i.precision===void 0?void 0:+i.precision,this.trim=!!i.trim,this.type=i.type===void 0?"":i.type+""}VA.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function cpe(i){e:for(var e=i.length,t=1,n=-1,r;t<e;++t)switch(i[t]){case".":n=r=t;break;case"0":n===0&&(n=t),r=t;break;default:if(!+i[t])break e;n>0&&(n=0);break}return n>0?i.slice(0,n)+i.slice(r+1):i}var Ij;function upe(i,e){var t=sb(i,e);if(!t)return i+"";var n=t[0],r=t[1],s=r-(Ij=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,a=n.length;return s===a?n:s>a?n+new Array(s-a+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+sb(i,Math.max(0,e+s-1))[0]}function mI(i,e){var t=sb(i,e);if(!t)return i+"";var n=t[0],r=t[1];return r<0?"0."+new Array(-r).join("0")+n:n.length>r+1?n.slice(0,r+1)+"."+n.slice(r+1):n+new Array(r-n.length+2).join("0")}const gI={"%":(i,e)=>(i*100).toFixed(e),b:i=>Math.round(i).toString(2),c:i=>i+"",d:spe,e:(i,e)=>i.toExponential(e),f:(i,e)=>i.toFixed(e),g:(i,e)=>i.toPrecision(e),o:i=>Math.round(i).toString(8),p:(i,e)=>mI(i*100,e),r:mI,s:upe,X:i=>Math.round(i).toString(16).toUpperCase(),x:i=>Math.round(i).toString(16)};function xI(i){return i}var yI=Array.prototype.map,vI=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function hpe(i){var e=i.grouping===void 0||i.thousands===void 0?xI:ape(yI.call(i.grouping,Number),i.thousands+""),t=i.currency===void 0?"":i.currency[0]+"",n=i.currency===void 0?"":i.currency[1]+"",r=i.decimal===void 0?".":i.decimal+"",s=i.numerals===void 0?xI:ope(yI.call(i.numerals,String)),a=i.percent===void 0?"%":i.percent+"",o=i.minus===void 0?"":i.minus+"",l=i.nan===void 0?"NaN":i.nan+"";function c(d){d=ab(d);var p=d.fill,m=d.align,g=d.sign,y=d.symbol,x=d.zero,_=d.width,S=d.comma,w=d.precision,T=d.trim,C=d.type;C==="n"?(S=!0,C="g"):gI[C]||(w===void 0&&(w=12),T=!0,C="g"),(x||p==="0"&&m==="=")&&(x=!0,p="0",m="=");var E=y==="$"?t:y==="#"&&/[boxX]/.test(C)?"0"+C.toLowerCase():"",D=y==="$"?n:/[%p]/.test(C)?a:"",O=gI[C],R=/[defgprs%]/.test(C);w=w===void 0?6:/[gprs]/.test(C)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function P(L){var V=E,j=D,B,J,U;if(C==="c")j=O(L)+j,L="";else{L=+L;var X=L<0||1/L<0;if(L=isNaN(L)?l:O(Math.abs(L),w),T&&(L=cpe(L)),X&&+L==0&&g!=="+"&&(X=!1),V=(X?g==="("?g:o:g==="-"||g==="("?"":g)+V,j=(C==="s"?vI[8+Ij/3]:"")+j+(X&&g==="("?")":""),R){for(B=-1,J=L.length;++B<J;)if(U=L.charCodeAt(B),48>U||U>57){j=(U===46?r+L.slice(B+1):L.slice(B))+j,L=L.slice(0,B);break}}}S&&!x&&(L=e(L,1/0));var $=V.length+L.length+j.length,Q=$<_?new Array(_-$+1).join(p):"";switch(S&&x&&(L=e(Q+L,Q.length?_-j.length:1/0),Q=""),m){case"<":L=V+L+j+Q;break;case"=":L=V+Q+L+j;break;case"^":L=Q.slice(0,$=Q.length>>1)+V+L+j+Q.slice($);break;default:L=Q+V+L+j;break}return s(L)}return P.toString=function(){return d+""},P}function u(d,p){var m=c((d=ab(d),d.type="f",d)),g=Math.max(-8,Math.min(8,Math.floor(b0(p)/3)))*3,y=Math.pow(10,-g),x=vI[8+g/3];return function(_){return m(y*_)+x}}return{format:c,formatPrefix:u}}var cy,Dj,Nj;dpe({thousands:",",grouping:[3],currency:["$",""]});function dpe(i){return cy=hpe(i),Dj=cy.format,Nj=cy.formatPrefix,cy}function fpe(i){return Math.max(0,-b0(Math.abs(i)))}function ppe(i,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(b0(e)/3)))*3-b0(Math.abs(i)))}function mpe(i,e){return i=Math.abs(i),e=Math.abs(e)-i,Math.max(0,b0(e)-b0(i))+1}function gpe(i,e,t,n){var r=v0e(i,e,t),s;switch(n=ab(n??",f"),n.type){case"s":{var a=Math.max(Math.abs(i),Math.abs(e));return n.precision==null&&!isNaN(s=ppe(r,a))&&(n.precision=s),Nj(n,a)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=mpe(r,Math.max(Math.abs(i),Math.abs(e))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=fpe(r))&&(n.precision=s-(n.type==="%")*2);break}}return Dj(n)}function xpe(i){var e=i.domain;return i.ticks=function(t){var n=e();return y0e(n[0],n[n.length-1],t??10)},i.tickFormat=function(t,n){var r=e();return gpe(r[0],r[r.length-1],t??10,n)},i.nice=function(t){t==null&&(t=10);var n=e(),r=0,s=n.length-1,a=n[r],o=n[s],l,c,u=10;for(o<a&&(c=a,a=o,o=c,c=r,r=s,s=c);u-- >0;){if(c=pj(a,o,t),c===l)return n[r]=a,n[s]=o,e(n);if(c>0)a=Math.floor(a/c)*c,o=Math.ceil(o/c)*c;else if(c<0)a=Math.ceil(a*c)/c,o=Math.floor(o*c)/c;else break;l=c}return i},i}function _0(){var i=rpe();return i.copy=function(){return npe(i,_0())},b0e.apply(i,arguments),xpe(i)}const L4=new Date,k4=new Date;function Ar(i,e,t,n){function r(s){return i(s=arguments.length===0?new Date:new Date(+s)),s}return r.floor=s=>(i(s=new Date(+s)),s),r.ceil=s=>(i(s=new Date(s-1)),e(s,1),i(s),s),r.round=s=>{const a=r(s),o=r.ceil(s);return s-a<o-s?a:o},r.offset=(s,a)=>(e(s=new Date(+s),a==null?1:Math.floor(a)),s),r.range=(s,a,o)=>{const l=[];if(s=r.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let c;do l.push(c=new Date(+s)),e(s,o),i(s);while(c<s&&s<a);return l},r.filter=s=>Ar(a=>{if(a>=a)for(;i(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;e(a,-1),!s(a););else for(;--o>=0;)for(;e(a,1),!s(a););}),t&&(r.count=(s,a)=>(L4.setTime(+s),k4.setTime(+a),i(L4),i(k4),Math.floor(t(L4,k4))),r.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?r.filter(n?a=>n(a)%s===0:a=>r.count(0,a)%s===0):r)),r}const mg=1e3,_u=mg*60,gg=_u*60,xg=gg*24,Lj=xg*7,GA=Ar(i=>{i.setTime(i-i.getMilliseconds())},(i,e)=>{i.setTime(+i+e*mg)},(i,e)=>(e-i)/mg,i=>i.getUTCSeconds());GA.range;const kj=Ar(i=>{i.setTime(i-i.getMilliseconds()-i.getSeconds()*mg)},(i,e)=>{i.setTime(+i+e*_u)},(i,e)=>(e-i)/_u,i=>i.getMinutes());kj.range;const Oj=Ar(i=>{i.setUTCSeconds(0,0)},(i,e)=>{i.setTime(+i+e*_u)},(i,e)=>(e-i)/_u,i=>i.getUTCMinutes());Oj.range;const zj=Ar(i=>{i.setTime(i-i.getMilliseconds()-i.getSeconds()*mg-i.getMinutes()*_u)},(i,e)=>{i.setTime(+i+e*gg)},(i,e)=>(e-i)/gg,i=>i.getHours());zj.range;const Uj=Ar(i=>{i.setUTCMinutes(0,0,0)},(i,e)=>{i.setTime(+i+e*gg)},(i,e)=>(e-i)/gg,i=>i.getUTCHours());Uj.range;const Fj=Ar(i=>i.setHours(0,0,0,0),(i,e)=>i.setDate(i.getDate()+e),(i,e)=>(e-i-(e.getTimezoneOffset()-i.getTimezoneOffset())*_u)/xg,i=>i.getDate()-1);Fj.range;const Bj=Ar(i=>{i.setUTCHours(0,0,0,0)},(i,e)=>{i.setUTCDate(i.getUTCDate()+e)},(i,e)=>(e-i)/xg,i=>i.getUTCDate()-1);Bj.range;const ype=Ar(i=>{i.setUTCHours(0,0,0,0)},(i,e)=>{i.setUTCDate(i.getUTCDate()+e)},(i,e)=>(e-i)/xg,i=>Math.floor(i/xg));ype.range;function yd(i){return Ar(e=>{e.setDate(e.getDate()-(e.getDay()+7-i)%7),e.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+t*7)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*_u)/Lj)}const Hj=yd(0),vpe=yd(1),bpe=yd(2),_pe=yd(3),Spe=yd(4),wpe=yd(5),Mpe=yd(6);Hj.range;vpe.range;bpe.range;_pe.range;Spe.range;wpe.range;Mpe.range;function vd(i){return Ar(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-i)%7),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t*7)},(e,t)=>(t-e)/Lj)}const jj=vd(0),Tpe=vd(1),Ape=vd(2),Cpe=vd(3),Epe=vd(4),Rpe=vd(5),Ppe=vd(6);jj.range;Tpe.range;Ape.range;Cpe.range;Epe.range;Rpe.range;Ppe.range;const Vj=Ar(i=>{i.setDate(1),i.setHours(0,0,0,0)},(i,e)=>{i.setMonth(i.getMonth()+e)},(i,e)=>e.getMonth()-i.getMonth()+(e.getFullYear()-i.getFullYear())*12,i=>i.getMonth());Vj.range;const Gj=Ar(i=>{i.setUTCDate(1),i.setUTCHours(0,0,0,0)},(i,e)=>{i.setUTCMonth(i.getUTCMonth()+e)},(i,e)=>e.getUTCMonth()-i.getUTCMonth()+(e.getUTCFullYear()-i.getUTCFullYear())*12,i=>i.getUTCMonth());Gj.range;const WA=Ar(i=>{i.setMonth(0,1),i.setHours(0,0,0,0)},(i,e)=>{i.setFullYear(i.getFullYear()+e)},(i,e)=>e.getFullYear()-i.getFullYear(),i=>i.getFullYear());WA.every=i=>!isFinite(i=Math.floor(i))||!(i>0)?null:Ar(e=>{e.setFullYear(Math.floor(e.getFullYear()/i)*i),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t*i)});WA.range;const qA=Ar(i=>{i.setUTCMonth(0,1),i.setUTCHours(0,0,0,0)},(i,e)=>{i.setUTCFullYear(i.getUTCFullYear()+e)},(i,e)=>e.getUTCFullYear()-i.getUTCFullYear(),i=>i.getUTCFullYear());qA.every=i=>!isFinite(i=Math.floor(i))||!(i>0)?null:Ar(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/i)*i),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t*i)});qA.range;function Ipe(i,e){e.domain&&("nice"in i||"quantiles"in i||"padding"in i,i.domain(e.domain))}function Dpe(i,e){e.range&&("padding"in i,i.range(e.range))}function Npe(i,e){"align"in i&&"align"in e&&typeof e.align<"u"&&i.align(e.align)}function Lpe(i,e){"base"in i&&"base"in e&&typeof e.base<"u"&&i.base(e.base)}function kpe(i,e){"clamp"in i&&"clamp"in e&&typeof e.clamp<"u"&&i.clamp(e.clamp)}function Ope(i,e){"constant"in i&&"constant"in e&&typeof e.constant<"u"&&i.constant(e.constant)}function zpe(i,e){"exponent"in i&&"exponent"in e&&typeof e.exponent<"u"&&i.exponent(e.exponent)}const bI={lab:q0e,hcl:X0e,"hcl-long":Y0e,hsl:G0e,"hsl-long":W0e,cubehelix:$0e,"cubehelix-long":K0e,rgb:Y5};function Upe(i){switch(i){case"lab":case"hcl":case"hcl-long":case"hsl":case"hsl-long":case"cubehelix":case"cubehelix-long":case"rgb":return bI[i]}const{type:e,gamma:t}=i,n=bI[e];return typeof t>"u"?n:n.gamma(t)}function Fpe(i,e){if("interpolate"in e&&"interpolate"in i&&typeof e.interpolate<"u"){const t=Upe(e.interpolate);i.interpolate(t)}}const Bpe=new Date(Date.UTC(2020,1,2,3,4,5)),Hpe="%Y-%m-%d %H:%M";function jpe(i){return i.tickFormat(1,Hpe)(Bpe)==="2020-02-02 03:04"}const _I={day:Fj,hour:zj,minute:kj,month:Vj,second:GA,week:Hj,year:WA},SI={day:Bj,hour:Uj,minute:Oj,month:Gj,second:GA,week:jj,year:qA};function Vpe(i,e){if("nice"in e&&typeof e.nice<"u"&&"nice"in i){const{nice:t}=e;if(typeof t=="boolean")t&&i.nice();else if(typeof t=="number")i.nice(t);else{const n=i,r=jpe(n);if(typeof t=="string")n.nice(r?SI[t]:_I[t]);else{const{interval:s,step:a}=t,o=(r?SI[s]:_I[s]).every(a);o!=null&&n.nice(o)}}}}function Gpe(i,e){"padding"in i&&"padding"in e&&typeof e.padding<"u"&&i.padding(e.padding),"paddingInner"in i&&"paddingInner"in e&&typeof e.paddingInner<"u"&&i.paddingInner(e.paddingInner),"paddingOuter"in i&&"paddingOuter"in e&&typeof e.paddingOuter<"u"&&i.paddingOuter(e.paddingOuter)}function Wpe(i,e){if(e.reverse){const t=i.range().slice().reverse();"padding"in i,i.range(t)}}function qpe(i,e){"round"in e&&typeof e.round<"u"&&(e.round&&"interpolate"in e&&typeof e.interpolate<"u"?console.warn("[visx/scale/applyRound] ignoring round: scale config contains round and interpolate. only applying interpolate. config:",e):"round"in i?i.round(e.round):"interpolate"in i&&e.round&&i.interpolate(Cj))}function Xpe(i,e){"unknown"in i&&"unknown"in e&&typeof e.unknown<"u"&&i.unknown(e.unknown)}function Ype(i,e){if("zero"in e&&e.zero===!0){const t=i.domain(),[n,r]=t,s=r<n,[a,o]=s?[r,n]:[n,r],l=[Math.min(0,a),Math.max(0,o)];i.domain(s?l.reverse():l)}}const $pe=["domain","nice","zero","interpolate","round","range","reverse","align","base","clamp","constant","exponent","padding","unknown"],Kpe={domain:Ipe,nice:Vpe,zero:Ype,interpolate:Fpe,round:qpe,align:Npe,base:Lpe,clamp:kpe,constant:Ope,exponent:zpe,padding:Gpe,range:Dpe,reverse:Wpe,unknown:Xpe};function Zpe(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];const n=new Set(e),r=$pe.filter(s=>n.has(s));return function(a,o){return typeof o<"u"&&r.forEach(l=>{Kpe[l](a,o)}),a}}const Qpe=Zpe("domain","range","reverse","clamp","interpolate","nice","round","zero");function wI(i){return Qpe(_0(),i)}function Wj(i){if((typeof i=="function"||typeof i=="object"&&i)&&"valueOf"in i){const e=i.valueOf();if(typeof e=="number")return e}return i}function Jpe(i,e){const t=i;return"ticks"in t?t.ticks(e):t.domain().filter((n,r,s)=>e==null||s.length<=e||r%Math.round((s.length-1)/e)===0)}function eme(i){return i?.toString()}function sr(i){return function(){return i}}const Z5=Math.PI,Q5=2*Z5,Ih=1e-6,tme=Q5-Ih;function qj(i){this._+=i[0];for(let e=1,t=i.length;e<t;++e)this._+=arguments[e]+i[e]}function nme(i){let e=Math.floor(i);if(!(e>=0))throw new Error(`invalid digits: ${i}`);if(e>15)return qj;const t=10**e;return function(n){this._+=n[0];for(let r=1,s=n.length;r<s;++r)this._+=Math.round(arguments[r]*t)/t+n[r]}}class ime{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?qj:nme(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,n,r){this._append`Q${+e},${+t},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(e,t,n,r,s,a){this._append`C${+e},${+t},${+n},${+r},${this._x1=+s},${this._y1=+a}`}arcTo(e,t,n,r,s){if(e=+e,t=+t,n=+n,r=+r,s=+s,s<0)throw new Error(`negative radius: ${s}`);let a=this._x1,o=this._y1,l=n-e,c=r-t,u=a-e,d=o-t,p=u*u+d*d;if(this._x1===null)this._append`M${this._x1=e},${this._y1=t}`;else if(p>Ih)if(!(Math.abs(d*l-c*u)>Ih)||!s)this._append`L${this._x1=e},${this._y1=t}`;else{let m=n-a,g=r-o,y=l*l+c*c,x=m*m+g*g,_=Math.sqrt(y),S=Math.sqrt(p),w=s*Math.tan((Z5-Math.acos((y+p-x)/(2*_*S)))/2),T=w/S,C=w/_;Math.abs(T-1)>Ih&&this._append`L${e+T*u},${t+T*d}`,this._append`A${s},${s},0,0,${+(d*m>u*g)},${this._x1=e+C*l},${this._y1=t+C*c}`}}arc(e,t,n,r,s,a){if(e=+e,t=+t,n=+n,a=!!a,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(r),l=n*Math.sin(r),c=e+o,u=t+l,d=1^a,p=a?r-s:s-r;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>Ih||Math.abs(this._y1-u)>Ih)&&this._append`L${c},${u}`,n&&(p<0&&(p=p%Q5+Q5),p>tme?this._append`A${n},${n},0,1,${d},${e-o},${t-l}A${n},${n},0,1,${d},${this._x1=c},${this._y1=u}`:p>Ih&&this._append`A${n},${n},0,${+(p>=Z5)},${d},${this._x1=e+n*Math.cos(s)},${this._y1=t+n*Math.sin(s)}`)}rect(e,t,n,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function Xj(i){let e=3;return i.digits=function(t){if(!arguments.length)return e;if(t==null)e=null;else{const n=Math.floor(t);if(!(n>=0))throw new RangeError(`invalid digits: ${t}`);e=n}return i},()=>new ime(e)}function Yj(i){return typeof i=="object"&&"length"in i?i:Array.from(i)}function $j(i){this._context=i}$j.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(i,e){switch(i=+i,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(i,e):this._context.moveTo(i,e);break;case 1:this._point=2;default:this._context.lineTo(i,e);break}}};function ob(i){return new $j(i)}function Kj(i){return i[0]}function Zj(i){return i[1]}function Qj(i,e){var t=sr(!0),n=null,r=ob,s=null,a=Xj(o);i=typeof i=="function"?i:i===void 0?Kj:sr(i),e=typeof e=="function"?e:e===void 0?Zj:sr(e);function o(l){var c,u=(l=Yj(l)).length,d,p=!1,m;for(n==null&&(s=r(m=a())),c=0;c<=u;++c)!(c<u&&t(d=l[c],c,l))===p&&((p=!p)?s.lineStart():s.lineEnd()),p&&s.point(+i(d,c,l),+e(d,c,l));if(m)return s=null,m+""||null}return o.x=function(l){return arguments.length?(i=typeof l=="function"?l:sr(+l),o):i},o.y=function(l){return arguments.length?(e=typeof l=="function"?l:sr(+l),o):e},o.defined=function(l){return arguments.length?(t=typeof l=="function"?l:sr(!!l),o):t},o.curve=function(l){return arguments.length?(r=l,n!=null&&(s=r(n)),o):r},o.context=function(l){return arguments.length?(l==null?n=s=null:s=r(n=l),o):n},o}function rme(i,e,t){var n=null,r=sr(!0),s=null,a=ob,o=null,l=Xj(c);i=typeof i=="function"?i:i===void 0?Kj:sr(+i),e=typeof e=="function"?e:sr(e===void 0?0:+e),t=typeof t=="function"?t:t===void 0?Zj:sr(+t);function c(d){var p,m,g,y=(d=Yj(d)).length,x,_=!1,S,w=new Array(y),T=new Array(y);for(s==null&&(o=a(S=l())),p=0;p<=y;++p){if(!(p<y&&r(x=d[p],p,d))===_)if(_=!_)m=p,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),g=p-1;g>=m;--g)o.point(w[g],T[g]);o.lineEnd(),o.areaEnd()}_&&(w[p]=+i(x,p,d),T[p]=+e(x,p,d),o.point(n?+n(x,p,d):w[p],t?+t(x,p,d):T[p]))}if(S)return o=null,S+""||null}function u(){return Qj().defined(r).curve(a).context(s)}return c.x=function(d){return arguments.length?(i=typeof d=="function"?d:sr(+d),n=null,c):i},c.x0=function(d){return arguments.length?(i=typeof d=="function"?d:sr(+d),c):i},c.x1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:sr(+d),c):n},c.y=function(d){return arguments.length?(e=typeof d=="function"?d:sr(+d),t=null,c):e},c.y0=function(d){return arguments.length?(e=typeof d=="function"?d:sr(+d),c):e},c.y1=function(d){return arguments.length?(t=d==null?null:typeof d=="function"?d:sr(+d),c):t},c.lineX0=c.lineY0=function(){return u().x(i).y(e)},c.lineY1=function(){return u().x(i).y(t)},c.lineX1=function(){return u().x(n).y(e)},c.defined=function(d){return arguments.length?(r=typeof d=="function"?d:sr(!!d),c):r},c.curve=function(d){return arguments.length?(a=d,s!=null&&(o=a(s)),c):a},c.context=function(d){return arguments.length?(d==null?s=o=null:o=a(s=d),c):s},c}function Jj(i,e){this._context=i,this._t=e}Jj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(i,e){switch(i=+i,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(i,e):this._context.moveTo(i,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(i,e);else{var t=this._x*(1-this._t)+i*this._t;this._context.lineTo(t,this._y),this._context.lineTo(t,e)}break}}this._x=i,this._y=e}};function yg(i){return new Jj(i,.5)}function oo(i,e){i(e)}function sme(){let{x:i,x0:e,x1:t,y:n,y0:r,y1:s,defined:a,curve:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const l=rme();return i&&oo(l.x,i),e&&oo(l.x0,e),t&&oo(l.x1,t),n&&oo(l.y,n),r&&oo(l.y0,r),s&&oo(l.y1,s),a&&l.defined(a),o&&l.curve(o),l}function ame(){let{x:i,y:e,defined:t,curve:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=Qj();return i&&oo(r.x,i),e&&oo(r.y,e),t&&r.defined(t),n&&r.curve(n),r}function wm(i){let{from:e={x:0,y:0},to:t={x:1,y:1},fill:n="transparent",className:r,innerRef:s,...a}=i;const o=e.x===t.x||e.y===t.y;return v.jsx("line",{ref:s,className:ca("visx-line",r),x1:e.x,y1:e.y,x2:t.x,y2:t.y,fill:n,shapeRendering:o?"crispEdges":"auto",...a})}function vg(i){let{children:e,data:t=[],x:n,y:r,fill:s="transparent",className:a,curve:o,innerRef:l,defined:c=()=>!0,...u}=i;const d=ame({x:n,y:r,defined:c,curve:o});return e?v.jsx(v.Fragment,{children:e({path:d})}):v.jsx("path",{ref:l,className:ca("visx-linepath",a),d:d(t)||"",fill:s,strokeLinecap:"round",...u})}function eV(i){let{x:e,x0:t,x1:n,y:r,y1:s,y0:a,yScale:o,data:l=[],defined:c=()=>!0,className:u,curve:d,innerRef:p,children:m,...g}=i;const y=sme({x:e,x0:t,x1:n,defined:c,curve:d});return a==null?y.y0(o.range()[0]):oo(y.y0,a),r&&!s&&oo(y.y1,r),s&&!r&&oo(y.y1,s),m?v.jsx(v.Fragment,{children:m({path:y})}):v.jsx("path",{ref:p,className:ca("visx-area-closed",u),d:y(l)||"",...g})}function ome(i){let{className:e,innerRef:t,...n}=i;return v.jsx("rect",{ref:t,className:ca("visx-bar",e),...n})}var O4,MI;function lme(){if(MI)return O4;MI=1,O4=i;function i(n,r,s){n instanceof RegExp&&(n=e(n,s)),r instanceof RegExp&&(r=e(r,s));var a=t(n,r,s);return a&&{start:a[0],end:a[1],pre:s.slice(0,a[0]),body:s.slice(a[0]+n.length,a[1]),post:s.slice(a[1]+r.length)}}function e(n,r){var s=r.match(n);return s?s[0]:null}i.range=t;function t(n,r,s){var a,o,l,c,u,d=s.indexOf(n),p=s.indexOf(r,d+1),m=d;if(d>=0&&p>0){for(a=[],l=s.length;m>=0&&!u;)m==d?(a.push(m),d=s.indexOf(n,m+1)):a.length==1?u=[a.pop(),p]:(o=a.pop(),o<l&&(l=o,c=p),p=s.indexOf(r,m+1)),m=d<p&&d>=0?d:p;a.length&&(u=[l,c])}return u}return O4}var z4,TI;function cme(){if(TI)return z4;TI=1,z4=i;function i(n,r,s){n instanceof RegExp&&(n=e(n,s)),r instanceof RegExp&&(r=e(r,s));var a=t(n,r,s);return a&&{start:a[0],end:a[1],pre:s.slice(0,a[0]),body:s.slice(a[0]+n.length,a[1]),post:s.slice(a[1]+r.length)}}function e(n,r){var s=r.match(n);return s?s[0]:null}i.range=t;function t(n,r,s){var a,o,l,c,u,d=s.indexOf(n),p=s.indexOf(r,d+1),m=d;if(d>=0&&p>0){if(n===r)return[d,p];for(a=[],l=s.length;m>=0&&!u;)m==d?(a.push(m),d=s.indexOf(n,m+1)):a.length==1?u=[a.pop(),p]:(o=a.pop(),o<l&&(l=o,c=p),p=s.indexOf(r,m+1)),m=d<p&&d>=0?d:p;a.length&&(u=[l,c])}return u}return z4}var U4,AI;function ume(){if(AI)return U4;AI=1;var i=cme();U4=e;function e(r,s,a){var o=r;return t(r,s).reduce(function(l,c){return l.replace(c.functionIdentifier+"("+c.matches.body+")",n(c.matches.body,c.functionIdentifier,a,o,s))},r)}function t(r,s){var a=[],o=typeof s=="string"?new RegExp("\\b("+s+")\\("):s;do{var l=o.exec(r);if(!l)return a;if(l[1]===void 0)throw new Error("Missing the first couple of parenthesis to get the function identifier in "+s);var c=l[1],u=l.index,d=i("(",")",r.substring(u));if(!d||d.start!==l[0].length-1)throw new SyntaxError(c+"(): missing closing ')' in the value '"+r+"'");a.push({matches:d,functionIdentifier:c}),r=d.post}while(o.test(r));return a}function n(r,s,a,o,l){return a(e(r,l,a),s,o)}return U4}var F4,CI;function hme(){if(CI)return F4;CI=1;var i=function(e){this.value=e};return i.math={isDegree:!0,acos:function(e){return i.math.isDegree?180/Math.PI*Math.acos(e):Math.acos(e)},add:function(e,t){return e+t},asin:function(e){return i.math.isDegree?180/Math.PI*Math.asin(e):Math.asin(e)},atan:function(e){return i.math.isDegree?180/Math.PI*Math.atan(e):Math.atan(e)},acosh:function(e){return Math.log(e+Math.sqrt(e*e-1))},asinh:function(e){return Math.log(e+Math.sqrt(e*e+1))},atanh:function(e){return Math.log((1+e)/(1-e))},C:function(e,t){var n=1,r=e-t,s=t;s<r&&(s=r,r=t);for(var a=s+1;a<=e;a++)n*=a;return n/i.math.fact(r)},changeSign:function(e){return-e},cos:function(e){return i.math.isDegree&&(e=i.math.toRadian(e)),Math.cos(e)},cosh:function(e){return(Math.pow(Math.E,e)+Math.pow(Math.E,-1*e))/2},div:function(e,t){return e/t},fact:function(e){if(e%1!==0)return"NaN";for(var t=1,n=2;n<=e;n++)t*=n;return t},inverse:function(e){return 1/e},log:function(e){return Math.log(e)/Math.log(10)},mod:function(e,t){return e%t},mul:function(e,t){return e*t},P:function(e,t){for(var n=1,r=Math.floor(e)-Math.floor(t)+1;r<=Math.floor(e);r++)n*=r;return n},Pi:function(e,t,n){for(var r=1,s=e;s<=t;s++)r*=Number(n.postfixEval({n:s}));return r},pow10x:function(e){for(var t=1;e--;)t*=10;return t},sigma:function(e,t,n){for(var r=0,s=e;s<=t;s++)r+=Number(n.postfixEval({n:s}));return r},sin:function(e){return i.math.isDegree&&(e=i.math.toRadian(e)),Math.sin(e)},sinh:function(e){return(Math.pow(Math.E,e)-Math.pow(Math.E,-1*e))/2},sub:function(e,t){return e-t},tan:function(e){return i.math.isDegree&&(e=i.math.toRadian(e)),Math.tan(e)},tanh:function(e){return i.sinha(e)/i.cosha(e)},toRadian:function(e){return e*Math.PI/180},and:function(e,t){return e&t}},i.Exception=function(e){this.message=e},F4=i,F4}var B4,EI;function dme(){if(EI)return B4;EI=1;var i=hme();function e(S,w){for(var T=0;T<S.length;T++)S[T]+=w;return S}for(var t=[{token:"sin",show:"sin",type:0,value:i.math.sin},{token:"cos",show:"cos",type:0,value:i.math.cos},{token:"tan",show:"tan",type:0,value:i.math.tan},{token:"pi",show:"&pi;",type:3,value:"PI"},{token:"(",show:"(",type:4,value:"("},{token:")",show:")",type:5,value:")"},{token:"P",show:"P",type:10,value:i.math.P},{token:"C",show:"C",type:10,value:i.math.C},{token:" ",show:" ",type:14,value:" ".anchor},{token:"asin",show:"asin",type:0,value:i.math.asin},{token:"acos",show:"acos",type:0,value:i.math.acos},{token:"atan",show:"atan",type:0,value:i.math.atan},{token:"7",show:"7",type:1,value:"7"},{token:"8",show:"8",type:1,value:"8"},{token:"9",show:"9",type:1,value:"9"},{token:"int",show:"Int",type:0,value:Math.floor},{token:"cosh",show:"cosh",type:0,value:i.math.cosh},{token:"acosh",show:"acosh",type:0,value:i.math.acosh},{token:"ln",show:" ln",type:0,value:Math.log},{token:"^",show:"^",type:10,value:Math.pow},{token:"root",show:"root",type:0,value:Math.sqrt},{token:"4",show:"4",type:1,value:"4"},{token:"5",show:"5",type:1,value:"5"},{token:"6",show:"6",type:1,value:"6"},{token:"/",show:"&divide;",type:2,value:i.math.div},{token:"!",show:"!",type:7,value:i.math.fact},{token:"tanh",show:"tanh",type:0,value:i.math.tanh},{token:"atanh",show:"atanh",type:0,value:i.math.atanh},{token:"Mod",show:" Mod ",type:2,value:i.math.mod},{token:"1",show:"1",type:1,value:"1"},{token:"2",show:"2",type:1,value:"2"},{token:"3",show:"3",type:1,value:"3"},{token:"*",show:"&times;",type:2,value:i.math.mul},{token:"sinh",show:"sinh",type:0,value:i.math.sinh},{token:"asinh",show:"asinh",type:0,value:i.math.asinh},{token:"e",show:"e",type:3,value:"E"},{token:"log",show:" log",type:0,value:i.math.log},{token:"0",show:"0",type:1,value:"0"},{token:".",show:".",type:6,value:"."},{token:"+",show:"+",type:9,value:i.math.add},{token:"-",show:"-",type:9,value:i.math.sub},{token:",",show:",",type:11,value:","},{token:"Sigma",show:"&Sigma;",type:12,value:i.math.sigma},{token:"n",show:"n",type:13,value:"n"},{token:"Pi",show:"&Pi;",type:12,value:i.math.Pi},{token:"pow",show:"pow",type:8,value:Math.pow,numberOfArguments:2},{token:"&",show:"&",type:9,value:i.math.and}],n={0:11,1:0,2:3,3:0,4:0,5:0,6:0,7:11,8:11,9:1,10:10,11:0,12:11,13:0,14:-1,15:11},r=0;r<t.length;r++)t[r].precedence=n[t[r].type];var s={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,9:!0,12:!0,13:!0,14:!0,15:!0},a={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,12:!0,13:!0,15:!0},o={0:!0,3:!0,4:!0,8:!0,12:!0,13:!0,15:!0},l={},c={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,12:!0,13:!0,15:!0},u={1:!0},d=[[],["1","2","3","7","8","9","4","5","6","+","-","*","/","(",")","^","!","P","C","e","0",".",",","n"," ","&"],["pi","ln","Pi"],["sin","cos","tan","Del","int","Mod","log","pow"],["asin","acos","atan","cosh","root","tanh","sinh"],["acosh","atanh","asinh","Sigma"]];function p(S,w,T,C){for(var E=0;E<C;E++)if(S[T+E]!==w[E])return!1;return!0}i.tokenTypes={FUNCTION_WITH_ONE_ARG:0,NUMBER:1,BINARY_OPERATOR_HIGH_PRECENDENCE:2,CONSTANT:3,OPENING_PARENTHESIS:4,CLOSING_PARENTHESIS:5,DECIMAL:6,POSTFIX_FUNCTION_WITH_ONE_ARG:7,FUNCTION_WITH_N_ARGS:8,BINARY_OPERATOR_LOW_PRECENDENCE:9,BINARY_OPERATOR_PERMUTATION:10,COMMA:11,EVALUATED_FUNCTION:12,EVALUATED_FUNCTION_PARAMETER:13,SPACE:14},i.addToken=function(S){for(var w=0;w<S.length;w++){var T=S[w].token.length,C=-1;S[w].type===i.tokenTypes.FUNCTION_WITH_N_ARGS&&S[w].numberOfArguments===void 0&&(S[w].numberOfArguments=2),d[T]=d[T]||[];for(var E=0;E<d[T].length;E++)if(S[w].token===d[T][E]){C=m(d[T][E],t);break}C===-1?(t.push(S[w]),S[w].precedence=n[S[w].type],d.length<=S[w].token.length&&(d[S[w].token.length]=[]),d[S[w].token.length].push(S[w].token)):(t[C]=S[w],S[w].precedence=n[S[w].type])}};function m(S,w){for(var T=0;T<w.length;T++)if(w[T].token===S)return T;return-1}function g(S){for(var w=[],T=S.length,C,E,D,O=0;O<T;O++)if(!(O<T-1&&S[O]===" "&&S[O+1]===" ")){for(C="",E=S.length-O>d.length-2?d.length-1:S.length-O;E>0;E--)if(d[E]!==void 0)for(D=0;D<d[E].length;D++)p(S,d[E][D],O,E)&&(C=d[E][D],D=d[E].length,E=0);if(O+=C.length-1,C==="")throw new i.Exception("Can't understand after "+S.slice(O));w.push(t[m(C,t)])}return w}var y={value:i.math.changeSign,type:0,pre:21,show:"-"},x={value:")",show:")",type:5,pre:0},_={value:"(",type:4,pre:0,show:"("};return i.lex=function(S,w){var T=[_],C=[],E=S,D=s,O=0,R=l,P="",L;typeof w<"u"&&i.addToken(w);var V={},j=g(E);for(L=0;L<j.length;L++){var B=j[L];if(B.type===14){if(L>0&&L<j.length-1&&j[L+1].type===1&&(j[L-1].type===1||j[L-1].type===6))throw new i.Exception("Unexpected Space");continue}var J=B.token,U=B.type,X=B.value,$=B.precedence,Q=B.show,se=T[T.length-1],ye;for(ye=C.length;ye--&&C[ye]===0;)if([0,2,3,4,5,9,11,12,13].indexOf(U)!==-1){if(D[U]!==!0)throw new i.Exception(J+" is not allowed after "+P);T.push(x),D=a,R=c,C.pop()}if(D[U]!==!0)throw new i.Exception(J+" is not allowed after "+P);if(R[U]===!0&&(U=2,X=i.math.mul,Q="&times;",$=3,L=L-1),V={value:X,type:U,pre:$,show:Q,numberOfArguments:B.numberOfArguments},U===0)D=s,R=l,e(C,2),T.push(V),j[L+1].type!==4&&(T.push(_),C.push(2));else if(U===1)se.type===1?(se.value+=X,e(C,1)):T.push(V),D=a,R=o;else if(U===2)D=s,R=l,e(C,2),T.push(V);else if(U===3)T.push(V),D=a,R=c;else if(U===4)e(C,1),O++,D=s,R=l,T.push(V);else if(U===5){if(!O)throw new i.Exception("Closing parenthesis are more than opening one, wait What!!!");O--,D=a,R=c,T.push(V),e(C,1)}else if(U===6){if(se.hasDec)throw new i.Exception("Two decimals are not allowed in one number");se.type!==1&&(se={value:0,type:1,pre:0},T.push(se)),D=u,e(C,1),R=l,se.value+=X,se.hasDec=!0}else U===7&&(D=a,R=c,e(C,1),T.push(V));U===8?(D=s,R=l,e(C,B.numberOfArguments+2),T.push(V),j[L+1].type!==4&&(T.push(_),C.push(B.numberOfArguments+2))):U===9?(se.type===9?se.value===i.math.add?(se.value=X,se.show=Q,e(C,1)):se.value===i.math.sub&&Q==="-"&&(se.value=i.math.add,se.show="+",e(C,1)):se.type!==5&&se.type!==7&&se.type!==1&&se.type!==3&&se.type!==13?J==="-"&&(D=s,R=l,e(C,2).push(2),T.push(y),T.push(_)):(T.push(V),e(C,2)),D=s,R=l):U===10?(D=s,R=l,e(C,2),T.push(V)):U===11?(D=s,R=l,T.push(V)):U===12?(D=s,R=l,e(C,6),T.push(V),j[L+1].type!==4&&(T.push(_),C.push(6))):U===13&&(D=a,R=c,T.push(V)),e(C,-1),P=J}for(ye=C.length;ye--;)T.push(x);if(D[5]!==!0)throw new i.Exception("complete the expression");for(;O--;)T.push(x);return T.push(x),new i(T)},B4=i,B4}var H4,RI;function fme(){if(RI)return H4;RI=1;var i=dme();return i.prototype.toPostfix=function(){for(var e=[],t,n,r,s,a,o=[{value:"(",type:4,pre:0}],l=this.value,c=1;c<l.length;c++)if(l[c].type===1||l[c].type===3||l[c].type===13)l[c].type===1&&(l[c].value=Number(l[c].value)),e.push(l[c]);else if(l[c].type===4)o.push(l[c]);else if(l[c].type===5)for(;(n=o.pop()).type!==4;)e.push(n);else if(l[c].type===11){for(;(n=o.pop()).type!==4;)e.push(n);o.push(n)}else{t=l[c],s=t.pre,a=o[o.length-1],r=a.pre;var u=a.value=="Math.pow"&&t.value=="Math.pow";if(s>r)o.push(t);else{for(;r>=s&&!u||u&&s<r;)n=o.pop(),a=o[o.length-1],e.push(n),r=a.pre,u=t.value=="Math.pow"&&a.value=="Math.pow";o.push(t)}}return new i(e)},H4=i,H4}var j4,PI;function pme(){if(PI)return j4;PI=1;var i=fme();return i.prototype.postfixEval=function(e){e=e||{},e.PI=Math.PI,e.E=Math.E;for(var t=[],n,r,s,a=this.value,o=typeof e.n<"u",l=0;l<a.length;l++)if(a[l].type===1)t.push({value:a[l].value,type:1});else if(a[l].type===3)t.push({value:e[a[l].value],type:1});else if(a[l].type===0)typeof t[t.length-1].type>"u"?t[t.length-1].value.push(a[l]):t[t.length-1].value=a[l].value(t[t.length-1].value);else if(a[l].type===7)typeof t[t.length-1].type>"u"?t[t.length-1].value.push(a[l]):t[t.length-1].value=a[l].value(t[t.length-1].value);else if(a[l].type===8){for(var c=[],u=0;u<a[l].numberOfArguments;u++)c.push(t.pop().value);t.push({type:1,value:a[l].value.apply(a[l],c.reverse())})}else a[l].type===10?(n=t.pop(),r=t.pop(),typeof r.type>"u"?(r.value=r.concat(n),r.value.push(a[l]),t.push(r)):typeof n.type>"u"?(n.unshift(r),n.push(a[l]),t.push(n)):t.push({type:1,value:a[l].value(r.value,n.value)})):a[l].type===2||a[l].type===9?(n=t.pop(),r=t.pop(),typeof r.type>"u"?(r=r.concat(n),r.push(a[l]),t.push(r)):typeof n.type>"u"?(n.unshift(r),n.push(a[l]),t.push(n)):t.push({type:1,value:a[l].value(r.value,n.value)})):a[l].type===12?(n=t.pop(),typeof n.type<"u"&&(n=[n]),r=t.pop(),s=t.pop(),t.push({type:1,value:a[l].value(s.value,r.value,new i(n))})):a[l].type===13&&(o?t.push({value:e[a[l].value],type:3}):t.push([a[l]]));if(t.length>1)throw new i.Exception("Uncaught Syntax error");return t[0].value>1e15?"Infinity":parseFloat(t[0].value.toFixed(15))},i.eval=function(e,t,n){return typeof t>"u"?this.lex(e).toPostfix().postfixEval():typeof n>"u"?typeof t.length<"u"?this.lex(e,t).toPostfix().postfixEval():this.lex(e).toPostfix().postfixEval(t):this.lex(e,t).toPostfix().postfixEval(n)},j4=i,j4}var V4,II;function mme(){if(II)return V4;II=1;var i=pme();return i.prototype.formulaEval=function(){for(var e,t,n,r=[],s=this.value,a=0;a<s.length;a++)s[a].type===1||s[a].type===3?r.push({value:s[a].type===3?s[a].show:s[a].value,type:1}):s[a].type===13?r.push({value:s[a].show,type:1}):s[a].type===0?r[r.length-1]={value:s[a].show+(s[a].show!="-"?"(":"")+r[r.length-1].value+(s[a].show!="-"?")":""),type:0}:s[a].type===7?r[r.length-1]={value:(r[r.length-1].type!=1?"(":"")+r[r.length-1].value+(r[r.length-1].type!=1?")":"")+s[a].show,type:7}:s[a].type===10?(e=r.pop(),t=r.pop(),s[a].show==="P"||s[a].show==="C"?r.push({value:"<sup>"+t.value+"</sup>"+s[a].show+"<sub>"+e.value+"</sub>",type:10}):r.push({value:(t.type!=1?"(":"")+t.value+(t.type!=1?")":"")+"<sup>"+e.value+"</sup>",type:1})):s[a].type===2||s[a].type===9?(e=r.pop(),t=r.pop(),r.push({value:(t.type!=1?"(":"")+t.value+(t.type!=1?")":"")+s[a].show+(e.type!=1?"(":"")+e.value+(e.type!=1?")":""),type:s[a].type})):s[a].type===12&&(e=r.pop(),t=r.pop(),n=r.pop(),r.push({value:s[a].show+"("+n.value+","+t.value+","+e.value+")",type:12}));return r[0].value},V4=i,V4}var G4,DI;function gme(){if(DI)return G4;DI=1;var i=lme(),e=ume(),t=mme(),n=100,r=/(\+|\-|\*|\\|[^a-z]|)(\s*)(\()/g,s;G4=a;function a(l,c){s=0,c=Math.pow(10,c===void 0?5:c),l=l.replace(/\n+/g," ");function u(p,m,g){if(s++>n)throw s=0,new Error("Call stack overflow for "+g);if(p==="")throw new Error(m+"(): '"+g+"' must contain a non-whitespace string");p=d(p,g);var y=o(p);if(y.length>1||p.indexOf("var(")>-1)return m+"("+p+")";var x=y[0]||"";x==="%"&&(p=p.replace(/\b[0-9\.]+%/g,function(w){return parseFloat(w.slice(0,-1))*.01}));var _=p.replace(new RegExp(x,"gi"),""),S;try{S=t.eval(_)}catch{return m+"("+p+")"}return x==="%"&&(S*=100),(m.length||x==="%")&&(S=Math.round(S*c)/c),S+=x,S}function d(p,m){p=p.replace(/((?:\-[a-z]+\-)?calc)/g,"");for(var g="",y=p,x;x=r.exec(y);){x[0].index>0&&(g+=y.substring(0,x[0].index));var _=i("(",")",y.substring([0].index));if(_.body==="")throw new Error("'"+p+"' must contain a non-whitespace string");var S=u(_.body,"",m);g+=_.pre+S,y=_.post}return g+y}return e(l,/((?:\-[a-z]+\-)?calc)\(/,u)}function o(l){for(var c=[],u=[],d=/[\.0-9]([%a-z]+)/gi,p=d.exec(l);p;)!p||!p[1]||(u.indexOf(p[1].toLowerCase())===-1&&(c.push(p[1]),u.push(p[1].toLowerCase())),p=d.exec(l));return c}return G4}var xme=gme();const W4=od(xme);var q4,NI;function yme(){if(NI)return q4;NI=1;var i=typeof Xx=="object"&&Xx&&Xx.Object===Object&&Xx;return q4=i,q4}var X4,LI;function H2(){if(LI)return X4;LI=1;var i=yme(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=i||e||Function("return this")();return X4=t,X4}var Y4,kI;function tV(){if(kI)return Y4;kI=1;var i=H2(),e=i.Symbol;return Y4=e,Y4}var $4,OI;function vme(){if(OI)return $4;OI=1;var i=tV(),e=Object.prototype,t=e.hasOwnProperty,n=e.toString,r=i?i.toStringTag:void 0;function s(a){var o=t.call(a,r),l=a[r];try{a[r]=void 0;var c=!0}catch{}var u=n.call(a);return c&&(o?a[r]=l:delete a[r]),u}return $4=s,$4}var K4,zI;function bme(){if(zI)return K4;zI=1;var i=Object.prototype,e=i.toString;function t(n){return e.call(n)}return K4=t,K4}var Z4,UI;function nV(){if(UI)return Z4;UI=1;var i=tV(),e=vme(),t=bme(),n="[object Null]",r="[object Undefined]",s=i?i.toStringTag:void 0;function a(o){return o==null?o===void 0?r:n:s&&s in Object(o)?e(o):t(o)}return Z4=a,Z4}var Q4,FI;function j2(){if(FI)return Q4;FI=1;function i(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return Q4=i,Q4}var J4,BI;function _me(){if(BI)return J4;BI=1;var i=nV(),e=j2(),t="[object AsyncFunction]",n="[object Function]",r="[object GeneratorFunction]",s="[object Proxy]";function a(o){if(!e(o))return!1;var l=i(o);return l==n||l==r||l==t||l==s}return J4=a,J4}var ew,HI;function Sme(){if(HI)return ew;HI=1;var i=H2(),e=i["__core-js_shared__"];return ew=e,ew}var tw,jI;function wme(){if(jI)return tw;jI=1;var i=Sme(),e=(function(){var n=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function t(n){return!!e&&e in n}return tw=t,tw}var nw,VI;function Mme(){if(VI)return nw;VI=1;var i=Function.prototype,e=i.toString;function t(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return nw=t,nw}var iw,GI;function Tme(){if(GI)return iw;GI=1;var i=_me(),e=wme(),t=j2(),n=Mme(),r=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,a=Function.prototype,o=Object.prototype,l=a.toString,c=o.hasOwnProperty,u=RegExp("^"+l.call(c).replace(r,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function d(p){if(!t(p)||e(p))return!1;var m=i(p)?u:s;return m.test(n(p))}return iw=d,iw}var rw,WI;function Ame(){if(WI)return rw;WI=1;function i(e,t){return e?.[t]}return rw=i,rw}var sw,qI;function iV(){if(qI)return sw;qI=1;var i=Tme(),e=Ame();function t(n,r){var s=e(n,r);return i(s)?s:void 0}return sw=t,sw}var aw,XI;function V2(){if(XI)return aw;XI=1;var i=iV(),e=i(Object,"create");return aw=e,aw}var ow,YI;function Cme(){if(YI)return ow;YI=1;var i=V2();function e(){this.__data__=i?i(null):{},this.size=0}return ow=e,ow}var lw,$I;function Eme(){if($I)return lw;$I=1;function i(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}return lw=i,lw}var cw,KI;function Rme(){if(KI)return cw;KI=1;var i=V2(),e="__lodash_hash_undefined__",t=Object.prototype,n=t.hasOwnProperty;function r(s){var a=this.__data__;if(i){var o=a[s];return o===e?void 0:o}return n.call(a,s)?a[s]:void 0}return cw=r,cw}var uw,ZI;function Pme(){if(ZI)return uw;ZI=1;var i=V2(),e=Object.prototype,t=e.hasOwnProperty;function n(r){var s=this.__data__;return i?s[r]!==void 0:t.call(s,r)}return uw=n,uw}var hw,QI;function Ime(){if(QI)return hw;QI=1;var i=V2(),e="__lodash_hash_undefined__";function t(n,r){var s=this.__data__;return this.size+=this.has(n)?0:1,s[n]=i&&r===void 0?e:r,this}return hw=t,hw}var dw,JI;function Dme(){if(JI)return dw;JI=1;var i=Cme(),e=Eme(),t=Rme(),n=Pme(),r=Ime();function s(a){var o=-1,l=a==null?0:a.length;for(this.clear();++o<l;){var c=a[o];this.set(c[0],c[1])}}return s.prototype.clear=i,s.prototype.delete=e,s.prototype.get=t,s.prototype.has=n,s.prototype.set=r,dw=s,dw}var fw,eD;function Nme(){if(eD)return fw;eD=1;function i(){this.__data__=[],this.size=0}return fw=i,fw}var pw,tD;function Lme(){if(tD)return pw;tD=1;function i(e,t){return e===t||e!==e&&t!==t}return pw=i,pw}var mw,nD;function G2(){if(nD)return mw;nD=1;var i=Lme();function e(t,n){for(var r=t.length;r--;)if(i(t[r][0],n))return r;return-1}return mw=e,mw}var gw,iD;function kme(){if(iD)return gw;iD=1;var i=G2(),e=Array.prototype,t=e.splice;function n(r){var s=this.__data__,a=i(s,r);if(a<0)return!1;var o=s.length-1;return a==o?s.pop():t.call(s,a,1),--this.size,!0}return gw=n,gw}var xw,rD;function Ome(){if(rD)return xw;rD=1;var i=G2();function e(t){var n=this.__data__,r=i(n,t);return r<0?void 0:n[r][1]}return xw=e,xw}var yw,sD;function zme(){if(sD)return yw;sD=1;var i=G2();function e(t){return i(this.__data__,t)>-1}return yw=e,yw}var vw,aD;function Ume(){if(aD)return vw;aD=1;var i=G2();function e(t,n){var r=this.__data__,s=i(r,t);return s<0?(++this.size,r.push([t,n])):r[s][1]=n,this}return vw=e,vw}var bw,oD;function Fme(){if(oD)return bw;oD=1;var i=Nme(),e=kme(),t=Ome(),n=zme(),r=Ume();function s(a){var o=-1,l=a==null?0:a.length;for(this.clear();++o<l;){var c=a[o];this.set(c[0],c[1])}}return s.prototype.clear=i,s.prototype.delete=e,s.prototype.get=t,s.prototype.has=n,s.prototype.set=r,bw=s,bw}var _w,lD;function Bme(){if(lD)return _w;lD=1;var i=iV(),e=H2(),t=i(e,"Map");return _w=t,_w}var Sw,cD;function Hme(){if(cD)return Sw;cD=1;var i=Dme(),e=Fme(),t=Bme();function n(){this.size=0,this.__data__={hash:new i,map:new(t||e),string:new i}}return Sw=n,Sw}var ww,uD;function jme(){if(uD)return ww;uD=1;function i(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}return ww=i,ww}var Mw,hD;function W2(){if(hD)return Mw;hD=1;var i=jme();function e(t,n){var r=t.__data__;return i(n)?r[typeof n=="string"?"string":"hash"]:r.map}return Mw=e,Mw}var Tw,dD;function Vme(){if(dD)return Tw;dD=1;var i=W2();function e(t){var n=i(this,t).delete(t);return this.size-=n?1:0,n}return Tw=e,Tw}var Aw,fD;function Gme(){if(fD)return Aw;fD=1;var i=W2();function e(t){return i(this,t).get(t)}return Aw=e,Aw}var Cw,pD;function Wme(){if(pD)return Cw;pD=1;var i=W2();function e(t){return i(this,t).has(t)}return Cw=e,Cw}var Ew,mD;function qme(){if(mD)return Ew;mD=1;var i=W2();function e(t,n){var r=i(this,t),s=r.size;return r.set(t,n),this.size+=r.size==s?0:1,this}return Ew=e,Ew}var Rw,gD;function Xme(){if(gD)return Rw;gD=1;var i=Hme(),e=Vme(),t=Gme(),n=Wme(),r=qme();function s(a){var o=-1,l=a==null?0:a.length;for(this.clear();++o<l;){var c=a[o];this.set(c[0],c[1])}}return s.prototype.clear=i,s.prototype.delete=e,s.prototype.get=t,s.prototype.has=n,s.prototype.set=r,Rw=s,Rw}var Pw,xD;function Yme(){if(xD)return Pw;xD=1;var i=Xme(),e="Expected a function";function t(n,r){if(typeof n!="function"||r!=null&&typeof r!="function")throw new TypeError(e);var s=function(){var a=arguments,o=r?r.apply(this,a):a[0],l=s.cache;if(l.has(o))return l.get(o);var c=n.apply(this,a);return s.cache=l.set(o,c)||l,c};return s.cache=new(t.Cache||i),s}return t.Cache=i,Pw=t,Pw}var $me=Yme();const Kme=od($me),yD="__react_svg_text_measurement_id";function Zme(i,e){try{let t=document.getElementById(yD);if(!t){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("aria-hidden","true"),n.style.width="0",n.style.height="0",n.style.position="absolute",n.style.top="-100%",n.style.left="-100%",t=document.createElementNS("http://www.w3.org/2000/svg","text"),t.setAttribute("id",yD),n.appendChild(t),document.body.appendChild(n)}return Object.assign(t.style,e),t.textContent=i,t.getComputedTextLength()}catch(t){return console.warn(t),null}}const vD=Kme(Zme,(i,e)=>`${i}_${JSON.stringify(e)}`);function Iw(i){return typeof i=="number"}function bD(i){return typeof i=="number"&&Number.isFinite(i)||typeof i=="string"}function Qme(i){const{verticalAnchor:e="end",scaleToFit:t=!1,angle:n,width:r,lineHeight:s="1em",capHeight:a="0.71em",children:o,style:l,...c}=i,{x:u=0,y:d=0}=c,p=!bD(u)||!bD(d),{wordsWithWidth:m,spaceWidth:g}=z.useMemo(()=>({wordsWithWidth:(o==null?[]:o.toString().split(/(?:(?!\u00A0+)\s+)/)).map(w=>({word:w,wordWidth:vD(w,l)||0})),spaceWidth:vD("",l)||0}),[o,l]),y=z.useMemo(()=>p?[]:r||t?m.reduce((S,w)=>{let{word:T,wordWidth:C}=w;const E=S[S.length-1];if(E&&(r==null||t||(E.width||0)+C+g<r))E.words.push(T),E.width=E.width||0,E.width+=C+g;else{const D={words:[T],width:C};S.push(D)}return S},[]):[{words:o==null?[]:o.toString().split(/(?:(?!\u00A0+)\s+)/)}],[p,r,t,o,m,g]),x=z.useMemo(()=>p?"":W4(e==="start"?`calc(${a})`:e==="middle"?`calc(${(y.length-1)/2} * -${s} + (${a} / 2))`:`calc(${y.length-1} * -${s})`),[p,e,a,y.length,s]),_=z.useMemo(()=>{const S=[];if(p)return"";if(Iw(u)&&Iw(d)&&Iw(r)&&t&&y.length>0){const w=y[0].width||1,T=t==="shrink-only"?Math.min(r/w,1):r/w,C=T,E=u-T*u,D=d-C*d;S.push(`matrix(${T}, 0, 0, ${C}, ${E}, ${D})`)}return n&&S.push(`rotate(${n}, ${u}, ${d})`),S.length>0?S.join(" "):""},[p,u,d,r,t,y,n]);return{wordsByLines:y,startDy:x,transform:_}}const Jme={overflow:"visible"};function XA(i){const{dx:e=0,dy:t=0,textAnchor:n="start",innerRef:r,innerTextRef:s,verticalAnchor:a,angle:o,lineHeight:l="1em",scaleToFit:c=!1,capHeight:u,width:d,...p}=i,{x:m=0,fontSize:g}=p,{wordsByLines:y,startDy:x,transform:_}=Qme(i);return v.jsx("svg",{ref:r,x:e,y:t,fontSize:g,style:Jme,children:y.length>0?v.jsx("text",{ref:s,transform:_,...p,textAnchor:n,children:y.map((S,w)=>v.jsx("tspan",{x:m,dy:w===0?x:l,children:S.words.join(" ")},w))}):null})}const ws={top:"top",left:"left",bottom:"bottom"};function ege(i){let{labelOffset:e,labelProps:t,orientation:n,range:r,tickLabelFontSize:s,tickLength:a}=i;const o=n===ws.left||n===ws.top?-1:1;let l,c,u;if(n===ws.top||n===ws.bottom){const d=n===ws.bottom&&typeof t.fontSize=="number"?t.fontSize:0;l=(Number(r[0])+Number(r[r.length-1]))/2,c=o*(a+e+s+d)}else l=o*((Number(r[0])+Number(r[r.length-1]))/2),c=-(a+e),u=`rotate(${o*90})`;return{x:l,y:c,transform:u}}function tge(i){let{hideTicks:e,horizontal:t,orientation:n,tickClassName:r,tickComponent:s,tickLabelProps:a,tickStroke:o="#222",tickTransform:l,ticks:c,strokeWidth:u,tickLineProps:d}=i;return c.map(p=>{let{value:m,index:g,from:y,to:x,formattedValue:_}=p;const S=a[g]??{},w=Math.max(10,typeof S.fontSize=="number"&&S.fontSize||0),T=x.y+(t&&n!==ws.top?w:0);return v.jsxs(xd,{className:ca("visx-axis-tick",r),transform:l,children:[!e&&v.jsx(wm,{from:y,to:x,stroke:o,strokeWidth:u,strokeLinecap:"square",...d}),s?s({...S,x:x.x,y:T,formattedValue:_}):v.jsx(XA,{x:x.x,y:T,...S,children:_})]},`visx-tick-${m}-${g}`)})}const _D={textAnchor:"middle",fontFamily:"Arial",fontSize:10,fill:"#222"};function nge(i){let{axisFromPoint:e,axisLineClassName:t,axisToPoint:n,hideAxisLine:r,hideTicks:s,horizontal:a,label:o="",labelClassName:l,labelOffset:c=14,labelProps:u,orientation:d=ws.bottom,scale:p,stroke:m="#222",strokeDasharray:g,strokeWidth:y=1,tickClassName:x,tickComponent:_,tickLineProps:S,tickLabelProps:w,tickLength:T=8,tickStroke:C="#222",tickTransform:E,ticks:D,ticksComponent:O=tge}=i;const R={..._D,...u},P={..._D,...typeof w=="object"?w:null},L=D.map(j=>{let{value:B,index:J}=j;return typeof w=="function"?w(B,J,D):P}),V=Math.max(10,...L.map(j=>typeof j.fontSize=="number"?j.fontSize:0));return v.jsxs(v.Fragment,{children:[O({hideTicks:s,horizontal:a,orientation:d,scale:p,tickClassName:x,tickComponent:_,tickLabelProps:L,tickStroke:C,tickTransform:E,ticks:D,strokeWidth:y,tickLineProps:S}),!r&&v.jsx(wm,{className:ca("visx-axis-line",t),from:e,to:n,stroke:m,strokeWidth:y,strokeDasharray:g}),o&&v.jsx(XA,{className:ca("visx-axis-label",l),...ege({labelOffset:c,labelProps:R,orientation:d,range:p.range(),tickLabelFontSize:V,tickLength:T}),...R,children:o})]})}function ige(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"center";const t=i;if(e!=="start"&&"bandwidth"in t){let n=t.bandwidth();return e==="center"&&(n/=2),t.round()&&(n=Math.round(n)),r=>{const s=t(r);return typeof s=="number"?s+n:s}}return i}function rge(i){const e=i;return"tickFormat"in e?e.tickFormat():eme}class Ql{x=0;y=0;constructor(e){let{x:t=0,y:n=0}=e;this.x=t,this.y=n}value(){return{x:this.x,y:this.y}}toArray(){return[this.x,this.y]}}function sge(i,e){return new Ql({x:i.x+e.x,y:i.y+e.y})}function age(i,e){return new Ql({x:i.x-e.x,y:i.y-e.y})}function uy(i,e){let{x:t,y:n}=i;return new Ql(e?{x:t,y:n}:{x:n,y:t})}const Dw=0;function oge(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Dw;return typeof i=="number"?{start:i,end:i}:{start:Dw,end:Dw,...i}}function YA(i){let{children:e=nge,axisClassName:t,hideAxisLine:n=!1,hideTicks:r=!1,hideZero:s=!1,innerRef:a,left:o=0,numTicks:l=10,orientation:c=ws.bottom,rangePadding:u=0,scale:d,tickFormat:p,tickLength:m=8,tickValues:g,top:y=0,...x}=i;const _=p??rge(d),S=c===ws.left,w=c===ws.top,T=w||c===ws.bottom,C=ige(d),E=S||w?-1:1,D=d.range(),O=oge(u),R=uy({x:Number(D[0])+.5-O.start,y:0},T),P=uy({x:Number(D[D.length-1])+.5+O.end,y:0},T),L=(g??Jpe(d,l)).filter(j=>!s||j!==0&&j!=="0").map((j,B)=>({value:j,index:B})),V=L.map(j=>{let{value:B,index:J}=j;const U=Wj(C(B));return{value:B,index:J,from:uy({x:U,y:0},T),to:uy({x:U,y:m*E},T),formattedValue:_(B,J,L)}});return v.jsx(xd,{className:ca("visx-axis",t),innerRef:a,top:y,left:o,children:e({...x,axisFromPoint:R,axisToPoint:P,hideAxisLine:n,hideTicks:r,hideZero:s,horizontal:T,numTicks:l,orientation:c,rangePadding:u,scale:d,tickFormat:_,tickLength:m,tickPosition:C,tickSign:E,ticks:V})})}const lge={dx:"-0.25em",dy:"0.25em",fill:"#222",fontFamily:"Arial",fontSize:10,textAnchor:"end"};function cge(i){let{axisClassName:e,labelOffset:t=36,tickLength:n=8,tickLabelProps:r,...s}=i;const a=typeof r=="function"?r:{...lge,...r};return v.jsx(YA,{axisClassName:ca("visx-axis-left",e),labelOffset:t,orientation:ws.left,tickLabelProps:a,tickLength:n,...s})}const uge={dy:"0.25em",fill:"#222",fontFamily:"Arial",fontSize:10,textAnchor:"middle"};function hge(i){let{axisClassName:e,labelOffset:t=8,tickLength:n=8,tickLabelProps:r,...s}=i;const a=typeof r=="function"?r:{...uge,...r};return v.jsx(YA,{axisClassName:ca("visx-axis-bottom",e),labelOffset:t,orientation:ws.bottom,tickLabelProps:a,tickLength:n,...s})}var Nw,SD;function dge(){if(SD)return Nw;SD=1;var i=H2(),e=function(){return i.Date.now()};return Nw=e,Nw}var Lw,wD;function fge(){if(wD)return Lw;wD=1;var i=/\s/;function e(t){for(var n=t.length;n--&&i.test(t.charAt(n)););return n}return Lw=e,Lw}var kw,MD;function pge(){if(MD)return kw;MD=1;var i=fge(),e=/^\s+/;function t(n){return n&&n.slice(0,i(n)+1).replace(e,"")}return kw=t,kw}var Ow,TD;function mge(){if(TD)return Ow;TD=1;function i(e){return e!=null&&typeof e=="object"}return Ow=i,Ow}var zw,AD;function gge(){if(AD)return zw;AD=1;var i=nV(),e=mge(),t="[object Symbol]";function n(r){return typeof r=="symbol"||e(r)&&i(r)==t}return zw=n,zw}var Uw,CD;function xge(){if(CD)return Uw;CD=1;var i=pge(),e=j2(),t=gge(),n=NaN,r=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,a=/^0o[0-7]+$/i,o=parseInt;function l(c){if(typeof c=="number")return c;if(t(c))return n;if(e(c)){var u=typeof c.valueOf=="function"?c.valueOf():c;c=e(u)?u+"":u}if(typeof c!="string")return c===0?c:+c;c=i(c);var d=s.test(c);return d||a.test(c)?o(c.slice(2),d?2:8):r.test(c)?n:+c}return Uw=l,Uw}var Fw,ED;function yge(){if(ED)return Fw;ED=1;var i=j2(),e=dge(),t=xge(),n="Expected a function",r=Math.max,s=Math.min;function a(o,l,c){var u,d,p,m,g,y,x=0,_=!1,S=!1,w=!0;if(typeof o!="function")throw new TypeError(n);l=t(l)||0,i(c)&&(_=!!c.leading,S="maxWait"in c,p=S?r(t(c.maxWait)||0,l):p,w="trailing"in c?!!c.trailing:w);function T(j){var B=u,J=d;return u=d=void 0,x=j,m=o.apply(J,B),m}function C(j){return x=j,g=setTimeout(O,l),_?T(j):m}function E(j){var B=j-y,J=j-x,U=l-B;return S?s(U,p-J):U}function D(j){var B=j-y,J=j-x;return y===void 0||B>=l||B<0||S&&J>=p}function O(){var j=e();if(D(j))return R(j);g=setTimeout(O,E(j))}function R(j){return g=void 0,w&&u?T(j):(u=d=void 0,m)}function P(){g!==void 0&&clearTimeout(g),x=0,u=y=d=g=void 0}function L(){return g===void 0?m:R(e())}function V(){var j=e(),B=D(j);if(u=arguments,d=this,y=j,B){if(g===void 0)return C(y);if(S)return clearTimeout(g),g=setTimeout(O,l),T(y)}return g===void 0&&(g=setTimeout(O,l)),m}return V.cancel=P,V.flush=L,V}return Fw=a,Fw}var vge=yge();const bge=od(vge),_ge=[],RD={width:0,height:0,top:0,left:0};function Sge(){let{initialSize:i=RD,debounceTime:e=300,ignoreDimensions:t=_ge,enableDebounceLeadingCall:n=!0,resizeObserverPolyfill:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const s=z.useRef(null),a=z.useRef(0),[o,l]=z.useState({...RD,...i}),c=z.useMemo(()=>{const u=Array.isArray(t)?t:[t];return bge(d=>{l(p=>Object.keys(p).filter(x=>p[x]!==d[x]).every(x=>u.includes(x))?p:d)},e,{leading:n})},[e,n,t]);return z.useEffect(()=>{const u=r||window.ResizeObserver,d=new u(p=>{p.forEach(m=>{const{left:g,top:y,width:x,height:_}=m?.contentRect??{};a.current=window.requestAnimationFrame(()=>{c({width:x,height:_,top:y,left:g})})})});return s.current&&d.observe(s.current),()=>{window.cancelAnimationFrame(a.current),d.disconnect(),c.cancel()}},[c,r]),{parentRef:s,resize:c,...o}}const wge={width:"100%",height:"100%"};function Mge(i){let{className:e,children:t,debounceTime:n,ignoreDimensions:r,initialSize:s,parentSizeStyles:a=wge,enableDebounceLeadingCall:o=!0,resizeObserverPolyfill:l,...c}=i;const{parentRef:u,resize:d,...p}=Sge({initialSize:s,debounceTime:n,ignoreDimensions:r,enableDebounceLeadingCall:o,resizeObserverPolyfill:l});return v.jsx("div",{style:a,ref:u,className:e,...c,children:t({...p,ref:u.current,resize:d})})}const _h={maxColor:"pink.400",minColor:"cyan.400",gradient:"linear-gradient(to right, var(--chakra-colors-cyan-400), var(--chakra-colors-pink-400))"};function lb({pmin:i,pmax:e,vmin:t,vmax:n,onPminChange:r,onPmaxChange:s,onVminChange:a,onVmaxChange:o,onPmaxInputChange:l,onPminInputChange:c}){const u=m=>{const[g,y]=m.value;r(g),s(y)},d=l??s,p=c??r;return v.jsxs(gt,{w:"100%",h:"100%",px:2,gap:3,align:"center",children:[v.jsxs(gt,{gap:2,children:[v.jsx(Fh,{label:"Min %",value:i,onChange:p,color:_h.minColor,step:.1,width:"55px"}),v.jsx(Fh,{label:"Vmin",value:t,onChange:a,color:_h.minColor,width:"65px"})]}),v.jsx(qe,{flex:"1",position:"relative",px:2,pt:2,children:v.jsx(k6,{value:[i,e],onValueChange:u,min:0,max:100,step:.1,children:v.jsxs(O6,{children:[v.jsx(z6,{bg:"blackAlpha.200",height:"4px",borderRadius:"full",children:v.jsx(U6,{bgGradient:_h.gradient})}),v.jsx(cb,{index:0,color:_h.minColor}),v.jsx(cb,{index:1,color:_h.maxColor})]})})}),v.jsxs(gt,{gap:2,children:[v.jsx(Fh,{label:"Vmax",value:n,onChange:o,color:_h.maxColor,width:"65px"}),v.jsx(Fh,{label:"Max %",value:e,onChange:d,color:_h.maxColor,step:.1,width:"55px"})]})]})}function Tge({opacity:i,onOpacityChange:e,onOpacityInputChange:t,color:n="pink.400",label:r="Opacity"}){const s=t??e;return v.jsxs(gt,{w:"100%",h:"100%",px:2,gap:3,align:"center",children:[v.jsx(qe,{flex:"1",position:"relative",px:2,pt:2,children:v.jsx(k6,{value:[i],onValueChange:a=>e(a.value[0]),min:0,max:1,step:.01,children:v.jsxs(O6,{children:[v.jsx(z6,{bg:"whiteAlpha.200",height:"4px",borderRadius:"full",children:v.jsx(U6,{bg:n})}),v.jsx(cb,{index:0,color:n})]})})}),v.jsx(gt,{gap:1,children:v.jsx(Fh,{value:i,onChange:s,color:n,width:"60px",label:r,step:.01})})]})}function Age({refIndex:i,lambda0:e,fwhm:t,onRefIndexChange:n,onLambda0Change:r,onFwhmChange:s,angPerPixel:a,refIndexRange:o=[0,255],color:l="yellow.400"}){return v.jsxs(gt,{w:"100%",h:"100%",px:2,gap:3,align:"center",children:[v.jsx(qe,{flex:"1",position:"relative",px:2,pt:1,children:v.jsx(k6,{value:[i],onValueChange:c=>n(c.value[0]),min:o[0],max:o[1],step:1,children:v.jsxs(O6,{children:[v.jsx(z6,{bg:"whiteAlpha.200",height:"4px",borderRadius:"full",children:v.jsx(U6,{bg:l})}),v.jsx(cb,{index:0,color:l})]})})}),v.jsxs(gt,{gap:1,children:[v.jsx(ke,{fontSize:"sm",color:"gray.400",children:" ():"}),v.jsx(Fh,{value:e,onChange:r,color:l,label:" ()",step:1,width:"60px"}),v.jsx(ke,{fontSize:"sm",color:"gray.400",children:"fwhm (km/s):"}),v.jsx(Fh,{value:t,onChange:s,color:l,label:"FWHM (km/s)",step:50,width:"60px"}),a&&v.jsx(ke,{fontSize:"sm",color:"gray.400",fontFamily:"mono",children:`pixel scale: ${a.toFixed(2)}`})]})]})}function Fh({value:i,onChange:e,color:t,label:n,step:r=.01,width:s="60px"}){return v.jsx(HY,{w:"auto",children:v.jsx(qo,{size:"xs",step:r,value:i!==void 0?String(i):"",onValueChange:a=>e(a.valueAsNumber),allowMouseWheel:!0,width:s,children:v.jsx(Xo,{px:1,fontSize:"xs",fontFamily:"monospace",fontWeight:"semibold",textAlign:"center",color:t,placeholder:n,bg:"whiteAlpha.200",border:"none",_focus:{bg:"whiteAlpha.300",outline:"1px solid",outlineColor:t}})})})}function cb({index:i,color:e}){return v.jsx(BY,{index:i,boxSize:"16px",bg:"white",border:"2px solid",borderColor:e,boxShadow:`0 0 6px ${e}`,outline:"none"})}const Cge="This is not an object",Ege="This is not a Float16Array object",PD="This constructor is not a subclass of Float16Array",rV="The constructor property value is not an object",Rge="Species constructor didn't return TypedArray object",Pge="Derived constructor created TypedArray object which was too small length",Mm="Attempting to access detached ArrayBuffer",J5="Cannot convert undefined or null to object",e6="Cannot mix BigInt and other types, use explicit conversions",ID="@@iterator property is not callable",DD="Reduce of empty array with no initial value",Ige="The comparison function must be either a function or undefined",Bw="Offset is out of bounds";function ei(i){return(e,...t)=>ps(i,e,t)}function F0(i,e){return ei(S0(i,e).get)}const{apply:ps,construct:nm,defineProperty:ND,get:Hw,getOwnPropertyDescriptor:S0,getPrototypeOf:rx,has:t6,ownKeys:sV,set:LD,setPrototypeOf:aV}=Reflect,Dge=Proxy,{EPSILON:Nge,MAX_SAFE_INTEGER:kD,isFinite:oV,isNaN:w0}=Number,{iterator:tl,species:Lge,toStringTag:$A,for:kge}=Symbol,M0=Object,{create:q2,defineProperty:sx,freeze:Oge,is:OD}=M0,n6=M0.prototype,zge=n6.__lookupGetter__?ei(n6.__lookupGetter__):(i,e)=>{if(i==null)throw ni(J5);let t=M0(i);do{const n=S0(t,e);if(n!==void 0)return Kl(n,"get")?n.get:void 0}while((t=rx(t))!==null)},Kl=M0.hasOwn||ei(n6.hasOwnProperty),lV=Array,cV=lV.isArray,X2=lV.prototype,Uge=ei(X2.join),Fge=ei(X2.push),Bge=ei(X2.toLocaleString),KA=X2[tl],Hge=ei(KA),{abs:jge,trunc:uV}=Math,Y2=ArrayBuffer,Vge=Y2.isView,hV=Y2.prototype,Gge=ei(hV.slice),Wge=F0(hV,"byteLength"),i6=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:null,qge=i6&&F0(i6.prototype,"byteLength"),ZA=rx(Uint8Array),Xge=ZA.from,fr=ZA.prototype,Yge=fr[tl],$ge=ei(fr.keys),Kge=ei(fr.values),Zge=ei(fr.entries),Qge=ei(fr.set),zD=ei(fr.reverse),Jge=ei(fr.fill),exe=ei(fr.copyWithin),UD=ei(fr.sort),Bp=ei(fr.slice),txe=ei(fr.subarray),ir=F0(fr,"buffer"),Sh=F0(fr,"byteOffset"),Cn=F0(fr,"length"),dV=F0(fr,$A),nxe=Uint8Array,Ys=Uint16Array,FD=(...i)=>ps(Xge,Ys,i),QA=Uint32Array,ixe=Float32Array,id=rx([][tl]()),$2=ei(id.next),rxe=ei((function*(){})().next),sxe=rx(id),ni=TypeError,jw=RangeError,fV=WeakSet,pV=fV.prototype,axe=ei(pV.add),oxe=ei(pV.has),K2=WeakMap,JA=K2.prototype,ub=ei(JA.get),lxe=ei(JA.has),eC=ei(JA.set),mV=new K2,cxe=q2(null,{next:{value:function(){const e=ub(mV,this);return $2(e)}},[tl]:{value:function(){return this}}});function hy(i){if(i[tl]===KA&&id.next===$2)return i;const e=q2(cxe);return eC(mV,e,Hge(i)),e}const gV=new K2,xV=q2(sxe,{next:{value:function(){const e=ub(gV,this);return rxe(e)},writable:!0,configurable:!0}});for(const i of sV(id))i!=="next"&&sx(xV,i,S0(id,i));function BD(i){const e=q2(xV);return eC(gV,e,i),e}function hb(i){return i!==null&&typeof i=="object"||typeof i=="function"}function HD(i){return i!==null&&typeof i=="object"}function db(i){return dV(i)!==void 0}function r6(i){const e=dV(i);return e==="BigInt64Array"||e==="BigUint64Array"}function uxe(i){try{return cV(i)?!1:(Wge(i),!0)}catch{return!1}}function yV(i){if(i6===null)return!1;try{return qge(i),!0}catch{return!1}}function hxe(i){return uxe(i)||yV(i)}function jD(i){return cV(i)?i[tl]===KA&&id.next===$2:!1}function dxe(i){return db(i)?i[tl]===Yge&&id.next===$2:!1}function dy(i){if(typeof i!="string")return!1;const e=+i;return i!==e+""||!oV(e)?!1:e===uV(e)}const fb=kge("__Float16Array__");function fxe(i){if(!HD(i))return!1;const e=rx(i);if(!HD(e))return!1;const t=e.constructor;if(t===void 0)return!1;if(!hb(t))throw ni(rV);return t6(t,fb)}const s6=1/Nge;function pxe(i){return i+s6-s6}const vV=6103515625e-14,mxe=65504,bV=.0009765625,VD=bV*vV,gxe=bV*s6;function xxe(i){const e=+i;if(!oV(e)||e===0)return e;const t=e>0?1:-1,n=jge(e);if(n<vV)return t*pxe(n/VD)*VD;const r=(1+gxe)*n,s=r-(r-n);return s>mxe||w0(s)?t*(1/0):t*s}const _V=new Y2(4),SV=new ixe(_V),wV=new QA(_V),to=new Ys(512),no=new nxe(512);for(let i=0;i<256;++i){const e=i-127;e<-24?(to[i]=0,to[i|256]=32768,no[i]=24,no[i|256]=24):e<-14?(to[i]=1024>>-e-14,to[i|256]=1024>>-e-14|32768,no[i]=-e-1,no[i|256]=-e-1):e<=15?(to[i]=e+15<<10,to[i|256]=e+15<<10|32768,no[i]=13,no[i|256]=13):e<128?(to[i]=31744,to[i|256]=64512,no[i]=24,no[i|256]=24):(to[i]=31744,to[i|256]=64512,no[i]=13,no[i|256]=13)}function Do(i){SV[0]=xxe(i);const e=wV[0],t=e>>23&511;return to[t]+((e&8388607)>>no[t])}const tC=new QA(2048);for(let i=1;i<1024;++i){let e=i<<13,t=0;for(;(e&8388608)===0;)e<<=1,t-=8388608;e&=-8388609,t+=947912704,tC[i]=e|t}for(let i=1024;i<2048;++i)tC[i]=939524096+(i-1024<<13);const B0=new QA(64);for(let i=1;i<31;++i)B0[i]=i<<23;B0[31]=1199570944;B0[32]=2147483648;for(let i=33;i<63;++i)B0[i]=2147483648+(i-32<<23);B0[63]=3347054592;const MV=new Ys(64);for(let i=1;i<64;++i)i!==32&&(MV[i]=1024);function Ln(i){const e=i>>10;return wV[0]=tC[MV[e]+(i&1023)]+B0[e],SV[0]}function Ul(i){const e=+i;return w0(e)||e===0?0:uV(e)}function Vw(i){const e=Ul(i);return e<0?0:e<kD?e:kD}function fy(i,e){if(!hb(i))throw ni(Cge);const t=i.constructor;if(t===void 0)return e;if(!hb(t))throw ni(rV);const n=t[Lge];return n??e}function Tm(i){if(yV(i))return!1;try{return Gge(i,0,0),!1}catch{}return!0}function GD(i,e){const t=w0(i),n=w0(e);if(t&&n)return 0;if(t)return 1;if(n||i<e)return-1;if(i>e)return 1;if(i===0&&e===0){const r=OD(i,0),s=OD(e,0);if(!r&&s)return-1;if(r&&!s)return 1}return 0}const nC=2,pb=new K2;function Uf(i){return lxe(pb,i)||!Vge(i)&&fxe(i)}function An(i){if(!Uf(i))throw ni(Ege)}function py(i,e){const t=Uf(i),n=db(i);if(!t&&!n)throw ni(Rge);if(typeof e=="number"){let r;if(t){const s=en(i);r=Cn(s)}else r=Cn(i);if(r<e)throw ni(Pge)}if(r6(i))throw ni(e6)}function en(i){const e=ub(pb,i);if(e!==void 0){const r=ir(e);if(Tm(r))throw ni(Mm);return e}const t=i.buffer;if(Tm(t))throw ni(Mm);const n=nm(rd,[t,i.byteOffset,i.length],i.constructor);return ub(pb,n)}function WD(i){const e=Cn(i),t=[];for(let n=0;n<e;++n)t[n]=Ln(i[n]);return t}const TV=new fV;for(const i of sV(fr)){if(i===$A)continue;const e=S0(fr,i);Kl(e,"get")&&typeof e.get=="function"&&axe(TV,e.get)}const yxe=Oge({get(i,e,t){return dy(e)&&Kl(i,e)?Ln(Hw(i,e)):oxe(TV,zge(i,e))?Hw(i,e):Hw(i,e,t)},set(i,e,t,n){return dy(e)&&Kl(i,e)?LD(i,e,Do(t)):LD(i,e,t,n)},getOwnPropertyDescriptor(i,e){if(dy(e)&&Kl(i,e)){const t=S0(i,e);return t.value=Ln(t.value),t}return S0(i,e)},defineProperty(i,e,t){return dy(e)&&Kl(i,e)&&Kl(t,"value")&&(t.value=Do(t.value)),ND(i,e,t)}});let rd=class rr{constructor(e,t,n){let r;if(Uf(e))r=nm(Ys,[en(e)],new.target);else if(hb(e)&&!hxe(e)){let a,o;if(db(e)){a=e,o=Cn(e);const l=ir(e);if(Tm(l))throw ni(Mm);if(r6(e))throw ni(e6);const c=new Y2(o*nC);r=nm(Ys,[c],new.target)}else{const l=e[tl];if(l!=null&&typeof l!="function")throw ni(ID);l!=null?jD(e)?(a=e,o=e.length):(a=[...e],o=a.length):(a=e,o=Vw(a.length)),r=nm(Ys,[o],new.target)}for(let l=0;l<o;++l)r[l]=Do(a[l])}else r=nm(Ys,arguments,new.target);const s=new Dge(r,yxe);return eC(pb,s,r),s}static from(e,...t){const n=this;if(!t6(n,fb))throw ni(PD);if(n===rr){if(Uf(e)&&t.length===0){const u=en(e),d=new Ys(ir(u),Sh(u),Cn(u));return new rr(ir(Bp(d)))}if(t.length===0)return new rr(ir(FD(e,Do)));const l=t[0],c=t[1];return new rr(ir(FD(e,function(u,...d){return Do(ps(l,this,[u,...hy(d)]))},c)))}let r,s;const a=e[tl];if(a!=null&&typeof a!="function")throw ni(ID);if(a!=null)jD(e)?(r=e,s=e.length):dxe(e)?(r=e,s=Cn(e)):(r=[...e],s=r.length);else{if(e==null)throw ni(J5);r=M0(e),s=Vw(r.length)}const o=new n(s);if(t.length===0)for(let l=0;l<s;++l)o[l]=r[l];else{const l=t[0],c=t[1];for(let u=0;u<s;++u)o[u]=ps(l,c,[r[u],u])}return o}static of(...e){const t=this;if(!t6(t,fb))throw ni(PD);const n=e.length;if(t===rr){const s=new rr(n),a=en(s);for(let o=0;o<n;++o)a[o]=Do(e[o]);return s}const r=new t(n);for(let s=0;s<n;++s)r[s]=e[s];return r}keys(){An(this);const e=en(this);return $ge(e)}values(){An(this);const e=en(this);return BD((function*(){for(const t of Kge(e))yield Ln(t)})())}entries(){An(this);const e=en(this);return BD((function*(){for(const[t,n]of Zge(e))yield[t,Ln(n)]})())}at(e){An(this);const t=en(this),n=Cn(t),r=Ul(e),s=r>=0?r:n+r;if(!(s<0||s>=n))return Ln(t[s])}with(e,t){An(this);const n=en(this),r=Cn(n),s=Ul(e),a=s>=0?s:r+s,o=+t;if(a<0||a>=r)throw jw(Bw);const l=new Ys(ir(n),Sh(n),Cn(n)),c=new rr(ir(Bp(l))),u=en(c);return u[a]=Do(o),c}map(e,...t){An(this);const n=en(this),r=Cn(n),s=t[0],a=fy(n,rr);if(a===rr){const l=new rr(r),c=en(l);for(let u=0;u<r;++u){const d=Ln(n[u]);c[u]=Do(ps(e,s,[d,u,this]))}return l}const o=new a(r);py(o,r);for(let l=0;l<r;++l){const c=Ln(n[l]);o[l]=ps(e,s,[c,l,this])}return o}filter(e,...t){An(this);const n=en(this),r=Cn(n),s=t[0],a=[];for(let c=0;c<r;++c){const u=Ln(n[c]);ps(e,s,[u,c,this])&&Fge(a,u)}const o=fy(n,rr),l=new o(a);return py(l),l}reduce(e,...t){An(this);const n=en(this),r=Cn(n);if(r===0&&t.length===0)throw ni(DD);let s,a;t.length===0?(s=Ln(n[0]),a=1):(s=t[0],a=0);for(let o=a;o<r;++o)s=e(s,Ln(n[o]),o,this);return s}reduceRight(e,...t){An(this);const n=en(this),r=Cn(n);if(r===0&&t.length===0)throw ni(DD);let s,a;t.length===0?(s=Ln(n[r-1]),a=r-2):(s=t[0],a=r-1);for(let o=a;o>=0;--o)s=e(s,Ln(n[o]),o,this);return s}forEach(e,...t){An(this);const n=en(this),r=Cn(n),s=t[0];for(let a=0;a<r;++a)ps(e,s,[Ln(n[a]),a,this])}find(e,...t){An(this);const n=en(this),r=Cn(n),s=t[0];for(let a=0;a<r;++a){const o=Ln(n[a]);if(ps(e,s,[o,a,this]))return o}}findIndex(e,...t){An(this);const n=en(this),r=Cn(n),s=t[0];for(let a=0;a<r;++a){const o=Ln(n[a]);if(ps(e,s,[o,a,this]))return a}return-1}findLast(e,...t){An(this);const n=en(this),r=Cn(n),s=t[0];for(let a=r-1;a>=0;--a){const o=Ln(n[a]);if(ps(e,s,[o,a,this]))return o}}findLastIndex(e,...t){An(this);const n=en(this),r=Cn(n),s=t[0];for(let a=r-1;a>=0;--a){const o=Ln(n[a]);if(ps(e,s,[o,a,this]))return a}return-1}every(e,...t){An(this);const n=en(this),r=Cn(n),s=t[0];for(let a=0;a<r;++a)if(!ps(e,s,[Ln(n[a]),a,this]))return!1;return!0}some(e,...t){An(this);const n=en(this),r=Cn(n),s=t[0];for(let a=0;a<r;++a)if(ps(e,s,[Ln(n[a]),a,this]))return!0;return!1}set(e,...t){An(this);const n=en(this),r=Ul(t[0]);if(r<0)throw jw(Bw);if(e==null)throw ni(J5);if(r6(e))throw ni(e6);if(Uf(e))return Qge(en(this),en(e),r);if(db(e)){const l=ir(e);if(Tm(l))throw ni(Mm)}const s=Cn(n),a=M0(e),o=Vw(a.length);if(r===1/0||o+r>s)throw jw(Bw);for(let l=0;l<o;++l)n[l+r]=Do(a[l])}reverse(){An(this);const e=en(this);return zD(e),this}toReversed(){An(this);const e=en(this),t=new Ys(ir(e),Sh(e),Cn(e)),n=new rr(ir(Bp(t))),r=en(n);return zD(r),n}fill(e,...t){An(this);const n=en(this);return Jge(n,Do(e),...hy(t)),this}copyWithin(e,t,...n){An(this);const r=en(this);return exe(r,e,t,...hy(n)),this}sort(e){An(this);const t=en(this),n=e!==void 0?e:GD;return UD(t,(r,s)=>n(Ln(r),Ln(s))),this}toSorted(e){An(this);const t=en(this);if(e!==void 0&&typeof e!="function")throw new ni(Ige);const n=e!==void 0?e:GD,r=new Ys(ir(t),Sh(t),Cn(t)),s=new rr(ir(Bp(r))),a=en(s);return UD(a,(o,l)=>n(Ln(o),Ln(l))),s}slice(e,t){An(this);const n=en(this),r=fy(n,rr);if(r===rr){const g=new Ys(ir(n),Sh(n),Cn(n));return new rr(ir(Bp(g,e,t)))}const s=Cn(n),a=Ul(e),o=t===void 0?s:Ul(t);let l;a===-1/0?l=0:a<0?l=s+a>0?s+a:0:l=s<a?s:a;let c;o===-1/0?c=0:o<0?c=s+o>0?s+o:0:c=s<o?s:o;const u=c-l>0?c-l:0,d=new r(u);if(py(d,u),u===0)return d;const p=ir(n);if(Tm(p))throw ni(Mm);let m=0;for(;l<c;)d[m]=Ln(n[l]),++l,++m;return d}subarray(e,t){An(this);const n=en(this),r=fy(n,rr),s=new Ys(ir(n),Sh(n),Cn(n)),a=txe(s,e,t),o=new r(ir(a),Sh(a),Cn(a));return py(o),o}indexOf(e,...t){An(this);const n=en(this),r=Cn(n);let s=Ul(t[0]);if(s===1/0)return-1;s<0&&(s+=r,s<0&&(s=0));for(let a=s;a<r;++a)if(Kl(n,a)&&Ln(n[a])===e)return a;return-1}lastIndexOf(e,...t){An(this);const n=en(this),r=Cn(n);let s=t.length>=1?Ul(t[0]):r-1;if(s===-1/0)return-1;s>=0?s=s<r-1?s:r-1:s+=r;for(let a=s;a>=0;--a)if(Kl(n,a)&&Ln(n[a])===e)return a;return-1}includes(e,...t){An(this);const n=en(this),r=Cn(n);let s=Ul(t[0]);if(s===1/0)return!1;s<0&&(s+=r,s<0&&(s=0));const a=w0(e);for(let o=s;o<r;++o){const l=Ln(n[o]);if(a&&w0(l)||l===e)return!0}return!1}join(e){An(this);const t=en(this),n=WD(t);return Uge(n,e)}toLocaleString(...e){An(this);const t=en(this),n=WD(t);return Bge(n,...hy(e))}get[$A](){if(Uf(this))return"Float16Array"}};sx(rd,"BYTES_PER_ELEMENT",{value:nC});sx(rd,fb,{});aV(rd,ZA);const mb=rd.prototype;sx(mb,"BYTES_PER_ELEMENT",{value:nC});sx(mb,tl,{value:mb.values,writable:!0,configurable:!0});aV(mb,fr);function vxe(i){const{roiCollapseWindow:e,roiState:t}=un(Tt(o=>({roiCollapseWindow:o.roiCollapseWindow,roiState:o.roiState}))),n=Db({}),r=RL({}),s=Nb({});return{spectrum1D:z.useMemo(()=>{if(!i)return[];const o=n[i],l=r[i],c=s[i],u=o?.data,d=l?.data,p=c?.data;if(!u||!d||!p)return[];const m=new rd(u.buffer),g=new rd(d.buffer),y=u.width,x=u.height,{dx:_,dy:S}=p,{x:w,y:T,width:C,height:E}=t,D=[Zn(e.waveMin,0,C),Zn(e.waveMax,0,C)],O=D[0]<D[1]?D[0]:D[1],R=D[0]<D[1]?D[1]:D[0],P=[Zn(e.spatialMin,0,E),Zn(e.spatialMax,0,E)],L=P[0]<P[1]?P[0]:P[1],V=P[0]<P[1]?P[1]:P[0],j=Math.floor(O),B=Math.ceil(R),J=Math.floor(L),U=Math.ceil(V),X=[];for(let $=j;$<B;$++){const Q=w+$-_;if(Q<0||Q>=y)continue;let se=0,ye=0,we=0;for(let He=J;He<U;He++){const De=T+He-S;if(De<0||De>=x)continue;const Oe=De*y+Q,fe=m[Oe],ge=g[Oe];Number.isNaN(fe)||Number.isNaN(ge)||(se+=fe,ye+=ge*ge,we+=1)}if(we>0){const He=se,De=Math.sqrt(ye);X.push({wavelength:$,flux:He,error:De,fluxMinusErr:He-De,fluxPlusErr:He+De})}}return X},[i,n,r,s,e,t]),roiCollapseWindow:e,roiState:t}}function AV(){const i=Hn(r=>r.selectedFootprintId),e=Xl(r=>r.setCounterpartPosition),{data:t,isSuccess:n}=EL({selectedFootprintId:i,enabled:!!i});return z.useEffect(()=>{if(!n||!t)return;const{vertex_marker:r}=t.footprint;e({x0:r[0][0],y0:r[0][1],width:r[2][0]-r[0][0],height:r[2][1]-r[0][1]})},[n,t,e]),{selectedFootprintId:i}}const sd=1e4,iC=299792.458,bxe=2*Math.sqrt(2*Math.log(2));function qD(i,e=6){if(!Number.isFinite(i))return"";const t=10**e,n=Math.round(i*t)/t;return String(n)}function a6(i,e,t){const n=1+(Number.isFinite(t)?t:0);let r=1;return i===""&&(r*=sd),e==="rest"&&(r/=n||1),r}function fo(i,e,t,n){const r=1+(Number.isFinite(n)?n:0),s=t==="observe"?i:i/(r||1);return e==="m"?s:s*sd}function o6(i,e,t,n){const r=1+(Number.isFinite(n)?n:0);let s;return e==="m"?s=i:s=i/sd,t==="observe"?s:s*(r||1)}function CV(i,e,t,n,r=4){const s=fo(i,e,t,n);return e==="m"?`${s.toFixed(r)} m`:`${Math.round(s)} `}function _xe(i,e){const t=i.length;if(t===0)return null;let n=0,r=t-1;for(;n<r;){const o=n+r>>1;i[o]<e?n=o+1:r=o}let s=n,a=i[s];if(s>0){const o=i[s-1];Math.abs(o-e)<=Math.abs(a-e)&&(s=s-1,a=o)}return{index:s,wavelength:a}}const Mf={top:20,right:20,bottom:50,left:50};function Sxe({currentBasename:i}){const{spectrum1D:e,roiCollapseWindow:t}=vxe(i),[n,r]=z.useState(t.waveMin),[s,a]=z.useState(4e4),[o,l]=z.useState(1e3),{data:c,isSuccess:u}=PL({enabled:!0,waveMin:4,waveMax:4.8}),d=u&&c?c.mean_pixel_scale*1e4:1;if(e.length===0)return v.jsx(qe,{w:"100%",h:"100%",display:"flex",alignItems:"center",justifyContent:"center",bg:"gray.900",color:"gray.500",children:"No data available"});const p=d*iC/s;return v.jsxs(ld,{w:"100%",h:"100%",gap:1,align:"stretch",children:[v.jsx(qe,{w:"100%",h:"100%",minH:"0px",children:v.jsx(Mge,{debounceTime:10,children:({width:m,height:g})=>{const y=m-Mf.left-Mf.right,x=g-Mf.top-Mf.bottom,_=Math.min(...e.map(O=>O.wavelength)),S=Math.max(...e.map(O=>O.wavelength)),w=wI({domain:[_,S],range:[0,y]}),T=Math.min(...e.map(O=>O.fluxMinusErr)),C=Math.max(...e.map(O=>O.fluxPlusErr)),E=(C-T)*.1,D=wI({domain:[T-E,C+E],range:[x,0]});return v.jsx("svg",{width:m,height:g,children:v.jsx(wxe,{spectrum1D:e,innerWidth:y,innerHeight:x,xScale:w,yScale:D,refIndex:n,factor:u?p:void 0,label:{bottom:u?" (km/s)":" (pixels)"},anchor:{top:Mf.top,left:Mf.left},children:v.jsx(Mxe,{refIndex:n,fwhmKms:o,kmsPerPixel:u?p:void 0,xScale:w,innerWidth:y,innerHeight:x})})})}})}),v.jsx(qe,{w:"100%",flexShrink:0,children:v.jsx(Age,{refIndex:n,onRefIndexChange:m=>r(m),refIndexRange:[t.waveMin,t.waveMax],lambda0:s,onLambda0Change:m=>a(m),fwhm:o,onFwhmChange:m=>l(m)})})]})}const Ro={axisStroke:"#718096",tickLabel:"#A0AEC0",axisLabel:"#CBD5E0",lineFlux:"#4FD1C5",areaError:"#38B2AC"},wxe=z.memo(function(e){const{spectrum1D:t,xScale:n,yScale:r,innerWidth:s,innerHeight:a,anchor:o,label:l,children:c}=e,u=d=>((d-(e.refIndex??0))*(e.factor??1)).toFixed(0);return s<10||a<10?null:v.jsxs(xd,{left:o.left,top:o.top,children:[v.jsx(cge,{scale:r,numTicks:5,label:l?.left??"Flux (e/s)",labelOffset:45,stroke:Ro.axisStroke,tickStroke:Ro.axisStroke,tickLabelProps:()=>({fill:Ro.tickLabel,fontSize:10,fontFamily:"monospace",dx:-10,dy:3,textAnchor:"end"}),labelProps:{fill:Ro.axisLabel,fontSize:12,fontWeight:"bold",textAnchor:"middle"}}),v.jsx(hge,{top:a,scale:n,numTicks:6,tickFormat:d=>u(Number(d)),label:l?.bottom??" (pixels)",stroke:Ro.axisStroke,tickStroke:Ro.axisStroke,tickLabelProps:()=>({fill:Ro.tickLabel,fontSize:10,fontFamily:"monospace",textAnchor:"middle",dy:2}),labelProps:{fill:Ro.axisLabel,fontSize:12,fontWeight:"bold",dy:2}}),v.jsx(eV,{data:t,x:d=>n(d.wavelength)??0,y:d=>r(d.fluxPlusErr)??0,y0:d=>r(d.fluxMinusErr)??0,yScale:r,curve:yg,fill:Ro.areaError,fillOpacity:.15,stroke:"none"}),v.jsx(vg,{data:t,x:d=>n(d.wavelength)??0,y:d=>r(d.flux)??0,stroke:Ro.lineFlux,strokeWidth:1.5,curve:yg}),c]})}),Gw="#ED8903",Mxe=z.memo(function(e){const{refIndex:t,fwhmKms:n,kmsPerPixel:r,xScale:s,innerWidth:a,innerHeight:o}=e,l=n&&r?n/r:0,c=z.useMemo(()=>{if(t===void 0||l===0)return;const d=s(t-l/2);if(!(d===void 0||d<0||d>a))return d},[t,l,s,a]),u=z.useMemo(()=>{if(t===void 0||l===0)return;const d=s(t+l/2);if(!(d===void 0||d<0||d>a))return d},[t,l,s,a]);return v.jsxs(v.Fragment,{children:[t!==void 0&&v.jsx(wm,{from:{x:s(t),y:0},to:{x:s(t),y:o},stroke:Gw,strokeWidth:2,pointerEvents:"none"}),t!==void 0&&c!==void 0&&v.jsx(wm,{from:{x:c,y:0},to:{x:c,y:o},stroke:Gw,strokeWidth:1,pointerEvents:"none",strokeDasharray:"4 4"}),t!==void 0&&u!==void 0&&v.jsx(wm,{from:{x:u,y:0},to:{x:u,y:o},stroke:Gw,strokeWidth:1,pointerEvents:"none",strokeDasharray:"4 4"})]})});function Txe(){return v.jsxs("group",{children:[v.jsx(EV,{}),v.jsx(Dxe,{})]})}const Axe=4,Cxe=6,Exe="#000000",Rxe=1,Pxe=1.1,Ixe=({source:i,isMain:e,removeSource:t,setMain:n})=>{const r=z.useRef(null);NA(({camera:o})=>{if(!r.current)return;const l=1/o.zoom;r.current.scale.set(l,l,1)});const s=o=>{o.stopPropagation(),o.nativeEvent.preventDefault(),o.nativeEvent.metaKey||o.nativeEvent.ctrlKey?t(i.id):n(i.id)},a=e?Cxe:Axe;return v.jsxs("group",{ref:r,position:[i.x,-i.y,e?Pxe:Rxe],onContextMenu:s,children:[v.jsx(tI,{args:[a+1,32],position:[0,0,-.001],children:v.jsx("meshBasicMaterial",{color:Exe})}),v.jsx(tI,{args:[a,32],children:v.jsx("meshBasicMaterial",{color:i.color})})]})};function Dxe(){const{traceMode:i,traceSources:e,mainTraceSourceId:t,setMainTraceSource:n,removeTraceSource:r}=sa(Tt(s=>({traceMode:s.traceMode,traceSources:s.traceSources,mainTraceSourceId:s.mainTraceSourceId,setMainTraceSource:s.setMainTraceSource,removeTraceSource:s.removeTraceSource})));return i?v.jsx(v.Fragment,{children:e.map(s=>v.jsx(Ixe,{source:s,isMain:s.id===t,removeSource:r,setMain:n},s.id))}):null}const Nxe=1.5,Lxe=2.5,XD=.9,kxe=({source:i,isMain:e,currentBasename:t,enabled:n=!1})=>{const{data:r,isSuccess:s}=PL({x:i.x,y:i.y,basename:t,enabled:n}),a=e?XD+.01:XD,o=z.useMemo(()=>{if(!s||!r)return;const l=r.trace_xs,c=r.trace_ys;if(l.length!==c.length)return;const u=l.length,d=new Array(u);for(let p=0;p<u;p++)d[p]=[l[p],-c[p],a];return d},[s,r,a]);return!o||o.length===0?null:v.jsx(zA,{points:o,color:i.color,lineWidth:e?Lxe:Nxe,transparent:!0,opacity:.8,toneMapped:!1})};function EV(){const{traceMode:i,traceSources:e,mainTraceSourceId:t}=sa(Tt(n=>({traceMode:n.traceMode,traceSources:n.traceSources,mainTraceSourceId:n.mainTraceSourceId})));return i?v.jsx("group",{children:e.map(n=>v.jsx(kxe,{source:n,isMain:n.id===t,enabled:i},n.id))}):null}function Oxe({currentBasename:i}){return v.jsxs(ld,{h:"100%",align:"stretch",gap:0,bg:"gray.800",borderLeft:"1px solid #222",children:[v.jsx(zxe,{currentBasename:i}),v.jsx(qe,{flex:1,minH:"200px",children:v.jsx(Sxe,{currentBasename:i})}),v.jsx(Uxe,{})]})}function zxe({currentBasename:i}){const{roiState:e,backwardGlobalNorm:t,backwardRoiNorm:n,backwardNormIndependent:r}=un(Tt(p=>({roiState:p.roiState,backwardGlobalNorm:p.backwardGlobalNorm,backwardRoiNorm:p.backwardRoiNorm,backwardNormIndependent:p.backwardNormIndependent}))),s=Db({}),a=Nb({}),o=i?s?.[i]?.data:void 0,l=i?a?.[i]?.data:void 0,c=r?n.vmin:t.vmin,u=r?n.vmax:t.vmax,d=e.width/e.height;return v.jsxs(qe,{w:"100%",h:"auto",aspectRatio:d,bg:"black",borderBottom:"1px solid #444",position:"relative",flexShrink:0,children:[v.jsxs(ke,{position:"absolute",left:2,top:1,fontSize:"xs",bg:"blackAlpha.600",zIndex:10,color:"whiteAlpha.800",px:1,pointerEvents:"none",children:["ROI ZOOM ",r&&"(Local Norm)"]}),v.jsxs(JH,{children:[v.jsx(hj,{makeDefault:!0,manual:!0,position:[0,0,100],left:-e.width/2,right:e.width/2,top:e.height/2,bottom:-e.height/2,near:.1,far:1e3}),o&&v.jsxs(v.Fragment,{children:[v.jsx(dj,{buffer:o.buffer,width:o.width,height:o.height,dx:l?.dx??0,dy:l?.dy??0,vmin:c??-.05,vmax:u??.05,isVisible:!0}),v.jsx(c0e,{x:e.x,y:e.y,width:e.width,height:e.height}),v.jsx(u0e,{}),v.jsx(EV,{})]})]})]})}function Uxe(){return v.jsxs(qe,{p:4,borderTop:"1px solid #333",bg:"gray.900",children:[v.jsx(ke,{fontSize:"xs",fontWeight:"bold",mb:3,color:"gray.500",letterSpacing:"wider",children:"SHORTCUTS"}),v.jsxs(Lb,{templateColumns:"auto 1fr",gap:2,fontSize:"xs",color:"gray.400",children:[v.jsxs(Zr,{children:[v.jsx(zn,{children:"Shift"})," + ",v.jsx(zn,{children:"q"})," / ",v.jsx(zn,{children:"Shift"})," + ",v.jsx(zn,{children:"e"})]}),v.jsx(Zr,{children:"Previous Image / Next Image"}),v.jsxs(Zr,{children:[v.jsx(zn,{children:"Shift"})," + ",v.jsx(zn,{children:"c"})]}),v.jsx(Zr,{children:"Center Camera on ROI"}),v.jsxs(Zr,{children:[v.jsx(zn,{children:""})," / ",v.jsx(zn,{children:""})," / ",v.jsx(zn,{children:""})," / ",v.jsx(zn,{children:""})]}),v.jsx(Zr,{children:"Move ROI (1px)"}),v.jsxs(Zr,{children:[v.jsx(zn,{children:"Shift"})," + ",v.jsx(zn,{children:""})," / ",v.jsx(zn,{children:"Shift"})," + ",v.jsx(zn,{children:""})," /"," ",v.jsx(zn,{children:"Shift"})," + ",v.jsx(zn,{children:""})," / ",v.jsx(zn,{children:"Shift"})," + ",v.jsx(zn,{children:""})]}),v.jsx(Zr,{children:"Move ROI (10px)"}),v.jsxs(Zr,{children:[v.jsx(zn,{children:""})," + ",v.jsx(zn,{children:""})," / ",v.jsx(zn,{children:""})," + ",v.jsx(zn,{children:""})," /"," ",v.jsx(zn,{children:""})," + ",v.jsx(zn,{children:""})," / ",v.jsx(zn,{children:""})," + ",v.jsx(zn,{children:""})]}),v.jsx(Zr,{children:"Move ROI By Half Size"})]})]})}const Fxe=i0e({uTexture:new ri,uMode:0,uOpacity:1},`
    varying vec2 vUv;
    void main() {
        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
    }
    `,`
    uniform sampler2D uTexture;
    uniform int uMode;
    uniform float uOpacity;
    varying vec2 vUv;

    void main() {
        vec4 texColor = texture2D(uTexture, vUv);
        vec3 color = texColor.rgb;

        // Channel separation logic
        // If specific channel mode is selected, display that channel as grayscale
        if (uMode == 1) {
            color = vec3(texColor.r);
        } else if (uMode == 2) {
            color = vec3(texColor.g);
        } else if (uMode == 3) {
            color = vec3(texColor.b);
        }

        // Output color with opacity applied
        gl_FragColor = vec4(color, texColor.a * uOpacity);
    }
    `);WH({CounterpartMaterial:Fxe});function Bxe({visible:i}){const{counterpartPosition:e,displayMode:t,opacity:n}=Xl(Tt(P=>({counterpartPosition:P.counterpartPosition,displayMode:P.displayMode,opacity:P.opacity}))),{counterpartVisible:r,roiState:s,roiCollapseWindow:a}=un(Tt(P=>({counterpartVisible:P.counterpartVisible,roiState:P.roiState,roiCollapseWindow:P.roiCollapseWindow}))),o=i??r,{traceMode:l,mainTraceSourceId:c,addTraceSource:u,updateMainTraceSource:d,removeTraceSource:p}=sa(Tt(P=>({traceMode:P.traceMode,mainTraceSourceId:P.mainTraceSourceId,addTraceSource:P.addTraceSource,updateMainTraceSource:P.updateMainTraceSource,removeTraceSource:P.removeTraceSource}))),{selectedFootprintId:m}=AV(),g=IL({}),[y,x]=z.useState(null);z.useEffect(()=>{if(!g.isSuccess||!g.data)return;const P=g.data;let L=!1;return(async()=>{try{const j=await createImageBitmap(P,{imageOrientation:"flipY",premultiplyAlpha:"none",colorSpaceConversion:"default"});if(L){j.close();return}const B=new ri(j);B.colorSpace=Mr,B.minFilter=Jn,B.magFilter=Jn,B.wrapS=or,B.wrapT=or,B.needsUpdate=!0,x(B)}catch(j){queueMicrotask(()=>{Ui.error({title:"Failed to load counterpart image",description:j.message})})}})(),()=>{L=!0,x(j=>(j&&j.dispose(),null))}},[g.data,g.isSuccess]);const _=z.useMemo(()=>{switch(t){case"r":return 1;case"g":return 2;case"b":return 3;default:return 0}},[t]);if(!o||!y||!e.height||!e.width)return null;const{x0:S,y0:w,width:T,height:C}=e,E=S+T/2,D=-w-C/2,O=.05,R=P=>{if(!l)return;P.nativeEvent.preventDefault(),P.stopPropagation();const{x:L,y:V}=P.point,j=P.nativeEvent.shiftKey,B=P.nativeEvent.metaKey||P.nativeEvent.ctrlKey;j?u(L,-V,m,{roiState:s,collapseWindow:a}):B?c&&p(c):d({x:L,y:-V})};return v.jsxs("mesh",{position:[E,D,O],onContextMenu:R,children:[v.jsx("planeGeometry",{args:[T,C]}),v.jsx("counterpartMaterial",{uTexture:y,uMode:_,uOpacity:n,transparent:!0,side:co,depthWrite:!1})]})}const Gr=z.forwardRef(function(e,t){const{showArrow:n,children:r,disabled:s,portalled:a=!0,content:o,contentProps:l,portalRef:c,...u}=e;return s?r:v.jsxs(FK,{...u,children:[v.jsx(BK,{asChild:!0,children:r}),v.jsx(Au,{disabled:!a,container:c,children:v.jsx(HK,{children:v.jsxs(jK,{ref:t,...l,children:[n&&v.jsx(VK,{children:v.jsx(ez,{})}),o]})})})]})});function Hxe(){const i=z.useId(),e=Hn(c=>c.selectedFootprintId),[t,n]=z.useState(!1),r=Db({enabled:t}),s=RL({enabled:t}),a=Nb({enabled:t});z.useEffect(()=>{if(!e){n(!1);return}n(!1)},[e]);const o=t&&[r,s,a].every(c=>{const u=Object.values(c??{});return u.length===0?!0:u.every(d=>d.isSuccess)}),l=t&&[r,s,a].some(c=>{const u=Object.values(c??{});return u.length===0?!1:u.some(d=>d.isFetching)});return!e||o?null:v.jsx(qe,{position:"absolute",top:4,right:4,zIndex:10,children:v.jsx(Gr,{ids:{trigger:i},content:"Load all grism images for the current group",children:v.jsx(hr,{id:i,size:"xl",variant:"solid",bg:"whiteAlpha.400",borderRadius:"full",p:4,boxShadow:"lg",onClick:()=>n(!0),color:"white",_hover:{bg:"whiteAlpha.600"},_active:{bg:"whiteAlpha.800"},_focus:{boxShadow:"0 0 0 1px rgba(255,255,255,0.7)"},loading:l,children:"Fetch"})})})}function jxe(i){return Rb({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},child:[]},{tag:"polyline",attr:{points:"7 10 12 15 17 10"},child:[]},{tag:"line",attr:{x1:"12",y1:"15",x2:"12",y2:"3"},child:[]}]})(i)}function Vxe(i){return Rb({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"},child:[]}]})(i)}function Gxe(i){return Rb({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(i)}function Wxe({children:i,miniStatus:e}){const[t,n]=z.useState(!0);return v.jsx(qe,{position:"absolute",top:4,left:4,zIndex:10,maxW:"60vw",children:v.jsxs(OO,{open:t,onOpenChange:r=>n(r.open),children:[v.jsxs(gt,{mb:2,align:"center",children:[v.jsx(TK,{asChild:!0,children:v.jsx(ur,{"aria-label":"Toggle Toolbar",size:"sm",variant:"surface",bg:"blackAlpha.600",color:"white",_hover:{bg:"blackAlpha.800"},rounded:"full",children:t?v.jsx(Gxe,{}):v.jsx(Vxe,{})})}),!t&&e&&v.jsx(qe,{px:3,py:1,bg:"blackAlpha.600",backdropFilter:"blur(4px)",rounded:"full",border:"1px solid",borderColor:"whiteAlpha.200",children:e})]}),v.jsx(zO,{children:v.jsx(qe,{bg:"blackAlpha.800",backdropFilter:"blur(12px)",p:4,rounded:"xl",border:"1px solid",borderColor:"whiteAlpha.100",boxShadow:"xl",minW:"600px",children:i})})]})})}function Ww({label:i,value:e,options:t,isActive:n,color:r,onFilterChange:s,onCardClick:a}){const o=z.useMemo(()=>oc({items:t.map(p=>({label:p,value:p}))}),[t]),l=n?r:"whiteAlpha.100",c=n?"whiteAlpha.200":"transparent",u=n?r:"gray.500",d=n?1:.7;return v.jsx(qe,{w:"32%",minW:"80px",borderRadius:"md",borderWidth:"1px",borderColor:l,bg:"blackAlpha.400",transition:"all 0.2s ease-in-out",opacity:d,position:"relative",overflow:"hidden",cursor:"pointer",onClick:a,_hover:{borderColor:n?r:"whiteAlpha.400",opacity:1},children:v.jsxs(ld,{gap:0,align:"stretch",children:[v.jsx(qe,{px:2,py:1,bg:c,borderBottomWidth:"1px",borderBottomColor:n?"whiteAlpha.200":"transparent",transition:"background 0.2s",children:v.jsxs(gt,{justify:"space-between",align:"center",children:[v.jsx(ke,{fontSize:"xs",fontWeight:"bold",color:u,children:i}),n&&v.jsx(qe,{boxSize:"6px",borderRadius:"full",bg:r,boxShadow:`0 0 6px ${r}`})]})}),v.jsx(qe,{p:1,onClick:p=>p.stopPropagation(),children:v.jsxs(Hb,{collection:o,size:"xs",value:[e],onValueChange:p=>s(p.value[0]),children:[v.jsx(jb,{bg:"transparent",border:"none",color:e?"gray.200":"gray.600",px:1,h:"20px",fontSize:"xs",fontFamily:"mono",width:"100%",_hover:{bg:"whiteAlpha.100"},justifyContent:"center",onClick:p=>p.stopPropagation(),children:v.jsx(Wb,{placeholder:"-"})}),v.jsx(Au,{children:v.jsx(Vb,{children:v.jsx(Gb,{bg:"gray.900",borderColor:"whiteAlpha.200",zIndex:1500,children:o.items.map(p=>v.jsx(qb,{item:p,_hover:{bg:"whiteAlpha.200"},color:"gray.200",fontSize:"xs",fontFamily:"mono",py:1,children:p.label},p.value))})})})]})})]})})}function qxe(){const{availableFilters:i,setAvailableFilters:e,filterRGB:t,setFilterRGB:n,displayMode:r,setDisplayMode:s,opacity:a,setOpacity:o,counterpartNorm:l,setCounterpartNorm:c}=Xl(Tt(S=>({availableFilters:S.availableFilters,setAvailableFilters:S.setAvailableFilters,filterRGB:S.filterRGB,setFilterRGB:S.setFilterRGB,displayMode:S.displayMode,setDisplayMode:S.setDisplayMode,opacity:S.opacity,setOpacity:S.setOpacity,counterpartNorm:S.counterpartNorm,setCounterpartNorm:S.setCounterpartNorm}))),{data:u,isSuccess:d}=AL({queryKey:["available_filters"],path:"/image/counterpart_meta/"});z.useEffect(()=>{d&&u&&e(u)},[d,u,e]);const p=S=>{c({pmax:S})},m=S=>{c({pmin:S})},g=S=>{o(S)},y=S=>{s(r===S?"rgb":S)},x=t.r===t.g&&t.g===t.b,_=r==="rgb"&&!x;return v.jsxs(ld,{gap:4,align:"stretch",children:[v.jsxs(gt,{justify:"space-between",children:[v.jsx(ke,{fontSize:"xs",fontWeight:"bold",color:"gray.400",letterSpacing:"wider",children:"Counterpart"}),v.jsxs(gt,{gap:4,children:[v.jsx(Yxe,{}),v.jsx(Xxe,{})]})]}),v.jsxs(qe,{children:[v.jsx(gt,{justify:"space-between",children:v.jsx(ke,{fontSize:"xs",color:"pink.400",fontWeight:"semibold",children:"False Color Setup"})}),v.jsxs(gt,{gap:2,justify:"space-between",children:[v.jsx(Ww,{label:"R",value:t.r,options:i,color:"red.400",isActive:r.includes("r")&&!!t.r&&!x,onFilterChange:S=>n({...t,r:S}),onCardClick:()=>y("r")}),v.jsx(Ww,{label:"G",value:t.g,options:i,color:"green.400",isActive:r.includes("g")&&!!t.g&&!x,onFilterChange:S=>n({...t,g:S}),onCardClick:()=>y("g")}),v.jsx(Ww,{label:"B",value:t.b,options:i,color:"blue.400",isActive:r.includes("b")&&!!t.b&&!x,onFilterChange:S=>n({...t,b:S}),onCardClick:()=>y("b")})]}),v.jsx(ke,{fontSize:"2xs",color:"gray.600",mt:1,textAlign:"center",children:x?`Viewing ${t.r} in grayscale.`:_?"Viewing in RGB mode.":`Viewing in ${r.toUpperCase()} channel in grayscale.`})]}),v.jsxs(qe,{children:[v.jsx(ke,{fontSize:"xs",color:"pink.400",fontWeight:"semibold",mb:1,children:"Counterpart Norm"}),v.jsx(lb,{pmin:l.pmin,pmax:l.pmax,vmin:void 0,vmax:void 0,onPminChange:m,onPmaxChange:p,onVminChange:()=>{},onVmaxChange:()=>{}})]}),v.jsxs(qe,{children:[v.jsx(ke,{fontSize:"xs",color:"pink.400",fontWeight:"semibold",mb:1,children:"Opacity"}),v.jsx(Tge,{opacity:a,onOpacityChange:g})]}),v.jsx(Iu,{my:5})]})}function Xxe(){const i=Hn(u=>u.selectedFootprintId),e=Xl(u=>u.filterRGB),{refetch:t,isFetching:n,isSuccess:r,isError:s,error:a}=IL({}),{isFetching:o,isError:l,error:c}=EL({});return z.useEffect(()=>{if(l&&c){const u=c?.message??"Unknown error";queueMicrotask(()=>{Ui.error({title:"Failed to retrieve footprint",description:u})})}if(s&&a){const u=a?.message??"Unknown error";queueMicrotask(()=>{Ui.error({title:"Failed to retrieve counterpart image",description:u})})}r&&queueMicrotask(()=>{Ui.success({title:"The image is successfully retrieved"})})},[l,c,s,a,r]),v.jsxs(hr,{size:"xs",h:"24px",px:3,variant:"surface",colorPalette:"pink",fontSize:"xs",fontWeight:"bold",loading:o||n,onClick:()=>{if(!i){Ui.error({title:"No footprint selected",description:"Please select a footprint first."});return}if(!e.r||!e.g||!e.b){Ui.error({title:"Incomplete RGB filter",description:"Please set all RGB filter values."});return}t()},_hover:{bg:"pink.500",color:"white",borderColor:"pink.400"},children:[v.jsx(jxe,{})," Retrieve"]})}function Yxe(){const i=un(t=>t.counterpartVisible),e=un(t=>t.setCounterpartVisible);return v.jsxs(gt,{gap:2,children:[v.jsxs(ke,{fontSize:"xs",color:i?"pink.400":"gray.500",children:["Counterpart: ",i?"Visible":"Hidden"]}),v.jsxs(E0,{size:"sm",colorPalette:"pink",checked:i,onCheckedChange:t=>e(t.checked),children:[v.jsx(I0,{}),v.jsx(P0,{children:v.jsx(R0,{})})]})]})}function gb(i,e,t,n){var r=this,s=z.useRef(null),a=z.useRef(0),o=z.useRef(0),l=z.useRef(null),c=z.useRef([]),u=z.useRef(),d=z.useRef(),p=z.useRef(i),m=z.useRef(!0);p.current=i;var g=typeof window<"u",y=!e&&e!==0&&g;if(typeof i!="function")throw new TypeError("Expected a function");e=+e||0;var x=!!(t=t||{}).leading,_=!("trailing"in t)||!!t.trailing,S="maxWait"in t,w="debounceOnServer"in t&&!!t.debounceOnServer,T=S?Math.max(+t.maxWait||0,e):null;z.useEffect(function(){return m.current=!0,function(){m.current=!1}},[]);var C=z.useMemo(function(){var E=function(j){var B=c.current,J=u.current;return c.current=u.current=null,a.current=j,o.current=o.current||j,d.current=p.current.apply(J,B)},D=function(j,B){y&&cancelAnimationFrame(l.current),l.current=y?requestAnimationFrame(j):setTimeout(j,B)},O=function(j){if(!m.current)return!1;var B=j-s.current;return!s.current||B>=e||B<0||S&&j-a.current>=T},R=function(j){return l.current=null,_&&c.current?E(j):(c.current=u.current=null,d.current)},P=function j(){var B=Date.now();if(x&&o.current===a.current&&L(),O(B))return R(B);if(m.current){var J=e-(B-s.current),U=S?Math.min(J,T-(B-a.current)):J;D(j,U)}},L=function(){n&&n({})},V=function(){if(g||w){var j=Date.now(),B=O(j);if(c.current=[].slice.call(arguments),u.current=r,s.current=j,B){if(!l.current&&m.current)return a.current=s.current,D(P,e),x?E(s.current):d.current;if(S)return D(P,e),E(s.current)}return l.current||D(P,e),d.current}};return V.cancel=function(){var j=l.current;j&&(y?cancelAnimationFrame(l.current):clearTimeout(l.current)),a.current=0,c.current=s.current=u.current=l.current=null,j&&n&&n({})},V.isPending=function(){return!!l.current},V.flush=function(){return l.current?R(Date.now()):d.current},V},[x,S,e,T,_,y,g,w,n]);return C}function $xe(i,e){return i===e}function YD(i,e,t){var n=$xe,r=z.useRef(i),s=z.useState({})[1],a=gb(z.useCallback(function(l){r.current=l,s({})},[s]),e,t,s),o=z.useRef(i);return n(o.current,i)||(a(i),o.current=i),[r.current,a]}function Kxe({debounceMs:i=500}){const{roiState:e,pmin:t,pmax:n,backwardNormIndependent:r,setBackwardRoiNorm:s}=un(Tt(p=>({roiState:p.roiState,pmin:p.backwardRoiNorm.pmin,pmax:p.backwardRoiNorm.pmax,backwardNormIndependent:p.backwardNormIndependent,setBackwardRoiNorm:p.setBackwardRoiNorm}))),a=z.useMemo(()=>[t,n],[t,n]),[o]=YD(e,i),[l]=YD(a,i),c=DL({q:l,roi:o,enabled:r});z.useEffect(()=>{if(!r)return;const p=c.data;if(!p)return;const m=p.percentiles;if(m.length!==2)return;const g=m[0],y=m[1];s({vmin:g,vmax:y})},[c.data,r,s]);const u=e!==o||a[0]!==l[0]||a[1]!==l[1],d=r&&(u||c.isFetching);return{fluxPercentilesQuery:c,isDirty:u,isLoading:d}}function Zxe(){const{data:i}=DL({}),e=i?.percentiles,{isLoading:t}=Kxe({}),{backwardGlobalNorm:n,setBackwardGlobalNorm:r,backwardRoiNorm:s,setBackwardRoiNorm:a,backwardNormIndependent:o,setBackwardNormIndependent:l}=un(Tt(p=>({backwardGlobalNorm:p.backwardGlobalNorm,setBackwardGlobalNorm:p.setBackwardGlobalNorm,backwardRoiNorm:p.backwardRoiNorm,setBackwardRoiNorm:p.setBackwardRoiNorm,backwardNormIndependent:p.backwardNormIndependent,setBackwardNormIndependent:p.setBackwardNormIndependent}))),c=z.useCallback(p=>{if(!e)return null;const m=Zn(p*10,0,1e3),g=Zn(Math.floor(m),0,1e3),y=Zn(Math.ceil(m),0,1e3);if(g===y)return e[g];const x=e[g],_=e[y],S=m-g;return x*(1-S)+_*S},[e]),u=(p,m)=>{const g={[m]:p},y=c(p);y!==null&&(g[m==="pmin"?"vmin":"vmax"]=y),r(g)},d=(p,m)=>{a({[m]:p})};return v.jsxs(ld,{gap:4,align:"stretch",children:[v.jsxs(gt,{justify:"space-between",children:[v.jsx(ke,{fontSize:"xs",fontWeight:"bold",color:"gray.400",letterSpacing:"wider",children:"Grism"}),v.jsxs(gt,{gap:2,children:[v.jsxs(ke,{fontSize:"xs",color:o?"teal.300":"gray.500",children:["ROI Norm: ",o?"Local":"Global"]}),v.jsxs(E0,{size:"sm",colorPalette:"teal",checked:o,onCheckedChange:p=>l(p.checked),children:[v.jsx(I0,{}),v.jsx(P0,{children:v.jsx(R0,{})})]})]})]}),v.jsxs(qe,{children:[v.jsx(ke,{fontSize:"xs",color:"teal.300",fontWeight:"semibold",mb:1,children:"Global Norm"}),v.jsx(lb,{pmin:n.pmin,pmax:n.pmax,vmin:n.vmin,vmax:n.vmax,onPminChange:p=>u(p,"pmin"),onPmaxChange:p=>u(p,"pmax"),onVminChange:p=>r({vmin:p}),onVmaxChange:p=>r({vmax:p})})]}),v.jsxs(qe,{children:[v.jsxs(ke,{fontSize:"xs",color:o?"teal.300":"gray.500",fontWeight:"semibold",mb:1,children:["ROI Norm ",o?"(Active)":"(Disabled)"]}),v.jsx(lb,{pmin:s.pmin,pmax:s.pmax,vmin:s.vmin,vmax:s.vmax,onPminChange:p=>d(p,"pmin"),onPmaxChange:p=>d(p,"pmax"),onVminChange:p=>a({vmin:p}),onVmaxChange:p=>a({vmax:p})})]}),v.jsx(qe,{h:"16px",children:t&&v.jsx(ke,{fontSize:"xs",color:"cyan.300",textAlign:"center",animation:"pulse 1s infinite",children:"Updating ROI percentiles..."})})]})}function Qxe(){const{roiState:i}=un(Tt(t=>({roiState:t.roiState}))),{selectedFootprintId:e}=AV();return v.jsxs(ke,{fontSize:"xs",color:"gray.300",fontFamily:"mono",children:["ROI: (",i.x,", ",i.y,"), ",i.width," x ",i.height," | Group: ",e??"N/A"]})}function Jxe(){return v.jsxs(Wxe,{miniStatus:v.jsx(Qxe,{}),children:[v.jsx(qxe,{}),v.jsx(Zxe,{})]})}const e1e=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),t1e=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),$D=i=>{const e=t1e(i);return e.charAt(0).toUpperCase()+e.slice(1)},RV=(...i)=>i.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim(),n1e=i=>{for(const e in i)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var i1e={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const r1e=z.forwardRef(({color:i="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:r="",children:s,iconNode:a,...o},l)=>z.createElement("svg",{ref:l,...i1e,width:e,height:e,stroke:i,strokeWidth:n?Number(t)*24/Number(e):t,className:RV("lucide",r),...!s&&!n1e(o)&&{"aria-hidden":"true"},...o},[...a.map(([c,u])=>z.createElement(c,u)),...Array.isArray(s)?s:[s]]));const da=(i,e)=>{const t=z.forwardRef(({className:n,...r},s)=>z.createElement(r1e,{ref:s,iconNode:e,className:RV(`lucide-${e1e($D(i))}`,`lucide-${i}`,n),...r}));return t.displayName=$D(i),t};const s1e=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],a1e=da("activity",s1e);const o1e=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],PV=da("ban",o1e);const l1e=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],c1e=da("circle-check-big",l1e);const u1e=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],KD=da("clock",u1e);const h1e=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],d1e=da("cpu",h1e);const f1e=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]],p1e=da("crosshair",f1e);const m1e=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],g1e=da("external-link",m1e);const x1e=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],y1e=da("globe",x1e);const v1e=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],IV=da("info",v1e);const b1e=[["path",{d:"M2 5h20",key:"1fs1ex"}],["path",{d:"M6 12h12",key:"8npq4p"}],["path",{d:"M9 19h6",key:"456am0"}]],_1e=da("list-filter",b1e);const S1e=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],ZD=da("target",S1e);const w1e=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],rC=da("trash-2",w1e);const M1e=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],T1e=da("zap",M1e);function A1e(){const{traceSources:i,mainTraceSourceId:e,clearTraceSources:t,applyRoiToAllTraceSources:n}=sa(Tt(m=>({traceSources:m.traceSources,mainTraceSourceId:m.mainTraceSourceId,clearTraceSources:m.clearTraceSources,applyRoiToAllTraceSources:m.applyRoiToAllTraceSources}))),{roiState:r,collapseWindow:s,apertureSize:a,setApertureSize:o,forwardWaveRange:l,setForwardWaveRange:c}=un(Tt(m=>({roiState:m.roiState,collapseWindow:m.collapseWindow,apertureSize:m.apertureSize,setApertureSize:m.setApertureSize,forwardWaveRange:m.forwardWaveRange,setForwardWaveRange:m.setForwardWaveRange}))),u={apertureSize:a,waveMin:l.min,waveMax:l.max},d=u.waveMax>u.waveMin,p=m=>{const g=typeof m=="function"?m(u):m;o(g.apertureSize),c({min:g.waveMin,max:g.waveMax})};return{settings:u,isWaveRangeValid:d,totalSources:i.length,mainId:e,setSettings:p,clear:t,sync:()=>{n({roiState:r,collapseWindow:s})}}}const C1e=pr({slots:["root","panel","header","label","inputGroup","statusDisplay","actionGroup"],className:"global-controls",base:{root:{borderTopWidth:"1px",borderColor:"border.subtle",bg:"bg.canvas",p:4,position:"relative",zIndex:10,boxShadow:"0 -4px 20px -5px rgba(0,0,0,0.1)",_dark:{bg:"blackAlpha.900",borderTopColor:"border.accent",boxShadow:"0 -10px 30px -10px rgba(0, 255, 255, 0.1)"}},panel:{display:"flex",flexDirection:"column",gap:4},label:{fontSize:"xs",fontWeight:"semibold",textTransform:"uppercase",letterSpacing:"wider",color:"fg.muted",mb:1.5,display:"flex",alignItems:"center",gap:1,_dark:{color:"cyan.600"}},inputGroup:{display:"flex",alignItems:"flex-start",gap:3},statusDisplay:{fontFamily:"mono",fontSize:"xs",color:"fg.muted",bg:"bg.subtle",px:2,py:1,borderRadius:"sm",borderWidth:"1px",borderColor:"border.subtle",textAlign:"center",width:"100%",_dark:{bg:"whiteAlpha.50",borderColor:"whiteAlpha.200",color:"cyan.100"}},actionGroup:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:2,mt:1}}});function E1e(){const{settings:i,isWaveRangeValid:e,totalSources:t,mainId:n,setSettings:r,clear:s,sync:a}=A1e(),l=mr({recipe:C1e})();return v.jsx(qe,{css:l.root,children:v.jsxs(qe,{css:l.panel,children:[v.jsxs(Lb,{templateColumns:"1fr 2fr",gap:4,children:[v.jsx(Zr,{children:v.jsxs(wt,{gap:0,position:"relative",children:[v.jsxs(ke,{css:l.label,children:[v.jsx(fY,{size:10})," Aperture"]}),v.jsx(qo,{size:"sm",value:i.apertureSize.toString(),onValueChange:c=>{const u=parseInt(c.value,10);!Number.isNaN(u)&&u>1&&r(d=>({...d,apertureSize:u}))},min:2,width:"100%",children:v.jsx(Xo,{fontFamily:"mono",_focus:{borderColor:"border.accent",boxShadow:"0 0 0 1px var(--chakra-colors-border-accent)"}})})]})}),v.jsx(Zr,{children:v.jsxs(wt,{gap:0,position:"relative",children:[v.jsxs(ss,{justify:"space-between",align:"center",children:[v.jsxs(ke,{css:l.label,children:[v.jsx(pY,{size:10})," Range (m)"]}),!e&&v.jsx(ke,{color:"red.400",fontSize:"xs",fontWeight:"bold",position:"absolute",right:"0",top:"0",animation:"techPulse 4s infinite",children:"INVALID"})]}),v.jsxs(gt,{gap:2,width:"100%",children:[v.jsx(qo,{size:"sm",invalid:!e,value:i.waveMin.toString(),onValueChange:c=>{r(u=>({...u,waveMin:c.valueAsNumber}))},width:"100%",children:v.jsx(Xo,{fontFamily:"mono"})}),v.jsx(ke,{color:"fg.muted",children:"-"}),v.jsx(qo,{size:"sm",invalid:!e,value:i.waveMax.toString(),onValueChange:c=>{r(u=>({...u,waveMax:c.valueAsNumber}))},width:"100%",children:v.jsx(Xo,{fontFamily:"mono"})})]})]})})]}),v.jsx(qe,{css:l.statusDisplay,children:v.jsxs(gt,{justify:"center",gap:4,separator:v.jsx(ke,{color:"border.subtle",children:"|"}),children:[v.jsxs(ke,{children:["SRC: ",t.toString().padStart(2,"0")]}),v.jsxs(ke,{children:["MAIN: ",n?n.slice(0,8).toUpperCase():"N/A"]})]})}),v.jsxs(qe,{css:l.actionGroup,children:[v.jsx(Gr,{content:"Clear all trace sources",children:v.jsxs(hr,{size:"sm",variant:"ghost",colorPalette:"red",onClick:()=>{s(),Ui.success({title:"System Purged",description:`${t} sources removed from buffer.`})},flex:1,_hover:{bg:"red.500/10",borderColor:"red.500"},children:[v.jsx(D6,{})," Clear All"]})}),v.jsx(Gr,{content:"Sync current ROI settings to all sources",children:v.jsxs(hr,{size:"sm",variant:"outline",colorPalette:"cyan",onClick:()=>{a(),Ui.success({title:"Parameters Synced",description:"ROI settings broadcast to all units."})},flex:1,borderColor:"border.accent",_hover:{bg:"cyan.500/10",boxShadow:"0 0 10px var(--chakra-colors-cyan-500-20)"},children:[v.jsx(bL,{})," Sync ROI"]})})]})]})})}function DV(i){const{queryKey:e,path:t,axiosGetParams:n={},returnType:r="data",queryOptions:s={},checkParamsNull:a=!0}=i,o=bM(g=>g.isConnected),[l,c]=z.useState(0);let u=(i.enabled??!0)&&o;if(n?.params&&a){const g=Object.values(n.params).some(y=>y==null);u=u&&!g}const d=bM(g=>g.backendUrl);return{...Ng({queryKey:e,enabled:u,queryFn:async({signal:g})=>{c(0);const y={...n,signal:g,onDownloadProgress:x=>{if(x.total){const _=Math.round(x.loaded*100/x.total);c(_)}n.onDownloadProgress&&n.onDownloadProgress(x)}};if(r==="response")return eE.get(d+t,y);if(r==="data")return eE.get(d+t,y).then(x=>x.data);throw new Error(`Invalid returnType: ${r}`)},...s}),downloadProgress:l}}function R1e({selectedFootprintId:i,waveMin:e,waveMax:t,apertureSize:n,x:r,y:s,ra:a,dec:o,enabled:l=!1,queryKey:c}){let u=!0;if(r===void 0!=(s===void 0))throw new Error("Both x and y must be provided together");if(a===void 0!=(o===void 0))throw new Error("Both ra and dec must be provided together");r===void 0&&a===void 0&&(u=!1);const d=Hn(y=>y.selectedFootprintId),p=i??d,m=c??["extract_spectrum",e,t,n,a?.toFixed(10),o?.toFixed(10),r?.toFixed(1),s?.toFixed(1),p];return DV({queryKey:m,path:"/source/extract_spectrum/",enabled:l&&u&&p!=null,axiosGetParams:{params:{group_id:p,wavelength_min:e,wavelength_max:t,x:r,y:s,ra:a,dec:o,aperture_size:n}},checkParamsNull:!1})}function P1e({selectedFootprintId:i,x:e,y:t,ra:n,dec:r,ref_basename:s,enabled:a=!1}){if(e===void 0!=(t===void 0))throw new Error("Both x and y must be provided together");if(n===void 0!=(r===void 0))throw new Error("Both ra and dec must be provided together");if(e===void 0&&n===void 0)throw new Error("Either (x, y) or (ra, dec) must be provided");const o=Hn(d=>d.selectedFootprintId),l=i??o,c=["source-position",e?.toFixed(1),t?.toFixed(1),n,r,s,l];return DV({queryKey:c,enabled:a&&l!==null,path:"/source/source_position/",axiosGetParams:{params:{group_id:l,x:e,y:t,ra:n,dec:r,ref_basename:s}},checkParamsNull:!1})}function NV({source:i,apertureSize:e,waveMin:t,waveMax:n,posEnabled:r=!1,specEnabled:s=!1}){if(i.groupId===null||i.groupId===void 0)throw new Error("Source must have a valid groupId");const a=P1e({selectedFootprintId:i.groupId,x:i.x,y:i.y,enabled:r}),o=i.ra??a.data?.ra,l=i.dec??a.data?.dec,c=typeof o=="number"&&typeof l=="number",u=un(Tt(S=>S.apertureSize)),d=e??u,p=un(Tt(S=>S.forwardWaveRange)),m=t??p.min,g=n??p.max,y=g>m,x=["extract_spectrum",i.id,m,g,d,o?.toFixed(10),l?.toFixed(10)],_=R1e({selectedFootprintId:i.groupId,waveMin:m,waveMax:g,apertureSize:d,ra:c?o:void 0,dec:c?l:void 0,enabled:s&&c&&y,queryKey:x});return{positionQuery:a,spectrumQuery:_}}function I1e(i){const{apertureSize:e,forwardWaveRange:t}=un(Tt(C=>({apertureSize:C.apertureSize,forwardWaveRange:C.forwardWaveRange}))),{mainTraceSourceId:n,updateTraceSource:r,setMainTraceSource:s,removeTraceSource:a}=sa(Tt(C=>({mainTraceSourceId:C.mainTraceSourceId,updateTraceSource:C.updateTraceSource,setMainTraceSource:C.setMainTraceSource,removeTraceSource:C.removeTraceSource}))),[o,l]=z.useState(!1),c=i.id===n,u=e>1&&t.max>t.min,d=typeof i.ra=="number"&&typeof i.dec=="number",p=u&&d,m=mY(),{positionQuery:g,spectrumQuery:y}=NV({source:i,posEnabled:!d,specEnabled:!1});return z.useEffect(()=>{g.data&&queueMicrotask(()=>{r(i.id,{ra:g.data.ra,dec:g.data.dec,raHms:g.data.ra_hms,decDms:g.data.dec_dms})})},[g.data,i.id,r]),{isMain:c,useDms:o,toggleFormat:()=>{l(C=>!C)},positionQuery:g,spectrumQuery:y,isSettingsValid:u,sourceHasRaDec:d,canFetchSpec:p,fetchSpectrum:()=>{if(!u){Ui.error({title:"Invalid Settings",description:"Please ensure aperture size > 1 and waveMax > waveMin."});return}y.refetch()},setAsMainSource:()=>{s(c?null:i.id)},deleteSpectrum:()=>{m.cancelQueries({queryKey:["extract_spectrum",i.id],exact:!1}),m.removeQueries({queryKey:["extract_spectrum",i.id],exact:!1}),r(i.id,{spectrumReady:!1}),Ui.success({title:"Spectrum Deleted",description:`Spectrum for source ${i.id.slice(0,8)} has been deleted.`})},removeSource:()=>{a(i.id)}}}const D1e=pr({slots:["root","indicator","headerText","subText","actionGroup"],className:"source-card",base:{root:{position:"relative",p:3,borderWidth:"1px",borderRadius:"md",cursor:"pointer",transition:"all 0.2s",bg:"bg.card",borderColor:"border.subtle",boxShadow:"shadows.card",animation:"enter",_hover:{borderColor:"border.accent",animation:"hoverInteraction"}},indicator:{w:"10px",h:"10px",borderRadius:"full",mt:1.5},headerText:{fontSize:"xs",fontWeight:"bold",fontFamily:"mono",color:"fg"},subText:{fontSize:"xs",fontFamily:"mono",lineHeight:1.2,color:"fg.muted"},actionGroup:{display:"flex",flexDirection:"column",gap:2}},variants:{selected:{true:{root:{bg:"bg.cardSelected",borderColor:"border.accent",animation:"selected"},headerText:{color:"border.accent"}}},processing:{true:{root:{borderColor:"status.loading",animation:"processing"}}}}});function N1e({source:i}){const{isMain:e,useDms:t,toggleFormat:n,spectrumQuery:r,isSettingsValid:s,sourceHasRaDec:a,canFetchSpec:o,fetchSpectrum:l,setAsMainSource:c,deleteSpectrum:u,removeSource:d}=I1e(i),m=mr({recipe:D1e})({selected:e,processing:r.isFetching});return v.jsx(qe,{onClick:c,css:m.root,children:v.jsxs(ss,{justify:"space-between",align:"start",children:[v.jsxs(gt,{gap:3,align:"start",children:[v.jsx(qe,{css:m.indicator,style:{backgroundColor:i.color,boxShadow:`0 0 8px ${i.color}`}}),v.jsxs(wt,{gap:1,children:[v.jsx(ke,{css:m.headerText,children:i.id.slice(0,8).toUpperCase()}),v.jsxs(gt,{gap:1,children:[e&&v.jsx(ec,{colorPalette:"cyan",size:"xs",variant:"solid",children:"MAIN"}),i.spectrumReady?v.jsx(ec,{colorPalette:"green",size:"xs",variant:"solid",children:"READY"}):r.isFetching?v.jsx(ec,{colorPalette:"yellow",size:"xs",variant:"solid",children:"Loading"}):null]}),v.jsxs(wt,{gap:0,children:[v.jsxs(ke,{css:m.subText,children:["XY: ",i.x.toFixed(1),", ",i.y.toFixed(1)]}),v.jsx(Gr,{content:t?"Click to Switch to Degrees":"Click to Switch to DMS",children:v.jsxs(gt,{cursor:a?"pointer":"default",onClick:g=>{g.stopPropagation(),n()},h:"18px",_hover:{color:a?"cyan.300":void 0},children:[v.jsx(y1e,{size:10,color:"#718096"}),v.jsx(ke,{css:m.subText,children:a?t?`${i.raHms??"N/A"}, ${i.decDms??"N/A"}`:`${i.ra?.toFixed(5)??"N/A"}, ${i.dec?.toFixed(5)??"N/A"}`:"Loading Coords..."})]})})]})]})]}),v.jsxs(qe,{css:m.actionGroup,children:[v.jsx(Gr,{content:"Delete Source",children:v.jsx(ur,{"aria-label":"Delete Source",size:"xs",variant:"ghost",colorScheme:"red",onClick:g=>{g.stopPropagation(),d()},children:v.jsx(rC,{size:14})})}),v.jsx(Gr,{content:i.spectrumReady||r.isFetching?"Delete Spectrum":s?"Fetch Spectrum":"Invalid Settings",children:v.jsx(ur,{"aria-label":"Toggle Spectrum",size:"xs",variant:i.spectrumReady||r.isFetching?"solid":"outline",colorPalette:i.spectrumReady||r.isFetching?"red":"cyan",disabled:!i.spectrumReady&&!r.isFetching&&!o,loading:r.isFetching,onClick:g=>{g.stopPropagation(),i.spectrumReady||r.isFetching?u():l()},children:i.spectrumReady||r.isFetching?v.jsx(PV,{size:14}):v.jsx(T1e,{size:14})})})]})]})})}const L1e=({source:i})=>{const e=sa(s=>s.updateTraceSource),{spectrumQuery:t}=NV({source:i,specEnabled:!1}),n=z.useRef(0),r=z.useRef(0);return z.useEffect(()=>{if(!t.data||t.dataUpdatedAt===n.current)return;n.current=t.dataUpdatedAt,t.data.covered?(e(i.id,{spectrumReady:!0}),queueMicrotask(()=>{Ui.success({title:"Spectrum Extracted",description:`Source ${i.id.slice(0,8)} is covered.`})})):queueMicrotask(()=>{Ui.create({type:"warning",title:"Not Covered",description:`Source ${i.id.slice(0,8)} has no spectrum data.`})})},[t.data,t.dataUpdatedAt,i.id,e]),z.useEffect(()=>{!t.isError||!t.error||t.errorUpdatedAt!==r.current&&(r.current=t.errorUpdatedAt,i.spectrumReady&&e(i.id,{spectrumReady:!1}),queueMicrotask(()=>{Ui.error({title:"Fetch Failed",description:`Source ${i.id.slice(0,8)}: ${t.error.message}`})}))},[t.isError,t.error,t.errorUpdatedAt,i.id,i.spectrumReady,e]),null};function k1e(){const e=sa(Tt(t=>t.traceSources)).filter(t=>t.groupId!==null&&t.groupId!==void 0);return v.jsx(v.Fragment,{children:e.map(t=>v.jsx(L1e,{source:t},t.id))})}function O1e(){const{traceMode:i,traceSources:e}=sa(Tt(t=>({traceMode:t.traceMode,traceSources:t.traceSources})));return v.jsxs(G6,{placement:"end",size:"md",children:[v.jsx(Y6,{}),v.jsx(FO,{asChild:!0,children:v.jsx(hr,{position:"absolute",bottom:"12px",right:"12px",zIndex:10,size:"sm",fontSize:"xs",variant:i?"solid":"ghost",colorPalette:i?"cyan":"gray",animation:i?"selected":void 0,boxShadow:i?"0 0 15px {colors.cyan.500/30}":void 0,children:v.jsxs(gt,{gap:2,children:[i?v.jsx(ZD,{size:16}):v.jsx(_1e,{size:16}),v.jsx(ke,{children:i?"Trace Mode":"Source List"}),e.length>0&&v.jsx(ec,{variant:"solid",colorPalette:i?"cyan":"gray",size:"xs",children:e.length}),v.jsx(k1e,{})]})})}),v.jsx(Au,{children:v.jsx(W6,{children:v.jsxs(q6,{display:"flex",flexDirection:"column",h:"100%",children:[v.jsx($6,{flexShrink:0,children:v.jsxs(gt,{justify:"space-between",children:[v.jsxs(gt,{children:[v.jsx(p1e,{size:18,color:i?"var(--chakra-colors-cyan-400)":"var(--chakra-colors-gray-400)"}),v.jsx(yc,{size:"sm",color:"fg",children:"Trace Sources"})]}),v.jsx(X6,{asChild:!0,children:v.jsx(Fb,{})})]})}),v.jsx(am,{className:"custom-scrollbar",flex:"1",overflowY:"auto",px:4,pb:4,children:e.length===0?v.jsxs(ss,{direction:"column",align:"center",justify:"center",h:"100%",color:"fg.muted",children:[v.jsx(ZD,{size:40,style:{opacity:.5,marginBottom:10}}),v.jsx(ke,{fontSize:"sm",children:"No trace sources initialized."})]}):v.jsxs(wt,{gap:3,children:[e.map(t=>v.jsx(N1e,{source:t},t.id)),v.jsx(qe,{h:"4"})]})}),v.jsx(qe,{flexShrink:0,children:v.jsx(E1e,{})})]})})})]})}var Ur,LV,rc,Vo,hu,kV,Xf,my,OV=function(){return typeof window<"u"},zV=function(){return Ur||OV()&&(Ur=window.gsap)&&Ur.registerPlugin&&Ur},UV=function(e){return typeof e=="string"},QD=function(e){return typeof e=="function"},bg=function(e,t){var n=t==="x"?"Width":"Height",r="scroll"+n,s="client"+n;return e===rc||e===Vo||e===hu?Math.max(Vo[r],hu[r])-(rc["inner"+n]||Vo[s]||hu[s]):e[r]-e["offset"+n]},_g=function(e,t){var n="scroll"+(t==="x"?"Left":"Top");return e===rc&&(e.pageXOffset!=null?n="page"+t.toUpperCase()+"Offset":e=Vo[n]!=null?Vo:hu),function(){return e[n]}},z1e=function(e,t,n,r){if(QD(e)&&(e=e(t,n,r)),typeof e!="object")return UV(e)&&e!=="max"&&e.charAt(1)!=="="?{x:e,y:e}:{y:e};if(e.nodeType)return{y:e,x:e};var s={},a;for(a in e)s[a]=a!=="onAutoKill"&&QD(e[a])?e[a](t,n,r):e[a];return s},FV=function(e,t){if(e=kV(e)[0],!e||!e.getBoundingClientRect)return console.warn("scrollTo target doesn't exist. Using 0")||{x:0,y:0};var n=e.getBoundingClientRect(),r=!t||t===rc||t===hu,s=r?{top:Vo.clientTop-(rc.pageYOffset||Vo.scrollTop||hu.scrollTop||0),left:Vo.clientLeft-(rc.pageXOffset||Vo.scrollLeft||hu.scrollLeft||0)}:t.getBoundingClientRect(),a={x:n.left-s.left,y:n.top-s.top};return!r&&t&&(a.x+=_g(t,"x")(),a.y+=_g(t,"y")()),a},JD=function(e,t,n,r,s){return!isNaN(e)&&typeof e!="object"?parseFloat(e)-s:UV(e)&&e.charAt(1)==="="?parseFloat(e.substr(2))*(e.charAt(0)==="-"?-1:1)+r-s:e==="max"?bg(t,n)-s:Math.min(bg(t,n),FV(e,t)[n]-s)},l6=function(){Ur=zV(),OV()&&Ur&&typeof document<"u"&&document.body&&(rc=window,hu=document.body,Vo=document.documentElement,kV=Ur.utils.toArray,Ur.config({autoKillThreshold:7}),Xf=Ur.config(),LV=1)},H0={version:"3.13.0",name:"scrollTo",rawVars:1,register:function(e){Ur=e,l6()},init:function(e,t,n,r,s){LV||l6();var a=this,o=Ur.getProperty(e,"scrollSnapType");a.isWin=e===rc,a.target=e,a.tween=n,t=z1e(t,r,e,s),a.vars=t,a.autoKill=!!("autoKill"in t?t:Xf).autoKill,a.getX=_g(e,"x"),a.getY=_g(e,"y"),a.x=a.xPrev=a.getX(),a.y=a.yPrev=a.getY(),my||(my=Ur.core.globals().ScrollTrigger),Ur.getProperty(e,"scrollBehavior")==="smooth"&&Ur.set(e,{scrollBehavior:"auto"}),o&&o!=="none"&&(a.snap=1,a.snapInline=e.style.scrollSnapType,e.style.scrollSnapType="none"),t.x!=null?(a.add(a,"x",a.x,JD(t.x,e,"x",a.x,t.offsetX||0),r,s),a._props.push("scrollTo_x")):a.skipX=1,t.y!=null?(a.add(a,"y",a.y,JD(t.y,e,"y",a.y,t.offsetY||0),r,s),a._props.push("scrollTo_y")):a.skipY=1},render:function(e,t){for(var n=t._pt,r=t.target,s=t.tween,a=t.autoKill,o=t.xPrev,l=t.yPrev,c=t.isWin,u=t.snap,d=t.snapInline,p,m,g,y,x;n;)n.r(e,n.d),n=n._next;p=c||!t.skipX?t.getX():o,m=c||!t.skipY?t.getY():l,g=m-l,y=p-o,x=Xf.autoKillThreshold,t.x<0&&(t.x=0),t.y<0&&(t.y=0),a&&(!t.skipX&&(y>x||y<-x)&&p<bg(r,"x")&&(t.skipX=1),!t.skipY&&(g>x||g<-x)&&m<bg(r,"y")&&(t.skipY=1),t.skipX&&t.skipY&&(s.kill(),t.vars.onAutoKill&&t.vars.onAutoKill.apply(s,t.vars.onAutoKillParams||[]))),c?rc.scrollTo(t.skipX?p:t.x,t.skipY?m:t.y):(t.skipY||(r.scrollTop=t.y),t.skipX||(r.scrollLeft=t.x)),u&&(e===1||e===0)&&(m=r.scrollTop,p=r.scrollLeft,d?r.style.scrollSnapType=d:r.style.removeProperty("scroll-snap-type"),r.scrollTop=m+1,r.scrollLeft=p+1,r.scrollTop=m,r.scrollLeft=p),t.xPrev=t.x,t.yPrev=t.y,my&&my.update()},kill:function(e){var t=e==="scrollTo",n=this._props.indexOf(e);return(t||e==="scrollTo_x")&&(this.skipX=1),(t||e==="scrollTo_y")&&(this.skipY=1),n>-1&&this._props.splice(n,1),!this._props.length}};H0.max=bg;H0.getOffset=FV;H0.buildGetter=_g;H0.config=function(i){Xf||l6()||(Xf=Ur.config());for(var e in i)Xf[e]=i[e]};zV()&&Ur.registerPlugin(H0);const BV=["shift","alt","meta","mod","ctrl","control"],U1e={esc:"escape",return:"enter",left:"arrowleft",right:"arrowright",up:"arrowup",down:"arrowdown",ShiftLeft:"shift",ShiftRight:"shift",AltLeft:"alt",AltRight:"alt",MetaLeft:"meta",MetaRight:"meta",OSLeft:"meta",OSRight:"meta",ControlLeft:"ctrl",ControlRight:"ctrl"};function du(i){return(U1e[i.trim()]||i.trim()).toLowerCase().replace(/key|digit|numpad/,"")}function HV(i){return BV.includes(i)}function qw(i,e=","){return i.toLowerCase().split(e)}function Xw(i,e="+",t=">",n=!1,r){let s=[],a=!1;i=i.trim(),i.includes(t)?(a=!0,s=i.toLocaleLowerCase().split(t).map(c=>du(c))):s=i.toLocaleLowerCase().split(e).map(c=>du(c));const o={alt:s.includes("alt"),ctrl:s.includes("ctrl")||s.includes("control"),shift:s.includes("shift"),meta:s.includes("meta"),mod:s.includes("mod"),useKey:n},l=s.filter(c=>!BV.includes(c));return{...o,keys:l,description:r,isSequence:a,hotkey:i}}typeof document<"u"&&(document.addEventListener("keydown",i=>{i.code!==void 0&&jV([du(i.code)])}),document.addEventListener("keyup",i=>{i.code!==void 0&&VV([du(i.code)])})),typeof window<"u"&&(window.addEventListener("blur",()=>{Jl.clear()}),window.addEventListener("contextmenu",()=>{setTimeout(()=>{Jl.clear()},0)}));const Jl=new Set;function sC(i){return Array.isArray(i)}function F1e(i,e=","){return(sC(i)?i:i.split(e)).every(t=>Jl.has(t.trim().toLowerCase()))}function jV(i){const e=Array.isArray(i)?i:[i];Jl.has("meta")&&Jl.forEach(t=>!HV(t)&&Jl.delete(t.toLowerCase())),e.forEach(t=>Jl.add(t.toLowerCase()))}function VV(i){const e=Array.isArray(i)?i:[i];i==="meta"?Jl.clear():e.forEach(t=>Jl.delete(t.toLowerCase()))}function B1e(i,e,t){(typeof t=="function"&&t(i,e)||t===!0)&&i.preventDefault()}function H1e(i,e,t){return typeof t=="function"?t(i,e):t===!0||t===void 0}const j1e=["input","textarea","select","searchbox","slider","spinbutton","menuitem","menuitemcheckbox","menuitemradio","option","radio","textbox"];function V1e(i){return GV(i,j1e)}function GV(i,e=!1){const{target:t,composed:n}=i;let r,s;return G1e(t)&&n?(r=i.composedPath()[0]&&i.composedPath()[0].tagName,s=i.composedPath()[0]&&i.composedPath()[0].role):(r=t&&t.tagName,s=t&&t.role),sC(e)?!!(r&&e&&e.some(a=>a.toLowerCase()===r.toLowerCase()||a===s)):!!(r&&e&&e)}function G1e(i){return!!i.tagName&&!i.tagName.startsWith("-")&&i.tagName.includes("-")}function W1e(i,e){return i.length===0&&e?(console.warn('A hotkey has the "scopes" option set, however no active scopes were found. If you want to use the global scopes feature, you need to wrap your app in a <HotkeysProvider>'),!0):e?i.some(t=>e.includes(t))||i.includes("*"):!0}const q1e=(i,e,t=!1)=>{const{alt:n,meta:r,mod:s,shift:a,ctrl:o,keys:l,useKey:c}=e,{code:u,key:d,ctrlKey:p,metaKey:m,shiftKey:g,altKey:y}=i,x=du(u);if(c&&l?.length===1&&l.includes(d))return!0;if(!l?.includes(x)&&!["ctrl","control","unknown","meta","alt","shift","os"].includes(x))return!1;if(!t){if(n!==y&&x!=="alt"||a!==g&&x!=="shift")return!1;if(s){if(!m&&!p)return!1}else if(r!==m&&x!=="meta"&&x!=="os"||o!==p&&x!=="ctrl"&&x!=="control")return!1}return l&&l.length===1&&l.includes(x)?!0:l?F1e(l):!l},X1e=z.createContext(void 0),Y1e=()=>z.useContext(X1e);function WV(i,e){return i&&e&&typeof i=="object"&&typeof e=="object"?Object.keys(i).length===Object.keys(e).length&&Object.keys(i).reduce((t,n)=>t&&WV(i[n],e[n]),!0):i===e}const $1e=z.createContext({hotkeys:[],activeScopes:[],toggleScope:()=>{},enableScope:()=>{},disableScope:()=>{}}),K1e=()=>z.useContext($1e);function Z1e(i){const e=z.useRef(void 0);return WV(e.current,i)||(e.current=i),e.current}const eN=i=>{i.stopPropagation(),i.preventDefault(),i.stopImmediatePropagation()},Q1e=typeof window<"u"?z.useLayoutEffect:z.useEffect;function ki(i,e,t,n){const r=z.useRef(null),s=z.useRef(!1),a=Array.isArray(t)?Array.isArray(n)?void 0:n:t,o=sC(i)?i.join(a?.delimiter):i,l=Array.isArray(t)?t:Array.isArray(n)?n:void 0,c=z.useCallback(e,l??[]),u=z.useRef(c);l?u.current=c:u.current=e;const d=Z1e(a),{activeScopes:p}=K1e(),m=Y1e();return Q1e(()=>{if(d?.enabled===!1||!W1e(p,d?.scopes))return;let g=[],y;const x=(T,C=!1)=>{if(!(V1e(T)&&!GV(T,d?.enableOnFormTags))){if(r.current!==null){const E=r.current.getRootNode();if((E instanceof Document||E instanceof ShadowRoot)&&E.activeElement!==r.current&&!r.current.contains(E.activeElement)){eN(T);return}}T.target?.isContentEditable&&!d?.enableOnContentEditable||qw(o,d?.delimiter).forEach(E=>{if(E.includes(d?.splitKey??"+")&&E.includes(d?.sequenceSplitKey??">")){console.warn(`Hotkey ${E} contains both ${d?.splitKey??"+"} and ${d?.sequenceSplitKey??">"} which is not supported.`);return}const D=Xw(E,d?.splitKey,d?.sequenceSplitKey,d?.useKey,d?.description);if(D.isSequence){y=setTimeout(()=>{g=[]},d?.sequenceTimeoutMs??1e3);const O=D.useKey?T.key:du(T.code);if(HV(O.toLowerCase()))return;g.push(O);const R=D.keys?.[g.length-1];if(O!==R){g=[],y&&clearTimeout(y);return}g.length===D.keys?.length&&(u.current(T,D),y&&clearTimeout(y),g=[])}else if(q1e(T,D,d?.ignoreModifiers)||D.keys?.includes("*")){if(d?.ignoreEventWhen?.(T)||C&&s.current)return;if(B1e(T,D,d?.preventDefault),!H1e(T,D,d?.enabled)){eN(T);return}u.current(T,D),C||(s.current=!0)}})}},_=T=>{T.code!==void 0&&(jV(du(T.code)),(d?.keydown===void 0&&d?.keyup!==!0||d?.keydown)&&x(T))},S=T=>{T.code!==void 0&&(VV(du(T.code)),s.current=!1,d?.keyup&&x(T,!0))},w=r.current||a?.document||document;return w.addEventListener("keyup",S,a?.eventListenerOptions),w.addEventListener("keydown",_,a?.eventListenerOptions),m&&qw(o,d?.delimiter).forEach(T=>m.addHotkey(Xw(T,d?.splitKey,d?.sequenceSplitKey,d?.useKey,d?.description))),()=>{w.removeEventListener("keyup",S,a?.eventListenerOptions),w.removeEventListener("keydown",_,a?.eventListenerOptions),m&&qw(o,d?.delimiter).forEach(T=>m.removeHotkey(Xw(T,d?.splitKey,d?.sequenceSplitKey,d?.useKey,d?.description))),g=[],y&&clearTimeout(y)}},[o,d,p]),r}nu.registerPlugin(H0);function J1e(i,e){const[t,n]=z.useState(0),r=un(m=>m.setRoiState),s=sa(m=>m.setTraceMode),a=Xl(m=>m.setOpacity),o=Xl(m=>m.setDisplayMode),l=1,c=.5,u=10,d=m=>{const{roiState:g}=un.getState(),y=m(g);r(y)},p={enableOnFromTags:!1,preventDefault:!0};return ki("shift+t",m=>{m.preventDefault(),s(!sa.getState().traceMode)},p),ki("shift+j",m=>{m.preventDefault(),a(Xl.getState().opacity-.1)},p),ki("shift+k",m=>{m.preventDefault(),a(Xl.getState().opacity+.1)},p),ki("shift+r",m=>{m.preventDefault();const g=Xl.getState().displayMode;o(g==="rgb"?"r":g==="r"?"g":g==="g"?"b":"rgb")},p),ki("up",m=>{m.preventDefault(),d(g=>({y:g.y-l}))},p),ki("down",m=>{m.preventDefault(),d(g=>({y:g.y+l}))},p),ki("left",m=>{m.preventDefault(),d(g=>({x:g.x-l}))},p),ki("right",m=>{m.preventDefault(),d(g=>({x:g.x+l}))},p),ki("mod+up",m=>{m.preventDefault(),d(g=>({y:g.y-c*g.height}))},p),ki("mod+down",m=>{m.preventDefault(),d(g=>({y:g.y+c*g.height}))},p),ki("mod+left",m=>{m.preventDefault(),d(g=>({x:g.x-c*g.width}))},p),ki("mod+right",m=>{m.preventDefault(),d(g=>({x:g.x+c*g.width}))},p),ki("shift+up",m=>{m.preventDefault(),d(g=>({y:g.y-u}))},p),ki("shift+down",m=>{m.preventDefault(),d(g=>({y:g.y+u}))},p),ki("shift+left",m=>{m.preventDefault(),d(g=>({x:g.x-u}))},p),ki("shift+right",m=>{m.preventDefault(),d(g=>({x:g.x+u}))},p),ki("shift+e",m=>{m.preventDefault(),n(g=>(g+1)%i)},{enabled:i>0},[i]),ki("shift+q",m=>{m.preventDefault(),n(g=>(g-1+i)%i)},{enabled:i>0},[i]),{currentImageIndex:t,setCurrentImageIndex:n}}function eye(i){const e=un(n=>n.roiState),{camera:t}=Qr();ki("shift+c",n=>{n.preventDefault();const r=i.current;if(!r||!t||!e)return;const s=e.x+e.width/2,a=e.y+e.height/2;nu.killTweensOf(r.target),nu.killTweensOf(t.position),nu.to(r.target,{x:s,y:-a,z:0,duration:.5,ease:"power3.inOut",onUpdate:()=>{r.update()}});const o=t.position.z;nu.to(t.position,{x:s,y:-a,z:o,duration:.5,ease:"power3.inOut"}),r.update()},[e,t,i])}function qV(i,e={}){const t=z.useRef(null),{duration:n=1,offset:r=0,ease:s="power3.inOut",preventDefault:a=!0}=e;return ki(i,()=>{t.current&&nu.to(window,{duration:n,scrollTo:{y:t.current,offsetY:r,autoKill:!0},ease:s})},{preventDefault:a,enableOnFormTags:!0},[n,r,s]),t}function tye({currentBasename:i}){const{roiState:e,backwardGlobalNorm:t}=un(Tt(l=>({roiState:l.roiState,backwardGlobalNorm:l.backwardGlobalNorm}))),n=Db({}),r=Nb({}),s=i?n?.[i]?.data:void 0,a=i?r?.[i]?.data:void 0,o=z.useRef(null);return v.jsxs(qe,{position:"relative",w:"100%",h:"100%",overflow:"hidden",bg:"black",children:[v.jsxs(JH,{children:[v.jsx(hj,{makeDefault:!0,position:[0,0,100],zoom:.5,near:.1,far:1e3}),v.jsx(a0e,{ref:o,enableRotate:!1,screenSpacePanning:!0,minZoom:.1,maxZoom:20}),v.jsx(nye,{controlRef:o}),v.jsx("color",{attach:"background",args:["#050505"]}),v.jsx(Bxe,{}),v.jsx(Txe,{}),s&&a&&v.jsxs(v.Fragment,{children:[v.jsx(dj,{buffer:s.buffer,width:s.width,height:s.height,dx:a.dx,dy:a.dy,vmin:t.vmin??-.05,vmax:t.vmax??.05,isVisible:!0}),v.jsx(l0e,{x:e.x,y:e.y,width:e.width,height:e.height})]})]}),v.jsx(Jxe,{}),v.jsx(iye,{currentBasename:i}),v.jsx(Hxe,{}),v.jsx(O1e,{})]})}function nye({controlRef:i}){return eye(i),null}function iye({currentBasename:i}){const{footprints:e,selectedFootprintId:t}=Hn(Tt(a=>({footprints:a.footprints,selectedFootprintId:a.selectedFootprintId}))),n=z.useMemo(()=>t?e.find(o=>o.id===t)?.meta?.included_files??[]:[],[e,t]),r=n.length,s=i?n.indexOf(i):-1;return v.jsx(qe,{position:"absolute",bottom:4,left:4,bg:"blackAlpha.700",px:3,py:1,borderRadius:"full",pointerEvents:"none",border:"1px solid",borderColor:"whiteAlpha.200",children:v.jsxs(ke,{fontSize:"xs",fontFamily:"mono",color:"gray.300",children:[i??"No Image Loaded",v.jsxs(ke,{as:"span",color:"gray.500",ml:2,children:["(",r>0?s+1:0,"/",r,")"]})]})})}function rye(){const i=qV("shift+3",{offset:0}),{footprints:e,selectedFootprintId:t}=Hn(Tt(a=>({footprints:a.footprints,selectedFootprintId:a.selectedFootprintId}))),n=z.useMemo(()=>t?e.find(o=>o.id===t)?.meta?.included_files??[]:[],[e,t]),{currentImageIndex:r}=J1e(n.length),s=n[r];return v.jsxs(Lb,{templateColumns:"1fr 600px",h:"100vh",bg:"gray.900",color:"white",overflow:"auto",gap:0,ref:i,children:[v.jsx(Zr,{minW:"700px",children:v.jsx(tye,{currentBasename:s})}),v.jsx(Zr,{children:v.jsx(Oxe,{currentBasename:s})})]})}function sye(i){return!!i&&i instanceof Element}function aye(i){return!!i&&(i instanceof SVGElement||"ownerSVGElement"in i)}function oye(i){return!!i&&"createSVGPoint"in i}function lye(i){return!!i&&"getScreenCTM"in i}function cye(i){return!!i&&"changedTouches"in i}function uye(i){return!!i&&"clientX"in i}function hye(i){return!!i&&(i instanceof Event||"nativeEvent"in i&&i.nativeEvent instanceof Event)}const Yw={x:0,y:0};function dye(i){if(!i)return{...Yw};if(cye(i))return i.changedTouches.length>0?{x:i.changedTouches[0].clientX,y:i.changedTouches[0].clientY}:{...Yw};if(uye(i))return{x:i.clientX,y:i.clientY};const e=i?.target,t=e&&"getBoundingClientRect"in e?e.getBoundingClientRect():null;return t?{x:t.x+t.width/2,y:t.y+t.height/2}:{...Yw}}function tN(i,e){if(!i||!e)return null;const t=dye(e),n=aye(i)?i.ownerSVGElement:i,r=lye(n)?n.getScreenCTM():null;if(oye(n)&&r){let a=n.createSVGPoint();return a.x=t.x,a.y=t.y,a=a.matrixTransform(r.inverse()),new Ql({x:a.x,y:a.y})}const s=i.getBoundingClientRect();return new Ql({x:t.x-s.left-i.clientLeft,y:t.y-s.top-i.clientTop})}function nN(i,e){if(sye(i)&&e)return tN(i,e);if(hye(i)){const t=i,n=t.target;if(n)return tN(n,t)}return null}function fye(i){const[e,t]=z.useState(i),n=z.useRef(null),r=z.useCallback((s,a)=>{n.current=a||null,t(s)},[t]);return z.useLayoutEffect(()=>{n.current&&(n.current(e),n.current=null)},[e]),[e,r]}function iN(i,e,t){return Math.min(Math.max(i,e),t)}function pye(i,e){let t=i,n=1/0;for(const r of e){const s=Math.sqrt((r.x-i.x)**2+(r.y-i.y)**2);s<n&&(n=s,t={x:r.x,y:r.y})}return t}function rN(i,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return e.length>0?pye(i,e):{x:iN(i.x,t.xMin??-1/0,t.xMax??1/0),y:iN(i.y,t.yMin??-1/0,t.yMax??1/0)}}function mye(i,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;if(!i)return[];const n=[],r=i.getTotalLength();for(let s=0;s<=r;s+=t){const o=i.getPointAtLength(s).matrixTransform(e);n.push(o)}return n}function gye(i){return z.useMemo(()=>{if(!i)return[];const t=i.getCTM()||new DOMMatrix;return mye(i,t)},[i?.getTotalLength()])}function xye(){let{resetOnStart:i=!1,snapToPointer:e=!0,onDragEnd:t,onDragMove:n,onDragStart:r,x:s,y:a,dx:o,dy:l,isDragging:c,restrict:u={},restrictToPath:d}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const p=z.useRef({x:s,y:a,dx:o,dy:l}),[m,g]=fye({x:s,y:a,dx:o??0,dy:l??0,isDragging:!1}),[y,x]=z.useState(new Ql({x:0,y:0}));z.useEffect(()=>{(p.current.x!==s||p.current.y!==a||p.current.dx!==o||p.current.dy!==l)&&(p.current={x:s,y:a,dx:o,dy:l},g(C=>({...C,x:s,y:a,dx:o??0,dy:l??0})))}),z.useEffect(()=>{c!==void 0&&m.isDragging!==c&&g(C=>({...C,isDragging:c}))},[m.isDragging,c,g]);const _=gye(d),S=z.useCallback(C=>{C.persist(),g(E=>{const{x:D=0,y:O=0,dx:R,dy:P}=E,L=new Ql({x:(D||0)+R,y:(O||0)+P}),V=nN(C)||new Ql({x:0,y:0}),B=rN(e?V:L,_,u);return x(age(L,V)),{isDragging:!0,dx:i?0:E.dx,dy:i?0:E.dy,x:i?B.x:B.x-E.dx,y:i?B.y:B.y-E.dy}},r&&(E=>{r({...E,event:C})}))},[r,i,u,_,g,e]),w=z.useCallback(C=>{C.persist(),g(E=>{if(!E.isDragging)return E;const{x:D=0,y:O=0}=E,R=nN(C)||new Ql({x:0,y:0}),P=e?R:sge(R,y),L=rN(P,_,u);return{...E,dx:L.x-D,dy:L.y-O}},n&&(E=>{E.isDragging&&n({...E,event:C})}))},[g,n,e,y,_,u]),T=z.useCallback(C=>{C.persist(),g(E=>({...E,isDragging:!1}),t&&(E=>{t({...E,event:C})}))},[t,g]);return{...m,dragEnd:T,dragMove:w,dragStart:S}}function Z2(i){let{captureDragArea:e=!0,snapToPointer:t=!0,children:n,dx:r,dy:s,height:a,onDragEnd:o,onDragMove:l,onDragStart:c,resetOnStart:u,width:d,x:p,y:m,isDragging:g,restrict:y,restrictToPath:x}=i;const _=xye({resetOnStart:u,snapToPointer:t,onDragEnd:o,onDragMove:l,onDragStart:c,x:p,y:m,dx:r,dy:s,isDragging:g,restrict:y,restrictToPath:x});return v.jsxs(v.Fragment,{children:[_.isDragging&&e&&v.jsx("rect",{width:d,height:a,onPointerDown:_.dragStart,onPointerMove:_.dragMove,onPointerUp:_.dragEnd,fill:"transparent"}),n(_)]})}function xb(i,e){if("invert"in i&&typeof i.invert<"u")return i.invert(e).valueOf();const[t,n]=i.range();let r=0;const a=("step"in i&&typeof i.step<"u"?i.step():1)*(n-t)/Math.abs(n-t);if(a>0)for(;e>t+a*(r+1);)r+=1;else for(;e<t+a*(r+1);)r+=1;return r}function sN(i,e,t,n){let r;const s=xb(i,e+(e<t?-n:n)),a=xb(i,t+(t<e?-n:n)),o=Math.min(s,a),l=Math.max(s,a);if("invert"in i&&typeof i.invert<"u")r={start:o,end:l};else{const c=[],u=i.domain();for(let d=o;d<=l;d+=1)c.push(u[d]);r={values:c}}return r}function aC(i){if(typeof window<"u"&&window.TouchEvent&&i instanceof TouchEvent)return{pageX:i.touches[0].pageX,pageY:i.touches[0].pageY};const e=i;return{pageX:e.pageX,pageY:e.pageY}}function yye(i,e){let t;return function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];clearTimeout(t),t=setTimeout(()=>{i.apply(this,s)},e)}}let vye=class extends z.Component{handleDragStart=e=>{const{onBrushHandleChange:t,type:n,onBrushStart:r}=this.props;t&&t(n,aC(e.event)),r&&r(e)};handleDragMove=e=>{const{updateBrush:t,type:n,isControlled:r}=this.props;!e.isDragging||r||t(s=>{const{start:a,end:o}=s;let l=0;const c=Math.max(a.x,o.x),u=Math.min(a.x,o.x),d=Math.max(a.y,o.y),p=Math.min(a.y,o.y);switch(n){case"right":return l=c+e.dx,{...s,activeHandle:n,extent:{...s.extent,x0:Math.max(Math.min(l,a.x),s.bounds.x0),x1:Math.min(Math.max(l,a.x),s.bounds.x1)}};case"left":return l=u+e.dx,{...s,activeHandle:n,extent:{...s.extent,x0:Math.min(l,o.x),x1:Math.max(l,o.x)}};case"bottom":return l=d+e.dy,{...s,activeHandle:n,extent:{...s.extent,y0:Math.min(l,a.y),y1:Math.max(l,a.y)}};case"top":return l=p+e.dy,{...s,activeHandle:n,extent:{...s.extent,y0:Math.min(l,o.y),y1:Math.max(l,o.y)}};case"topLeft":case"topRight":case"bottomLeft":case"bottomRight":default:return s}})};handleDragEnd=()=>{const{updateBrush:e,onBrushEnd:t,onBrushHandleChange:n,isControlled:r}=this.props;r||e(s=>{const{start:a,end:o,extent:l}=s;a.x=Math.min(l.x0,l.x1),a.y=Math.min(l.y0,l.y0),o.x=Math.max(l.x0,l.x1),o.y=Math.max(l.y0,l.y1);const c={...s,start:a,end:o,activeHandle:null,isBrushing:!1,extent:{x0:Math.min(a.x,o.x),x1:Math.max(a.x,o.x),y0:Math.min(a.y,o.y),y1:Math.max(a.y,o.y)}};return t&&t(c),c}),n&&n()};render(){const{stageWidth:e,stageHeight:t,brush:n,type:r,handle:s,isControlled:a,isDragInProgress:o,renderBrushHandle:l}=this.props,{x:c,y:u,width:d,height:p}=s,m=r==="right"||r==="left"?"ew-resize":"ns-resize";return v.jsx(Z2,{width:e,height:t,onDragStart:this.handleDragStart,onDragMove:this.handleDragMove,onDragEnd:this.handleDragEnd,resetOnStart:!0,isDragging:a?o:void 0,children:g=>{let{dragStart:y,dragEnd:x,dragMove:_,isDragging:S}=g;return v.jsxs("g",{children:[S&&v.jsx("rect",{fill:"transparent",width:e,height:t,style:{cursor:m},onPointerMove:_,onPointerUp:a?void 0:x,onPointerLeave:a?void 0:x}),!l&&v.jsx("rect",{x:c,y:u,width:d,height:p,fill:"transparent",className:`visx-brush-handle-${r}`,onPointerDown:y,onPointerMove:_,onPointerUp:a?void 0:x,style:{cursor:m,pointerEvents:n.activeHandle||n.isBrushing?"none":"all"}}),l&&v.jsx("g",{onPointerDown:y,onPointerMove:_,onPointerUp:a?void 0:x,children:l({...this.props.handle,height:t,className:`visx-brush-handle-${r}`,isBrushActive:n.extent.x0!==-1&&n.extent.x1!==-1})})]})}})}};class bye extends z.Component{static defaultProps={style:{}};cornerDragMove=e=>{const{updateBrush:t,type:n}=this.props;e.isDragging&&t(r=>{const{start:s,end:a}=r,o=Math.max(s.x,a.x),l=Math.min(s.x,a.x),c=Math.max(s.y,a.y),u=Math.min(s.y,a.y);let d=0,p=0;switch(n){case"topRight":return d=o+e.dx,p=u+e.dy,{...r,activeHandle:n,extent:{...r.extent,x0:Math.max(Math.min(d,s.x),r.bounds.x0),x1:Math.min(Math.max(d,s.x),r.bounds.x1),y0:Math.max(Math.min(p,a.y),r.bounds.y0),y1:Math.min(Math.max(p,a.y),r.bounds.y1)}};case"topLeft":return d=l+e.dx,p=u+e.dy,{...r,activeHandle:n,extent:{...r.extent,x0:Math.max(Math.min(d,a.x),r.bounds.x0),x1:Math.min(Math.max(d,a.x),r.bounds.x1),y0:Math.max(Math.min(p,a.y),r.bounds.y0),y1:Math.min(Math.max(p,a.y),r.bounds.y1)}};case"bottomLeft":return d=l+e.dx,p=c+e.dy,{...r,activeHandle:n,extent:{...r.extent,x0:Math.max(Math.min(d,a.x),r.bounds.x0),x1:Math.min(Math.max(d,a.x),r.bounds.x1),y0:Math.max(Math.min(p,s.y),r.bounds.y0),y1:Math.min(Math.max(p,s.y),r.bounds.y1)}};case"bottomRight":return d=o+e.dx,p=c+e.dy,{...r,activeHandle:n,extent:{...r.extent,x0:Math.max(Math.min(d,s.x),r.bounds.x0),x1:Math.min(Math.max(d,s.x),r.bounds.x1),y0:Math.max(Math.min(p,s.y),r.bounds.y0),y1:Math.min(Math.max(p,s.y),r.bounds.y1)}};case"top":case"right":case"bottom":case"left":default:return r}})};cornerDragEnd=()=>{const{updateBrush:e,onBrushEnd:t}=this.props;e(n=>{const{start:r,end:s,extent:a}=n;r.x=Math.min(a.x0,a.x1),r.y=Math.min(a.y0,a.y0),s.x=Math.max(a.x0,a.x1),s.y=Math.max(a.y0,a.y1);const o={...n,start:r,end:s,activeHandle:null,domain:{x0:Math.min(r.x,s.x),x1:Math.max(r.x,s.x),y0:Math.min(r.y,s.y),y1:Math.max(r.y,s.y)}};return t&&t(o),o})};render(){const{type:e,brush:t,stageWidth:n,stageHeight:r,style:s,corner:a}=this.props,o=s?.cursor||(e==="topLeft"||e==="bottomRight"?"nwse-resize":"nesw-resize"),l=t.activeHandle||t.isBrushing?"none":"all";return v.jsx(Z2,{width:n,height:r,onDragMove:this.cornerDragMove,onDragEnd:this.cornerDragEnd,resetOnStart:!0,children:c=>{let{dragMove:u,dragEnd:d,dragStart:p,isDragging:m}=c;return v.jsxs("g",{children:[m&&v.jsx("rect",{fill:"transparent",width:n,height:r,style:{cursor:o},onPointerMove:u,onPointerUp:d}),v.jsx("rect",{fill:"transparent",onPointerDown:p,onPointerMove:u,onPointerUp:d,className:`visx-brush-corner-${e}`,style:{cursor:o,pointerEvents:l,...s},...a})]})}})}}const _ye={cursor:"move"};class Sye extends z.Component{static defaultProps={onMouseLeave:null,onMouseUp:null,onMouseMove:null,onClick:null};selectionDragStart=e=>{const{onMoveSelectionChange:t,onBrushStart:n}=this.props;t&&t("move",aC(e.event)),n&&n(e)};selectionDragMove=e=>{const{updateBrush:t,isControlled:n}=this.props;n||t(r=>{const{x:s,y:a}=r.start,{x:o,y:l}=r.end,c=e.dx>0?Math.min(e.dx,r.bounds.x1-o):Math.max(e.dx,r.bounds.x0-s),u=e.dy>0?Math.min(e.dy,r.bounds.y1-l):Math.max(e.dy,r.bounds.y0-a);return{...r,isBrushing:!0,extent:{...r.extent,x0:s+c,x1:o+c,y0:a+u,y1:l+u}}})};selectionDragEnd=()=>{const{updateBrush:e,onBrushEnd:t,onMoveSelectionChange:n,isControlled:r}=this.props;r||e(s=>{const a={...s,isBrushing:!1,start:{...s.start,x:Math.min(s.extent.x0,s.extent.x1),y:Math.min(s.extent.y0,s.extent.y1)},end:{...s.end,x:Math.max(s.extent.x0,s.extent.x1),y:Math.max(s.extent.y0,s.extent.y1)}};return t&&t(a),a}),n&&n()};render(){const{width:e,height:t,stageWidth:n,stageHeight:r,brush:s,disableDraggingSelection:a,onMouseLeave:o,onMouseMove:l,onMouseUp:c,onClick:u,selectedBoxStyle:d,isControlled:p,isDragInProgress:m}=this.props;return v.jsx(Z2,{width:e,height:t,resetOnStart:!0,onDragStart:this.selectionDragStart,onDragMove:this.selectionDragMove,onDragEnd:this.selectionDragEnd,isDragging:p?m:void 0,children:g=>{let{isDragging:y,dragStart:x,dragEnd:_,dragMove:S}=g;return v.jsxs("g",{children:[y&&v.jsx("rect",{width:n,height:r,fill:"transparent",onPointerUp:p?void 0:_,onPointerMove:S,onPointerLeave:p?void 0:_,style:_ye}),v.jsx("rect",{x:Math.min(s.extent.x0,s.extent.x1),y:Math.min(s.extent.y0,s.extent.y1),width:e,height:t,className:"visx-brush-selection",onPointerDown:a?void 0:x,onPointerLeave:w=>{o&&o(w)},onPointerMove:w=>{S(w),l&&l(w)},onPointerUp:w=>{p||_(w),c&&c(w)},onClick:w=>{u&&u(w)},style:{pointerEvents:s.isBrushing||s.activeHandle?"none":"all",cursor:a?void 0:"move"},...d})]})}})}}function aN(i){return v.jsx(ome,{className:"visx-brush-overlay",fill:"transparent",x:0,y:0,...i})}class wye extends z.Component{constructor(e){super(e);const{initialBrushPosition:t}=e,n=t?this.getExtent(t.start,t.end):{x0:-1,x1:-1,y0:-1,y1:-1};this.state={start:{x:Math.max(0,n.x0),y:Math.max(0,n.y0)},end:{x:Math.max(0,n.x1),y:Math.max(0,n.y1)},extent:n,bounds:{x0:0,x1:this.props.width,y0:0,y1:this.props.height},isBrushing:!1,brushingType:void 0,activeHandle:null}}mouseUpTime=0;mouseDownTime=0;static defaultProps={brushDirection:"both",inheritedMargin:{left:0,top:0,right:0,bottom:0},onChange:null,handleSize:4,resizeTriggerAreas:["left","right"],onBrushStart:null,onBrushEnd:null,onMouseLeave:null,onMouseUp:null,onMouseMove:null,onClick:null,disableDraggingSelection:!1,disableDraggingOverlay:!1,clickSensitivity:200,resetOnEnd:!1,initialBrushPosition:null,useWindowMoveEvents:!1,renderBrushHandles:null};getIdleState=()=>{const{width:e,height:t}=this.props;return{start:{x:0,y:0},end:{x:0,y:0},extent:{x0:-1,x1:-1,y0:-1,y1:-1},bounds:{x0:0,x1:e,y0:0,y1:t},isBrushing:!1,brushPageOffset:void 0,activeHandle:null,brushingType:void 0}};componentDidUpdate(e){(this.props.width!==e.width||this.props.height!==e.height)&&this.setState(t=>{let{start:n,end:r,extent:s}=t;if(!(s.x0===-1&&s.x1===-1&&s.y0===-1&&s.y1===-1)){const a=this.props.width/e.width,o=this.props.height/e.height;n={x:a*s.x0,y:o*s.y0},r={x:a*s.x1,y:o*s.y1},s=this.getExtent(n,r)}return{start:n,end:r,extent:s,bounds:{x0:0,x1:this.props.width,y0:0,y1:this.props.height}}})}componentDidMount(){this.props.useWindowMoveEvents&&(window.addEventListener("mouseup",this.handleWindowPointerUp),window.addEventListener("mousemove",this.debouncedHandleWindowPointerMove))}componentWillUnmount(){this.props.useWindowMoveEvents&&(window.removeEventListener("mouseup",this.handleWindowPointerUp),window.removeEventListener("mousemove",this.debouncedHandleWindowPointerMove))}handleWindowPointerUp=()=>{const{useWindowMoveEvents:e,onBrushEnd:t,resetOnEnd:n}=this.props,{brushingType:r}=this.state;e&&r&&this.updateBrush(s=>{const{start:a,end:o,extent:l}=s;a.x=Math.min(l.x0,l.x1),a.y=Math.min(l.y0,l.y0),o.x=Math.max(l.x0,l.x1),o.y=Math.max(l.y0,l.y1);let c={...s,activeHandle:null,isBrushing:!1,brushingType:void 0};return t&&t(c),n&&(c={...c,...this.getIdleState()}),c})};handleWindowPointerMove=e=>{const{useWindowMoveEvents:t}=this.props,{brushingType:n,isBrushing:r,brushPageOffset:s,start:a}=this.state;if(!t||!r)return;const o=e.pageX-(s?.pageX||0),l=e.pageY-(s?.pageY||0);["left","right","top","bottom"].includes(n??"")&&this.updateBrush(c=>{const{x:u,y:d}=c.start,{x:p,y:m}=c.end;return{...c,isBrushing:!0,extent:{...c.extent,...this.getExtent({x:n==="left"?Math.min(Math.max(u+o,c.bounds.x0),c.bounds.x1):u,y:n==="top"?Math.min(Math.max(d+l,c.bounds.y0),c.bounds.y1):d},{x:n==="right"?Math.min(Math.max(p+o,c.bounds.x0),c.bounds.x1):p,y:n==="bottom"?Math.min(Math.max(m+l,c.bounds.y0),c.bounds.y1):m})}}}),n==="move"&&this.updateBrush(c=>{const{x:u,y:d}=c.start,{x:p,y:m}=c.end,g=o>0?Math.min(o,c.bounds.x1-p):Math.max(o,c.bounds.x0-u),y=l>0?Math.min(l,c.bounds.y1-m):Math.max(l,c.bounds.y0-d);return{...c,isBrushing:!0,extent:{...c.extent,x0:u+g,y0:d+y,x1:p+g,y1:m+y}}}),n==="select"&&this.updateBrush(c=>{const{x:u,y:d}=c.start,p={x:Math.min(Math.max(u+o,c.bounds.x0),c.bounds.x1),y:Math.min(Math.max(d+l,c.bounds.y0),c.bounds.y1)},m=this.getExtent(a,p);return{...c,end:p,extent:m}})};debouncedHandleWindowPointerMove=yye(this.handleWindowPointerMove,1);getExtent=(e,t)=>{const{brushDirection:n,width:r,height:s}=this.props,a=n==="vertical"?0:Math.min(e.x||0,t.x||0),o=n==="vertical"?r:Math.max(e.x||0,t.x||0),l=n==="horizontal"?0:Math.min(e.y||0,t.y||0),c=n==="horizontal"?s:Math.max(e.y||0,t.y||0);return{x0:a,x1:o,y0:l,y1:c}};handleDragStart=e=>{const{onBrushStart:t,left:n,top:r,inheritedMargin:s,useWindowMoveEvents:a}=this.props,o=s?.left?s.left:0,l=s?.top?s.top:0,c={x:(e.x||0)+e.dx-n-o,y:(e.y||0)+e.dy-r-l},u={...c};t&&t(c),this.updateBrush(d=>({...d,start:c,end:u,extent:{x0:-1,x1:-1,y0:-1,y1:-1},isBrushing:!0,brushingType:"select",brushPageOffset:a?aC(e.event):void 0}))};handleBrushStart=e=>{const{onBrushStart:t,left:n,top:r,inheritedMargin:s}=this.props;if(t){const a=s?.left?s.left:0,o=s?.top?s.top:0,l={x:(e.x||0)+e.dx-n-a,y:(e.y||0)+e.dy-r-o};t(l)}};handleDragMove=e=>{const{left:t,top:n,inheritedMargin:r,useWindowMoveEvents:s}=this.props;if(!e.isDragging||s)return;const a=r?.left||0,o=r?.top||0,l={x:(e.x||0)+e.dx-t-a,y:(e.y||0)+e.dy-n-o};this.updateBrush(c=>{const{start:u}=c,d=this.getExtent(u,l);return{...c,end:l,extent:d}})};handleDragEnd=()=>{const{onBrushEnd:e,resetOnEnd:t,useWindowMoveEvents:n}=this.props;n||this.updateBrush(r=>{const{extent:s}=r;let a={...r,start:{x:s.x0,y:s.y0},end:{x:s.x1,y:s.y1},isBrushing:!1,brushingType:void 0,activeHandle:null};return e&&e(a),t&&(a={...a,...this.getIdleState()}),a})};getBrushWidth=()=>{const{extent:e}=this.state,{x0:t,x1:n}=e;return Math.max(Math.max(t,n)-Math.min(t,n),0)};getBrushHeight=()=>{const{extent:e}=this.state,{y1:t,y0:n}=e;return Math.max(Math.max(n,t)-Math.min(n,t),0)};handles=()=>{const{handleSize:e}=this.props,{extent:t}=this.state,{x0:n,x1:r,y0:s,y1:a}=t,o=e/2,l=this.getBrushWidth(),c=this.getBrushHeight();return{top:{x:n-o,y:s-o,height:e,width:l+e},bottom:{x:n-o,y:a-o,height:e,width:l+e},right:{x:r-o,y:s-o,height:c+e,width:e},left:{x:n-o,y:s-o,height:c+e,width:e}}};corners=()=>{const{handleSize:e}=this.props,{extent:t}=this.state,{x0:n,x1:r,y0:s,y1:a}=t,o=e/2,l=e,c=e;return{topLeft:{x:Math.min(n,r)-o,y:Math.min(s,a)-o,width:l,height:c},topRight:{x:Math.max(n,r)-o,y:Math.min(s,a)-o,width:l,height:c},bottomLeft:{x:Math.min(n,r)-o,y:Math.max(s,a)-o,width:l,height:c},bottomRight:{x:Math.max(n,r)-o,y:Math.max(s,a)-o,width:l,height:c}}};updateBrush=e=>{const{onChange:t}=this.props;this.setState(e,()=>{t&&t(this.state)})};reset=()=>this.updateBrush(()=>this.getIdleState());handleBrushingTypeChange=(e,t)=>{this.updateBrush(n=>{const r={...n,brushingType:e,isBrushing:e!==void 0};return(t||e===void 0)&&(r.brushPageOffset=t),r})};render(){const{start:e,end:t}=this.state,{top:n,left:r,width:s,height:a,onMouseLeave:o,onMouseUp:l,onMouseMove:c,onBrushEnd:u,onClick:d,resizeTriggerAreas:p,selectedBoxStyle:m,disableDraggingSelection:g,disableDraggingOverlay:y,clickSensitivity:x,useWindowMoveEvents:_,renderBrushHandle:S}=this.props,{brushingType:w}=this.state,T=this.handles(),C=this.corners(),E=this.getBrushWidth(),D=this.getBrushHeight(),O=new Set(p);return v.jsxs(xd,{className:"visx-brush",top:n,left:r,children:[y?v.jsx(aN,{width:s,height:a,onClick:R=>{const P=this.mouseUpTime-this.mouseDownTime;d&&P<x&&d(R)},style:{cursor:"default"}}):v.jsx(Z2,{width:s,height:a,resetOnStart:!0,onDragStart:this.handleDragStart,onDragMove:this.handleDragMove,onDragEnd:this.handleDragEnd,isDragging:_?w==="select":void 0,children:R=>{let{dragStart:P,isDragging:L,dragMove:V,dragEnd:j}=R;return v.jsx(aN,{width:s,height:a,onDoubleClick:()=>this.reset(),onClick:B=>{const J=this.mouseUpTime-this.mouseDownTime;d&&J<x&&d(B)},onPointerDown:B=>{this.mouseDownTime=Date.now(),P(B)},onPointerLeave:B=>{o&&o(B)},onPointerMove:B=>{!L&&c&&c(B),L&&V(B)},onPointerUp:B=>{this.mouseUpTime=Date.now(),l&&l(B),j(B)},style:{cursor:"crosshair"}})}}),e&&t&&v.jsx(Sye,{updateBrush:this.updateBrush,width:E,height:D,stageWidth:s,stageHeight:a,brush:this.state,disableDraggingSelection:g,onBrushEnd:u,onBrushStart:this.handleBrushStart,onMouseLeave:o,onMouseMove:c,onMouseUp:l,onMoveSelectionChange:this.handleBrushingTypeChange,onClick:d,selectedBoxStyle:m,isControlled:_,isDragInProgress:_?w==="move":void 0}),e&&t&&Object.keys(T).filter(R=>O.has(R)).map(R=>{const P=T[R];return P&&v.jsx(vye,{type:R,handle:P,stageWidth:s,stageHeight:a,updateBrush:this.updateBrush,brush:this.state,onBrushStart:this.handleBrushStart,onBrushEnd:u,isControlled:_,isDragInProgress:_?w===R:void 0,onBrushHandleChange:this.handleBrushingTypeChange,renderBrushHandle:S},`handle-${R}`)}),e&&t&&Object.keys(C).filter(R=>O.has(R)).map(R=>{const P=C[R];return P&&v.jsx(bye,{type:R,brush:this.state,updateBrush:this.updateBrush,stageWidth:s,stageHeight:a,corner:P,onBrushEnd:u},`corner-${R}`)})]})}}const oN=2,lN="steelblue";class Mye extends z.Component{static defaultProps={xScale:null,yScale:null,onChange:null,height:0,width:0,selectedBoxStyle:{fill:lN,fillOpacity:.2,stroke:lN,strokeWidth:1,strokeOpacity:.8},margin:{top:0,left:0,right:0,bottom:0},handleSize:4,brushDirection:"horizontal",initialBrushPosition:null,resizeTriggerAreas:["left","right"],brushRegion:"chart",yAxisOrientation:"right",xAxisOrientation:"bottom",onBrushStart:null,onBrushEnd:null,disableDraggingSelection:!1,resetOnEnd:!1,onMouseMove:null,onMouseLeave:null,onClick:null,useWindowMoveEvents:!1,renderBrushHandles:null};handleChange=e=>{const{onChange:t}=this.props;if(!t)return;const{x0:n}=e.extent;if(typeof n>"u"||n<0){t(null);return}const r=this.convertRangeToDomain(e);t(r)};convertRangeToDomain(e){const{xScale:t,yScale:n}=this.props,{x0:r,x1:s,y0:a,y1:o}=e.extent,l=sN(t,r||0,s||0,oN),c=sN(n,a||0,o||0,oN);return{x0:l.start||0,x1:l.end||0,xValues:l.values,y0:c.start||0,y1:c.end||0,yValues:c.values}}handleBrushStart=e=>{const{onBrushStart:t}=this.props;if(!t)return;const{x:n,y:r}=e,{xScale:s,yScale:a}=this.props,o=xb(s,n),l=xb(a,r);t({x:"invert"in s&&typeof s.invert<"u"?o:s.domain()[o],y:"invert"in a&&typeof a.invert<"u"?l:a.domain()[l]})};handleBrushEnd=e=>{const{onBrushEnd:t}=this.props;if(!t)return;const{x0:n}=e.extent;if(typeof n>"u"||n<0){t(null);return}const r=this.convertRangeToDomain(e);t(r)};render(){const{xScale:e,yScale:t,height:n,width:r,margin:s,brushDirection:a,initialBrushPosition:o,innerRef:l,resizeTriggerAreas:c,brushRegion:u,yAxisOrientation:d,xAxisOrientation:p,selectedBoxStyle:m,disableDraggingSelection:g,disableDraggingOverlay:y,resetOnEnd:x,onMouseLeave:_,onMouseMove:S,onClick:w,handleSize:T,useWindowMoveEvents:C,renderBrushHandle:E}=this.props;if(!e||!t)return null;let D,O,R,P;const L=s?.left?s.left:0,V=s?.top?s.top:0,j=s?.right?s.right:0,B=s?.bottom?s.bottom:0;return u==="chart"?(R=0,P=0,D=r,O=n):u==="yAxis"?(P=0,O=n,d==="right"?(R=r,D=j):(R=-L,D=L)):(R=0,D=r,p==="bottom"?(P=n,O=B):(P=-V,O=V)),v.jsx(wye,{width:D,height:O,left:R,top:P,brushDirection:a,disableDraggingSelection:g,disableDraggingOverlay:y,handleSize:T,inheritedMargin:s,initialBrushPosition:o,ref:l,resetOnEnd:x,resizeTriggerAreas:c,selectedBoxStyle:m,onBrushEnd:this.handleBrushEnd,onBrushStart:this.handleBrushStart,onChange:this.handleChange,onClick:w,onMouseLeave:_,onMouseMove:S,useWindowMoveEvents:C,renderBrushHandle:E})}}function Tye(i){const[e,t]=z.useState({tooltipOpen:!1,...i}),n=z.useCallback(s=>t(typeof s=="function"?a=>{let{tooltipOpen:o,...l}=a;return{...s(l),tooltipOpen:!0}}:{tooltipOpen:!0,tooltipLeft:s.tooltipLeft,tooltipTop:s.tooltipTop,tooltipData:s.tooltipData}),[t]),r=z.useCallback(()=>t({tooltipOpen:!1,tooltipLeft:void 0,tooltipTop:void 0,tooltipData:void 0}),[t]);return{tooltipOpen:e.tooltipOpen,tooltipLeft:e.tooltipLeft,tooltipTop:e.tooltipTop,tooltipData:e.tooltipData,updateTooltip:t,showTooltip:n,hideTooltip:r}}class Aye extends z.PureComponent{componentWillUnmount(){this.node&&document.body&&(document.body.removeChild(this.node),delete this.node)}render(){return!this.node&&typeof document<"u"&&(this.node=document.createElement("div"),this.props.zIndex!=null&&(this.node.style.zIndex=`${this.props.zIndex}`),document.body.append(this.node)),this.node?gY.createPortal(this.props.children,this.node):null}}const oC={position:"absolute",backgroundColor:"white",color:"#666666",padding:"0.3rem 0.5rem",borderRadius:"3px",fontSize:"14px",boxShadow:"0 1px 2px rgba(33,33,33,0.2)",lineHeight:"1em",pointerEvents:"none"},lC=z.forwardRef((i,e)=>{let{className:t,top:n,left:r,offsetLeft:s=10,offsetTop:a=10,style:o=oC,children:l,unstyled:c=!1,applyPositionStyle:u=!1,...d}=i;return v.jsx("div",{ref:e,className:ca("visx-tooltip",t),style:{top:n==null||a==null?n:n+a,left:r==null||s==null?r:r+s,...u&&{position:"absolute"},...!c&&o},...d,children:l})});lC.displayName="Tooltip";const cN={top:0,right:0,bottom:0,left:0,width:0,height:0};function Cye(i){return class extends z.PureComponent{static displayName=`withBoundingRects(${i.displayName||""})`;constructor(t){super(t),this.state={rect:void 0,parentRect:void 0},this.nodeRef=z.createRef(),this.getRects=this.getRects.bind(this)}componentDidMount(){this.node=this.nodeRef?.current||null,this.setState(()=>this.getRects())}getRects(){if(!this.node)return this.state;const{node:t}=this,n=t.parentNode,r=t.getBoundingClientRect?t.getBoundingClientRect():cN,s=n?.getBoundingClientRect?n.getBoundingClientRect():cN;return{rect:r,parentRect:s}}render(){return v.jsx(i,{nodeRef:this.nodeRef,getRects:this.getRects,...this.state,...this.props})}}}const XV=z.createContext({isFlippedVertically:!1,isFlippedHorizontally:!1}),Eye=XV.Provider;XV.Consumer;function Rye(i){let{children:e,getRects:t,left:n=0,offsetLeft:r=10,offsetTop:s=10,parentRect:a,rect:o,style:l=oC,top:c=0,unstyled:u=!1,nodeRef:d,...p}=i,m,g=!1,y=!1;if(o&&a){let x=n,_=c;if(a.width){const S=x+r+o.width-a.width,w=o.width-x-r;g=S>0&&S>w}else{const S=x+r+o.width-window.innerWidth,w=o.width-x-r;g=S>0&&S>w}if(a.height){const S=_+s+o.height-a.height,w=o.height-_-s;y=S>0&&S>w}else y=_+s+o.height>window.innerHeight;x=g?x-o.width-r:x+r,_=y?_-o.height-s:_+s,x=Math.round(x),_=Math.round(_),m=`translate(${x}px, ${_}px)`}return v.jsx(lC,{ref:d,style:{left:0,top:0,transform:m,...!u&&l},...p,children:v.jsx(Eye,{value:{isFlippedVertically:!y,isFlippedHorizontally:!g},children:e})})}const Pye=Cye(Rye);function Iye(){let{detectBounds:i=!0,zIndex:e,...t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const[n,r,s]=ZH(t),[a,o]=z.useState(!1);z.useEffect(()=>{o(!1)},[]);const l=z.useMemo(()=>function(c){let{left:u=0,top:d=0,detectBounds:p,zIndex:m,...g}=c;const y=p??i,x=m??e,_=y?Pye:lC,S=a?0:window.scrollX,w=a?0:window.scrollY,T=u+(r.left||0)+S,C=d+(r.top||0)+w;return v.jsx(Aye,{zIndex:x,children:v.jsx(_,{left:T,top:C,...g})})},[i,e,r.left,r.top,a]);return{containerRef:n,containerBounds:r,forceRefreshBounds:s,TooltipInPortal:l}}function YV(){const{waveUnit:i,zRedshift:e}=un(Tt(l=>({waveUnit:l.waveUnit,zRedshift:l.zRedshift}))),{waveFrame:t}=Ai(Tt(l=>({waveFrame:l.waveFrame}))),n=a6(i,t,e),r=l=>fo(l,i,t,e),s=l=>CV(l,i,t,e),a=l=>{const c=fo(l,i,t,e),u=i==="m"?4:0;return c.toFixed(u)},o=`_${t==="observe"?"obs":"rest"} (${i})`;return{waveUnit:i,waveFrame:t,factor:n,converter:r,formatter:a,formatterWithUnit:s,label:o}}const Dye=z.memo(function({x:e,height:t,isBrushActive:n=!0}){const a=La("var(--chakra-colors-gray-50)","var(--chakra-colors-whiteAlpha-100)"),o=La("var(--chakra-colors-gray-400)","var(--chakra-colors-cyan-400)");return n?v.jsx(xd,{left:e+8/2,top:(t-15)/2,children:v.jsx("path",{fill:a,d:"M -4.5 0.5 L 3.5 0.5 L 3.5 15.5 L -4.5 15.5 L -4.5 0.5 M -1.5 4 L -1.5 12 M 0.5 4 L 0.5 12",stroke:o,strokeWidth:1,style:{cursor:"ew-resize"}})}):null}),Nye=z.memo(function(e){const{xScale:t,chartHeight:n}=e,{selectedEmissionLines:r,zRedshift:s}=un(Tt(c=>({selectedEmissionLines:c.selectedEmissionLines,zRedshift:c.zRedshift}))),a=La("var(--chakra-colors-red-600)","var(--chakra-colors-pink-300)"),[o,l]=t.domain();return v.jsx("g",{pointerEvents:"none",children:Object.entries(r).map(([c,u])=>{const d=u*(1+s);if(d<o||d>l)return null;const p=t(d);return v.jsxs("g",{children:[v.jsx("line",{x1:p,x2:p,y1:0,y2:n,stroke:a,strokeWidth:1}),v.jsx("text",{x:p,y:n+20,textAnchor:"middle",fontSize:12,fill:a,children:c})]},c)})})});function Lye(i){const{waveMin:e,waveMax:t,fluxMin:n,fluxMax:r,chartWidth:s,chartBrushHeight:a}=i,o=z.useMemo(()=>_0().domain([e,t]).range([0,s]),[e,t,s]),l=z.useMemo(()=>_0().domain([n,r]).range([a,0]),[n,r,a]);return{xScaleBrush:o,yScaleBrush:l}}function kye(i){const{waveArray:e,waveStartIndex:t,waveEndIndex:n,xScaleBrush:r,onSliceRangeChange:s}=i,a=z.useRef(null),o=z.useRef(!1),l=z.useCallback(c=>{if(!c)return;o.current=!0;const{x0:u,x1:d}=c,[p,m]=u<d?[u,d]:[d,u];p!==m&&s({min:p,max:m})},[s]);return z.useEffect(()=>{const c=a.current;if(!c)return;if(o.current){o.current=!1;return}const u=d=>{const p=c.getExtent({x:r(t>=0?e[t]:e[0])},{x:r(n>=0?e[n]:e[e.length-1])});return{...d,start:{y:p.y0,x:p.x0},end:{y:p.y1,x:p.x1},extent:p}};c.updateBrush(u)},[t,n,e,r]),{brushRef:a,handleBrushChange:l}}const $w=Math.sqrt(2*Math.log(2)),Oye={top:.15,bottom:.8,gap:.05},zye={top:20,bottom:50,left:100,right:30};function Uye(i){const{width:e,height:t,hRatio:n,margin:r}=i;return z.useMemo(()=>{const s=n??Oye,a=s.top+s.bottom+s.gap,o=a!==1?{top:s.top/a,bottom:s.bottom/a,gap:s.gap/a}:s,l=r??zye,c=t-l.top-l.bottom,u=e-l.left-l.right,d=c*o.top,p=c*o.bottom,m=c*o.gap,g={left:l.left,top:l.top},y={left:l.left,top:l.top+d+m};return{chartWidth:u,chartHeightTop:d,chartHeightBottom:p,chartBrushHeight:d,chartHeightSlice:p,chartAnchorTop:g,chartAnchorBottom:y}},[e,t,n,r])}function Q2(i,e,t){const n=i.length;if(n===0)return{startIdx:0,endIdx:-1};const{waveLow:r,waveHigh:s}=e<=t?{waveLow:e,waveHigh:t}:{waveLow:t,waveHigh:e},a=Zn(r,i[0],i[n-1]),o=Zn(s,i[0],i[n-1]),l=i.findIndex(u=>u>=a);let c=i.findIndex(u=>u>o)-1;return c<0&&(c=n-1),{startIdx:l,endIdx:c}}function uN(i,e,t){return i.slice(e.startIdx,e.endIdx+1).map(r=>r.slice(t.startIdx,t.endIdx+1))}function Fye(i,e,t="row"){const n=i.length,r=i[0]?.length||0;if(n===0||r===0)throw new Error("Input 2D arrays must not be empty");if(t==="row"){const s=new Array(r),a=new Array(r);for(let o=0;o<r;o++){let l=0,c=0;for(let u=0;u<n;u++){const d=i[u][o],p=e[u][o];l+=d,c+=p*p}s[o]=l,a[o]=Math.sqrt(c)}return{flux1D:s,error1D:a}}else{const s=new Array(n),a=new Array(n);for(let o=0;o<n;o++){let l=0,c=0;for(let u=0;u<r;u++){const d=i[o][u],p=e[o][u];l+=d,c+=p*p}s[o]=l,a[o]=Math.sqrt(c)}return{flux1D:s,error1D:a}}}function Bye(i,e,t="row"){if(!i.covered)return;const{startIdx:n,endIdx:r}=Q2(i.wavelength,e.waveMin,e.waveMax),s=Math.floor(e.spatialMin),a=Math.ceil(e.spatialMax),o=uN(i.spectrum_2d,{startIdx:s,endIdx:a},{startIdx:n,endIdx:r}),l=uN(i.error_2d,{startIdx:s,endIdx:a},{startIdx:n,endIdx:r}),c=i.wavelength.slice(n,r+1),{flux1D:u,error1D:d}=Fye(o,l,t);return{wavelength:c,flux1D:u,error1D:d}}function Hye(i,e,t){const n=Math.min(i.length,e.length,t.length),r=new Array(n);for(let s=0;s<n;s++)r[s]={wavelength:i[s],flux:e[s],error:t[s],fluxPlusErr:e[s]+t[s],fluxMinusErr:e[s]-t[s]};return r}function jye(i,e,t="row"){const n=Bye(i,e,t);if(n)return Hye(n.wavelength,n.flux1D,n.error1D)}function Vye(i,e){return z.useMemo(()=>Q2(i,e.min,e.max),[i,e])}function c6(i){const e=i.flat();return e.sort((t,n)=>t-n),e}function yb(i,e,t=!0){const n=Array.isArray(e)?e:[e],r=t?i.filter(o=>o!==0):i,s=r.length;if(s===0){const o=n.map(()=>0);return Array.isArray(e)?o:0}const a=n.map(o=>{const l=o/100*(s-1),c=Math.floor(l),u=Math.ceil(l);if(c===u)return r[c];const d=l-c;return r[c]*(1-d)+r[u]*d});return Array.isArray(e)?a:a[0]}function Gye(i,e=[],t=!0,n){const r=e??c6(i),{pmin:s,pmax:a,vmin:o,vmax:l}=n;if(s===void 0&&o===void 0||a===void 0&&l===void 0)throw new Error("Either pmin/vmin or pmax/vmax must be provided for normalization.");const c=o??yb(r,s??0,t),u=l??yb(r,a??100,t);if(u<=c)return i.map(m=>m.map(()=>0));const d=1/(u-c);return i.map(m=>m.map(g=>{const y=(g-c)*d;return Zn(y,0,1)}))}function Wye(i){const e=i.flat(),t=new Uint8ClampedArray(e.length);for(let n=0;n<e.length;n++)t[n]=Math.round(Zn(e[n]*255,0,255));return t}function qye(i,e,t){const n=document.createElement("canvas");n.width=e,n.height=t;const r=n.getContext("2d");if(!r)throw new Error("Failed to get 2D context from canvas");const s=r.createImageData(e,t);for(let a=0;a<i.length;a++){const o=i[a],l=a*4;s.data[l+0]=o,s.data[l+1]=o,s.data[l+2]=o,s.data[l+3]=255}return r.putImageData(s,0,0),cn.from(n)}function Xye({data:i,pmin:e,pmax:t,vmin:n,vmax:r,width:s=null,height:a=null,sortedArray:o=[],excludeZero:l=!0}){s||(s=i[0].length),a||(a=i.length);const c=Gye(i,o,l,{pmin:e,pmax:t,vmin:n,vmax:r}),u=Wye(c);return qye(u,s,a)}function hN(i,e,t=201){const n=Math.max(e.min,i.range.min),r=Math.min(e.max,i.range.max);if(n>=r)return[];if(i.kind==="linear"){const s=i.k,a=i.b,o=i.x0,l=s*(n-o)+a,c=s*(r-o)+a;return[{wavelength:n,flux:l},{wavelength:(r+n)/2,flux:(l+c)/2},{wavelength:r,flux:c}]}else if(i.kind==="gaussian"){const s=i.amplitude,a=i.mu,o=i.sigma,l=new Array(t);for(let c=0;c<t;c++){const u=c/(t-1),d=n+u*(r-n),p=-.5*((d-a)/o)**2,m=s*Math.exp(p);l[c]={wavelength:d,flux:m}}return l}else throw new Error("Unknown model kind")}function Yye(i,e){if(i.kind==="linear"){const t=i.k,n=i.b,r=i.x0,s=t*(e-r)+n;return{wavelength:e,flux:s}}else if(i.kind==="gaussian"){const t=i.amplitude,n=i.mu,r=i.sigma,s=-.5*((e-n)/r)**2,a=t*Math.exp(s);return{wavelength:e,flux:a}}else throw new Error("Unknown model kind")}function $ye(i){const e=i.length,t=new Array(e);let n=1/0,r=-1/0,s=1/0,a=-1/0;for(let o=0;o<e;o++){const l=i[o];t[o]=l.wavelength,l.wavelength<n&&(n=l.wavelength),l.wavelength>r&&(r=l.wavelength),l.fluxMinusErr<s&&(s=l.fluxMinusErr),l.fluxPlusErr>a&&(a=l.fluxPlusErr)}return Number.isFinite(n)||(n=0,r=1,s=0,a=1),{waveArray:t,waveMin:n,waveMax:r,fluxMin:s,fluxMax:a}}function Kye(i){const{spectrum1D:e,startIndex:t,endIndex:n,modelsSubtracted:r}=i;return e.slice(t,n+1).map(o=>{let l=0;for(const c of r){const u=Yye(c,o.wavelength).flux;l+=u}return{...o,flux:o.flux-l,fluxMinusErr:o.fluxMinusErr-l,fluxPlusErr:o.fluxPlusErr-l}})}function Zye(i){const e=Math.min(...i.map(n=>n.fluxMinusErr)),t=Math.max(...i.map(n=>n.fluxPlusErr));return{fluxMin:e,fluxMax:t}}function Qye(i){const{sliceSpectrum:e,sliceRange:t,chartWidth:n,chartHeightSlice:r}=i;return z.useMemo(()=>{const{fluxMin:s,fluxMax:a}=Zye(e),o=(a-s)*.05,l=_0().domain([t.min,t.max]).range([0,n]),c=_0().domain([s-o,a+o]).range([r,0]);return{xScaleSlice:l,yScaleSlice:c}},[e,t,n,r])}function Jye(i){const{spectrum1D:e,waveStartIndex:t,waveEndIndex:n,modelsSubtracted:r}=i;return z.useMemo(()=>Kye({spectrum1D:e,startIndex:t,endIndex:n,modelsSubtracted:r}),[e,t,n,r])}function eve(i){return z.useMemo(()=>$ye(i),[i])}function tve(i){const{anchor:e,tooltipOffset:t=5}=i,{tooltipOpen:n,tooltipData:r,tooltipLeft:s,tooltipTop:a,showTooltip:o,hideTooltip:l}=Tye(),{containerRef:c,TooltipInPortal:u}=Iye({detectBounds:!0,scroll:!0}),d=z.useCallback(p=>{if(!p){l();return}o({tooltipData:p,tooltipLeft:p.pointerX+e.left+t,tooltipTop:p.pointerY+e.top+t})},[e.left,e.top,l,o,t]);return{tooltipOpen:n,tooltipData:r,tooltipLeft:s,tooltipTop:a,TooltipInPortal:u,containerRef:c,handleHover:d}}const nve=z.memo(function(e){const{spectrum1D:t,xScale:n,yScale:r,anchor:s,children:a}=e,o=La("var(--chakra-colors-gray-700)","var(--chakra-colors-cyan-400)");return v.jsxs(xd,{left:s.left,top:s.top,children:[v.jsx(vg,{data:t,x:l=>n(l.wavelength)??0,y:l=>r(l.flux)??0,stroke:o,strokeWidth:2,curve:yg}),a]})}),ive=z.memo(function(e){const{xScale:t,yScale:n,chartHeight:r,sliceRange:s}=e,a=La("var(--chakra-colors-gray-900)","var(--chakra-colors-cyan-200)"),{updateModel:o,models:l,validateModel:c}=Ai(Tt(m=>({updateModel:m.updateModel,models:m.models,validateModel:m.validateModel}))),u=l.filter(m=>m.active&&m.subtracted===!1),[d,p]=z.useState(null);return u.length===0?null:v.jsx("g",{children:u.map(m=>m.kind==="gaussian"?v.jsx(rve,{model:m,xScale:t,yScale:n,sliceRange:s,chartHeight:r,drag:d,setDrag:p,updateModel:o,validateModel:c,handleStroke:a},`handle-gaussian-${m.id}`):v.jsx(sve,{model:m,xScale:t,yScale:n,sliceRange:s,drag:d,setDrag:p,updateModel:o,validateModel:c,handleStroke:a},`handle-linear-${m.id}`))})});function rve(i){const{model:e,xScale:t,yScale:n,sliceRange:r,chartHeight:s,drag:a,setDrag:o,updateModel:l,validateModel:c,cricleSize:u=7,handleStroke:d}=i,p=e.mu,m=e.amplitude,g=t(p),y=n(m),x=p>=r.min&&p<=r.max&&y!==void 0&&y>=0&&y<=s,_=m/2,S=e.sigma*$w,w=e.mu-S,T=e.mu+S,C=t(w),E=t(T),D=n(_),O=n(_),R=w>=r.min&&w<=r.max&&D!==void 0&&D>=0&&D<=s,P=T>=r.min&&T<=r.max&&O!==void 0&&O>=0&&O<=s;return v.jsxs("g",{pointerEvents:"visiblePainted",children:[x&&v.jsx("circle",{cx:g,cy:y,r:u,fill:e.color,stroke:d,strokeWidth:1,style:{cursor:"move"},onPointerDown:L=>{L.stopPropagation(),L.currentTarget.setPointerCapture(L.pointerId),o({type:"gauss-peak",id:e.id,lastX:L.clientX,lastY:L.clientY})},onPointerMove:L=>{if(!a||a.type!=="gauss-peak"||a.id!==e.id)return;const V=L.clientX-a.lastX,j=L.clientY-a.lastY;if(V===0&&j===0)return;const B=g+V,J=y+j,U=t.invert(B),X=n.invert(J);l(e.id,{mu:U,amplitude:X}),o({...a,lastX:L.clientX,lastY:L.clientY})},onPointerUp:L=>{!a||a.type!=="gauss-peak"||a.id!==e.id||(L.currentTarget.releasePointerCapture(L.pointerId),o(null),c?.())}}),R&&v.jsx("circle",{cx:C,cy:D,r:u,fill:e.color,stroke:d,strokeWidth:1,style:{cursor:"ew-resize"},onPointerDown:L=>{L.stopPropagation(),L.currentTarget.setPointerCapture(L.pointerId),o({type:"gauss-sigma-left",id:e.id,lastX:L.clientX})},onPointerMove:L=>{if(!a||a.type!=="gauss-sigma-left"||a.id!==e.id)return;const V=L.clientX-a.lastX;if(V===0)return;const B=(S-(t.invert(V)-t.invert(0)))/$w;l(e.id,{sigma:B}),o({...a,lastX:L.clientX})},onPointerUp:L=>{!a||a.type!=="gauss-sigma-left"||a.id!==e.id||(L.currentTarget.releasePointerCapture(L.pointerId),o(null),c?.())}}),P&&v.jsx("circle",{cx:E,cy:O,r:u,fill:e.color,stroke:d,strokeWidth:1,style:{cursor:"ew-resize"},onPointerDown:L=>{L.stopPropagation(),L.currentTarget.setPointerCapture(L.pointerId),o({type:"gauss-sigma-right",id:e.id,lastX:L.clientX})},onPointerMove:L=>{if(!a||a.type!=="gauss-sigma-right"||a.id!==e.id)return;const V=L.clientX-a.lastX;if(V===0)return;const B=(S+t.invert(V)-t.invert(0))/$w;l(e.id,{sigma:B}),o({...a,lastX:L.clientX})},onPointerUp:L=>{!a||a.type!=="gauss-sigma-right"||a.id!==e.id||(L.currentTarget.releasePointerCapture(L.pointerId),o(null),c?.())}})]})}function sve(i){const{model:e,xScale:t,yScale:n,drag:r,setDrag:s,updateModel:a,validateModel:o,cricleSize:l=7,handleStroke:c}=i,u=t(e.x0),d=n(e.b),p=u!==void 0&&d!==void 0,m=t(e.range.min),g=n(e.k*(e.range.min-e.x0)+e.b),y=m!==void 0&&g!==void 0,x=t(e.range.max),_=n(e.k*(e.range.max-e.x0)+e.b),S=x!==void 0&&_!==void 0;return v.jsxs("g",{pointerEvents:"visiblePainted",children:[p&&v.jsx("circle",{cx:u,cy:d,r:l,fill:e.color,stroke:c,strokeWidth:1,style:{cursor:"move"},onPointerDown:w=>{w.stopPropagation(),w.currentTarget.setPointerCapture(w.pointerId),s({type:"linear-x0",id:e.id,lastX:w.clientX,lastY:w.clientY})},onPointerMove:w=>{if(!r||r.type!=="linear-x0"||r.id!==e.id)return;const T=w.clientX-r.lastX,C=w.clientY-r.lastY;if(T===0&&C===0)return;const E=e.x0+t.invert(T)-t.invert(0),D=e.b+n.invert(C)-n.invert(0);a(e.id,{x0:E,b:D}),s({...r,lastX:w.clientX,lastY:w.clientY})},onPointerUp:w=>{!r||r.type!=="linear-x0"||r.id!==e.id||(w.currentTarget.releasePointerCapture(w.pointerId),s(null),o?.())}}),y&&v.jsx("circle",{cx:m,cy:g,r:l,fill:e.color,stroke:c,strokeWidth:1,style:{cursor:"ns-resize"},onPointerDown:w=>{w.stopPropagation(),w.currentTarget.setPointerCapture(w.pointerId),s({type:"linear-left",id:e.id,lastY:w.clientY})},onPointerMove:w=>{if(!r||r.type!=="linear-left"||r.id!==e.id)return;const T=w.clientY-r.lastY;if(T===0)return;const C=e.k+(n.invert(T)-n.invert(0))/(e.range.min-e.x0);a(e.id,{k:C}),s({...r,lastY:w.clientY})},onPointerUp:w=>{!r||r.type!=="linear-left"||r.id!==e.id||(w.currentTarget.releasePointerCapture(w.pointerId),s(null),o?.())}}),S&&v.jsx("circle",{cx:x,cy:_,r:l,fill:e.color,stroke:c,strokeWidth:1,style:{cursor:"ns-resize"},onPointerDown:w=>{w.stopPropagation(),w.currentTarget.setPointerCapture(w.pointerId),s({type:"linear-right",id:e.id,lastY:w.clientY})},onPointerMove:w=>{if(!r||r.type!=="linear-right"||r.id!==e.id)return;const T=w.clientY-r.lastY;if(T===0)return;const C=e.k+(n.invert(T)-n.invert(0))/(e.range.max-e.x0);a(e.id,{k:C}),s({...r,lastY:w.clientY})},onPointerUp:w=>{!r||r.type!=="linear-right"||r.id!==e.id||(w.currentTarget.releasePointerCapture(w.pointerId),s(null),o?.())}})]})}const ave=z.memo(function(e){const{xScale:t,yScale:n,samplePoints:r=201}=e,s=Ai(d=>d.models),a=s.filter(d=>d.kind==="gaussian"&&d.active&&d.subtracted===!1),o=s.filter(d=>d.kind==="linear"&&d.active&&d.subtracted===!1),l=un(d=>d.slice1DWaveRange),c=z.useMemo(()=>a.map(d=>hN(d,l,r).filter(g=>g.wavelength>=l.min&&g.wavelength<=l.max&&n(g.flux)!==void 0&&n(g.flux)>=0&&n(g.flux)<=n.range()[0])),[a,l,r,n]),u=z.useMemo(()=>o.map(d=>hN(d,l)),[o,l]);return v.jsxs("g",{pointerEvents:"none",children:[u.map((d,p)=>d.length<2?null:v.jsx(vg,{data:d,x:m=>t(m.wavelength)??0,y:m=>n(m.flux)??0,stroke:o[p].color,strokeWidth:1,curve:ob},`fit-linear-${o[p].id}`)),c.map((d,p)=>d.length<2?null:v.jsx(vg,{data:d,x:m=>t(m.wavelength)??0,y:m=>n(m.flux)??0,stroke:a[p].color,strokeWidth:1,curve:ob},`fit-gaussian-${a[p].id}`))]})});function ove(i){const{spectrum1D:e,width:t,height:n,xScale:r,yScale:s,onHover:a}=i,o=La("var(--chakra-colors-blue-600)","var(--chakra-colors-cyan-300)"),l=La("var(--chakra-colors-white)","var(--chakra-colors-gray-900)"),c=La("var(--chakra-colors-gray-400)","var(--chakra-colors-cyan-600)"),u=z.useMemo(()=>e.map(y=>y.wavelength),[e]),[d,p]=z.useState(null),m=y=>{if(e.length===0){p(null),a(null);return}const x=y.currentTarget.getBoundingClientRect(),_=y.clientX-x.left,S=y.clientY-x.top;if(_<0||_>t||S<0||S>n){p(null),a(null);return}const w=r.invert(_),T=_xe(u,w);if(T===null){p(null),a(null);return}const C=e[T.index],E=r(C.wavelength)??0,D=s(C.flux)??0,O={wavelength:C.wavelength,flux:C.flux,error:C.error,axisX:E,axisY:D,pointerX:_,pointerY:S};p(O),a(O)},g=()=>{p(null),a(null)};return v.jsxs(v.Fragment,{children:[v.jsx("rect",{x:0,y:0,width:t,height:n,fill:"transparent",pointerEvents:"all",onMouseMove:m,onMouseLeave:g}),d&&v.jsxs("g",{pointerEvents:"none",children:[v.jsx("circle",{cx:d.axisX,cy:d.axisY,r:4,fill:o,stroke:l,strokeWidth:2}),v.jsx("line",{x1:d.pointerX,x2:d.pointerX,y1:0,y2:n,stroke:c,strokeWidth:1,strokeDasharray:"4 4"}),v.jsx("line",{x1:0,x2:t,y1:d.pointerY,y2:d.pointerY,stroke:c,strokeWidth:1,strokeDasharray:"4 4"})]})]})}var cC=ox(),Xt=i=>ax(i,cC),uC=ox();Xt.write=i=>ax(i,uC);var J2=ox();Xt.onStart=i=>ax(i,J2);var hC=ox();Xt.onFrame=i=>ax(i,hC);var dC=ox();Xt.onFinish=i=>ax(i,dC);var Yf=[];Xt.setTimeout=(i,e)=>{const t=Xt.now()+e,n=()=>{const s=Yf.findIndex(a=>a.cancel==n);~s&&Yf.splice(s,1),au-=~s?1:0},r={time:t,handler:i,cancel:n};return Yf.splice($V(t),0,r),au+=1,KV(),r};var $V=i=>~(~Yf.findIndex(e=>e.time>i)||~Yf.length);Xt.cancel=i=>{J2.delete(i),hC.delete(i),dC.delete(i),cC.delete(i),uC.delete(i)};Xt.sync=i=>{u6=!0,Xt.batchedUpdates(i),u6=!1};Xt.throttle=i=>{let e;function t(){try{i(...e)}finally{e=null}}function n(...r){e=r,Xt.onStart(t)}return n.handler=i,n.cancel=()=>{J2.delete(t),e=null},n};var fC=typeof window<"u"?window.requestAnimationFrame:(()=>{});Xt.use=i=>fC=i;Xt.now=typeof performance<"u"?()=>performance.now():Date.now;Xt.batchedUpdates=i=>i();Xt.catch=console.error;Xt.frameLoop="always";Xt.advance=()=>{Xt.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):QV()};var su=-1,au=0,u6=!1;function ax(i,e){u6?(e.delete(i),i(0)):(e.add(i),KV())}function KV(){su<0&&(su=0,Xt.frameLoop!=="demand"&&fC(ZV))}function lve(){su=-1}function ZV(){~su&&(fC(ZV),Xt.batchedUpdates(QV))}function QV(){const i=su;su=Xt.now();const e=$V(su);if(e&&(JV(Yf.splice(0,e),t=>t.handler()),au-=e),!au){lve();return}J2.flush(),cC.flush(i?Math.min(64,su-i):16.667),hC.flush(),uC.flush(),dC.flush()}function ox(){let i=new Set,e=i;return{add(t){au+=e==i&&!i.has(t)?1:0,i.add(t)},delete(t){return au-=e==i&&i.has(t)?1:0,i.delete(t)},flush(t){e.size&&(i=new Set,au-=e.size,JV(e,n=>n(t)&&i.add(n)),au+=i.size,e=i)}}}function JV(i,e){i.forEach(t=>{try{e(t)}catch(n){Xt.catch(n)}})}var cve=Object.defineProperty,uve=(i,e)=>{for(var t in e)cve(i,t,{get:e[t],enumerable:!0})},xo={};uve(xo,{assign:()=>dve,colors:()=>fu,createStringInterpolator:()=>mC,skipAnimation:()=>tG,to:()=>eG,willAdvance:()=>gC});function h6(){}var hve=(i,e,t)=>Object.defineProperty(i,e,{value:t,writable:!0,configurable:!0}),Ze={arr:Array.isArray,obj:i=>!!i&&i.constructor.name==="Object",fun:i=>typeof i=="function",str:i=>typeof i=="string",num:i=>typeof i=="number",und:i=>i===void 0};function Bl(i,e){if(Ze.arr(i)){if(!Ze.arr(e)||i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(i[t]!==e[t])return!1;return!0}return i===e}var Qt=(i,e)=>i.forEach(e);function nl(i,e,t){if(Ze.arr(i)){for(let n=0;n<i.length;n++)e.call(t,i[n],`${n}`);return}for(const n in i)i.hasOwnProperty(n)&&e.call(t,i[n],n)}var is=i=>Ze.und(i)?[]:Ze.arr(i)?i:[i];function Am(i,e){if(i.size){const t=Array.from(i);i.clear(),Qt(t,e)}}var im=(i,...e)=>Am(i,t=>t(...e)),pC=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),mC,eG,fu=null,tG=!1,gC=h6,dve=i=>{i.to&&(eG=i.to),i.now&&(Xt.now=i.now),i.colors!==void 0&&(fu=i.colors),i.skipAnimation!=null&&(tG=i.skipAnimation),i.createStringInterpolator&&(mC=i.createStringInterpolator),i.requestAnimationFrame&&Xt.use(i.requestAnimationFrame),i.batchedUpdates&&(Xt.batchedUpdates=i.batchedUpdates),i.willAdvance&&(gC=i.willAdvance),i.frameLoop&&(Xt.frameLoop=i.frameLoop)},Cm=new Set,Ea=[],Kw=[],vb=0,e_={get idle(){return!Cm.size&&!Ea.length},start(i){vb>i.priority?(Cm.add(i),Xt.onStart(fve)):(nG(i),Xt(d6))},advance:d6,sort(i){if(vb)Xt.onFrame(()=>e_.sort(i));else{const e=Ea.indexOf(i);~e&&(Ea.splice(e,1),iG(i))}},clear(){Ea=[],Cm.clear()}};function fve(){Cm.forEach(nG),Cm.clear(),Xt(d6)}function nG(i){Ea.includes(i)||iG(i)}function iG(i){Ea.splice(pve(Ea,e=>e.priority>i.priority),0,i)}function d6(i){const e=Kw;for(let t=0;t<Ea.length;t++){const n=Ea[t];vb=n.priority,n.idle||(gC(n),n.advance(i),n.idle||e.push(n))}return vb=0,Kw=Ea,Kw.length=0,Ea=e,Ea.length>0}function pve(i,e){const t=i.findIndex(e);return t<0?i.length:t}var mve={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},po="[-+]?\\d*\\.?\\d+",bb=po+"%";function t_(...i){return"\\(\\s*("+i.join(")\\s*,\\s*(")+")\\s*\\)"}var gve=new RegExp("rgb"+t_(po,po,po)),xve=new RegExp("rgba"+t_(po,po,po,po)),yve=new RegExp("hsl"+t_(po,bb,bb)),vve=new RegExp("hsla"+t_(po,bb,bb,po)),bve=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,_ve=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Sve=/^#([0-9a-fA-F]{6})$/,wve=/^#([0-9a-fA-F]{8})$/;function Mve(i){let e;return typeof i=="number"?i>>>0===i&&i>=0&&i<=4294967295?i:null:(e=Sve.exec(i))?parseInt(e[1]+"ff",16)>>>0:fu&&fu[i]!==void 0?fu[i]:(e=gve.exec(i))?(Tf(e[1])<<24|Tf(e[2])<<16|Tf(e[3])<<8|255)>>>0:(e=xve.exec(i))?(Tf(e[1])<<24|Tf(e[2])<<16|Tf(e[3])<<8|pN(e[4]))>>>0:(e=bve.exec(i))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=wve.exec(i))?parseInt(e[1],16)>>>0:(e=_ve.exec(i))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=yve.exec(i))?(dN(fN(e[1]),gy(e[2]),gy(e[3]))|255)>>>0:(e=vve.exec(i))?(dN(fN(e[1]),gy(e[2]),gy(e[3]))|pN(e[4]))>>>0:null}function Zw(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*(2/3-t)*6:i}function dN(i,e,t){const n=t<.5?t*(1+e):t+e-t*e,r=2*t-n,s=Zw(r,n,i+1/3),a=Zw(r,n,i),o=Zw(r,n,i-1/3);return Math.round(s*255)<<24|Math.round(a*255)<<16|Math.round(o*255)<<8}function Tf(i){const e=parseInt(i,10);return e<0?0:e>255?255:e}function fN(i){return(parseFloat(i)%360+360)%360/360}function pN(i){const e=parseFloat(i);return e<0?0:e>1?255:Math.round(e*255)}function gy(i){const e=parseFloat(i);return e<0?0:e>100?1:e/100}function mN(i){let e=Mve(i);if(e===null)return i;e=e||0;const t=(e&4278190080)>>>24,n=(e&16711680)>>>16,r=(e&65280)>>>8,s=(e&255)/255;return`rgba(${t}, ${n}, ${r}, ${s})`}var Sg=(i,e,t)=>{if(Ze.fun(i))return i;if(Ze.arr(i))return Sg({range:i,output:e,extrapolate:t});if(Ze.str(i.output[0]))return mC(i);const n=i,r=n.output,s=n.range||[0,1],a=n.extrapolateLeft||n.extrapolate||"extend",o=n.extrapolateRight||n.extrapolate||"extend",l=n.easing||(c=>c);return c=>{const u=Ave(c,s);return Tve(c,s[u],s[u+1],r[u],r[u+1],l,a,o,n.map)}};function Tve(i,e,t,n,r,s,a,o,l){let c=l?l(i):i;if(c<e){if(a==="identity")return c;a==="clamp"&&(c=e)}if(c>t){if(o==="identity")return c;o==="clamp"&&(c=t)}return n===r?n:e===t?i<=e?n:r:(e===-1/0?c=-c:t===1/0?c=c-e:c=(c-e)/(t-e),c=s(c),n===-1/0?c=-c:r===1/0?c=c+n:c=c*(r-n)+n,c)}function Ave(i,e){for(var t=1;t<e.length-1&&!(e[t]>=i);++t);return t-1}var Cve={linear:i=>i},wg=Symbol.for("FluidValue.get"),T0=Symbol.for("FluidValue.observers"),Ca=i=>!!(i&&i[wg]),ys=i=>i&&i[wg]?i[wg]():i,gN=i=>i[T0]||null;function Eve(i,e){i.eventObserved?i.eventObserved(e):i(e)}function Mg(i,e){const t=i[T0];t&&t.forEach(n=>{Eve(n,e)})}var rG=class{constructor(i){if(!i&&!(i=this.get))throw Error("Unknown getter");Rve(this,i)}},Rve=(i,e)=>sG(i,wg,e);function j0(i,e){if(i[wg]){let t=i[T0];t||sG(i,T0,t=new Set),t.has(e)||(t.add(e),i.observerAdded&&i.observerAdded(t.size,e))}return e}function Tg(i,e){const t=i[T0];if(t&&t.has(e)){const n=t.size-1;n?t.delete(e):i[T0]=null,i.observerRemoved&&i.observerRemoved(n,e)}}var sG=(i,e,t)=>Object.defineProperty(i,e,{value:t,writable:!0,configurable:!0}),Fy=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Pve=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,xN=new RegExp(`(${Fy.source})(%|[a-z]+)`,"i"),Ive=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,n_=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,aG=i=>{const[e,t]=Dve(i);if(!e||pC())return i;const n=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(n)return n.trim();if(t&&t.startsWith("--")){const r=window.getComputedStyle(document.documentElement).getPropertyValue(t);return r||i}else{if(t&&n_.test(t))return aG(t);if(t)return t}return i},Dve=i=>{const e=n_.exec(i);if(!e)return[,];const[,t,n]=e;return[t,n]},Qw,Nve=(i,e,t,n,r)=>`rgba(${Math.round(e)}, ${Math.round(t)}, ${Math.round(n)}, ${r})`,oG=i=>{Qw||(Qw=fu?new RegExp(`(${Object.keys(fu).join("|")})(?!\\w)`,"g"):/^\b$/);const e=i.output.map(s=>ys(s).replace(n_,aG).replace(Pve,mN).replace(Qw,mN)),t=e.map(s=>s.match(Fy).map(Number)),r=t[0].map((s,a)=>t.map(o=>{if(!(a in o))throw Error('The arity of each "output" value must be equal');return o[a]})).map(s=>Sg({...i,output:s}));return s=>{const a=!xN.test(e[0])&&e.find(l=>xN.test(l))?.replace(Fy,"");let o=0;return e[0].replace(Fy,()=>`${r[o++](s)}${a||""}`).replace(Ive,Nve)}},xC="react-spring: ",lG=i=>{const e=i;let t=!1;if(typeof e!="function")throw new TypeError(`${xC}once requires a function parameter`);return(...n)=>{t||(e(...n),t=!0)}},Lve=lG(console.warn);function kve(){Lve(`${xC}The "interpolate" function is deprecated in v9 (use "to" instead)`)}var Ove=lG(console.warn);function zve(){Ove(`${xC}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function i_(i){return Ze.str(i)&&(i[0]=="#"||/\d/.test(i)||!pC()&&n_.test(i)||i in(fu||{}))}var Ff=pC()?z.useEffect:z.useLayoutEffect,Uve=()=>{const i=z.useRef(!1);return Ff(()=>(i.current=!0,()=>{i.current=!1}),[]),i};function cG(){const i=z.useState()[1],e=Uve();return()=>{e.current&&i(Math.random())}}var uG=i=>z.useEffect(i,Fve),Fve=[];function Bve(i){const e=z.useRef(void 0);return z.useEffect(()=>{e.current=i}),e.current}var Ag=Symbol.for("Animated:node"),Hve=i=>!!i&&i[Ag]===i,Lo=i=>i&&i[Ag],yC=(i,e)=>hve(i,Ag,e),r_=i=>i&&i[Ag]&&i[Ag].getPayload(),hG=class{constructor(){yC(this,this)}getPayload(){return this.payload||[]}},s_=class dG extends hG{constructor(e){super(),this._value=e,this.done=!0,this.durationProgress=0,Ze.num(this._value)&&(this.lastPosition=this._value)}static create(e){return new dG(e)}getPayload(){return[this]}getValue(){return this._value}setValue(e,t){return Ze.num(e)&&(this.lastPosition=e,t&&(e=Math.round(e/t)*t,this.done&&(this.lastPosition=e))),this._value===e?!1:(this._value=e,!0)}reset(){const{done:e}=this;this.done=!1,Ze.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}},_b=class fG extends s_{constructor(e){super(0),this._string=null,this._toString=Sg({output:[e,e]})}static create(e){return new fG(e)}getValue(){const e=this._string;return e??(this._string=this._toString(this._value))}setValue(e){if(Ze.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else if(super.setValue(e))this._string=null;else return!1;return!0}reset(e){e&&(this._toString=Sg({output:[this.getValue(),e]})),this._value=0,super.reset()}},Sb={dependencies:null},a_=class extends hG{constructor(i){super(),this.source=i,this.setValue(i)}getValue(i){const e={};return nl(this.source,(t,n)=>{Hve(t)?e[n]=t.getValue(i):Ca(t)?e[n]=ys(t):i||(e[n]=t)}),e}setValue(i){this.source=i,this.payload=this._makePayload(i)}reset(){this.payload&&Qt(this.payload,i=>i.reset())}_makePayload(i){if(i){const e=new Set;return nl(i,this._addToPayload,e),Array.from(e)}}_addToPayload(i){Sb.dependencies&&Ca(i)&&Sb.dependencies.add(i);const e=r_(i);e&&Qt(e,t=>this.add(t))}},jve=class pG extends a_{constructor(e){super(e)}static create(e){return new pG(e)}getValue(){return this.source.map(e=>e.getValue())}setValue(e){const t=this.getPayload();return e.length==t.length?t.map((n,r)=>n.setValue(e[r])).some(Boolean):(super.setValue(e.map(Vve)),!0)}};function Vve(i){return(i_(i)?_b:s_).create(i)}function f6(i){const e=Lo(i);return e?e.constructor:Ze.arr(i)?jve:i_(i)?_b:s_}var yN=(i,e)=>{const t=!Ze.fun(i)||i.prototype&&i.prototype.isReactComponent;return z.forwardRef((n,r)=>{const s=z.useRef(null),a=t&&z.useCallback(g=>{s.current=qve(r,g)},[r]),[o,l]=Wve(n,e),c=cG(),u=()=>{const g=s.current;if(t&&!g)return;(g?e.applyAnimatedValues(g,o.getValue(!0)):!1)===!1&&c()},d=new Gve(u,l),p=z.useRef(void 0);Ff(()=>(p.current=d,Qt(l,g=>j0(g,d)),()=>{p.current&&(Qt(p.current.deps,g=>Tg(g,p.current)),Xt.cancel(p.current.update))})),z.useEffect(u,[]),uG(()=>()=>{const g=p.current;Qt(g.deps,y=>Tg(y,g))});const m=e.getComponentProps(o.getValue());return z.createElement(i,{...m,ref:a})})},Gve=class{constructor(i,e){this.update=i,this.deps=e}eventObserved(i){i.type=="change"&&Xt.write(this.update)}};function Wve(i,e){const t=new Set;return Sb.dependencies=t,i.style&&(i={...i,style:e.createAnimatedStyle(i.style)}),i=new a_(i),Sb.dependencies=null,[i,t]}function qve(i,e){return i&&(Ze.fun(i)?i(e):i.current=e),e}var vN=Symbol.for("AnimatedComponent"),Xve=(i,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:t=r=>new a_(r),getComponentProps:n=r=>r}={})=>{const r={applyAnimatedValues:e,createAnimatedStyle:t,getComponentProps:n},s=a=>{const o=bN(a)||"Anonymous";return Ze.str(a)?a=s[a]||(s[a]=yN(a,r)):a=a[vN]||(a[vN]=yN(a,r)),a.displayName=`Animated(${o})`,a};return nl(i,(a,o)=>{Ze.arr(i)&&(o=bN(a)),s[o]=s(a)}),{animated:s}},bN=i=>Ze.str(i)?i:i&&Ze.str(i.displayName)?i.displayName:Ze.fun(i)&&i.name||null;function vs(i,...e){return Ze.fun(i)?i(...e):i}var Em=(i,e)=>i===!0||!!(e&&i&&(Ze.fun(i)?i(e):is(i).includes(e))),mG=(i,e)=>Ze.obj(i)?e&&i[e]:i,gG=(i,e)=>i.default===!0?i[e]:i.default?i.default[e]:void 0,Yve=i=>i,vC=(i,e=Yve)=>{let t=$ve;i.default&&i.default!==!0&&(i=i.default,t=Object.keys(i));const n={};for(const r of t){const s=e(i[r],r);Ze.und(s)||(n[r]=s)}return n},$ve=["config","onProps","onStart","onChange","onPause","onResume","onRest"],Kve={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function Zve(i){const e={};let t=0;if(nl(i,(n,r)=>{Kve[r]||(e[r]=n,t++)}),t)return e}function bC(i){const e=Zve(i);if(e){const t={to:e};return nl(i,(n,r)=>r in e||(t[r]=n)),t}return{...i}}function Cg(i){return i=ys(i),Ze.arr(i)?i.map(Cg):i_(i)?xo.createStringInterpolator({range:[0,1],output:[i,i]})(1):i}function Qve(i){for(const e in i)return!0;return!1}function p6(i){return Ze.fun(i)||Ze.arr(i)&&Ze.obj(i[0])}function _N(i,e){i.ref?.delete(i),e?.delete(i)}function Jve(i,e){e&&i.ref!==e&&(i.ref?.delete(i),e.add(i),i.ref=e)}var ebe={default:{tension:170,friction:26}},m6={...ebe.default,mass:1,damping:1,easing:Cve.linear,clamp:!1},tbe=class{constructor(){this.velocity=0,Object.assign(this,m6)}};function nbe(i,e,t){t&&(t={...t},SN(t,e),e={...t,...e}),SN(i,e),Object.assign(i,e);for(const a in m6)i[a]==null&&(i[a]=m6[a]);let{frequency:n,damping:r}=i;const{mass:s}=i;return Ze.und(n)||(n<.01&&(n=.01),r<0&&(r=0),i.tension=Math.pow(2*Math.PI/n,2)*s,i.friction=4*Math.PI*r*s/n),i}function SN(i,e){if(!Ze.und(e.decay))i.duration=void 0;else{const t=!Ze.und(e.tension)||!Ze.und(e.friction);(t||!Ze.und(e.frequency)||!Ze.und(e.damping)||!Ze.und(e.mass))&&(i.duration=void 0,i.decay=void 0),t&&(i.frequency=void 0)}}var wN=[],ibe=class{constructor(){this.changed=!1,this.values=wN,this.toValues=null,this.fromValues=wN,this.config=new tbe,this.immediate=!1}};function xG(i,{key:e,props:t,defaultProps:n,state:r,actions:s}){return new Promise((a,o)=>{let l,c,u=Em(t.cancel??n?.cancel,e);if(u)m();else{Ze.und(t.pause)||(r.paused=Em(t.pause,e));let g=n?.pause;g!==!0&&(g=r.paused||Em(g,e)),l=vs(t.delay||0,e),g?(r.resumeQueue.add(p),s.pause()):(s.resume(),p())}function d(){r.resumeQueue.add(p),r.timeouts.delete(c),c.cancel(),l=c.time-Xt.now()}function p(){l>0&&!xo.skipAnimation?(r.delayed=!0,c=Xt.setTimeout(m,l),r.pauseQueue.add(d),r.timeouts.add(c)):m()}function m(){r.delayed&&(r.delayed=!1),r.pauseQueue.delete(d),r.timeouts.delete(c),i<=(r.cancelId||0)&&(u=!0);try{s.start({...t,callId:i,cancel:u},a)}catch(g){o(g)}}})}var _C=(i,e)=>e.length==1?e[0]:e.some(t=>t.cancelled)?$f(i.get()):e.every(t=>t.noop)?yG(i.get()):lo(i.get(),e.every(t=>t.finished)),yG=i=>({value:i,noop:!0,finished:!0,cancelled:!1}),lo=(i,e,t=!1)=>({value:i,finished:e,cancelled:t}),$f=i=>({value:i,cancelled:!0,finished:!1});function vG(i,e,t,n){const{callId:r,parentId:s,onRest:a}=e,{asyncTo:o,promise:l}=t;return!s&&i===o&&!e.reset?l:t.promise=(async()=>{t.asyncId=r,t.asyncTo=i;const c=vC(e,(x,_)=>_==="onRest"?void 0:x);let u,d;const p=new Promise((x,_)=>(u=x,d=_)),m=x=>{const _=r<=(t.cancelId||0)&&$f(n)||r!==t.asyncId&&lo(n,!1);if(_)throw x.result=_,d(x),x},g=(x,_)=>{const S=new MN,w=new TN;return(async()=>{if(xo.skipAnimation)throw Eg(t),w.result=lo(n,!1),d(w),w;m(S);const T=Ze.obj(x)?{...x}:{..._,to:x};T.parentId=r,nl(c,(E,D)=>{Ze.und(T[D])&&(T[D]=E)});const C=await n.start(T);return m(S),t.paused&&await new Promise(E=>{t.resumeQueue.add(E)}),C})()};let y;if(xo.skipAnimation)return Eg(t),lo(n,!1);try{let x;Ze.arr(i)?x=(async _=>{for(const S of _)await g(S)})(i):x=Promise.resolve(i(g,n.stop.bind(n))),await Promise.all([x.then(u),p]),y=lo(n.get(),!0,!1)}catch(x){if(x instanceof MN)y=x.result;else if(x instanceof TN)y=x.result;else throw x}finally{r==t.asyncId&&(t.asyncId=s,t.asyncTo=s?o:void 0,t.promise=s?l:void 0)}return Ze.fun(a)&&Xt.batchedUpdates(()=>{a(y,n,n.item)}),y})()}function Eg(i,e){Am(i.timeouts,t=>t.cancel()),i.pauseQueue.clear(),i.resumeQueue.clear(),i.asyncId=i.asyncTo=i.promise=void 0,e&&(i.cancelId=e)}var MN=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},TN=class extends Error{constructor(){super("SkipAnimationSignal")}},g6=i=>i instanceof SC,rbe=1,SC=class extends rG{constructor(){super(...arguments),this.id=rbe++,this._priority=0}get priority(){return this._priority}set priority(i){this._priority!=i&&(this._priority=i,this._onPriorityChange(i))}get(){const i=Lo(this);return i&&i.getValue()}to(...i){return xo.to(this,i)}interpolate(...i){return kve(),xo.to(this,i)}toJSON(){return this.get()}observerAdded(i){i==1&&this._attach()}observerRemoved(i){i==0&&this._detach()}_attach(){}_detach(){}_onChange(i,e=!1){Mg(this,{type:"change",parent:this,value:i,idle:e})}_onPriorityChange(i){this.idle||e_.sort(this),Mg(this,{type:"priority",parent:this,priority:i})}},ad=Symbol.for("SpringPhase"),bG=1,x6=2,y6=4,Jw=i=>(i[ad]&bG)>0,qc=i=>(i[ad]&x6)>0,Hp=i=>(i[ad]&y6)>0,AN=(i,e)=>e?i[ad]|=x6|bG:i[ad]&=~x6,CN=(i,e)=>e?i[ad]|=y6:i[ad]&=~y6,sbe=class extends SC{constructor(i,e){if(super(),this.animation=new ibe,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!Ze.und(i)||!Ze.und(e)){const t=Ze.obj(i)?{...i}:{...e,from:i};Ze.und(t.default)&&(t.default=!0),this.start(t)}}get idle(){return!(qc(this)||this._state.asyncTo)||Hp(this)}get goal(){return ys(this.animation.to)}get velocity(){const i=Lo(this);return i instanceof s_?i.lastVelocity||0:i.getPayload().map(e=>e.lastVelocity||0)}get hasAnimated(){return Jw(this)}get isAnimating(){return qc(this)}get isPaused(){return Hp(this)}get isDelayed(){return this._state.delayed}advance(i){let e=!0,t=!1;const n=this.animation;let{toValues:r}=n;const{config:s}=n,a=r_(n.to);!a&&Ca(n.to)&&(r=is(ys(n.to))),n.values.forEach((c,u)=>{if(c.done)return;const d=c.constructor==_b?1:a?a[u].lastPosition:r[u];let p=n.immediate,m=d;if(!p){if(m=c.lastPosition,s.tension<=0){c.done=!0;return}let g=c.elapsedTime+=i;const y=n.fromValues[u],x=c.v0!=null?c.v0:c.v0=Ze.arr(s.velocity)?s.velocity[u]:s.velocity;let _;const S=s.precision||(y==d?.005:Math.min(1,Math.abs(d-y)*.001));if(Ze.und(s.duration))if(s.decay){const w=s.decay===!0?.998:s.decay,T=Math.exp(-(1-w)*g);m=y+x/(1-w)*(1-T),p=Math.abs(c.lastPosition-m)<=S,_=x*T}else{_=c.lastVelocity==null?x:c.lastVelocity;const w=s.restVelocity||S/10,T=s.clamp?0:s.bounce,C=!Ze.und(T),E=y==d?c.v0>0:y<d;let D,O=!1;const R=1,P=Math.ceil(i/R);for(let L=0;L<P&&(D=Math.abs(_)>w,!(!D&&(p=Math.abs(d-m)<=S,p)));++L){C&&(O=m==d||m>d==E,O&&(_=-_*T,m=d));const V=-s.tension*1e-6*(m-d),j=-s.friction*.001*_,B=(V+j)/s.mass;_=_+B*R,m=m+_*R}}else{let w=1;s.duration>0&&(this._memoizedDuration!==s.duration&&(this._memoizedDuration=s.duration,c.durationProgress>0&&(c.elapsedTime=s.duration*c.durationProgress,g=c.elapsedTime+=i)),w=(s.progress||0)+g/this._memoizedDuration,w=w>1?1:w<0?0:w,c.durationProgress=w),m=y+s.easing(w)*(d-y),_=(m-c.lastPosition)/i,p=w==1}c.lastVelocity=_,Number.isNaN(m)&&(console.warn("Got NaN while animating:",this),p=!0)}a&&!a[u].done&&(p=!1),p?c.done=!0:e=!1,c.setValue(m,s.round)&&(t=!0)});const o=Lo(this),l=o.getValue();if(e){const c=ys(n.to);(l!==c||t)&&!s.decay?(o.setValue(c),this._onChange(c)):t&&s.decay&&this._onChange(l),this._stop()}else t&&this._onChange(l)}set(i){return Xt.batchedUpdates(()=>{this._stop(),this._focus(i),this._set(i)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(qc(this)){const{to:i,config:e}=this.animation;Xt.batchedUpdates(()=>{this._onStart(),e.decay||this._set(i,!1),this._stop()})}return this}update(i){return(this.queue||(this.queue=[])).push(i),this}start(i,e){let t;return Ze.und(i)?(t=this.queue||[],this.queue=[]):t=[Ze.obj(i)?i:{...e,to:i}],Promise.all(t.map(n=>this._update(n))).then(n=>_C(this,n))}stop(i){const{to:e}=this.animation;return this._focus(this.get()),Eg(this._state,i&&this._lastCallId),Xt.batchedUpdates(()=>this._stop(e,i)),this}reset(){this._update({reset:!0})}eventObserved(i){i.type=="change"?this._start():i.type=="priority"&&(this.priority=i.priority+1)}_prepareNode(i){const e=this.key||"";let{to:t,from:n}=i;t=Ze.obj(t)?t[e]:t,(t==null||p6(t))&&(t=void 0),n=Ze.obj(n)?n[e]:n,n==null&&(n=void 0);const r={to:t,from:n};return Jw(this)||(i.reverse&&([t,n]=[n,t]),n=ys(n),Ze.und(n)?Lo(this)||this._set(t):this._set(n)),r}_update({...i},e){const{key:t,defaultProps:n}=this;i.default&&Object.assign(n,vC(i,(a,o)=>/^on/.test(o)?mG(a,t):a)),RN(this,i,"onProps"),Vp(this,"onProps",i,this);const r=this._prepareNode(i);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const s=this._state;return xG(++this._lastCallId,{key:t,props:i,defaultProps:n,state:s,actions:{pause:()=>{Hp(this)||(CN(this,!0),im(s.pauseQueue),Vp(this,"onPause",lo(this,jp(this,this.animation.to)),this))},resume:()=>{Hp(this)&&(CN(this,!1),qc(this)&&this._resume(),im(s.resumeQueue),Vp(this,"onResume",lo(this,jp(this,this.animation.to)),this))},start:this._merge.bind(this,r)}}).then(a=>{if(i.loop&&a.finished&&!(e&&a.noop)){const o=_G(i);if(o)return this._update(o,!0)}return a})}_merge(i,e,t){if(e.cancel)return this.stop(!0),t($f(this));const n=!Ze.und(i.to),r=!Ze.und(i.from);if(n||r)if(e.callId>this._lastToId)this._lastToId=e.callId;else return t($f(this));const{key:s,defaultProps:a,animation:o}=this,{to:l,from:c}=o;let{to:u=l,from:d=c}=i;r&&!n&&(!e.default||Ze.und(u))&&(u=d),e.reverse&&([u,d]=[d,u]);const p=!Bl(d,c);p&&(o.from=d),d=ys(d);const m=!Bl(u,l);m&&this._focus(u);const g=p6(e.to),{config:y}=o,{decay:x,velocity:_}=y;(n||r)&&(y.velocity=0),e.config&&!g&&nbe(y,vs(e.config,s),e.config!==a.config?vs(a.config,s):void 0);let S=Lo(this);if(!S||Ze.und(u))return t(lo(this,!0));const w=Ze.und(e.reset)?r&&!e.default:!Ze.und(d)&&Em(e.reset,s),T=w?d:this.get(),C=Cg(u),E=Ze.num(C)||Ze.arr(C)||i_(C),D=!g&&(!E||Em(a.immediate||e.immediate,s));if(m){const L=f6(u);if(L!==S.constructor)if(D)S=this._set(C);else throw Error(`Cannot animate between ${S.constructor.name} and ${L.name}, as the "to" prop suggests`)}const O=S.constructor;let R=Ca(u),P=!1;if(!R){const L=w||!Jw(this)&&p;(m||L)&&(P=Bl(Cg(T),C),R=!P),(!Bl(o.immediate,D)&&!D||!Bl(y.decay,x)||!Bl(y.velocity,_))&&(R=!0)}if(P&&qc(this)&&(o.changed&&!w?R=!0:R||this._stop(l)),!g&&((R||Ca(l))&&(o.values=S.getPayload(),o.toValues=Ca(u)?null:O==_b?[1]:is(C)),o.immediate!=D&&(o.immediate=D,!D&&!w&&this._set(l)),R)){const{onRest:L}=o;Qt(abe,j=>RN(this,e,j));const V=lo(this,jp(this,l));im(this._pendingCalls,V),this._pendingCalls.add(t),o.changed&&Xt.batchedUpdates(()=>{o.changed=!w,L?.(V,this),w?vs(a.onRest,V):o.onStart?.(V,this)})}w&&this._set(T),g?t(vG(e.to,e,this._state,this)):R?this._start():qc(this)&&!m?this._pendingCalls.add(t):t(yG(T))}_focus(i){const e=this.animation;i!==e.to&&(gN(this)&&this._detach(),e.to=i,gN(this)&&this._attach())}_attach(){let i=0;const{to:e}=this.animation;Ca(e)&&(j0(e,this),g6(e)&&(i=e.priority+1)),this.priority=i}_detach(){const{to:i}=this.animation;Ca(i)&&Tg(i,this)}_set(i,e=!0){const t=ys(i);if(!Ze.und(t)){const n=Lo(this);if(!n||!Bl(t,n.getValue())){const r=f6(t);!n||n.constructor!=r?yC(this,r.create(t)):n.setValue(t),n&&Xt.batchedUpdates(()=>{this._onChange(t,e)})}}return Lo(this)}_onStart(){const i=this.animation;i.changed||(i.changed=!0,Vp(this,"onStart",lo(this,jp(this,i.to)),this))}_onChange(i,e){e||(this._onStart(),vs(this.animation.onChange,i,this)),vs(this.defaultProps.onChange,i,this),super._onChange(i,e)}_start(){const i=this.animation;Lo(this).reset(ys(i.to)),i.immediate||(i.fromValues=i.values.map(e=>e.lastPosition)),qc(this)||(AN(this,!0),Hp(this)||this._resume())}_resume(){xo.skipAnimation?this.finish():e_.start(this)}_stop(i,e){if(qc(this)){AN(this,!1);const t=this.animation;Qt(t.values,r=>{r.done=!0}),t.toValues&&(t.onChange=t.onPause=t.onResume=void 0),Mg(this,{type:"idle",parent:this});const n=e?$f(this.get()):lo(this.get(),jp(this,i??t.to));im(this._pendingCalls,n),t.changed&&(t.changed=!1,Vp(this,"onRest",n,this))}}};function jp(i,e){const t=Cg(e),n=Cg(i.get());return Bl(n,t)}function _G(i,e=i.loop,t=i.to){const n=vs(e);if(n){const r=n!==!0&&bC(n),s=(r||i).reverse,a=!r||r.reset;return wb({...i,loop:e,default:!1,pause:void 0,to:!s||p6(t)?t:void 0,from:a?i.from:void 0,reset:a,...r})}}function wb(i){const{to:e,from:t}=i=bC(i),n=new Set;return Ze.obj(e)&&EN(e,n),Ze.obj(t)&&EN(t,n),i.keys=n.size?Array.from(n):null,i}function EN(i,e){nl(i,(t,n)=>t!=null&&e.add(n))}var abe=["onStart","onRest","onChange","onPause","onResume"];function RN(i,e,t){i.animation[t]=e[t]!==gG(e,t)?mG(e[t],i.key):void 0}function Vp(i,e,...t){i.animation[e]?.(...t),i.defaultProps[e]?.(...t)}var obe=["onStart","onChange","onRest"],lbe=1,cbe=class{constructor(i,e){this.id=lbe++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),e&&(this._flush=e),i&&this.start({default:!0,...i})}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(i=>i.idle&&!i.isDelayed&&!i.isPaused)}get item(){return this._item}set item(i){this._item=i}get(){const i={};return this.each((e,t)=>i[t]=e.get()),i}set(i){for(const e in i){const t=i[e];Ze.und(t)||this.springs[e].set(t)}}update(i){return i&&this.queue.push(wb(i)),this}start(i){let{queue:e}=this;return i?e=is(i).map(wb):this.queue=[],this._flush?this._flush(this,e):(TG(this,e),ube(this,e))}stop(i,e){if(i!==!!i&&(e=i),e){const t=this.springs;Qt(is(e),n=>t[n].stop(!!i))}else Eg(this._state,this._lastAsyncId),this.each(t=>t.stop(!!i));return this}pause(i){if(Ze.und(i))this.start({pause:!0});else{const e=this.springs;Qt(is(i),t=>e[t].pause())}return this}resume(i){if(Ze.und(i))this.start({pause:!1});else{const e=this.springs;Qt(is(i),t=>e[t].resume())}return this}each(i){nl(this.springs,i)}_onFrame(){const{onStart:i,onChange:e,onRest:t}=this._events,n=this._active.size>0,r=this._changed.size>0;(n&&!this._started||r&&!this._started)&&(this._started=!0,Am(i,([o,l])=>{l.value=this.get(),o(l,this,this._item)}));const s=!n&&this._started,a=r||s&&t.size?this.get():null;r&&e.size&&Am(e,([o,l])=>{l.value=a,o(l,this,this._item)}),s&&(this._started=!1,Am(t,([o,l])=>{l.value=a,o(l,this,this._item)}))}eventObserved(i){if(i.type=="change")this._changed.add(i.parent),i.idle||this._active.add(i.parent);else if(i.type=="idle")this._active.delete(i.parent);else return;Xt.onFrame(this._onFrame)}};function ube(i,e){return Promise.all(e.map(t=>SG(i,t))).then(t=>_C(i,t))}async function SG(i,e,t){const{keys:n,to:r,from:s,loop:a,onRest:o,onResolve:l}=e,c=Ze.obj(e.default)&&e.default;a&&(e.loop=!1),r===!1&&(e.to=null),s===!1&&(e.from=null);const u=Ze.arr(r)||Ze.fun(r)?r:void 0;u?(e.to=void 0,e.onRest=void 0,c&&(c.onRest=void 0)):Qt(obe,y=>{const x=e[y];if(Ze.fun(x)){const _=i._events[y];e[y]=({finished:S,cancelled:w})=>{const T=_.get(x);T?(S||(T.finished=!1),w&&(T.cancelled=!0)):_.set(x,{value:null,finished:S||!1,cancelled:w||!1})},c&&(c[y]=e[y])}});const d=i._state;e.pause===!d.paused?(d.paused=e.pause,im(e.pause?d.pauseQueue:d.resumeQueue)):d.paused&&(e.pause=!0);const p=(n||Object.keys(i.springs)).map(y=>i.springs[y].start(e)),m=e.cancel===!0||gG(e,"cancel")===!0;(u||m&&d.asyncId)&&p.push(xG(++i._lastAsyncId,{props:e,state:d,actions:{pause:h6,resume:h6,start(y,x){m?(Eg(d,i._lastAsyncId),x($f(i))):(y.onRest=o,x(vG(u,y,d,i)))}}})),d.paused&&await new Promise(y=>{d.resumeQueue.add(y)});const g=_C(i,await Promise.all(p));if(a&&g.finished&&!(t&&g.noop)){const y=_G(e,a,r);if(y)return TG(i,[y]),SG(i,y,!0)}return l&&Xt.batchedUpdates(()=>l(g,i,i.item)),g}function hbe(i,e){const t={...i.springs};return e&&Qt(is(e),n=>{Ze.und(n.keys)&&(n=wb(n)),Ze.obj(n.to)||(n={...n,to:void 0}),MG(t,n,r=>wG(r))}),dbe(i,t),t}function dbe(i,e){nl(e,(t,n)=>{i.springs[n]||(i.springs[n]=t,j0(t,i))})}function wG(i,e){const t=new sbe;return t.key=i,e&&j0(t,e),t}function MG(i,e,t){e.keys&&Qt(e.keys,n=>{(i[n]||(i[n]=t(n)))._prepareNode(e)})}function TG(i,e){Qt(e,t=>{MG(i.springs,t,n=>wG(n,i))})}var fbe=z.createContext({pause:!1,immediate:!1}),pbe=()=>{const i=[],e=function(n){zve();const r=[];return Qt(i,(s,a)=>{if(Ze.und(n))r.push(s.start());else{const o=t(n,s,a);o&&r.push(s.start(o))}}),r};e.current=i,e.add=function(n){i.includes(n)||i.push(n)},e.delete=function(n){const r=i.indexOf(n);~r&&i.splice(r,1)},e.pause=function(){return Qt(i,n=>n.pause(...arguments)),this},e.resume=function(){return Qt(i,n=>n.resume(...arguments)),this},e.set=function(n){Qt(i,(r,s)=>{const a=Ze.fun(n)?n(s,r):n;a&&r.set(a)})},e.start=function(n){const r=[];return Qt(i,(s,a)=>{if(Ze.und(n))r.push(s.start());else{const o=this._getProps(n,s,a);o&&r.push(s.start(o))}}),r},e.stop=function(){return Qt(i,n=>n.stop(...arguments)),this},e.update=function(n){return Qt(i,(r,s)=>r.update(this._getProps(n,r,s))),this};const t=function(n,r,s){return Ze.fun(n)?n(s,r):n};return e._getProps=t,e};function mbe(i,e,t){const n=Ze.fun(e)&&e,{reset:r,sort:s,trail:a=0,expires:o=!0,exitBeforeEnter:l=!1,onDestroyed:c,ref:u,config:d}=n?n():e,p=z.useMemo(()=>n||arguments.length==3?pbe():void 0,[]),m=is(i),g=[],y=z.useRef(null),x=r?null:y.current;Ff(()=>{y.current=g}),uG(()=>(Qt(g,B=>{p?.add(B.ctrl),B.ctrl.ref=p}),()=>{Qt(y.current,B=>{B.expired&&clearTimeout(B.expirationId),_N(B.ctrl,p),B.ctrl.stop(!0)})}));const _=xbe(m,n?n():e,x),S=r&&y.current||[];Ff(()=>Qt(S,({ctrl:B,item:J,key:U})=>{_N(B,p),vs(c,J,U)}));const w=[];if(x&&Qt(x,(B,J)=>{B.expired?(clearTimeout(B.expirationId),S.push(B)):(J=w[J]=_.indexOf(B.key),~J&&(g[J]=B))}),Qt(m,(B,J)=>{g[J]||(g[J]={key:_[J],item:B,phase:"mount",ctrl:new cbe},g[J].ctrl.item=B)}),w.length){let B=-1;const{leave:J}=n?n():e;Qt(w,(U,X)=>{const $=x[X];~U?(B=g.indexOf($),g[B]={...$,item:m[U]}):J&&g.splice(++B,0,$)})}Ze.fun(s)&&g.sort((B,J)=>s(B.item,J.item));let T=-a;const C=cG(),E=vC(e),D=new Map,O=z.useRef(new Map),R=z.useRef(!1);Qt(g,(B,J)=>{const U=B.key,X=B.phase,$=n?n():e;let Q,se;const ye=vs($.delay||0,U);if(X=="mount")Q=$.enter,se="enter";else{const Oe=_.indexOf(U)<0;if(X!="leave")if(Oe)Q=$.leave,se="leave";else if(Q=$.update)se="update";else return;else if(!Oe)Q=$.enter,se="enter";else return}if(Q=vs(Q,B.item,J),Q=Ze.obj(Q)?bC(Q):{to:Q},!Q.config){const Oe=d||E.config;Q.config=vs(Oe,B.item,J,se)}T+=a;const we={...E,delay:ye+T,ref:u,immediate:$.immediate,reset:!1,...Q};if(se=="enter"&&Ze.und(we.from)){const Oe=n?n():e,fe=Ze.und(Oe.initial)||x?Oe.from:Oe.initial;we.from=vs(fe,B.item,J)}const{onResolve:He}=we;we.onResolve=Oe=>{vs(He,Oe);const fe=y.current,ge=fe.find(Ne=>Ne.key===U);if(ge&&!(Oe.cancelled&&ge.phase!="update")&&ge.ctrl.idle){const Ne=fe.every(Qe=>Qe.ctrl.idle);if(ge.phase=="leave"){const Qe=vs(o,ge.item);if(Qe!==!1){const et=Qe===!0?0:Qe;if(ge.expired=!0,!Ne&&et>0){et<=2147483647&&(ge.expirationId=setTimeout(C,et));return}}}Ne&&fe.some(Qe=>Qe.expired)&&(O.current.delete(ge),l&&(R.current=!0),C())}};const De=hbe(B.ctrl,we);se==="leave"&&l?O.current.set(B,{phase:se,springs:De,payload:we}):D.set(B,{phase:se,springs:De,payload:we})});const P=z.useContext(fbe),L=Bve(P),V=P!==L&&Qve(P);Ff(()=>{V&&Qt(g,B=>{B.ctrl.start({default:P})})},[P]),Qt(D,(B,J)=>{if(O.current.size){const U=g.findIndex(X=>X.key===J.key);g.splice(U,1)}}),Ff(()=>{Qt(O.current.size?O.current:D,({phase:B,payload:J},U)=>{const{ctrl:X}=U;U.phase=B,p?.add(X),V&&B=="enter"&&X.start({default:P}),J&&(Jve(X,J.ref),(X.ref||p)&&!R.current?X.update(J):(X.start(J),R.current&&(R.current=!1)))})},r?void 0:t);const j=B=>z.createElement(z.Fragment,null,g.map((J,U)=>{const{springs:X}=D.get(J)||J.ctrl,$=B({...X},J.item,J,U),Q=Ze.str(J.key)||Ze.num(J.key)?J.key:J.ctrl.id,se=z.version<"19.0.0",ye=$?.props??{},we=se?$?.ref:ye?.ref;return $&&$.type?z.createElement($.type,{...ye,key:Q,ref:we}):$}));return p?[j,p]:j}var gbe=1;function xbe(i,{key:e,keys:t=e},n){if(t===null){const r=new Set;return i.map(s=>{const a=n&&n.find(o=>o.item===s&&o.phase!=="leave"&&!r.has(o));return a?(r.add(a),a.key):gbe++})}return Ze.und(t)?i:Ze.fun(t)?i.map(t):is(t)}var AG=class extends SC{constructor(i,e){super(),this.source=i,this.idle=!0,this._active=new Set,this.calc=Sg(...e);const t=this._get(),n=f6(t);yC(this,n.create(t))}advance(i){const e=this._get(),t=this.get();Bl(e,t)||(Lo(this).setValue(e),this._onChange(e,this.idle)),!this.idle&&PN(this._active)&&eM(this)}_get(){const i=Ze.arr(this.source)?this.source.map(ys):is(ys(this.source));return this.calc(...i)}_start(){this.idle&&!PN(this._active)&&(this.idle=!1,Qt(r_(this),i=>{i.done=!1}),xo.skipAnimation?(Xt.batchedUpdates(()=>this.advance()),eM(this)):e_.start(this))}_attach(){let i=1;Qt(is(this.source),e=>{Ca(e)&&j0(e,this),g6(e)&&(e.idle||this._active.add(e),i=Math.max(i,e.priority+1))}),this.priority=i,this._start()}_detach(){Qt(is(this.source),i=>{Ca(i)&&Tg(i,this)}),this._active.clear(),eM(this)}eventObserved(i){i.type=="change"?i.idle?this.advance():(this._active.add(i.parent),this._start()):i.type=="idle"?this._active.delete(i.parent):i.type=="priority"&&(this.priority=is(this.source).reduce((e,t)=>Math.max(e,(g6(t)?t.priority:0)+1),0))}};function ybe(i){return i.idle!==!1}function PN(i){return!i.size||Array.from(i).every(ybe)}function eM(i){i.idle||(i.idle=!0,Qt(r_(i),e=>{e.done=!0}),Mg(i,{type:"idle",parent:i}))}var vbe=(i,...e)=>new AG(i,e);xo.assign({createStringInterpolator:oG,to:(i,e)=>new AG(i,e)});var CG=/^--/;function bbe(i,e){return e==null||typeof e=="boolean"||e===""?"":typeof e=="number"&&e!==0&&!CG.test(i)&&!(Rm.hasOwnProperty(i)&&Rm[i])?e+"px":(""+e).trim()}var IN={};function _be(i,e){if(!i.nodeType||!i.setAttribute)return!1;const t=i.nodeName==="filter"||i.parentNode&&i.parentNode.nodeName==="filter",{className:n,style:r,children:s,scrollTop:a,scrollLeft:o,viewBox:l,...c}=e,u=Object.values(c),d=Object.keys(c).map(p=>t||i.hasAttribute(p)?p:IN[p]||(IN[p]=p.replace(/([A-Z])/g,m=>"-"+m.toLowerCase())));s!==void 0&&(i.textContent=s);for(const p in r)if(r.hasOwnProperty(p)){const m=bbe(p,r[p]);CG.test(p)?i.style.setProperty(p,m):i.style[p]=m}d.forEach((p,m)=>{i.setAttribute(p,u[m])}),n!==void 0&&(i.className=n),a!==void 0&&(i.scrollTop=a),o!==void 0&&(i.scrollLeft=o),l!==void 0&&i.setAttribute("viewBox",l)}var Rm={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sbe=(i,e)=>i+e.charAt(0).toUpperCase()+e.substring(1),wbe=["Webkit","Ms","Moz","O"];Rm=Object.keys(Rm).reduce((i,e)=>(wbe.forEach(t=>i[Sbe(t,e)]=i[e]),i),Rm);var Mbe=/^(matrix|translate|scale|rotate|skew)/,Tbe=/^(translate)/,Abe=/^(rotate|skew)/,tM=(i,e)=>Ze.num(i)&&i!==0?i+e:i,By=(i,e)=>Ze.arr(i)?i.every(t=>By(t,e)):Ze.num(i)?i===e:parseFloat(i)===e,Cbe=class extends a_{constructor({x:i,y:e,z:t,...n}){const r=[],s=[];(i||e||t)&&(r.push([i||0,e||0,t||0]),s.push(a=>[`translate3d(${a.map(o=>tM(o,"px")).join(",")})`,By(a,0)])),nl(n,(a,o)=>{if(o==="transform")r.push([a||""]),s.push(l=>[l,l===""]);else if(Mbe.test(o)){if(delete n[o],Ze.und(a))return;const l=Tbe.test(o)?"px":Abe.test(o)?"deg":"";r.push(is(a)),s.push(o==="rotate3d"?([c,u,d,p])=>[`rotate3d(${c},${u},${d},${tM(p,l)})`,By(p,0)]:c=>[`${o}(${c.map(u=>tM(u,l)).join(",")})`,By(c,o.startsWith("scale")?1:0)])}}),r.length&&(n.transform=new Ebe(r,s)),super(n)}},Ebe=class extends rG{constructor(i,e){super(),this.inputs=i,this.transforms=e,this._value=null}get(){return this._value||(this._value=this._get())}_get(){let i="",e=!0;return Qt(this.inputs,(t,n)=>{const r=ys(t[0]),[s,a]=this.transforms[n](Ze.arr(r)?r:t.map(ys));i+=" "+s,e=e&&a}),e?"none":i}observerAdded(i){i==1&&Qt(this.inputs,e=>Qt(e,t=>Ca(t)&&j0(t,this)))}observerRemoved(i){i==0&&Qt(this.inputs,e=>Qt(e,t=>Ca(t)&&Tg(t,this)))}eventObserved(i){i.type=="change"&&(this._value=null),Mg(this,i)}},Rbe=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"];xo.assign({batchedUpdates:xY.unstable_batchedUpdates,createStringInterpolator:oG,colors:mve});var Pbe=Xve(Rbe,{applyAnimatedValues:_be,createAnimatedStyle:i=>new Cbe(i),getComponentProps:({scrollTop:i,scrollLeft:e,...t})=>t}),nM=Pbe.animated;function xy(i,e,t,n,r){switch(i){case"center":return r;case"min":return t??0;case"max":return n??0;case"outside":default:return((e??0)<r?t:n)??0}}function DN(i){let{from:e,to:t}=i;return{fromX:e.x,toX:t.x,fromY:e.y,toY:t.y,opacity:1}}function Ibe(i){let{scale:e,animateXOrY:t,animationTrajectory:n="outside"}=i;const r=t==="x";return z.useMemo(()=>{const[s,a]=e.range().map(Wj),o=a!=null&&s!=null&&a<s,[l,c]=o?[a,s]:[s,a],u=a!=null&&s!=null?Math.abs(a-s):0,d=(l??0)+u/2;let p=n;!r&&n==="min"&&(p="max"),!r&&n==="max"&&(p="min");const m=g=>{let{from:y,to:x}=g;return{fromX:r?xy(p,y.x,l,c,d):y.x,toX:r?xy(p,y.x,l,c,d):x.x,fromY:r?y.y:xy(p,y.y,l,c,d),toY:r?x.y:xy(p,y.y,l,c,d),opacity:0}};return{from:m,leave:m,enter:DN,update:DN}},[e,r,n])}function Dbe(i){let{hideTicks:e,horizontal:t,orientation:n,scale:r,tickClassName:s,tickComponent:a,tickLabelProps:o,tickStroke:l="#222",tickTransform:c,ticks:u,tickLineProps:d,animationTrajectory:p}=i;const m=mbe(u,{...Ibe({scale:r,animateXOrY:t?"x":"y",animationTrajectory:p}),keys:g=>`tick-${g.value}-${g.index}`});return v.jsx(v.Fragment,{children:m((g,y,x,_)=>{let{fromX:S,toX:w,fromY:T,toY:C,opacity:E}=g,{key:D}=x;const O=o[_]??o[0]??{};return y==null||D==null?null:v.jsxs(nM.g,{className:ca("visx-axis-tick",s),transform:c,children:[!e&&v.jsx(nM.line,{x1:S,x2:w,y1:T,y2:C,stroke:l,strokeLinecap:"square",strokeOpacity:E,...d}),v.jsx(nM.g,{transform:vbe([w,C],(R,P)=>`translate(${R},${P+(n===ws.bottom&&typeof O.fontSize=="number"?O.fontSize??10:0)})`),opacity:E,children:a?a({...O,x:w,y:C,formattedValue:y?.formattedValue}):v.jsx(XA,{...O,children:y?.formattedValue})},_)]},D)})})}function NN(i){let{animationTrajectory:e,tickComponent:t,...n}=i;const r=z.useMemo(()=>function(a){return v.jsx(Dbe,{...a,tickComponent:t,animationTrajectory:e})},[e,t]);return v.jsx(YA,{...n,ticksComponent:r})}const Nbe=z.memo(function(e){const{spectrum1D:t,xScale:n,yScale:r,height:s,anchor:a,label:o,children:l}=e,{label:c,formatter:u}=YV(),d=La("var(--chakra-colors-gray-600)","var(--chakra-colors-cyan-700)"),p=La("var(--chakra-colors-gray-800)","var(--chakra-colors-cyan-200)");return v.jsxs(xd,{left:a.left,top:a.top,children:[v.jsx(NN,{orientation:"left",scale:r,numTicks:5,label:o?.left??"flux",labelOffset:35,animationTrajectory:"outside",tickLabelProps:{dx:-10,dy:-5,fill:p},labelProps:{fill:p},stroke:p,tickStroke:p}),v.jsx(NN,{orientation:"bottom",animationTrajectory:"outside",left:0,top:s,scale:n,numTicks:8,label:c,tickFormat:m=>{const g=typeof m=="number"?m:Number(m.valueOf());return u(g)},tickLabelProps:{fill:p},labelProps:{fill:p},stroke:p,tickStroke:p}),v.jsx(eV,{yScale:r,data:t,x:m=>n(m.wavelength)??0,y:m=>r(m.fluxPlusErr)??0,y0:m=>r(m.fluxMinusErr)??0,curve:yg,fill:d,fillOpacity:.25,stroke:"none"}),v.jsx(vg,{data:t,x:m=>n(m.wavelength)??0,y:m=>r(m.flux)??0,stroke:p,strokeWidth:2,curve:yg}),l]})});function Lbe(i){const{spectrum1D:e,width:t,height:n,hRatio:r,margin:s}=i,{waveArray:a,waveMin:o,waveMax:l,fluxMin:c,fluxMax:u}=eve(e),{chartWidth:d,chartHeightTop:p,chartHeightBottom:m,chartBrushHeight:g,chartHeightSlice:y,chartAnchorTop:x,chartAnchorBottom:_}=Uye({width:t,height:n,hRatio:r,margin:s}),{xScaleBrush:S,yScaleBrush:w}=Lye({waveMin:o,waveMax:l,fluxMin:c,fluxMax:u,chartWidth:d,chartBrushHeight:g}),{slice1DWaveRange:T,setSlice1DWaveRange:C}=un(Tt(Oe=>({slice1DWaveRange:Oe.slice1DWaveRange,setSlice1DWaveRange:Oe.setSlice1DWaveRange}))),{startIdx:E,endIdx:D}=Vye(a,T),O=Ai(Oe=>Oe.models),R=z.useMemo(()=>O.filter(Oe=>Oe.subtracted&&Oe.active),[O]),P=Jye({spectrum1D:e,waveStartIndex:E,waveEndIndex:D,modelsSubtracted:R}),{xScaleSlice:L,yScaleSlice:V}=Qye({sliceSpectrum:P,sliceRange:T,chartWidth:d,chartHeightSlice:y}),{brushRef:j,handleBrushChange:B}=kye({waveArray:a,waveStartIndex:E,waveEndIndex:D,xScaleBrush:S,onSliceRangeChange:C}),{tooltipOpen:J,tooltipData:U,tooltipLeft:X,tooltipTop:$,TooltipInPortal:Q,containerRef:se,handleHover:ye}=tve({anchor:_}),{formatterWithUnit:we,formatter:He}=YV(),De=La("var(--chakra-colors-cyan-600)","var(--chakra-colors-cyan-300)");return v.jsxs(qe,{position:"relative",ref:se,children:[v.jsxs("svg",{width:t,height:n,children:[v.jsxs(nve,{spectrum1D:e,xScale:S,yScale:w,anchor:x,children:[v.jsx(Nye,{xScale:S,chartHeight:g}),v.jsx(Mye,{xScale:S,yScale:w,width:d,height:p,innerRef:j,margin:{top:0,bottom:0,left:0,right:0},handleSize:8,resizeTriggerAreas:["left","right"],brushDirection:"horizontal",useWindowMoveEvents:!0,renderBrushHandle:Oe=>v.jsx(Dye,{...Oe}),onChange:B,selectedBoxStyle:{fill:"url(#brush-pattern)",stroke:De}})]}),v.jsxs(Nbe,{spectrum1D:P,width:d,height:m,xScale:L,yScale:V,anchor:_,label:{left:"Flux",bottom:"Wavelength"},children:[v.jsx(ave,{xScale:L,yScale:V}),v.jsx(ove,{spectrum1D:P,width:d,height:m,xScale:L,yScale:V,onHover:ye}),v.jsx(ive,{xScale:L,yScale:V,chartHeight:m,sliceRange:T})]})]}),J&&U&&v.jsxs(Q,{top:$,left:X,style:{...oC,zIndex:100},children:[v.jsx("div",{children:`(${He(L.invert(U.axisX))}, ${V.invert(U.axisY).toFixed(4)})`}),v.jsxs("div",{children:[v.jsx("strong",{children:"Wave:"})," ",we(U.wavelength)]}),v.jsxs("div",{children:[v.jsx("strong",{children:"Flux:"})," ",U.flux.toFixed(4)]}),v.jsxs("div",{children:[v.jsx("strong",{children:"Error:"})," ",U.error.toFixed(4)]})]})]})}function kbe(){const[i,e]=z.useState(null),[t,n]=z.useState({width:0,height:0}),r=z.useCallback(d=>{e(d)},[]),{collapseWindow:s,spectrumQueryKey:a}=un(Tt(d=>({collapseWindow:d.collapseWindow,spectrumQueryKey:d.spectrumQueryKey}))),{data:o}=Ng({queryKey:a??["extract_spectrum","empty"],queryFn:async()=>{},enabled:!1}),l=z.useMemo(()=>!o||!o.covered?[]:jye(o,s,"row")??[],[o,s]);z.useEffect(()=>{if(!i)return;const d=()=>{n({width:i.clientWidth,height:i.clientHeight})};d();const p=new ResizeObserver(d);return p.observe(i),()=>p.disconnect()},[i]);const c=t.width,u=t.height;return v.jsx(qe,{ref:r,width:"100%",height:"100%",flex:"1",minH:0,children:c>0&&u>0&&l.length>0?v.jsx(Lbe,{spectrum1D:l,width:c,height:u,margin:{top:20,right:30,bottom:50,left:60}}):null})}function Obe({canvas:i,toolbar:e,width:t=900}){const{open:n,onToggle:r}=GY({defaultOpen:!1});return v.jsxs(qe,{position:"relative",w:t,role:"group",children:[v.jsxs(qe,{position:"relative",zIndex:1,border:"1px solid",borderColor:"border.subtle",transition:"all 0.2s",children:[i,v.jsx(ur,{"aria-label":"Toggle Toolbar",onClick:r,size:"xs",variant:"solid",colorPalette:"gray",position:"absolute",bottom:2,right:2,zIndex:2,rounded:"md",opacity:n?1:.4,_groupHover:{opacity:1},boxShadow:"md",children:n?v.jsx(yY,{}):v.jsx(N6,{})})]}),v.jsx(qe,{position:"absolute",top:"100%",left:0,right:0,zIndex:3,pointerEvents:n?"auto":"none",children:v.jsx(OO,{open:n,unmountOnExit:!0,children:v.jsx(zO,{children:v.jsx(qe,{h:"48px",bg:"whiteAlpha.900",_dark:{bg:"gray.800"},backdropFilter:"blur(8px)",border:"1px solid",borderTop:"none",borderColor:"border.subtle",borderBottomRadius:"md",boxShadow:"xl",display:"flex",alignItems:"center",children:e})})})})]})}var zbe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ube(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var EG={exports:{}};(function(i,e){(function(){var t,n;n=function(r){return i.exports=r},t={linear:function(r,s,a,o){return a*r/o+s},easeInQuad:function(r,s,a,o){return a*(r/=o)*r+s},easeOutQuad:function(r,s,a,o){return-a*(r/=o)*(r-2)+s},easeInOutQuad:function(r,s,a,o){return(r/=o/2)<1?a/2*r*r+s:-a/2*(--r*(r-2)-1)+s},easeInCubic:function(r,s,a,o){return a*(r/=o)*r*r+s},easeOutCubic:function(r,s,a,o){return a*((r=r/o-1)*r*r+1)+s},easeInOutCubic:function(r,s,a,o){return(r/=o/2)<1?a/2*r*r*r+s:a/2*((r-=2)*r*r+2)+s},easeInQuart:function(r,s,a,o){return a*(r/=o)*r*r*r+s},easeOutQuart:function(r,s,a,o){return-a*((r=r/o-1)*r*r*r-1)+s},easeInOutQuart:function(r,s,a,o){return(r/=o/2)<1?a/2*r*r*r*r+s:-a/2*((r-=2)*r*r*r-2)+s},easeInQuint:function(r,s,a,o){return a*(r/=o)*r*r*r*r+s},easeOutQuint:function(r,s,a,o){return a*((r=r/o-1)*r*r*r*r+1)+s},easeInOutQuint:function(r,s,a,o){return(r/=o/2)<1?a/2*r*r*r*r*r+s:a/2*((r-=2)*r*r*r*r+2)+s},easeInSine:function(r,s,a,o){return-a*Math.cos(r/o*(Math.PI/2))+a+s},easeOutSine:function(r,s,a,o){return a*Math.sin(r/o*(Math.PI/2))+s},easeInOutSine:function(r,s,a,o){return-a/2*(Math.cos(Math.PI*r/o)-1)+s},easeInExpo:function(r,s,a,o){return r===0?s:a*Math.pow(2,10*(r/o-1))+s},easeOutExpo:function(r,s,a,o){return r===o?s+a:a*(-Math.pow(2,-10*r/o)+1)+s},easeInOutExpo:function(r,s,a,o){return(r/=o/2)<1?a/2*Math.pow(2,10*(r-1))+s:a/2*(-Math.pow(2,-10*--r)+2)+s},easeInCirc:function(r,s,a,o){return-a*(Math.sqrt(1-(r/=o)*r)-1)+s},easeOutCirc:function(r,s,a,o){return a*Math.sqrt(1-(r=r/o-1)*r)+s},easeInOutCirc:function(r,s,a,o){return(r/=o/2)<1?-a/2*(Math.sqrt(1-r*r)-1)+s:a/2*(Math.sqrt(1-(r-=2)*r)+1)+s},easeInElastic:function(r,s,a,o){var l,c,u;return u=1.70158,c=0,l=a,r===0||(r/=o),c||(c=o*.3),l<Math.abs(a)?(l=a,u=c/4):u=c/(2*Math.PI)*Math.asin(a/l),-(l*Math.pow(2,10*(r-=1))*Math.sin((r*o-u)*(2*Math.PI)/c))+s},easeOutElastic:function(r,s,a,o){var l,c,u;return u=1.70158,c=0,l=a,r===0||(r/=o),c||(c=o*.3),l<Math.abs(a)?(l=a,u=c/4):u=c/(2*Math.PI)*Math.asin(a/l),l*Math.pow(2,-10*r)*Math.sin((r*o-u)*(2*Math.PI)/c)+a+s},easeInOutElastic:function(r,s,a,o){var l,c,u;return u=1.70158,c=0,l=a,r===0||(r/=o/2),c||(c=o*(.3*1.5)),l<Math.abs(a)?(l=a,u=c/4):u=c/(2*Math.PI)*Math.asin(a/l),r<1?-.5*(l*Math.pow(2,10*(r-=1))*Math.sin((r*o-u)*(2*Math.PI)/c))+s:l*Math.pow(2,-10*(r-=1))*Math.sin((r*o-u)*(2*Math.PI)/c)*.5+a+s},easeInBack:function(r,s,a,o,l){return l===void 0&&(l=1.70158),a*(r/=o)*r*((l+1)*r-l)+s},easeOutBack:function(r,s,a,o,l){return l===void 0&&(l=1.70158),a*((r=r/o-1)*r*((l+1)*r+l)+1)+s},easeInOutBack:function(r,s,a,o,l){return l===void 0&&(l=1.70158),(r/=o/2)<1?a/2*(r*r*(((l*=1.525)+1)*r-l))+s:a/2*((r-=2)*r*(((l*=1.525)+1)*r+l)+2)+s},easeInBounce:function(r,s,a,o){var l;return l=t.easeOutBounce(o-r,0,a,o),a-l+s},easeOutBounce:function(r,s,a,o){return(r/=o)<1/2.75?a*(7.5625*r*r)+s:r<2/2.75?a*(7.5625*(r-=1.5/2.75)*r+.75)+s:r<2.5/2.75?a*(7.5625*(r-=2.25/2.75)*r+.9375)+s:a*(7.5625*(r-=2.625/2.75)*r+.984375)+s},easeInOutBounce:function(r,s,a,o){var l;return r<o/2?(l=t.easeInBounce(r*2,0,a,o),l*.5+s):(l=t.easeOutBounce(r*2-o,0,a,o),l*.5+a*.5+s)}},n(t)}).call(zbe)})(EG);var Fbe=EG.exports;const LN=Ube(Fbe);function o_(i,e){if(i){if(typeof i=="function")return i;if(typeof i=="string")return LN[i]}else return LN[e]}class Bbe{constructor(e){this.viewport=e,this.touches=[],this.addListeners()}addListeners(){this.viewport.eventMode="static",this.viewport.forceHitArea||(this.viewport.hitArea=new Qn(0,0,this.viewport.worldWidth,this.viewport.worldHeight)),this.viewport.on("pointerdown",this.down,this),this.viewport.options.allowPreserveDragOutside?this.viewport.on("globalpointermove",this.move,this):this.viewport.on("pointermove",this.move,this),this.viewport.on("pointerup",this.up,this),this.viewport.on("pointerupoutside",this.up,this),this.viewport.on("pointercancel",this.up,this),this.viewport.options.allowPreserveDragOutside||this.viewport.on("pointerleave",this.up,this),this.wheelFunction=e=>this.handleWheel(e),this.viewport.options.events.domElement.addEventListener("wheel",this.wheelFunction,{passive:this.viewport.options.passiveWheel}),this.isMouseDown=!1}destroy(){var e;(e=this.viewport.options.events.domElement)==null||e.removeEventListener("wheel",this.wheelFunction)}down(e){if(!(this.viewport.pause||!this.viewport.visible)){if(e.pointerType==="mouse"?this.isMouseDown=!0:this.get(e.pointerId)||this.touches.push({id:e.pointerId,last:null}),this.count()===1){this.last=e.global.clone();const t=this.viewport.plugins.get("decelerate",!0),n=this.viewport.plugins.get("bounce",!0);(!t||!t.isActive())&&(!n||!n.isActive())?this.clickedAvailable=!0:this.clickedAvailable=!1}else this.clickedAvailable=!1;this.viewport.plugins.down(e)&&this.viewport.options.stopPropagation&&e.stopPropagation()}}clear(){this.isMouseDown=!1,this.touches=[],this.last=null}checkThreshold(e){return Math.abs(e)>=this.viewport.threshold}move(e){if(this.viewport.pause||!this.viewport.visible)return;const t=this.viewport.plugins.move(e);if(this.clickedAvailable&&this.last){const n=e.global.x-this.last.x,r=e.global.y-this.last.y;(this.checkThreshold(n)||this.checkThreshold(r))&&(this.clickedAvailable=!1)}t&&this.viewport.options.stopPropagation&&e.stopPropagation()}up(e){if(this.viewport.pause||!this.viewport.visible)return;e.pointerType==="mouse"&&(this.isMouseDown=!1),e.pointerType!=="mouse"&&this.remove(e.pointerId);const t=this.viewport.plugins.up(e);this.clickedAvailable&&this.count()===0&&this.last&&(this.viewport.emit("clicked",{event:e,screen:this.last,world:this.viewport.toWorld(this.last),viewport:this.viewport}),this.clickedAvailable=!1),t&&this.viewport.options.stopPropagation&&e.stopPropagation()}getPointerPosition(e){const t=new Sn;return this.viewport.options.events.mapPositionToPoint(t,e.clientX,e.clientY),t}handleWheel(e){if(this.viewport.pause||!this.viewport.visible)return;const t=this.viewport.toLocal(this.getPointerPosition(e));this.viewport.left<=t.x&&t.x<=this.viewport.right&&this.viewport.top<=t.y&&t.y<=this.viewport.bottom&&this.viewport.plugins.wheel(e)&&!this.viewport.options.passiveWheel&&e.preventDefault()}pause(){this.touches=[],this.isMouseDown=!1}get(e){for(const t of this.touches)if(t.id===e)return t;return null}remove(e){for(let t=0;t<this.touches.length;t++)if(this.touches[t].id===e){this.touches.splice(t,1);return}}count(){return(this.isMouseDown?1:0)+this.touches.length}}const Gp=["drag","pinch","wheel","follow","mouse-edges","decelerate","animate","bounce","snap-zoom","clamp-zoom","snap","clamp"];class Hbe{constructor(e){this.viewport=e,this.list=[],this.plugins={}}add(e,t,n=Gp.length){const r=this.plugins[e];r&&r.destroy(),this.plugins[e]=t;const s=Gp.indexOf(e);s!==-1&&Gp.splice(s,1),Gp.splice(n,0,e),this.sort()}get(e,t){var n;return t&&(n=this.plugins[e])!=null&&n.paused?null:this.plugins[e]}update(e){for(const t of this.list)t.update(e)}resize(){for(const e of this.list)e.resize()}reset(){for(const e of this.list)e.reset()}removeAll(){this.list.forEach(e=>{e.destroy()}),this.plugins={},this.sort()}remove(e){var t;this.plugins[e]&&((t=this.plugins[e])==null||t.destroy(),delete this.plugins[e],this.viewport.emit("plugin-remove",e),this.sort())}pause(e){var t;(t=this.plugins[e])==null||t.pause()}resume(e){var t;(t=this.plugins[e])==null||t.resume()}sort(){this.list=[];for(const e of Gp)this.plugins[e]&&this.list.push(this.plugins[e])}down(e){let t=!1;for(const n of this.list)n.down(e)&&(t=!0);return t}move(e){let t=!1;for(const n of this.viewport.plugins.list)n.move(e)&&(t=!0);return t}up(e){let t=!1;for(const n of this.list)n.up(e)&&(t=!0);return t}wheel(e){let t=!1;for(const n of this.list)n.wheel(e)&&(t=!0);return t}}class Wa{constructor(e){this.parent=e,this.paused=!1}destroy(){}down(e){return!1}move(e){return!1}up(e){return!1}wheel(e){return!1}update(e){}resize(){}reset(){}pause(){this.paused=!0}resume(){this.paused=!1}}const jbe={removeOnInterrupt:!1,ease:"linear",time:1e3};class Vbe extends Wa{constructor(e,t={}){super(e),this.startWidth=null,this.startHeight=null,this.deltaWidth=null,this.deltaHeight=null,this.width=null,this.height=null,this.time=0,this.options=Object.assign({},jbe,t),this.options.ease=o_(this.options.ease),this.setupPosition(),this.setupZoom(),this.time=0}setupPosition(){typeof this.options.position<"u"?(this.startX=this.parent.center.x,this.startY=this.parent.center.y,this.deltaX=this.options.position.x-this.parent.center.x,this.deltaY=this.options.position.y-this.parent.center.y,this.keepCenter=!1):this.keepCenter=!0}setupZoom(){this.width=null,this.height=null,typeof this.options.scale<"u"?this.width=this.parent.screenWidth/this.options.scale:typeof this.options.scaleX<"u"||typeof this.options.scaleY<"u"?(typeof this.options.scaleX<"u"&&(this.width=this.parent.screenWidth/this.options.scaleX),typeof this.options.scaleY<"u"&&(this.height=this.parent.screenHeight/this.options.scaleY)):(typeof this.options.width<"u"&&(this.width=this.options.width),typeof this.options.height<"u"&&(this.height=this.options.height)),this.width!==null&&(this.startWidth=this.parent.screenWidthInWorldPixels,this.deltaWidth=this.width-this.startWidth),this.height!==null&&(this.startHeight=this.parent.screenHeightInWorldPixels,this.deltaHeight=this.height-this.startHeight)}down(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("animate"),!1}complete(){this.parent.plugins.remove("animate"),this.width!==null&&this.parent.fitWidth(this.width,this.keepCenter,this.height===null),this.height!==null&&this.parent.fitHeight(this.height,this.keepCenter,this.width===null),!this.keepCenter&&this.options.position&&this.parent.moveCenter(this.options.position),this.parent.emit("animate-end",this.parent),this.options.callbackOnComplete&&this.options.callbackOnComplete(this.parent)}update(e){if(this.paused)return;this.time+=e;const t=new Sn(this.parent.scale.x,this.parent.scale.y);if(this.time>=this.options.time){const n=this.parent.width,r=this.parent.height;this.complete(),(n!==this.parent.width||r!==this.parent.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:t,type:"animate"})}else{const n=this.options.ease(this.time,0,1,this.options.time);if(this.width!==null){const r=this.startWidth,s=this.deltaWidth;this.parent.fitWidth(r+s*n,this.keepCenter,this.height===null)}if(this.height!==null){const r=this.startHeight,s=this.deltaHeight;this.parent.fitHeight(r+s*n,this.keepCenter,this.width===null)}if(this.width===null?this.parent.scale.x=this.parent.scale.y:this.height===null&&(this.parent.scale.y=this.parent.scale.x),!this.keepCenter){const r=this.startX,s=this.startY,a=this.deltaX,o=this.deltaY,l=new Sn(this.parent.x,this.parent.y);this.parent.moveCenter(r+a*n,s+o*n),this.parent.emit("moved",{viewport:this.parent,original:l,type:"animate"})}(this.width||this.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:t,type:"animate"})}}}const Gbe={sides:"all",friction:.5,time:150,ease:"easeInOutSine",underflow:"center",bounceBox:null};class Wbe extends Wa{constructor(e,t={}){super(e),this.options=Object.assign({},Gbe,t),this.ease=o_(this.options.ease,"easeInOutSine"),this.options.sides?this.options.sides==="all"?this.top=this.bottom=this.left=this.right=!0:this.options.sides==="horizontal"?(this.right=this.left=!0,this.top=this.bottom=!1):this.options.sides==="vertical"?(this.left=this.right=!1,this.top=this.bottom=!0):(this.top=this.options.sides.indexOf("top")!==-1,this.bottom=this.options.sides.indexOf("bottom")!==-1,this.left=this.options.sides.indexOf("left")!==-1,this.right=this.options.sides.indexOf("right")!==-1):this.left=this.top=this.right=this.bottom=!1;const n=this.options.underflow.toLowerCase();n==="center"?(this.underflowX=0,this.underflowY=0):(this.underflowX=n.indexOf("left")!==-1?-1:n.indexOf("right")!==-1?1:0,this.underflowY=n.indexOf("top")!==-1?-1:n.indexOf("bottom")!==-1?1:0),this.reset()}isActive(){return this.toX!==null||this.toY!==null}down(){return this.toX=this.toY=null,!1}up(){return this.bounce(),!1}update(e){if(!this.paused){if(this.bounce(),this.toX){const t=this.toX;t.time+=e,this.parent.emit("moved",{viewport:this.parent,type:"bounce-x"}),t.time>=this.options.time?(this.parent.x=t.end,this.toX=null,this.parent.emit("bounce-x-end",this.parent)):this.parent.x=this.ease(t.time,t.start,t.delta,this.options.time)}if(this.toY){const t=this.toY;t.time+=e,this.parent.emit("moved",{viewport:this.parent,type:"bounce-y"}),t.time>=this.options.time?(this.parent.y=t.end,this.toY=null,this.parent.emit("bounce-y-end",this.parent)):this.parent.y=this.ease(t.time,t.start,t.delta,this.options.time)}}}calcUnderflowX(){let e;switch(this.underflowX){case-1:e=0;break;case 1:e=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:e=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}return e}calcUnderflowY(){let e;switch(this.underflowY){case-1:e=0;break;case 1:e=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:e=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}return e}oob(){const e=this.options.bounceBox;if(e){const t=typeof e.x>"u"?0:e.x,n=typeof e.y>"u"?0:e.y,r=typeof e.width>"u"?this.parent.worldWidth:e.width,s=typeof e.height>"u"?this.parent.worldHeight:e.height;return{left:this.parent.left<t,right:this.parent.right>r,top:this.parent.top<n,bottom:this.parent.bottom>s,topLeft:new Sn(t*this.parent.scale.x,n*this.parent.scale.y),bottomRight:new Sn(r*this.parent.scale.x-this.parent.screenWidth,s*this.parent.scale.y-this.parent.screenHeight)}}return{left:this.parent.left<0,right:this.parent.right>this.parent.worldWidth,top:this.parent.top<0,bottom:this.parent.bottom>this.parent.worldHeight,topLeft:new Sn(0,0),bottomRight:new Sn(this.parent.worldWidth*this.parent.scale.x-this.parent.screenWidth,this.parent.worldHeight*this.parent.scale.y-this.parent.screenHeight)}}bounce(){var e,t;if(this.paused)return;let n,r=this.parent.plugins.get("decelerate",!0);r&&(r.x||r.y)&&(r.x&&r.percentChangeX===((e=r.options)==null?void 0:e.friction)||r.y&&r.percentChangeY===((t=r.options)==null?void 0:t.friction))&&(n=this.oob(),(n.left&&this.left||n.right&&this.right)&&(r.percentChangeX=this.options.friction),(n.top&&this.top||n.bottom&&this.bottom)&&(r.percentChangeY=this.options.friction));const s=this.parent.plugins.get("drag",!0)||{},a=this.parent.plugins.get("pinch",!0)||{};if(r=r||{},!(s!=null&&s.active)&&!(a!=null&&a.active)&&(!this.toX||!this.toY)&&(!r.x||!r.y)){n=n||this.oob();const o=n.topLeft,l=n.bottomRight;if(!this.toX&&!r.x){let c=null;n.left&&this.left?c=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-o.x:n.right&&this.right&&(c=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-l.x),c!==null&&this.parent.x!==c&&(this.toX={time:0,start:this.parent.x,delta:c-this.parent.x,end:c},this.parent.emit("bounce-x-start",this.parent))}if(!this.toY&&!r.y){let c=null;n.top&&this.top?c=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-o.y:n.bottom&&this.bottom&&(c=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-l.y),c!==null&&this.parent.y!==c&&(this.toY={time:0,start:this.parent.y,delta:c-this.parent.y,end:c},this.parent.emit("bounce-y-start",this.parent))}}}reset(){this.toX=this.toY=null,this.bounce()}}const qbe={left:!1,right:!1,top:!1,bottom:!1,direction:null,underflow:"center"};class Xbe extends Wa{constructor(e,t={}){super(e),this.options=Object.assign({},qbe,t),this.options.direction&&(this.options.left=this.options.direction==="x"||this.options.direction==="all"?!0:null,this.options.right=this.options.direction==="x"||this.options.direction==="all"?!0:null,this.options.top=this.options.direction==="y"||this.options.direction==="all"?!0:null,this.options.bottom=this.options.direction==="y"||this.options.direction==="all"?!0:null),this.parseUnderflow(),this.last={x:null,y:null,scaleX:null,scaleY:null},this.update()}parseUnderflow(){const e=this.options.underflow.toLowerCase();e==="none"?this.noUnderflow=!0:e==="center"?(this.underflowX=this.underflowY=0,this.noUnderflow=!1):(this.underflowX=e.indexOf("left")!==-1?-1:e.indexOf("right")!==-1?1:0,this.underflowY=e.indexOf("top")!==-1?-1:e.indexOf("bottom")!==-1?1:0,this.noUnderflow=!1)}move(){return this.update(),!1}update(){if(this.paused||this.parent.x===this.last.x&&this.parent.y===this.last.y&&this.parent.scale.x===this.last.scaleX&&this.parent.scale.y===this.last.scaleY)return;const e=new Sn(this.parent.x,this.parent.y),t=this.parent.plugins.decelerate||{};if(this.options.left!==null||this.options.right!==null){let n=!1;if(!this.noUnderflow&&this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x!==0&&(this.parent.x=0,n=!0);break;case 1:this.parent.x!==this.parent.screenWidth-this.parent.screenWorldWidth&&(this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth,n=!0);break;default:this.parent.x!==(this.parent.screenWidth-this.parent.screenWorldWidth)/2&&(this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2,n=!0)}else this.options.left!==null&&this.parent.left<(this.options.left===!0?0:this.options.left)&&(this.parent.x=-(this.options.left===!0?0:this.options.left)*this.parent.scale.x,t.x=0,n=!0),this.options.right!==null&&this.parent.right>(this.options.right===!0?this.parent.worldWidth:this.options.right)&&(this.parent.x=-(this.options.right===!0?this.parent.worldWidth:this.options.right)*this.parent.scale.x+this.parent.screenWidth,t.x=0,n=!0);n&&this.parent.emit("moved",{viewport:this.parent,original:e,type:"clamp-x"})}if(this.options.top!==null||this.options.bottom!==null){let n=!1;if(!this.noUnderflow&&this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y!==0&&(this.parent.y=0,n=!0);break;case 1:this.parent.y!==this.parent.screenHeight-this.parent.screenWorldHeight&&(this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight,n=!0);break;default:this.parent.y!==(this.parent.screenHeight-this.parent.screenWorldHeight)/2&&(this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2,n=!0)}else this.options.top!==null&&this.parent.top<(this.options.top===!0?0:this.options.top)&&(this.parent.y=-(this.options.top===!0?0:this.options.top)*this.parent.scale.y,t.y=0,n=!0),this.options.bottom!==null&&this.parent.bottom>(this.options.bottom===!0?this.parent.worldHeight:this.options.bottom)&&(this.parent.y=-(this.options.bottom===!0?this.parent.worldHeight:this.options.bottom)*this.parent.scale.y+this.parent.screenHeight,t.y=0,n=!0);n&&this.parent.emit("moved",{viewport:this.parent,original:e,type:"clamp-y"})}this.last.x=this.parent.x,this.last.y=this.parent.y,this.last.scaleX=this.parent.scale.x,this.last.scaleY=this.parent.scale.y}reset(){this.update()}}const Ybe={minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,minScale:null,maxScale:null};class $be extends Wa{constructor(e,t={}){super(e),this.options=Object.assign({},Ybe,t),this.clamp()}resize(){this.clamp()}clamp(){if(!this.paused){if(this.options.minWidth||this.options.minHeight||this.options.maxWidth||this.options.maxHeight){let e=this.parent.worldScreenWidth,t=this.parent.worldScreenHeight;if(this.options.minWidth!==null&&e<this.options.minWidth){const n=this.parent.scale.x;this.parent.fitWidth(this.options.minWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/n,e=this.parent.worldScreenWidth,t=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.maxWidth!==null&&e>this.options.maxWidth){const n=this.parent.scale.x;this.parent.fitWidth(this.options.maxWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/n,e=this.parent.worldScreenWidth,t=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.minHeight!==null&&t<this.options.minHeight){const n=this.parent.scale.y;this.parent.fitHeight(this.options.minHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/n,e=this.parent.worldScreenWidth,t=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.maxHeight!==null&&t>this.options.maxHeight){const n=this.parent.scale.y;this.parent.fitHeight(this.options.maxHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/n,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}}else if(this.options.minScale||this.options.maxScale){const e={x:null,y:null},t={x:null,y:null};if(typeof this.options.minScale=="number")e.x=this.options.minScale,e.y=this.options.minScale;else if(this.options.minScale!==null){const s=this.options.minScale;e.x=typeof s.x>"u"?null:s.x,e.y=typeof s.y>"u"?null:s.y}if(typeof this.options.maxScale=="number")t.x=this.options.maxScale,t.y=this.options.maxScale;else if(this.options.maxScale!==null){const s=this.options.maxScale;t.x=typeof s.x>"u"?null:s.x,t.y=typeof s.y>"u"?null:s.y}let n=this.parent.scale.x,r=this.parent.scale.y;e.x!==null&&n<e.x&&(n=e.x),t.x!==null&&n>t.x&&(n=t.x),e.y!==null&&r<e.y&&(r=e.y),t.y!==null&&r>t.y&&(r=t.y),(n!==this.parent.scale.x||r!==this.parent.scale.y)&&(this.parent.scale.set(n,r),this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"}))}}}reset(){this.clamp()}}const Kbe={friction:.98,bounce:.8,minSpeed:.01},Xc=16;class Zbe extends Wa{constructor(e,t={}){super(e),this.options=Object.assign({},Kbe,t),this.saved=[],this.timeSinceRelease=0,this.reset(),this.parent.on("moved",n=>this.handleMoved(n))}down(){return this.saved=[],this.x=this.y=null,!1}isActive(){return!!(this.x||this.y)}move(){if(this.paused)return!1;const e=this.parent.input.count();return(e===1||e>1&&!this.parent.plugins.get("pinch",!0))&&(this.saved.push({x:this.parent.x,y:this.parent.y,time:performance.now()}),this.saved.length>60&&this.saved.splice(0,30)),!1}handleMoved(e){if(this.saved.length){const t=this.saved[this.saved.length-1];e.type==="clamp-x"&&e.original?t.x===e.original.x&&(t.x=this.parent.x):e.type==="clamp-y"&&e.original&&t.y===e.original.y&&(t.y=this.parent.y)}}up(){if(this.parent.input.count()===0&&this.saved.length){const e=performance.now();for(const t of this.saved)if(t.time>=e-100){const n=e-t.time;this.x=(this.parent.x-t.x)/n,this.y=(this.parent.y-t.y)/n,this.percentChangeX=this.percentChangeY=this.options.friction,this.timeSinceRelease=0;break}}return!1}activate(e){e=e||{},typeof e.x<"u"&&(this.x=e.x,this.percentChangeX=this.options.friction),typeof e.y<"u"&&(this.y=e.y,this.percentChangeY=this.options.friction)}update(e){if(this.paused)return;const t=this.x||this.y,n=this.timeSinceRelease,r=this.timeSinceRelease+e;if(this.x){const s=this.percentChangeX,a=Math.log(s);this.parent.x+=this.x*Xc/a*(Math.pow(s,r/Xc)-Math.pow(s,n/Xc)),this.x*=Math.pow(this.percentChangeX,e/Xc)}if(this.y){const s=this.percentChangeY,a=Math.log(s);this.parent.y+=this.y*Xc/a*(Math.pow(s,r/Xc)-Math.pow(s,n/Xc)),this.y*=Math.pow(this.percentChangeY,e/Xc)}this.timeSinceRelease+=e,this.x&&this.y?Math.abs(this.x)<this.options.minSpeed&&Math.abs(this.y)<this.options.minSpeed&&(this.x=0,this.y=0):(Math.abs(this.x||0)<this.options.minSpeed&&(this.x=0),Math.abs(this.y||0)<this.options.minSpeed&&(this.y=0)),t&&this.parent.emit("moved",{viewport:this.parent,type:"decelerate"})}reset(){this.x=this.y=null}}const Qbe={direction:"all",pressDrag:!0,wheel:!0,wheelScroll:1,reverse:!1,clampWheel:!1,underflow:"center",factor:1,mouseButtons:"all",keyToPress:null,ignoreKeyToPressOnTouch:!1,lineHeight:20,wheelSwapAxes:!1};class Jbe extends Wa{constructor(e,t={}){super(e),this.windowEventHandlers=[],this.options=Object.assign({},Qbe,t),this.moved=!1,this.reverse=this.options.reverse?1:-1,this.xDirection=!this.options.direction||this.options.direction==="all"||this.options.direction==="x",this.yDirection=!this.options.direction||this.options.direction==="all"||this.options.direction==="y",this.keyIsPressed=!1,this.parseUnderflow(),this.mouseButtons(this.options.mouseButtons),this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(e){const t=r=>{e.includes(r.code)&&(this.keyIsPressed=!0)},n=r=>{e.includes(r.code)&&(this.keyIsPressed=!1)};this.addWindowEventHandler("keyup",n),this.addWindowEventHandler("keydown",t)}addWindowEventHandler(e,t){typeof window>"u"||(window.addEventListener(e,t),this.windowEventHandlers.push({event:e,handler:t}))}destroy(){typeof window>"u"||this.windowEventHandlers.forEach(({event:e,handler:t})=>{window.removeEventListener(e,t)})}mouseButtons(e){!e||e==="all"?this.mouse=[!0,!0,!0]:this.mouse=[e.indexOf("left")!==-1,e.indexOf("middle")!==-1,e.indexOf("right")!==-1]}parseUnderflow(){const e=this.options.underflow.toLowerCase();e==="center"?(this.underflowX=0,this.underflowY=0):(e.includes("left")?this.underflowX=-1:e.includes("right")?this.underflowX=1:this.underflowX=0,e.includes("top")?this.underflowY=-1:e.includes("bottom")?this.underflowY=1:this.underflowY=0)}checkButtons(e){const t=e.pointerType==="mouse",n=this.parent.input.count();return!!((n===1||n>1&&!this.parent.plugins.get("pinch",!0))&&(!t||this.mouse[e.button]))}checkKeyPress(e){return!this.options.keyToPress||this.keyIsPressed||this.options.ignoreKeyToPressOnTouch&&e.data.pointerType==="touch"}down(e){return this.paused||!this.options.pressDrag?!1:this.checkButtons(e)&&this.checkKeyPress(e)?(this.last={x:e.global.x,y:e.global.y},(this.parent.parent||this.parent).toLocal(this.last,void 0,this.last),this.current=e.pointerId,!0):(this.last=null,!1)}get active(){return this.moved}move(e){if(this.paused||!this.options.pressDrag)return!1;if(this.last&&this.current===e.data.pointerId){const t=e.global.x,n=e.global.y,r=this.parent.input.count();if(r===1||r>1&&!this.parent.plugins.get("pinch",!0)){const s={x:t,y:n};(this.parent.parent||this.parent).toLocal(s,void 0,s);const a=s.x-this.last.x,o=s.y-this.last.y;if(this.moved||this.xDirection&&this.parent.input.checkThreshold(a)||this.yDirection&&this.parent.input.checkThreshold(o))return this.xDirection&&(this.parent.x+=(s.x-this.last.x)*this.options.factor),this.yDirection&&(this.parent.y+=(s.y-this.last.y)*this.options.factor),this.last=s,this.moved||this.parent.emit("drag-start",{event:e,screen:new Sn(this.last.x,this.last.y),world:this.parent.toWorld(new Sn(this.last.x,this.last.y)),viewport:this.parent}),this.moved=!0,this.parent.emit("moved",{viewport:this.parent,type:"drag"}),!0}else this.moved=!1}return!1}up(e){if(this.paused)return!1;const t=this.parent.input.touches;if(t.length===1){const n=t[0];return n.last&&(this.last={x:n.last.x,y:n.last.y},this.current=n.id),this.moved=!1,!0}else if(this.last&&this.moved){const n=new Sn(this.last.x,this.last.y);return(this.parent.parent||this.parent).toGlobal(n,n,!0),this.parent.emit("drag-end",{event:e,screen:n,world:this.parent.toWorld(n),viewport:this.parent}),this.last=null,this.moved=!1,!0}return!1}wheel(e){if(this.paused)return!1;if(this.options.wheel){const t=this.parent.plugins.get("wheel",!0);if(!t||!t.options.wheelZoom&&!e.ctrlKey){const n=e.deltaMode?this.options.lineHeight:1,r=[e.deltaX,e.deltaY],[s,a]=this.options.wheelSwapAxes?r.reverse():r;return this.xDirection&&(this.parent.x+=s*n*this.options.wheelScroll*this.reverse),this.yDirection&&(this.parent.y+=a*n*this.options.wheelScroll*this.reverse),this.options.clampWheel&&this.clamp(),this.parent.emit("wheel-scroll",this.parent),this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.options.passiveWheel||e.preventDefault(),this.parent.options.stopPropagation&&e.stopPropagation(),!0}}return!1}resume(){this.last=null,this.paused=!1}clamp(){const e=this.parent.plugins.get("decelerate",!0)||{};if(this.options.clampWheel!=="y")if(this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x=0;break;case 1:this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}else this.parent.left<0?(this.parent.x=0,e.x=0):this.parent.right>this.parent.worldWidth&&(this.parent.x=-this.parent.worldWidth*this.parent.scale.x+this.parent.screenWidth,e.x=0);if(this.options.clampWheel!=="x")if(this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y=0;break;case 1:this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}else this.parent.top<0&&(this.parent.y=0,e.y=0),this.parent.bottom>this.parent.worldHeight&&(this.parent.y=-this.parent.worldHeight*this.parent.scale.y+this.parent.screenHeight,e.y=0)}}const e2e={speed:0,acceleration:null,radius:null};class t2e extends Wa{constructor(e,t,n={}){super(e),this.target=t,this.options=Object.assign({},e2e,n),this.velocity={x:0,y:0}}update(e){if(this.paused)return;const t=this.parent.center;let n=this.target.x,r=this.target.y;if(this.options.radius)if(Math.sqrt(Math.pow(this.target.y-t.y,2)+Math.pow(this.target.x-t.x,2))>this.options.radius){const o=Math.atan2(this.target.y-t.y,this.target.x-t.x);n=this.target.x-Math.cos(o)*this.options.radius,r=this.target.y-Math.sin(o)*this.options.radius}else return;const s=n-t.x,a=r-t.y;if(s||a)if(this.options.speed)if(this.options.acceleration){const o=Math.atan2(r-t.y,n-t.x),l=Math.sqrt(Math.pow(s,2)+Math.pow(a,2));if(l){const c=(Math.pow(this.velocity.x,2)+Math.pow(this.velocity.y,2))/(2*this.options.acceleration);l>c?this.velocity={x:Math.min(this.velocity.x+(this.options.acceleration*e,this.options.speed)),y:Math.min(this.velocity.y+(this.options.acceleration*e,this.options.speed))}:this.velocity={x:Math.max(this.velocity.x-this.options.acceleration*this.options.speed,0),y:Math.max(this.velocity.y-this.options.acceleration*this.options.speed,0)};const u=Math.cos(o)*this.velocity.x,d=Math.sin(o)*this.velocity.y,p=Math.abs(u)>Math.abs(s)?n:t.x+u,m=Math.abs(d)>Math.abs(a)?r:t.y+d;this.parent.moveCenter(p,m),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}else{const o=Math.atan2(r-t.y,n-t.x),l=Math.cos(o)*this.options.speed,c=Math.sin(o)*this.options.speed,u=Math.abs(l)>Math.abs(s)?n:t.x+l,d=Math.abs(c)>Math.abs(a)?r:t.y+c;this.parent.moveCenter(u,d),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}else this.parent.moveCenter(n,r),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}const n2e={radius:null,distance:null,top:null,bottom:null,left:null,right:null,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1};class i2e extends Wa{constructor(e,t={}){super(e),this.options=Object.assign({},n2e,t),this.reverse=this.options.reverse?1:-1,this.radiusSquared=typeof this.options.radius=="number"?Math.pow(this.options.radius,2):null,this.resize()}resize(){const e=this.options.distance;e!==null?(this.left=e,this.top=e,this.right=this.parent.screenWidth-e,this.bottom=this.parent.screenHeight-e):this.options.radius||(this.left=this.options.left,this.top=this.options.top,this.right=this.options.right===null?null:this.parent.screenWidth-this.options.right,this.bottom=this.options.bottom===null?null:this.parent.screenHeight-this.options.bottom)}down(){return this.paused||this.options.allowButtons||(this.horizontal=this.vertical=null),!1}move(e){if(this.paused||e.pointerType!=="mouse"&&e.pointerId!==1||!this.options.allowButtons&&e.buttons!==0)return!1;const t=e.global.x,n=e.global.y;if(this.radiusSquared){const r=this.parent.toScreen(this.parent.center);if(Math.pow(r.x-t,2)+Math.pow(r.y-n,2)>=this.radiusSquared){const s=Math.atan2(r.y-n,r.x-t);this.options.linear?(this.horizontal=Math.round(Math.cos(s))*this.options.speed*this.reverse*(60/1e3),this.vertical=Math.round(Math.sin(s))*this.options.speed*this.reverse*(60/1e3)):(this.horizontal=Math.cos(s)*this.options.speed*this.reverse*(60/1e3),this.vertical=Math.sin(s)*this.options.speed*this.reverse*(60/1e3))}else this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=0}else this.left!==null&&t<this.left?this.horizontal=Number(this.reverse)*this.options.speed*(60/1e3):this.right!==null&&t>this.right?this.horizontal=-1*this.reverse*this.options.speed*(60/1e3):(this.decelerateHorizontal(),this.horizontal=0),this.top!==null&&n<this.top?this.vertical=Number(this.reverse)*this.options.speed*(60/1e3):this.bottom!==null&&n>this.bottom?this.vertical=-1*this.reverse*this.options.speed*(60/1e3):(this.decelerateVertical(),this.vertical=0);return!1}decelerateHorizontal(){const e=this.parent.plugins.get("decelerate",!0);this.horizontal&&e&&!this.options.noDecelerate&&e.activate({x:this.horizontal*this.options.speed*this.reverse/(1e3/60)})}decelerateVertical(){const e=this.parent.plugins.get("decelerate",!0);this.vertical&&e&&!this.options.noDecelerate&&e.activate({y:this.vertical*this.options.speed*this.reverse/(1e3/60)})}up(){return this.paused||(this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=null),!1}update(){if(!this.paused&&(this.horizontal||this.vertical)){const e=this.parent.center;this.horizontal&&(e.x+=this.horizontal*this.options.speed),this.vertical&&(e.y+=this.vertical*this.options.speed),this.parent.moveCenter(e),this.parent.emit("moved",{viewport:this.parent,type:"mouse-edges"})}}}const r2e={noDrag:!1,percent:1,center:null,factor:1,axis:"all"},s2e=new Sn;class a2e extends Wa{constructor(e,t={}){super(e),this.active=!1,this.pinching=!1,this.moved=!1,this.options=Object.assign({},r2e,t)}down(){return this.parent.input.count()>=2?(this.active=!0,!0):!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}move(e){if(this.paused||!this.active)return!1;const{x:t,y:n}=(this.parent.parent||this.parent).toLocal(e.global,void 0,s2e),r=this.parent.input.touches;if(r.length>=2){const s=r[0],a=r[1],o=s.last&&a.last?Math.sqrt(Math.pow(a.last.x-s.last.x,2)+Math.pow(a.last.y-s.last.y,2)):null;if(s.id===e.pointerId?s.last={x:t,y:n,data:e}:a.id===e.pointerId&&(a.last={x:t,y:n,data:e}),o){let l;const c=new Sn(s.last.x+(a.last.x-s.last.x)/2,s.last.y+(a.last.y-s.last.y)/2);this.options.center||(l=this.parent.toLocal(c,this.parent.parent||this.parent));let u=Math.sqrt(Math.pow(a.last.x-s.last.x,2)+Math.pow(a.last.y-s.last.y,2));u=u===0?u=1e-10:u;const d=(1-o/u)*this.options.percent*(this.isAxisX()?this.parent.scale.x:this.parent.scale.y);this.isAxisX()&&(this.parent.scale.x+=d),this.isAxisY()&&(this.parent.scale.y+=d),this.parent.emit("zoomed",{viewport:this.parent,type:"pinch",center:c});const p=this.parent.plugins.get("clamp-zoom",!0);if(p&&p.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const m=(this.parent.parent||this.parent).toLocal(l,this.parent);this.parent.x+=(c.x-m.x)*this.options.factor,this.parent.y+=(c.y-m.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})}!this.options.noDrag&&this.lastCenter&&(this.parent.x+=(c.x-this.lastCenter.x)*this.options.factor,this.parent.y+=(c.y-this.lastCenter.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})),this.lastCenter=c,this.moved=!0}else this.pinching||(this.parent.emit("pinch-start",this.parent),this.pinching=!0);return!0}return!1}up(){return this.pinching&&this.parent.input.touches.length<=1?(this.active=!1,this.lastCenter=null,this.pinching=!1,this.moved=!1,this.parent.emit("pinch-end",this.parent),!0):!1}}const o2e={topLeft:!1,friction:.8,time:1e3,ease:"easeInOutSine",interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1};class l2e extends Wa{constructor(e,t,n,r={}){super(e),this.options=Object.assign({},o2e,r),this.ease=o_(r.ease,"easeInOutSine"),this.x=t,this.y=n,this.options.forceStart&&this.snapStart()}snapStart(){this.percent=0,this.snapping={time:0};const e=this.options.topLeft?this.parent.corner:this.parent.center;this.deltaX=this.x-e.x,this.deltaY=this.y-e.y,this.startX=e.x,this.startY=e.y,this.parent.emit("snap-start",this.parent)}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap"):this.options.interrupt&&(this.snapping=null),!1}up(){if(this.parent.input.count()===0){const e=this.parent.plugins.get("decelerate",!0);e&&(e.x||e.y)&&(e.percentChangeX=e.percentChangeY=this.options.friction)}return!1}update(e){if(!this.paused&&!(this.options.interrupt&&this.parent.input.count()!==0))if(this.snapping){const t=this.snapping;t.time+=e;let n,r,s;const a=this.startX,o=this.startY,l=this.deltaX,c=this.deltaY;if(t.time>this.options.time)n=!0,r=a+l,s=o+c;else{const u=this.ease(t.time,0,1,this.options.time);r=a+l*u,s=o+c*u}this.options.topLeft?this.parent.moveCorner(r,s):this.parent.moveCenter(r,s),this.parent.emit("moved",{viewport:this.parent,type:"snap"}),n&&(this.options.removeOnComplete&&this.parent.plugins.remove("snap"),this.parent.emit("snap-end",this.parent),this.snapping=null)}else{const t=this.options.topLeft?this.parent.corner:this.parent.center;(t.x!==this.x||t.y!==this.y)&&this.snapStart()}}}const c2e={width:0,height:0,time:1e3,ease:"easeInOutSine",center:null,interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1,noMove:!1};class u2e extends Wa{constructor(e,t={}){super(e),this.options=Object.assign({},c2e,t),this.ease=o_(this.options.ease),this.xIndependent=!1,this.yIndependent=!1,this.xScale=0,this.yScale=0,this.options.width>0&&(this.xScale=e.screenWidth/this.options.width,this.xIndependent=!0),this.options.height>0&&(this.yScale=e.screenHeight/this.options.height,this.yIndependent=!0),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale,this.options.time===0?(e.container.scale.x=this.xScale,e.container.scale.y=this.yScale,this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom")):t.forceStart&&this.createSnapping()}createSnapping(){const e=this.parent.worldScreenWidth,t=this.parent.worldScreenHeight,n=this.parent.screenWidth/this.xScale,r=this.parent.screenHeight/this.yScale;this.snapping={time:0,startX:e,startY:t,deltaX:n-e,deltaY:r-t},this.parent.emit("snap-zoom-start",this.parent)}resize(){this.snapping=null,this.options.width>0&&(this.xScale=this.parent.screenWidth/this.options.width),this.options.height>0&&(this.yScale=this.parent.screenHeight/this.options.height),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap-zoom"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap-zoom"):this.options.interrupt&&(this.snapping=null),!1}update(e){if(this.paused||this.options.interrupt&&this.parent.input.count()!==0)return;let t;if(!this.options.center&&!this.options.noMove&&(t=this.parent.center),!this.snapping)(this.parent.scale.x!==this.xScale||this.parent.scale.y!==this.yScale)&&this.createSnapping();else if(this.snapping){const n=this.snapping;if(n.time+=e,n.time>=this.options.time)this.parent.scale.set(this.xScale,this.yScale),this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom"),this.parent.emit("snap-zoom-end",this.parent),this.snapping=null;else{const s=this.snapping,a=this.ease(s.time,s.startX,s.deltaX,this.options.time),o=this.ease(s.time,s.startY,s.deltaY,this.options.time);this.parent.scale.x=this.parent.screenWidth/a,this.parent.scale.y=this.parent.screenHeight/o}const r=this.parent.plugins.get("clamp-zoom",!0);r&&r.clamp(),this.options.noMove||(this.options.center?this.parent.moveCenter(this.options.center):this.parent.moveCenter(t))}}resume(){this.snapping=null,super.resume()}}const h2e={percent:.1,smooth:!1,interrupt:!0,reverse:!1,center:null,lineHeight:20,axis:"all",keyToPress:null,trackpadPinch:!1,wheelZoom:!0};class d2e extends Wa{constructor(e,t={}){super(e),this.options=Object.assign({},h2e,t),this.keyIsPressed=!1,this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(e){typeof window>"u"||(window.addEventListener("keydown",t=>{e.includes(t.code)&&(this.keyIsPressed=!0)}),window.addEventListener("keyup",t=>{e.includes(t.code)&&(this.keyIsPressed=!1)}))}checkKeyPress(){return!this.options.keyToPress||this.keyIsPressed}down(){return this.options.interrupt&&(this.smoothing=null),!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}update(){if(this.smoothing){const e=this.smoothingCenter,t=this.smoothing;let n;this.options.center||(n=this.parent.toLocal(e)),this.isAxisX()&&(this.parent.scale.x+=t.x),this.isAxisY()&&(this.parent.scale.y+=t.y),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const r=this.parent.plugins.get("clamp-zoom",!0);if(r&&r.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const s=this.parent.parent||this.parent;s.toLocal(n,this.parent,n);const a=s.toLocal(e);this.parent.x+=a.x-n.x,this.parent.y+=a.y-n.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.smoothingCount++,typeof this.options.smooth=="number"&&this.smoothingCount>=this.options.smooth&&(this.smoothing=null)}}pinch(e){if(this.paused)return;const t=this.parent.input.getPointerPosition(e),n=-e.deltaY*(e.deltaMode?this.options.lineHeight:1)/200,r=Math.pow(2,(1+this.options.percent)*n);let s;this.options.center||(s=this.parent.toLocal(t)),this.isAxisX()&&(this.parent.scale.x*=r),this.isAxisY()&&(this.parent.scale.y*=r),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const a=this.parent.plugins.get("clamp-zoom",!0);if(a&&a.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const o=this.parent.parent||this.parent;o.toLocal(s,this.parent,s);const l=o.toLocal(t);this.parent.x+=l.x-s.x,this.parent.y+=l.y-s.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel-start",{event:e,viewport:this.parent})}wheel(e){if(this.paused||!this.checkKeyPress())return!1;if(e.ctrlKey&&this.options.trackpadPinch)this.pinch(e);else if(this.options.wheelZoom){const t=this.parent.input.getPointerPosition(e),n=(this.options.reverse?-1:1)*-e.deltaY*(e.deltaMode?this.options.lineHeight:1)/500,r=Math.pow(2,(1+this.options.percent)*n);if(this.options.smooth){const s={x:this.smoothing?this.smoothing.x*(this.options.smooth-this.smoothingCount):0,y:this.smoothing?this.smoothing.y*(this.options.smooth-this.smoothingCount):0};this.smoothing={x:((this.parent.scale.x+s.x)*r-this.parent.scale.x)/this.options.smooth,y:((this.parent.scale.y+s.y)*r-this.parent.scale.y)/this.options.smooth},this.smoothingCount=0,this.smoothingCenter=t}else{let s;this.options.center||(s=this.parent.toLocal(t)),this.isAxisX()&&(this.parent.scale.x*=r),this.isAxisY()&&(this.parent.scale.y*=r),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const a=this.parent.plugins.get("clamp-zoom",!0);if(a&&a.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const o=this.parent.parent||this.parent;o.toLocal(s,this.parent,s);const l=o.toLocal(t);this.parent.x+=l.x-s.x,this.parent.y+=l.y-s.y}}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel-start",{event:e,viewport:this.parent})}return!this.parent.options.passiveWheel}}const f2e={screenWidth:typeof window>"u"?0:window.innerWidth,screenHeight:typeof window>"u"?0:window.innerHeight,worldWidth:null,worldHeight:null,threshold:5,passiveWheel:!0,stopPropagation:!1,forceHitArea:null,noTicker:!1,disableOnContextMenu:!1,ticker:qp.shared,allowPreserveDragOutside:!1};class p2e extends Fi{constructor(e){super(),this._disableOnContextMenu=t=>t.preventDefault(),this.options={...f2e,...e},this.screenWidth=this.options.screenWidth,this.screenHeight=this.options.screenHeight,this._worldWidth=this.options.worldWidth,this._worldHeight=this.options.worldHeight,this.forceHitArea=this.options.forceHitArea,this.threshold=this.options.threshold,this.options.disableOnContextMenu&&this.options.events.domElement.addEventListener("contextmenu",this._disableOnContextMenu),this.options.noTicker||(this.tickerFunction=()=>this.update(this.options.ticker.elapsedMS),this.options.ticker.add(this.tickerFunction)),this.input=new Bbe(this),this.plugins=new Hbe(this)}destroy(e){var t;!this.options.noTicker&&this.tickerFunction&&this.options.ticker.remove(this.tickerFunction),this.options.disableOnContextMenu&&((t=this.options.events.domElement)==null||t.removeEventListener("contextmenu",this._disableOnContextMenu)),this.input.destroy(),super.destroy(e)}update(e){this.pause||(this.plugins.update(e),this.lastViewport&&(this.lastViewport.x!==this.x||this.lastViewport.y!==this.y?this.moving=!0:this.moving&&(this.emit("moved-end",this),this.moving=!1),this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y?this.zooming=!0:this.zooming&&(this.emit("zoomed-end",this),this.zooming=!1)),this.forceHitArea||(this._hitAreaDefault=new Qn(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight),this.hitArea=this._hitAreaDefault),this._dirty=this._dirty||!this.lastViewport||this.lastViewport.x!==this.x||this.lastViewport.y!==this.y||this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y,this.lastViewport={x:this.x,y:this.y,scaleX:this.scale.x,scaleY:this.scale.y},this.emit("frame-end",this))}resize(e=typeof window>"u"?0:window.innerWidth,t=typeof window>"u"?0:window.innerHeight,n,r){this.screenWidth=e,this.screenHeight=t,typeof n<"u"&&(this._worldWidth=n),typeof r<"u"&&(this._worldHeight=r),this.plugins.resize(),this.dirty=!0}get worldWidth(){return this._worldWidth?this._worldWidth:this.width/this.scale.x}set worldWidth(e){this._worldWidth=e,this.plugins.resize()}get worldHeight(){return this._worldHeight?this._worldHeight:this.height/this.scale.y}set worldHeight(e){this._worldHeight=e,this.plugins.resize()}getVisibleBounds(){return new Qn(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight)}toWorld(e,t){return arguments.length===2?this.toLocal(new Sn(e,t)):this.toLocal(e)}toScreen(e,t){return arguments.length===2?this.toGlobal(new Sn(e,t)):this.toGlobal(e)}get worldScreenWidth(){return this.screenWidth/this.scale.x}get worldScreenHeight(){return this.screenHeight/this.scale.y}get screenWorldWidth(){return this.worldWidth*this.scale.x}get screenWorldHeight(){return this.worldHeight*this.scale.y}get center(){return new Sn(this.worldScreenWidth/2-this.x/this.scale.x,this.worldScreenHeight/2-this.y/this.scale.y)}set center(e){this.moveCenter(e)}moveCenter(...e){let t,n;typeof e[0]=="number"?(t=e[0],n=e[1]):(t=e[0].x,n=e[0].y);const r=(this.worldScreenWidth/2-t)*this.scale.x,s=(this.worldScreenHeight/2-n)*this.scale.y;return(this.x!==r||this.y!==s)&&(this.position.set(r,s),this.plugins.reset(),this.dirty=!0),this}get corner(){return new Sn(-this.x/this.scale.x,-this.y/this.scale.y)}set corner(e){this.moveCorner(e)}moveCorner(...e){let t,n;return e.length===1?(t=-e[0].x*this.scale.x,n=-e[0].y*this.scale.y):(t=-e[0]*this.scale.x,n=-e[1]*this.scale.y),(t!==this.x||n!==this.y)&&(this.position.set(t,n),this.plugins.reset(),this.dirty=!0),this}get screenWidthInWorldPixels(){return this.screenWidth/this.scale.x}get screenHeightInWorldPixels(){return this.screenHeight/this.scale.y}findFitWidth(e){return this.screenWidth/e}findFitHeight(e){return this.screenHeight/e}findFit(e,t){const n=this.screenWidth/e,r=this.screenHeight/t;return Math.min(n,r)}findCover(e,t){const n=this.screenWidth/e,r=this.screenHeight/t;return Math.max(n,r)}fitWidth(e=this.worldWidth,t,n=!0,r){let s;t&&(s=this.center),this.scale.x=this.screenWidth/e,n&&(this.scale.y=this.scale.x);const a=this.plugins.get("clamp-zoom",!0);return!r&&a&&a.clamp(),t&&s&&this.moveCenter(s),this}fitHeight(e=this.worldHeight,t,n=!0,r){let s;t&&(s=this.center),this.scale.y=this.screenHeight/e,n&&(this.scale.x=this.scale.y);const a=this.plugins.get("clamp-zoom",!0);return!r&&a&&a.clamp(),t&&s&&this.moveCenter(s),this}fitWorld(e){let t;e&&(t=this.center),this.scale.x=this.screenWidth/this.worldWidth,this.scale.y=this.screenHeight/this.worldHeight,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const n=this.plugins.get("clamp-zoom",!0);return n&&n.clamp(),e&&t&&this.moveCenter(t),this}fit(e,t=this.worldWidth,n=this.worldHeight){let r;e&&(r=this.center),this.scale.x=this.screenWidth/t,this.scale.y=this.screenHeight/n,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const s=this.plugins.get("clamp-zoom",!0);return s&&s.clamp(),e&&r&&this.moveCenter(r),this}setZoom(e,t){let n;t&&(n=this.center),this.scale.set(e);const r=this.plugins.get("clamp-zoom",!0);return r&&r.clamp(),t&&n&&this.moveCenter(n),this}zoomPercent(e,t){return this.setZoom(this.scale.x+this.scale.x*e,t)}zoom(e,t){return this.fitWidth(e+this.worldScreenWidth,t),this}get scaled(){return this.scale.x}set scaled(e){this.setZoom(e,!0)}snapZoom(e){return this.plugins.add("snap-zoom",new u2e(this,e)),this}OOB(){return{left:this.left<0,right:this.right>this.worldWidth,top:this.top<0,bottom:this.bottom>this.worldHeight,cornerPoint:new Sn(this.worldWidth*this.scale.x-this.screenWidth,this.worldHeight*this.scale.y-this.screenHeight)}}get right(){return-this.x/this.scale.x+this.worldScreenWidth}set right(e){this.x=-e*this.scale.x+this.screenWidth,this.plugins.reset()}get left(){return-this.x/this.scale.x}set left(e){this.x=-e*this.scale.x,this.plugins.reset()}get top(){return-this.y/this.scale.y}set top(e){this.y=-e*this.scale.y,this.plugins.reset()}get bottom(){return-this.y/this.scale.y+this.worldScreenHeight}set bottom(e){this.y=-e*this.scale.y+this.screenHeight,this.plugins.reset()}get dirty(){return!!this._dirty}set dirty(e){this._dirty=e}get forceHitArea(){return this._forceHitArea}set forceHitArea(e){e?(this._forceHitArea=e,this.hitArea=e):(this._forceHitArea=null,this.hitArea=new Qn(0,0,this.worldWidth,this.worldHeight))}drag(e){return this.plugins.add("drag",new Jbe(this,e)),this}clamp(e){return this.plugins.add("clamp",new Xbe(this,e)),this}decelerate(e){return this.plugins.add("decelerate",new Zbe(this,e)),this}bounce(e){return this.plugins.add("bounce",new Wbe(this,e)),this}pinch(e){return this.plugins.add("pinch",new a2e(this,e)),this}snap(e,t,n){return this.plugins.add("snap",new l2e(this,e,t,n)),this}follow(e,t){return this.plugins.add("follow",new t2e(this,e,t)),this}wheel(e){return this.plugins.add("wheel",new d2e(this,e)),this}animate(e){return this.plugins.add("animate",new Vbe(this,e)),this}clampZoom(e){return this.plugins.add("clamp-zoom",new $be(this,e)),this}mouseEdges(e){return this.plugins.add("mouse-edges",new i2e(this,e)),this}get pause(){return!!this._pause}set pause(e){this._pause=e,this.lastViewport=null,this.moving=!1,this.zooming=!1,e&&this.input.pause()}ensureVisible(e,t,n,r,s){s&&(n>this.worldScreenWidth||r>this.worldScreenHeight)&&(this.fit(!0,n,r),this.emit("zoomed",{viewport:this,type:"ensureVisible"}));let a=!1;e<this.left?(this.left=e,a=!0):e+n>this.right&&(this.right=e+n,a=!0),t<this.top?(this.top=t,a=!0):t+r>this.bottom&&(this.bottom=t+r,a=!0),a&&this.emit("moved",{viewport:this,type:"ensureVisible"})}}class m2e extends p2e{constructor(e){const{app:t,...n}=e;super({...n,events:t.renderer.events}),this.drag().pinch().wheel().decelerate()}}cl({ViewportWrapper:m2e});function g2e(i){const{children:e,...t}=i,{app:n}=D0();return n?.renderer&&v.jsx("pixiViewportWrapper",{app:n,...t,children:e})}function x2e(){return v.jsxs(gt,{w:"100%",h:"full",gap:3,px:2,align:"center",children:[v.jsx(qe,{flex:1,children:v.jsx(y2e,{})}),v.jsx(Iu,{orientation:"vertical",h:"20px",borderColor:"border.muted"}),v.jsx(v2e,{})]})}function y2e(){const{grismNorm:i,extractedSpecSortedArray:e,setGrismNorm:t}=un(Tt(s=>({grismNorm:s.grismNorm,normInWindow:s.normInWindow,extractedSpecSortedArray:s.extractedSpecSortedArray,setGrismNorm:s.setGrismNorm}))),n=s=>{const a=i.pmax-5,o=Zn(s,0,a);if(e){const l=yb(e,o);t({pmin:o,vmin:l})}else t({pmin:o,vmin:void 0})},r=s=>{const a=i.pmin+5,o=Zn(s,a,100);if(e){const l=yb(e,o);t({pmax:o,vmax:l})}else t({pmax:o,vmax:void 0})};return v.jsx(lb,{pmin:i.pmin,pmax:i.pmax,vmin:i.vmin,vmax:i.vmax,onPminChange:n,onPmaxChange:r,onVminChange:s=>t({vmin:s}),onVmaxChange:s=>t({vmax:s})})}function v2e(){const{normInWindow:i,setNormInWindow:e}=un(Tt(n=>({normInWindow:n.normInWindow,setNormInWindow:n.setNormInWindow}))),t=z.useId();return v.jsx(Gr,{ids:{trigger:t},content:i?"Switch to use entire range":"Switch to use current window range",children:v.jsxs(E0,{ids:{root:t},checked:i,onCheckedChange:n=>e(n.checked),children:[v.jsx(I0,{}),v.jsx(P0,{children:v.jsx(R0,{})})]})})}cl({Graphics:Jo,Container:Fi,Sprite:$y});function b2e({layerRef:i}){const{apertureSize:e,collapseWindow:t,showTraceOnSpectrum2D:n,spectrumQueryKey:r}=un(Tt(w=>({apertureSize:w.apertureSize,collapseWindow:w.collapseWindow,showTraceOnSpectrum2D:w.showTraceOnSpectrum2D,spectrumQueryKey:w.spectrumQueryKey}))),{app:s}=D0(),a=z.useRef(null);z.useEffect(()=>{const w=i.current,T=a.current;if(!(!w||!T))return w.attach(T),()=>{w.detach(T)}},[i]);const{data:o}=Ng({queryKey:r??["extract_spectrum","empty"],queryFn:async()=>{},enabled:!1}),l=o?.wavelength||[],{waveMin:c,waveMax:u,spatialMin:d,spatialMax:p}=t,{startIdx:m,endIdx:g}=Q2(l,c,u),[y,x]=z.useState(cn.EMPTY);z.useEffect(()=>{if(l.length===0)return;const w=new Jo,T=g-m,C=p-d;w.rect(0,0,T,C).stroke({color:15597568,width:1});const E=s.renderer.generateTexture(w);x(D=>(D&&!D.destroyed&&D.destroy(!0),E))},[g,m,d,p,l,s.renderer.generateTexture]);const[_,S]=z.useState(cn.EMPTY);return z.useEffect(()=>{if(l.length===0)return;const w=new Jo,T=15,C=15,E=l.length;let D=0,O=!0;for(;D<E;){const P=Math.min(O?T:C,E-D);O&&(w.moveTo(D,0),w.lineTo(D+P,0).stroke({color:15597568,width:1})),D+=P,O=!O}const R=s.renderer.generateTexture(w);S(P=>(P&&!P.destroyed&&P.destroy(!0),R))},[l,s.renderer.generateTexture]),z.useEffect(()=>()=>{x(w=>(w&&!w.destroyed&&w.destroy(!0),cn.EMPTY)),S(w=>(w&&!w.destroyed&&w.destroy(!0),cn.EMPTY))},[]),o?v.jsxs("pixiContainer",{ref:a,children:[v.jsx("pixiSprite",{texture:y,x:m,y:d,anchor:0}),n&&v.jsx("pixiSprite",{texture:_,x:0,y:(e-1)/2,anchor:{x:0,y:.5}})]}):null}cl({Sprite:$y});function _2e({layerRef:i}){const e=z.useRef(null),{grismNorm:t,extractedSpecSortedArray:n,normInWindow:r,collapseWindow:s,setExtractedSpecSortedArray:a,spectrumQueryKey:o}=un(Tt(m=>({grismNorm:m.grismNorm,normInWindow:m.normInWindow,collapseWindow:m.collapseWindow,extractedSpecSortedArray:m.extractedSpecSortedArray,setExtractedSpecSortedArray:m.setExtractedSpecSortedArray,spectrumQueryKey:m.spectrumQueryKey}))),{data:l}=Ng({queryKey:o??["extract_spectrum","empty"],queryFn:async()=>{},enabled:!1}),c=z.useMemo(()=>!l||!l.covered?null:c6(l.spectrum_2d),[l]),u=z.useMemo(()=>{if(!l||!l.covered||!r)return null;const m=l.spectrum_2d,g=l.wavelength,{startIdx:y,endIdx:x}=Q2(g,s.waveMin,s.waveMax),_=Math.floor(s.spatialMin),S=Math.ceil(s.spatialMax),w=m.slice(_,S+1).map(T=>T.slice(y,x+1));return c6(w)},[l,r,s]);z.useEffect(()=>{a(r?u:c)},[r,u,c,a]);const[d,p]=z.useState(cn.EMPTY);return z.useEffect(()=>{if(!l||!n)return;const m=Xye({data:l.spectrum_2d,pmin:t.pmin,pmax:t.pmax,sortedArray:n,excludeZero:!0});p(g=>(g&&!g.destroyed&&g.destroy(!0),m))},[l,n,t.pmin,t.pmax]),z.useEffect(()=>()=>{p(m=>(m&&!m.destroyed&&m.destroy(!0),cn.EMPTY))},[]),z.useEffect(()=>{if(!i||d===cn.EMPTY)return;const m=i.current,g=e.current;if(!(!m||!g))return m.attach(g),()=>{m.detach(g)}},[i,d]),d!==cn.EMPTY&&v.jsx("pixiSprite",{ref:e,texture:d,anchor:0,x:0,y:0})}cl({RenderLayer:MU});function S2e(){const i=z.useRef(null),e=z.useRef(null),t=z.useRef(null),n=La(15921906,328976),r=v.jsx(qe,{ref:i,height:"120px",width:"100%",children:v.jsxs(zU,{resizeTo:i,backgroundColor:n,resolution:1,antialias:!0,autoDensity:!0,children:[v.jsx(w2e,{color:n}),v.jsxs(g2e,{passiveWheel:!1,children:[v.jsx("pixiRenderLayer",{ref:e}),v.jsx("pixiRenderLayer",{ref:t}),v.jsx(_2e,{layerRef:e}),v.jsx(b2e,{layerRef:t})]})]})});return v.jsx(Obe,{canvas:r,toolbar:v.jsx(x2e,{}),width:"100%"})}function w2e({color:i}){const{app:e}=D0();return z.useEffect(()=>{const t=e?.renderer;t&&("background"in t&&t.background?t.background.color=i:t.backgroundColor=i)},[e,i]),null}const Su={root:{display:"flex",flexDirection:"column",h:"100%",minH:0,borderRadius:"md",borderWidth:"1px",borderColor:"border.subtle",position:"relative",overflow:"hidden",bg:"bg.canvas",boxShadow:"shadows.card",_dark:{bg:"blackAlpha.900",borderColor:"whiteAlpha.200",boxShadow:"0 0 30px -10px rgba(0, 255, 255, 0.2)",bgImage:"radial-gradient(circle at 85% 0%, rgba(34, 211, 238, 0.14) 0%, transparent 45%), radial-gradient(circle at 0% 100%, rgba(168, 85, 247, 0.12) 0%, transparent 50%)"}},topSection:{display:"flex",flexDirection:"column",gap:5,p:4,flexShrink:0},divider:{borderColor:"border.subtle"},scrollSection:{flex:1,minH:0,overflow:"hidden",display:"flex",flexDirection:"column"}};function wC({children:i}){const e=z.Children.toArray(i),t=e.pop();return v.jsxs(qe,{css:Su.root,children:[e,t?v.jsx(qe,{css:Su.scrollSection,children:t}):null]})}function M2e(i){return Rb({attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},child:[]}]})(i)}const T2e=z.forwardRef(function(e,t){const{showArrow:n,children:r,portalled:s=!0,content:a,contentProps:o,portalRef:l,...c}=e;return v.jsxs(K6,{...c,positioning:{...c.positioning,gutter:4},children:[v.jsx(Z6,{asChild:!0,children:r}),v.jsx(Au,{disabled:!s,container:l,children:v.jsx(Q6,{children:v.jsxs(J6,{width:"auto",px:"2",py:"1",textStyle:"xs",rounded:"sm",ref:t,...o,children:[n&&v.jsx(WO,{children:v.jsx(GO,{})}),a]})})})]})}),RG=z.forwardRef(function(e,t){const{children:n,buttonProps:r,...s}=e;return v.jsx(T2e,{content:n,...s,ref:t,children:v.jsx(ur,{variant:"ghost","aria-label":"info",size:"2xs",colorPalette:"gray",...r,children:v.jsx(M2e,{})})})}),A2e=pr({slots:["root","left","title","leftSlot","rightSlot"],className:"section-header",base:{root:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",columnGap:3,rowGap:2,gap:2,w:"full",minW:0},left:{display:"flex",alignItems:"center",gap:2,flex:"1 1 auto",minW:0,flexWrap:"wrap"},title:{fontSize:"sm",letterSpacing:"wide",fontWeight:"extrabold",textTransform:"uppercase",color:{base:"gray.700",_dark:"transparent"},bgGradient:{base:"none",_dark:"to-r"},gradientFrom:{_dark:"cyan.400"},gradientTo:{_dark:"purple.500"},bgClip:{base:"border-box",_dark:"text"}},leftSlot:{display:"flex",alignItems:"center",gap:2},rightSlot:{display:"flex",alignItems:"center",gap:2,flexShrink:0}}});function MC({title:i,tip:e,leftSlot:t,rightSlot:n}){const s=mr({recipe:A2e})();return v.jsxs(gt,{css:s.root,children:[v.jsxs(gt,{css:s.left,children:[v.jsx(yc,{css:s.title,children:i}),e?v.jsx(RG,{content:e}):null,t?v.jsx(qe,{css:s.leftSlot,children:t}):null]}),n?v.jsx(qe,{css:s.rightSlot,children:n}):null]})}function C2e(){const{waveUnit:i,emissionLines:e,addEmissionLine:t}=un(Tt(c=>({waveUnit:c.waveUnit,emissionLines:c.emissionLines,addEmissionLine:c.addEmissionLine}))),[n,r]=z.useState(""),[s,a]=z.useState(""),o=n.trim().length>0&&!Number.isNaN(parseFloat(s))&&!e[n.trim()],l=z.useCallback(()=>{if(!o)return;const c=parseFloat(s);if(!Number.isFinite(c))return;const u=i==="m"?c:c/sd;t(n.trim(),u),r(""),a("")},[o,s,i,t,n]);return{waveUnit:i,inputName:n,setInputName:r,inputWavelength:s,setInputWavelength:a,canAdd:o,handleAdd:l}}const E2e=pr({slots:["trigger","content","title","label","input","button"],className:"emission-line-adder",base:{trigger:{color:"cyan.400",_hover:{bg:"cyan.600",color:"cyan.200"}},content:{width:"260px",bg:"bg.panel",borderColor:"border.subtle",backdropFilter:"blur(10px)",boxShadow:"xl",_dark:{bg:"rgba(20, 20, 25, 0.9)",borderColor:"whiteAlpha.200"}},title:{color:"cyan.400"},label:{textStyle:"2xs",fontWeight:"bold",color:"fg.muted",letterSpacing:"0.05em"},input:{fontFamily:"mono",bg:"blackAlpha.200",borderColor:"whiteAlpha.100",_focus:{borderColor:"cyan.500",bg:"blackAlpha.400"}},button:{width:"full",mt:1}}});function R2e(){const e=mr({recipe:E2e})(),{waveUnit:t,inputName:n,setInputName:r,inputWavelength:s,setInputWavelength:a,canAdd:o,handleAdd:l}=C2e(),c=u=>{u.key==="Enter"&&l()};return v.jsxs(K6,{positioning:{placement:"bottom-end"},children:[v.jsx(Z6,{asChild:!0,children:v.jsx(ur,{size:"xs",variant:"ghost","aria-label":"Add emission line",css:e.trigger,children:v.jsx(I6,{})})}),v.jsx(Au,{children:v.jsx(Q6,{children:v.jsxs(J6,{css:e.content,children:[v.jsx(WO,{bg:"transparent"}),v.jsx(qO,{p:3,children:v.jsxs(wt,{gap:3,children:[v.jsx(yc,{size:"xs",css:e.title,children:"Add New Line"}),v.jsxs(wt,{gap:1,children:[v.jsx(ke,{css:e.label,children:"Name"}),v.jsx(F6,{size:"sm",css:e.input,placeholder:"e.g. H",value:n,onChange:u=>r(u.target.value),onKeyDown:c,autoFocus:!0})]}),v.jsxs(wt,{gap:1,children:[v.jsxs(ke,{css:e.label,children:["Rest Wavelength (",t,")"]}),v.jsx(qo,{size:"sm",value:s,onValueChange:({value:u})=>a(u),step:t==="m"?1e-4:1,children:v.jsx(Xo,{css:e.input,placeholder:t==="m"?"0.6563":"6563",onKeyDown:c})})]}),v.jsx(hr,{size:"sm",colorPalette:"cyan",variant:"surface",css:e.button,onClick:l,disabled:!o,children:"ADD LINE"})]})})]})})})]})}function P2e(i){const{waveUnit:e,zRedshift:t,emissionLines:n,selectedEmissionLines:r,setSelectedEmissionLines:s,removeEmissionLine:a}=un(Tt(d=>({waveUnit:d.waveUnit,zRedshift:d.zRedshift,emissionLines:d.emissionLines,selectedEmissionLines:d.selectedEmissionLines,setSelectedEmissionLines:d.setSelectedEmissionLines,removeEmissionLine:d.removeEmissionLine}))),o=Object.hasOwn(r,i),l=z.useMemo(()=>{const d=n[i],p=e==="m",m=p?"m":"",g=p?4:1,y=1+(Number.isFinite(t)?t:0);if(!Number.isFinite(d))return{rest:"-",obs:"-",unit:m};const x=p?d:d*sd,_=d*y*(p?1:sd);return{rest:x.toFixed(g),obs:_.toFixed(g),unit:m}},[n,i,e,t]),c=d=>{const p={...r};if(d){const m=n[i];Number.isFinite(m)&&(p[i]=m)}else delete p[i];s(p)},u=()=>{a(i)};return{name:i,isSelected:o,rest:l.rest,obs:l.obs,unit:l.unit,toggleSelected:c,remove:u}}const I2e=pr({slots:["root","label","value","actionButton"],className:"emission-line-card",base:{root:{position:"relative",w:"full",p:3,borderWidth:"1px",borderRadius:"md",cursor:"pointer",transition:"all 0.2s",bg:"bg.card",borderColor:"border.subtle",boxShadow:"shadows.card",_hover:{borderColor:"border.accent"}},label:{textStyle:"sm",fontWeight:"bold",fontFamily:"mono",color:"border.accent"},value:{textStyle:"xs",fontFamily:"mono",color:"fg.muted"},actionButton:{color:"fg.muted",_hover:{color:"red.500",bg:{base:"red.50",_dark:"whiteAlpha.100"}}}},variants:{selected:{true:{root:{bg:"bg.cardSelected",borderColor:"border.accent"},label:{color:"border.accent"},value:{color:"fg"}}}}}),D2e=z.memo(function({emissionName:e}){const t=mr({recipe:I2e}),{name:n,isSelected:r,rest:s,obs:a,unit:o,toggleSelected:l,remove:c}=P2e(e),u=t({selected:r});return v.jsx(qe,{css:u.root,role:"button",onClick:()=>l(!r),children:v.jsxs(ss,{justify:"space-between",align:"start",children:[v.jsxs(qe,{flex:1,minW:0,children:[v.jsx(ke,{css:u.label,mb:1,children:n}),v.jsxs(gt,{align:"center",gap:3,wrap:"wrap",children:[v.jsxs(ke,{css:u.value,children:["Rest: ",s,` ${o}`]}),v.jsxs(ke,{css:u.value,children:["Obs: ",a,` ${o}`]})]})]}),v.jsx(ur,{"aria-label":"Delete line",size:"xs",variant:"ghost",css:u.actionButton,onClick:d=>{d.stopPropagation(),c()},children:v.jsx(D6,{})})]})})});function N2e(){const{emissionLines:i}=un(Tt(t=>({emissionLines:t.emissionLines})));return{sortedLineKeys:z.useMemo(()=>Object.entries(i).sort(([,t],[,n])=>t-n).map(([t])=>t),[i])}}const L2e=pr({slots:["emptyState","emptyText"],className:"emission-lines",base:{emptyState:{alignItems:"center",justifyContent:"center",h:"full",color:"fg.muted",gap:2,opacity:.6},emptyText:{textStyle:"xs",letterSpacing:"wide"}}});function k2e(){const{sortedLineKeys:i}=N2e(),t=mr({recipe:L2e})();return v.jsxs(wt,{gap:3,h:"full",minH:0,children:[v.jsx(qe,{px:4,children:v.jsx(MC,{title:"Emission Lines",tip:"Add and select emission lines to display on the spectrum.",rightSlot:v.jsx(R2e,{})})}),v.jsxs(eT,{flex:"1",minH:"0",children:[v.jsx(tT,{children:v.jsx(nT,{p:2,pb:8,children:i.length===0?v.jsxs(wt,{css:t.emptyState,children:[v.jsx(_L,{size:24,style:{opacity:.3}}),v.jsx(ke,{css:t.emptyText,children:"NO DATA FOUND"})]}):v.jsx(wt,{gap:2,children:i.map(n=>v.jsx(D2e,{emissionName:n},n))})})}),v.jsx(iT,{children:v.jsx(Bb,{})}),v.jsx(rT,{})]})]})}const iM={label:{textStyle:"2xs",color:"fg.muted",fontWeight:"bold",letterSpacing:"0.05em",opacity:.8},inputRoot:{size:"xs",variant:"outline"},inputField:{fontFamily:"mono",fontSize:"xs",borderRadius:"sm",transition:"all 0.2s ease-out",bg:{base:"white",_dark:"blackAlpha.200"},borderColor:{base:"gray.200",_dark:"whiteAlpha.100"},color:{base:"gray.800",_dark:"fg.subtle"},_focus:{borderColor:"cyan.500",boxShadow:"0 0 0 1px var(--chakra-colors-cyan-500)",bg:{base:"cyan.50",_dark:"blackAlpha.400"},color:{base:"cyan.900",_dark:"cyan.100"}},_hover:{borderColor:{base:"gray.300",_dark:"whiteAlpha.300"}},_disabled:{opacity:.4,cursor:"not-allowed",bg:{base:"gray.100",_dark:"whiteAlpha.50"}}}};function mi(i){const{label:e,value:t,onChange:n,step:r=1,min:s,max:a,decimalScale:o=4,labelWidth:l="36px",inputWidth:c="120px",onBlur:u,labelPos:d="left",showControls:p=!0,disabled:m}=i,g=Number.isFinite(t)?t.toFixed(o).replace(/\.?0+$/,""):"",y=d==="top"?"column":"row",x=d==="top"?1:2,_=d==="top"?"flex-start":"center";return v.jsxs(wt,{direction:y,gap:x,align:_,children:[v.jsx(ke,{...iM.label,minW:l,children:e}),v.jsxs(qo,{...iM.inputRoot,maxW:c,value:g,step:r,min:s,max:a,disabled:m,onValueChange:({valueAsNumber:S})=>{Number.isNaN(S)||n(S)},children:[p&&v.jsx(jO,{}),v.jsx(Xo,{onBlur:u,...iM.inputField})]})]})}function PG(){const{waveFrame:i,setWaveFrame:e}=Ai(Tt(r=>({waveFrame:r.waveFrame,setWaveFrame:r.setWaveFrame}))),{waveUnit:t,setWaveUnit:n}=un(Tt(r=>({waveUnit:r.waveUnit,setWaveUnit:r.setWaveUnit})));return v.jsxs(gt,{gap:1,align:"flex-start",children:[v.jsxs(wt,{gap:1,children:[v.jsx(ke,{textStyle:"xs",color:"fg.muted",children:"Frame"}),v.jsxs(AM,{size:"xs",value:i,onValueChange:r=>{const s=r.value;(s==="observe"||s==="rest")&&e(s)},children:[v.jsx(RM,{}),v.jsx(sE,{items:[{value:"observe",label:"Obs"},{value:"rest",label:"Rest"}]})]})]}),v.jsxs(wt,{gap:1,children:[v.jsx(ke,{textStyle:"xs",color:"fg.muted",children:" unit"}),v.jsxs(AM,{size:"xs",value:t,onValueChange:r=>{const s=r.value;(s==="m"||s==="")&&n(s)},children:[v.jsx(RM,{}),v.jsx(sE,{items:[{value:"m",label:"m"},{value:"",label:""}]})]})]})]})}function O2e(){const{collapseWindow:i,setCollapseWindow:e,showTraceOnSpectrum2D:t,switchShowTraceOnSpectrum2D:n,waveUnit:r,zRedshift:s,slice1DWaveRange:a,setSlice1DWaveRange:o,spectrumQueryKey:l}=un(Tt(B=>({collapseWindow:B.collapseWindow,setCollapseWindow:B.setCollapseWindow,showTraceOnSpectrum2D:B.showTraceOnSpectrum2D,switchShowTraceOnSpectrum2D:B.switchShowTraceOnSpectrum2D,waveUnit:B.waveUnit,zRedshift:B.zRedshift,slice1DWaveRange:B.slice1DWaveRange,setSlice1DWaveRange:B.setSlice1DWaveRange,spectrumQueryKey:B.spectrumQueryKey}))),{waveFrame:c}=Ai(Tt(B=>({waveFrame:B.waveFrame}))),u=z.useCallback(B=>CV(B,r,c,s),[r,c,s]),d=z.useCallback(B=>fo(B,r,c,s),[r,c,s]),[p,m]=z.useState(""),[g,y]=z.useState("");z.useEffect(()=>{const B=d(a.min),J=d(a.max);m(Number.isFinite(B)?String(B):""),y(Number.isFinite(J)?String(J):"")},[a,d]);const x=z.useCallback(()=>{const B=parseFloat(p),J=parseFloat(g);if(!Number.isFinite(B)||!Number.isFinite(J))return;let U=o6(B,r,c,s),X=o6(J,r,c,s);if(U>X){const se=U;U=X,X=se}const $=Math.min(i.waveMin,i.waveMax),Q=Math.max(i.waveMin,i.waveMax);U=Zn(U,$,Q),X=Zn(X,U,Q),o({min:U,max:X})},[p,g,r,c,s,i,o]),_=z.useMemo(()=>({minInputStr:p,maxInputStr:g,minValue:p===""?NaN:parseFloat(p),maxValue:g===""?NaN:parseFloat(g),setMin:B=>m(Number.isNaN(B)?"":B.toString()),setMax:B=>y(Number.isNaN(B)?"":B.toString()),applyRange:x,waveUnit:r}),[p,g,x,r]),{data:S}=Ng({queryKey:l??["extract_spectrum","empty"],queryFn:async()=>{},enabled:!1}),w=S?.wavelength??[],T=w.length>0,C=z.useMemo(()=>{if(!T)return{waveMin:i.waveMin??0,waveMax:i.waveMax??0,spatialMax:Math.max(i.spatialMax,0)};const B=w[0],J=w[w.length-1],U=S?.spectrum_2d?.length??0;return{waveMin:Math.min(B,J),waveMax:Math.max(B,J),spatialMax:U>0?U-1:0}},[T,w,S?.spectrum_2d,i]),[E,D]=z.useState([i.waveMin,i.waveMax]),[O,R]=z.useState([i.spatialMin,i.spatialMax]);z.useEffect(()=>{D([i.waveMin,i.waveMax]),R([i.spatialMin,i.spatialMax])},[i]);const P=gb(B=>e(B),20);return{localWaveRange:E,localSpatialRange:O,dataLimits:C,hasSpectrum:T,waveUnit:r,formatterWithUnit:u,showTraceOnSpectrum2D:t,switchShowTraceOnSpectrum2D:n,handleWaveSliderChange:({value:B})=>{if(!T)return;const[J,U]=B,X=Zn(J,C.waveMin,C.waveMax),$=Zn(U,X,C.waveMax);D([X,$]),P({waveMin:X,waveMax:$})},handleSpatialSliderChange:({value:B})=>{if(!T)return;const[J,U]=B,X=Zn(J,0,C.spatialMax),$=Zn(U,X,C.spatialMax);R([X,$]),P({spatialMin:X,spatialMax:$})},handleSliceContainerKeyDown:B=>{B.key==="Enter"&&_.applyRange()},sliceManager:_}}const z2e=pr({slots:["root","label","valuePill","switchControl","sliderGroup","rangeRow","sliceRow","sliceDivider"],className:"extraction-controls",base:{root:{gap:4},label:{textStyle:"2xs",color:"fg.muted",fontWeight:"bold",letterSpacing:"wider"},valuePill:{textStyle:"xs",fontFamily:"mono",px:1.5,py:.5,borderRadius:"sm",borderWidth:"1px",bg:{base:"cyan.50",_dark:"blackAlpha.400"},color:{base:"cyan.800",_dark:"cyan.300"},borderColor:{base:"cyan.200",_dark:"transparent"},fontWeight:{base:"medium",_dark:"normal"}},switchControl:{bg:{base:"gray.300",_dark:"whiteAlpha.200"},borderColor:{base:"gray.400",_dark:"whiteAlpha.100"},transition:"all 0.2s",_checked:{bg:{base:"cyan.500",_dark:"cyan.600"},borderColor:{base:"cyan.600",_dark:"cyan.400"},boxShadow:{_dark:"0 0 10px rgba(0, 200, 255, 0.3)"}}},sliderGroup:{gap:5,transition:"opacity 0.2s"},rangeRow:{justifyContent:"space-between",alignItems:"center"},sliceRow:{alignItems:"flex-end",gap:3},sliceDivider:{pb:1.5,color:"fg.subtle",opacity:.5}}});function U2e(){const i=z.useId(),{localWaveRange:e,localSpatialRange:t,dataLimits:n,hasSpectrum:r,waveUnit:s,formatterWithUnit:a,showTraceOnSpectrum2D:o,switchShowTraceOnSpectrum2D:l,handleWaveSliderChange:c,handleSpatialSliderChange:u,handleSliceContainerKeyDown:d,sliceManager:p}=O2e(),g=mr({recipe:z2e})();return v.jsxs(wt,{css:g.root,children:[v.jsx(MC,{title:"Extraction",tip:"Adjust the extraction window (2D) and slice range (1D).",leftSlot:v.jsx(PG,{}),rightSlot:v.jsx(Gr,{ids:{trigger:i},content:o?"Hide trace on 2D spectrum":"Show trace on 2D spectrum",children:v.jsxs(E0,{ids:{root:i},size:"sm",checked:o,onCheckedChange:l,colorPalette:"cyan",children:[v.jsx(I0,{}),v.jsx(P0,{css:g.switchControl,children:v.jsx(R0,{})})]})})}),v.jsxs(wt,{css:g.sliderGroup,opacity:r?1:.6,pointerEvents:r?"auto":"none",children:[v.jsxs(wt,{gap:2,children:[v.jsxs(gt,{css:g.rangeRow,children:[v.jsx(ke,{css:g.label,children:"Wavelength Window"}),v.jsxs(gt,{gap:1,children:[v.jsx(ke,{css:g.valuePill,children:a(e[0])}),v.jsx(ke,{textStyle:"xs",color:"fg.subtle",children:""}),v.jsx(ke,{css:g.valuePill,children:a(e[1])})]})]}),v.jsx(_M,{min:n.waveMin,max:n.waveMax,step:1e-4,value:e,disabled:!r,minStepsBetweenThumbs:1,onValueChange:c,colorPalette:"cyan"})]}),v.jsxs(wt,{gap:2,children:[v.jsxs(gt,{css:g.rangeRow,children:[v.jsx(ke,{css:g.label,children:"Spatial Window (Rows)"}),v.jsxs(gt,{gap:1,children:[v.jsx(ke,{css:g.valuePill,children:t[0]}),v.jsx(ke,{textStyle:"xs",color:"fg.subtle",children:""}),v.jsx(ke,{css:g.valuePill,children:t[1]})]})]}),v.jsx(_M,{min:0,max:n.spatialMax,step:1,value:t,disabled:!r,minStepsBetweenThumbs:1,onValueChange:u,colorPalette:"purple"})]})]}),v.jsxs(wt,{gap:2,children:[v.jsxs(ke,{css:g.label,children:["1D Slice Wavelength Range (",s,")"]}),v.jsxs(gt,{css:g.sliceRow,align:"flex-end",onKeyDown:d,children:[v.jsx(mi,{label:"MIN",value:p.minValue,onChange:p.setMin,labelPos:"top",inputWidth:"full"}),v.jsx(ke,{css:g.sliceDivider,children:"~"}),v.jsx(mi,{label:"MAX",value:p.maxValue,onChange:p.setMax,labelPos:"top",inputWidth:"full"}),v.jsx(hr,{size:"xs",variant:"surface",onClick:p.applyRange,minW:"50px",colorPalette:"cyan",children:"APPLY"})]})]})]})}function F2e(){const{zRedshift:i,setZRedshift:e}=un(Tt(_=>({zRedshift:_.zRedshift,setZRedshift:_.setZRedshift}))),{displayedTraceSourceId:t,updateTraceSource:n}=sa(Tt(_=>({displayedTraceSourceId:_.displayedTraceSourceId,updateTraceSource:_.updateTraceSource}))),r=z.useCallback(_=>{t&&n(t,{z:_})},[t,n]),[s,a]=z.useState(12),[o,l]=z.useState(.001),[c,u]=z.useState(i||0);z.useEffect(()=>{u(i||0)},[i]);const d=gb(_=>{e(_)},10),p=gb(_=>{r(_)},10),m=Math.max(s,0),g=Zn(c,0,m);return{localZ:c,safeZ:g,safeMax:m,step:o,maxRedshift:s,setStep:l,setMaxRedshift:a,handleSliderChange:({value:_})=>{const S=Zn(_[0]??0,0,m);u(S),d(S),p(S)},handleZInputChange:_=>{const S=Zn(_,0,m);u(S),d(S),p(S)}}}const B2e=pr({slots:["root","slider","inputs"],className:"redshift-controls",base:{root:{gap:3},slider:{px:1},inputs:{gap:3,justifyContent:"space-between",alignItems:"flex-end",flexWrap:"wrap"}}});function H2e(){const{localZ:i,safeZ:e,safeMax:t,step:n,maxRedshift:r,setStep:s,setMaxRedshift:a,handleSliderChange:o,handleZInputChange:l}=F2e(),u=mr({recipe:B2e})();return v.jsxs(wt,{css:u.root,children:[v.jsx(MC,{title:"Redshift",tip:"Adjust the redshift (z) to shift the observed wavelength frame."}),v.jsx(wt,{css:u.slider,children:v.jsx(_M,{label:"z",min:0,max:t,step:n,value:[e],onValueChange:o,colorPalette:"cyan"})}),v.jsxs(gt,{css:u.inputs,children:[v.jsx(mi,{label:"VALUE (z)",value:i,onChange:l,step:n,min:0,max:t,decimalScale:4,labelWidth:"40px",inputWidth:"90px",labelPos:"top"}),v.jsx(mi,{label:"STEP",value:n,onChange:d=>d>0&&s(d),step:.001,min:1e-4,decimalScale:4,labelWidth:"40px",inputWidth:"70px",labelPos:"top"}),v.jsx(mi,{label:"MAX",value:r,onChange:d=>a(d),step:1,min:1,decimalScale:1,labelWidth:"40px",inputWidth:"60px",labelPos:"top"})]})]})}function j2e(){return v.jsxs(wC,{children:[v.jsxs(qe,{css:Su.topSection,children:[v.jsx(H2e,{}),v.jsx(Iu,{css:Su.divider}),v.jsx(U2e,{})]}),v.jsx(k2e,{})]})}function V2e(){const{addModel:i,models:e,saveCurrentConfiguration:t,updateModel:n}=Ai(Tt(d=>({addModel:d.addModel,models:d.models,saveCurrentConfiguration:d.saveCurrentConfiguration,updateModel:d.updateModel}))),{slice1DWaveRange:r}=un(Tt(d=>({slice1DWaveRange:d.slice1DWaveRange}))),[s,a]=z.useState(["linear"]),o=e.length>0,l=z.useCallback(()=>{const d=s[0]??"linear";i(d,r)},[i,s,r]),c=z.useCallback(()=>{o&&(e.forEach(d=>{if(d.kind==="gaussian"){const p=(r.min+r.max)/2;n(d.id,{range:r,mu:p})}else if(d.kind==="linear"){const p=(r.min+r.max)/2;n(d.id,{range:r,x0:p})}}),Ui.success({title:"Models synced",description:"Updated to current slice window"}))},[o,e,r,n]),u=z.useCallback(()=>{t(),Ui.create({title:"Configuration saved",type:"success"})},[t]);return{selectedType:s,setSelectedType:a,handleAdd:l,handleSync:c,handleSave:u,hasModels:o}}const G2e=pr({slots:["root","title","controls","selectControl","selectContent","selectItem","iconButton","addButton"],className:"fit-header",base:{root:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:3,w:"full",flexWrap:"wrap"},title:{fontSize:"sm",letterSpacing:"wide",fontWeight:"extrabold",textTransform:"uppercase",color:{base:"gray.700",_dark:"transparent"},bgGradient:{base:"none",_dark:"to-r"},gradientFrom:{_dark:"cyan.400"},gradientTo:{_dark:"purple.500"},bgClip:{base:"border-box",_dark:"text"}},controls:{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap",justifyContent:"flex-end"},selectControl:{bg:"bg.card",borderColor:"border.subtle",color:"fg",fontSize:"xs",transition:"all 0.2s",_hover:{borderColor:"cyan.400",bg:{base:"gray.50",_dark:"whiteAlpha.200"}},_focus:{borderColor:"cyan.500",boxShadow:"0 0 0 1px var(--chakra-colors-cyan-500)"}},selectContent:{bg:"bg.panel",borderColor:"border.subtle",backdropFilter:"blur(10px)"},selectItem:{cursor:"pointer",transition:"all 0.1s ease-out",borderRadius:"sm",_hover:{bg:{base:"gray.100",_dark:"whiteAlpha.100"},color:{base:"cyan.600",_dark:"cyan.400"}},_highlighted:{bg:{base:"gray.100",_dark:"whiteAlpha.100"},color:{base:"cyan.600",_dark:"cyan.400"}}},iconButton:{color:"fg.muted",_hover:{color:"cyan.400",bg:{base:"gray.100",_dark:"whiteAlpha.100"}}},addButton:{fontWeight:"semibold"}}}),kN=oc({items:[{label:"Linear",value:"linear"},{label:"Gaussian",value:"gaussian"}]});function W2e(){const{selectedType:i,setSelectedType:e,handleAdd:t,handleSync:n,handleSave:r,hasModels:s}=V2e(),o=mr({recipe:G2e})();return v.jsxs(gt,{css:o.root,children:[v.jsx(yc,{css:o.title,children:"Model Fitting"}),v.jsxs(gt,{css:o.controls,children:[v.jsxs(Hb,{collection:kN,size:"xs",width:"120px",value:i,onValueChange:({value:l})=>e(l),children:[v.jsx(lT,{}),v.jsx(oT,{css:o.selectControl,children:v.jsxs(jb,{children:[v.jsx(Wb,{placeholder:"Type"}),v.jsx(ZO,{})]})}),v.jsx(Au,{children:v.jsx(Vb,{children:v.jsx(Gb,{css:o.selectContent,children:kN.items.map(l=>v.jsxs(qb,{item:l,css:o.selectItem,children:[v.jsx(KO,{children:l.label}),v.jsx(aT,{})]},l.value))})})})]}),v.jsxs(hr,{size:"xs",variant:"surface",colorPalette:"cyan",css:o.addButton,onClick:t,children:[v.jsx(I6,{}),"Add"]}),v.jsx(Gr,{content:"Sync models to current slice window",children:v.jsx(ur,{"aria-label":"Sync models",size:"xs",variant:"ghost",css:o.iconButton,onClick:n,disabled:!s,children:v.jsx(bL,{})})}),v.jsx(Gr,{content:"Save configuration",children:v.jsx(ur,{"aria-label":"Save configuration",size:"xs",variant:"ghost",css:o.iconButton,onClick:r,children:v.jsx(vY,{})})})]})]})}function q2e(i){const{controls:e,disabled:t}=i;if(!e.length)return null;const n=v.jsxs(hr,{size:"xs",variant:"ghost",disabled:t,children:[v.jsx(N6,{}),v.jsx(ke,{as:"span",ml:"1",textStyle:"xs",children:"step set"})]});return t?n:v.jsxs(K6,{positioning:{placement:"bottom-end"},children:[v.jsx(Z6,{asChild:!0,children:n}),v.jsx(Au,{children:v.jsx(Q6,{children:v.jsx(J6,{minW:"200px",children:v.jsx(qO,{p:2,children:v.jsxs(wt,{gap:2,children:[v.jsx(ke,{textStyle:"xs",fontWeight:"semibold",color:"fg.muted",children:"Adjust Step Sizes"}),e.map(r=>v.jsxs(gt,{justify:"space-between",align:"center",gap:3,children:[v.jsx(ke,{textStyle:"xs",children:r.label}),v.jsx(qo,{size:"xs",maxW:"80px",value:Number.isFinite(r.value)?r.value.toString():"0.1",step:r.value||.1,onValueChange:({valueAsNumber:s})=>{Number.isFinite(s)&&r.onChange(s)},children:v.jsx(Xo,{})})]},r.key))]})})})})})]})}const X2e=pr({slots:["root","header","nameInput","actionGroup","switchControl","formula","body","iconButton"],className:"fit-model-card",base:{root:{position:"relative",gap:2,p:3,borderRadius:"lg",borderWidth:"1px",borderColor:"border.subtle",borderLeftWidth:"2px",borderLeftColor:"border.subtle",bg:"bg.card",boxShadow:"shadows.card",transition:"all 0.2s ease-out",animation:"enter",_hover:{borderColor:"border.accent",transform:"translateY(-1px)"}},header:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:2},nameInput:{fontWeight:"semibold",fontFamily:"mono",bg:"transparent",color:"fg",_focus:{bg:"bg.subtle",borderColor:"border.accent",boxShadow:"none"},_placeholder:{color:"fg.subtle"}},actionGroup:{display:"flex",alignItems:"center",gap:1},switchControl:{bg:{base:"gray.200",_dark:"whiteAlpha.100"},borderColor:"border.subtle",transition:"all 0.2s",_checked:{bg:{base:"cyan.500",_dark:"cyan.600"},borderColor:{base:"cyan.600",_dark:"cyan.400"}}},formula:{textStyle:"xs",fontFamily:"mono",color:"fg.muted",bg:"bg.subtle",px:2,py:1,borderRadius:"md",borderWidth:"1px",borderColor:"border.subtle",alignSelf:"start",fontWeight:{base:"medium",_dark:"normal"}},body:{gap:2,pt:1,transition:"opacity 0.2s"},iconButton:{color:"fg.muted",_hover:{color:"red.400",bg:{base:"red.50",_dark:"whiteAlpha.100"}}}},variants:{active:{true:{root:{opacity:1,borderLeftWidth:"3px",borderLeftColor:"var(--fit-model-accent)",boxShadow:"shadows.card"},body:{opacity:1,pointerEvents:"auto"}},false:{root:{opacity:.6},body:{opacity:.6,pointerEvents:"none"}}}}});function IG(i){const{name:e,onRename:t,color:n,onColorChange:r,active:s,onToggleActive:a,onRemove:o,stepControls:l,formula:c,children:u}=i,d=s?"Deactivate model":"Activate model",m=mr({recipe:X2e})({active:s}),g={"--fit-model-accent":n};return v.jsxs(wt,{css:m.root,style:g,children:[v.jsxs(gt,{css:m.header,children:[v.jsx(F6,{size:"xs",maxW:"140px",value:e,onChange:y=>t(y.target.value),placeholder:"MODEL_ID",css:m.nameInput}),v.jsxs(gt,{css:m.actionGroup,children:[v.jsx(kY,{value:n,onValueChange:r}),v.jsx(Gr,{content:d,children:v.jsxs(E0,{size:"sm",colorPalette:"cyan",checked:s,onCheckedChange:y=>a(y.checked),children:[v.jsx(I0,{}),v.jsx(P0,{css:m.switchControl}),v.jsx(UK,{srOnly:!0,children:"Active"})]})}),v.jsx(qe,{children:v.jsx(q2e,{controls:l,disabled:!s})}),v.jsx(ur,{"aria-label":"Delete model",size:"xs",variant:"ghost",css:m.iconButton,onClick:o,children:v.jsx(D6,{})})]})]}),v.jsx(qe,{css:m.formula,children:c}),v.jsx(wt,{css:m.body,children:u})]})}function DG(i){const{initialSteps:e,waveUnit:t,waveFrame:n,zRedshift:r}=i,[s,a]=z.useState(e),o=z.useRef(t),l=z.useRef(n);z.useEffect(()=>{const u=o.current,d=l.current;if(u===t&&d===n)return;const p=a6(u,d,r),m=a6(t,n,r);if(o.current=t,l.current=n,!Number.isFinite(p)||p===0||!Number.isFinite(m))return;const g=m/p;a(y=>{const x={...y};for(const _ in x)x[_]=x[_]*g;return x})},[t,n,r]);const c=z.useCallback((u,d)=>{a(p=>({...p,[u]:d}))},[]);return{steps:s,setSingleStep:c}}function NG(i){const{modelRange:e,sliceRange:t,onUpdate:n}=i,r=z.useCallback(()=>{const{min:a,max:o}=e,{min:l,max:c}=t;if(!Number.isFinite(a))return;const u=Number.isFinite(o)?o:c,d=Math.min(Math.max(a,l),Math.min(u,c));d!==a&&n({min:d,max:o})},[e,t,n]),s=z.useCallback(()=>{const{min:a,max:o}=e,{min:l,max:c}=t;if(!Number.isFinite(o))return;const u=Number.isFinite(a)?a:l,d=Math.max(Math.min(o,c),Math.max(u,l));d!==o&&n({min:a,max:d})},[e,t,n]);return{clampMinOnBlur:r,clampMaxOnBlur:s}}function LG(i,e,t){return z.useCallback(r=>s=>{if(!Number.isFinite(s))return;const a=o6(s,i,e,t);r(a)},[i,e,t])}function Y2e(i){const{updateModel:e,removeModel:t,renameModel:n,toggleActive:r,waveFrame:s}=Ai(Tt(Q=>({updateModel:Q.updateModel,removeModel:Q.removeModel,renameModel:Q.renameModel,toggleActive:Q.toggleActive,waveFrame:Q.waveFrame}))),{waveUnit:a,zRedshift:o,slice1DWaveRange:l}=un(Tt(Q=>({waveUnit:Q.waveUnit,zRedshift:Q.zRedshift,slice1DWaveRange:Q.slice1DWaveRange}))),{steps:c,setSingleStep:u}=DG({initialSteps:{A:.1,mu:a==="m"?.001:1,sigma:a==="m"?.001:1,range:a==="m"?.001:1},waveUnit:a,waveFrame:s,zRedshift:o}),d=fo(i.mu,a,s,o),p=fo(i.sigma,a,s,o),m=fo(i.range.min,a,s,o),g=fo(i.range.max,a,s,o),y=1+(Number.isFinite(o)?o:0),x=s==="observe"?i.sigma:i.sigma/(y||1),_=s==="observe"?i.mu:i.mu/(y||1),S=2.354820045*x,w=a==="m"?S:S*sd,T=_>0?S/_*iC:0,C={value:qD(w,a==="m"?4:1),velocity:qD(T,1),unit:a},E=z.useMemo(()=>[{key:"A",label:"A step",value:c.A,onChange:Q=>u("A",Q)},{key:"mu",label:" step",value:c.mu,onChange:Q=>u("mu",Q)},{key:"sigma",label:" step",value:c.sigma,onChange:Q=>u("sigma",Q)},{key:"range",label:"range step",value:c.range,onChange:Q=>u("range",Q)}],[u,c.A,c.mu,c.range,c.sigma]),D=LG(a,s,o),O=Q=>e(i.id,{amplitude:Q}),R=D(Q=>e(i.id,{mu:Q})),P=D(Q=>e(i.id,{sigma:Math.abs(Q)})),L=D(Q=>e(i.id,{range:{...i.range,min:Q}})),V=D(Q=>e(i.id,{range:{...i.range,max:Q}})),j=Q=>e(i.id,{color:Q}),B=Q=>n(i.id,Q),J=Q=>r(i.id,Q),U=()=>t(i.id),{clampMinOnBlur:X,clampMaxOnBlur:$}=NG({modelRange:i.range,sliceRange:l,onUpdate:Q=>e(i.id,{range:Q})});return{name:i.name,color:i.color,active:i.active,values:{amplitude:i.amplitude},display:{mu:d,sigma:p,x1:m,x2:g},steps:c,stepControls:E,fwhmDisplay:C,handleA:O,handleMu:R,handleSigma:P,handleX1:L,handleX2:V,handleColorChange:j,handleRename:B,handleToggle:J,handleRemove:U,clampMinOnBlur:X,clampMaxOnBlur:$}}function $2e(i){const{model:e}=i,{name:t,color:n,active:r,values:s,display:a,steps:o,stepControls:l,fwhmDisplay:c,handleA:u,handleMu:d,handleSigma:p,handleX1:m,handleX2:g,handleColorChange:y,handleRename:x,handleToggle:_,handleRemove:S,clampMinOnBlur:w,clampMaxOnBlur:T}=Y2e(e);return v.jsx(IG,{name:t,onRename:x,color:n,onColorChange:y,active:r,onToggleActive:_,onRemove:S,stepControls:l,formula:v.jsx(ke,{children:"y = Aexp((x)/2)  (x1 < x < x2)"}),children:v.jsxs(wt,{gap:1,children:[v.jsx(mi,{label:"A",value:s.amplitude,step:o.A,onChange:u,decimalScale:6}),v.jsxs(wt,{direction:"row",gap:2,children:[v.jsx(mi,{label:"",value:a.mu,step:o.mu,onChange:d}),v.jsx(mi,{label:"",value:a.sigma,step:o.sigma,onChange:p})]}),v.jsxs(wt,{direction:"row",gap:2,children:[v.jsx(mi,{label:"x1",value:a.x1,step:o.range,onChange:m,onBlur:w}),v.jsx(mi,{label:"x2",value:a.x2,step:o.range,onChange:g,onBlur:T})]}),v.jsxs(ke,{textStyle:"xs",color:"fg.muted",children:["FWHM ~ ",c.value," ",c.unit," (",c.velocity," ","km/s)"]})]})})}function K2e(){const{models:i,ensureInitialModels:e}=Ai(Tt(n=>({models:n.models,ensureInitialModels:n.ensureInitialModels}))),{slice1DWaveRange:t}=un(Tt(n=>({slice1DWaveRange:n.slice1DWaveRange})));return z.useEffect(()=>{e(t)},[e,t]),{models:i}}function Z2e(i){const{updateModel:e,removeModel:t,renameModel:n,toggleActive:r,waveFrame:s}=Ai(Tt(L=>({updateModel:L.updateModel,removeModel:L.removeModel,renameModel:L.renameModel,toggleActive:L.toggleActive,waveFrame:L.waveFrame}))),{waveUnit:a,zRedshift:o,slice1DWaveRange:l}=un(Tt(L=>({waveUnit:L.waveUnit,zRedshift:L.zRedshift,slice1DWaveRange:L.slice1DWaveRange}))),{steps:c,setSingleStep:u}=DG({initialSteps:{k:.1,b:.1,x0:a==="m"?.001:1,range:a==="m"?.001:1},waveUnit:a,waveFrame:s,zRedshift:o}),d=fo(i.x0,a,s,o),p=fo(i.range.min,a,s,o),m=fo(i.range.max,a,s,o),g=z.useMemo(()=>[{key:"k",label:"k step",value:c.k,onChange:L=>u("k",L)},{key:"b",label:"b step",value:c.b,onChange:L=>u("b",L)},{key:"x0",label:"x0 step",value:c.x0,onChange:L=>u("x0",L)},{key:"range",label:"range step",value:c.range,onChange:L=>u("range",L)}],[u,c.b,c.k,c.range,c.x0]),y=LG(a,s,o),x=L=>e(i.id,{k:L}),_=L=>e(i.id,{b:L}),S=y(L=>e(i.id,{x0:L})),w=y(L=>e(i.id,{range:{...i.range,min:L}})),T=y(L=>e(i.id,{range:{...i.range,max:L}})),C=L=>e(i.id,{color:L}),E=L=>n(i.id,L),D=L=>r(i.id,L),O=()=>t(i.id),{clampMinOnBlur:R,clampMaxOnBlur:P}=NG({modelRange:i.range,sliceRange:l,onUpdate:L=>e(i.id,{range:L})});return{name:i.name,color:i.color,active:i.active,values:{k:i.k,b:i.b},display:{x0:d,x1:p,x2:m},steps:c,stepControls:g,handleK:x,handleB:_,handleX0:S,handleX1:w,handleX2:T,handleColorChange:C,handleRename:E,handleToggle:D,handleRemove:O,clampMinOnBlur:R,clampMaxOnBlur:P}}function Q2e(i){const{model:e}=i,{name:t,color:n,active:r,values:s,display:a,steps:o,stepControls:l,handleK:c,handleB:u,handleX0:d,handleX1:p,handleX2:m,handleColorChange:g,handleRename:y,handleToggle:x,handleRemove:_,clampMinOnBlur:S,clampMaxOnBlur:w}=Z2e(e);return v.jsx(IG,{name:t,onRename:y,color:n,onColorChange:g,active:r,onToggleActive:x,onRemove:_,stepControls:l,formula:v.jsx(ke,{children:"y = k(x - x0) + b  (x1 < x < x2)"}),children:v.jsxs(wt,{gap:1,children:[v.jsxs(wt,{direction:"row",gap:2,children:[v.jsx(mi,{label:"k",value:s.k,step:o.k,onChange:c,decimalScale:6}),v.jsx(mi,{label:"b",value:s.b,step:o.b,onChange:u,decimalScale:6})]}),v.jsx(mi,{label:"x0",value:a.x0,step:o.x0,onChange:d}),v.jsxs(wt,{direction:"row",gap:2,children:[v.jsx(mi,{label:"x1",value:a.x1,step:o.range,onChange:p,onBlur:S}),v.jsx(mi,{label:"x2",value:a.x2,step:o.range,onChange:m,onBlur:w})]})]})})}const J2e=pr({slots:["content","emptyState","emptyTitle","emptySubtitle"],className:"fit-models-section",base:{content:{px:4,pb:6,pt:1},emptyState:{alignItems:"center",justifyContent:"center",h:"full",gap:1,textAlign:"center",color:"fg.muted"},emptyTitle:{textStyle:"sm",letterSpacing:"wider",fontWeight:"semibold"},emptySubtitle:{textStyle:"xs",color:"fg.subtle"}}});function e_e(){const{models:i}=K2e(),t=mr({recipe:J2e})();return v.jsxs(eT,{flex:"1",minH:"0",children:[v.jsx(tT,{children:v.jsx(nT,{css:t.content,children:i.length===0?v.jsxs(wt,{css:t.emptyState,children:[v.jsx(ke,{css:t.emptyTitle,children:"NO MODELS LOADED"}),v.jsx(ke,{css:t.emptySubtitle,children:"Add a signal model to begin"})]}):v.jsx(wt,{gap:3,pb:4,children:i.map(n=>n.kind==="linear"?v.jsx(Q2e,{model:n},n.id):v.jsx($2e,{model:n},n.id))})})}),v.jsx(iT,{children:v.jsx(Bb,{})}),v.jsx(rT,{})]})}function t_e(){const{models:i,updateModel:e}=Ai(Tt(c=>({models:c.models,updateModel:c.updateModel}))),[t,n]=z.useState([]),[r,s]=z.useState([]),a=z.useMemo(()=>i.filter(c=>!c.subtracted),[i]),o=z.useMemo(()=>i.filter(c=>c.subtracted),[i]),l=(c,u)=>{for(const d of c)e(Number(d),{subtracted:u});u?n([]):s([])};return{leftModels:a,rightModels:o,selectedLeft:t,selectedRight:r,setSelectedLeft:n,setSelectedRight:s,moveLeftToRight:()=>l(t,!0),moveRightToLeft:()=>l(r,!1)}}const n_e=pr({slots:["root","panel","label","content","groupLabel","item","emptyState","emptyText","transferControls","moveButton"],className:"fit-transfer-listbox",base:{root:{alignItems:"end",justifyContent:"center",gap:2,flexWrap:"wrap"},panel:{display:"flex",flexDirection:"column",gap:1,width:"170px"},label:{textStyle:"2xs",color:"fg.muted",fontWeight:"semibold",letterSpacing:"wider",textTransform:"uppercase"},content:{maxH:"120px",minH:"120px",overflowY:"auto",bg:"bg.card",borderRadius:"md",borderWidth:"1px",borderColor:"border.subtle",p:0},groupLabel:{px:2,py:1,fontSize:"2xs",color:"fg.muted",bg:"bg.muted",fontWeight:"bold"},item:{px:2,py:1,borderRadius:"sm",_hover:{bg:"bg.subtle"},_selected:{bg:{base:"cyan.50",_dark:"cyan.900"},color:{base:"cyan.700",_dark:"cyan.200"}}},emptyState:{alignItems:"center",justifyContent:"center",h:"full",color:"fg.muted"},emptyText:{fontSize:"xs",letterSpacing:"wide",opacity:.6},transferControls:{gap:1,pb:8},moveButton:{color:"fg.muted",_hover:{color:"cyan.400",bg:{base:"gray.100",_dark:"whiteAlpha.100"}}}}});function i_e(){const{leftModels:i,rightModels:e,selectedLeft:t,selectedRight:n,setSelectedLeft:r,setSelectedRight:s,moveLeftToRight:a,moveRightToLeft:o}=t_e(),c=mr({recipe:n_e})(),u=({title:d,models:p,selectedValues:m,onSelectedValuesChange:g})=>{const y=z.useMemo(()=>oc({items:p.map(x=>({label:x.name,value:String(x.id),kind:x.kind})),itemToString:x=>x.label,itemToValue:x=>x.value,groupBy:x=>x.kind==="linear"?"Linear Models":"Gaussian Models"}),[p]);return v.jsxs(MM,{collection:y,selectionMode:"multiple",value:m,onValueChange:x=>g(x.value),css:c.panel,children:[v.jsx(TM,{css:c.label,children:d}),v.jsx(Im,{css:c.content,children:y.items.length>0?y.group().map(([x,_])=>v.jsxs(RK,{children:[v.jsx(PK,{css:c.groupLabel,children:x}),_.map(S=>v.jsxs(Dm,{item:S,css:c.item,children:[v.jsx(qy,{fontSize:"xs",children:S.label}),v.jsx(Xy,{})]},S.value))]},x)):v.jsx(wt,{css:c.emptyState,children:v.jsx(ke,{css:c.emptyText,children:"Empty"})})})]})};return v.jsxs(gt,{css:c.root,children:[v.jsx(u,{title:"Model to draw",models:i,selectedValues:t,onSelectedValuesChange:r}),v.jsxs(wt,{css:c.transferControls,children:[v.jsx(ur,{"aria-label":"Move to subtract",size:"xs",variant:"ghost",css:c.moveButton,disabled:t.length===0,onClick:a,children:v.jsx(bY,{})}),v.jsx(ur,{"aria-label":"Move to draw",size:"xs",variant:"ghost",css:c.moveButton,disabled:n.length===0,onClick:o,children:v.jsx(_Y,{})})]}),v.jsx(u,{title:"Model to subtract",models:e,selectedValues:n,onSelectedValuesChange:s})]})}function r_e(){return v.jsxs(wC,{children:[v.jsxs(qe,{css:Su.topSection,children:[v.jsx(W2e,{}),v.jsx(PG,{}),v.jsx(Iu,{css:Su.divider}),v.jsx(i_e,{})]}),v.jsx(e_e,{})]})}const s_e=({jobId:i})=>{const{data:e}=OY(i),t=Ai(n=>n.updateJob);return z.useEffect(()=>{e&&t(e)},[e,t]),null};function a_e(){const e=Ai(t=>t.jobs).filter(t=>t.status==="pending"||t.status==="processing");return v.jsx(v.Fragment,{children:e.map(t=>v.jsx(s_e,{jobId:t.job_id},t.job_id))})}function ON({title:i,url:e}){return v.jsxs(wt,{gap:2,h:"full",children:[v.jsxs(gt,{justify:"space-between",align:"center",children:[v.jsx(yc,{size:"xs",color:"gray.400",children:i}),v.jsx(Gr,{content:"Open image in new tab",children:v.jsx(SY,{href:e,target:"_blank",children:v.jsxs(hr,{size:"xs",variant:"ghost",colorPalette:"cyan",children:[v.jsx(g1e,{size:14})," Open URL"]})})})]}),v.jsx(qe,{borderRadius:"md",overflow:"hidden",borderWidth:"1px",borderColor:"whiteAlpha.200",bg:"black",flex:1,display:"flex",alignItems:"center",justifyContent:"center",children:v.jsx(DY,{src:e,alt:i,objectFit:"contain",w:"full",maxH:"500px"})})]})}function o_e({selectedJob:i}){const e=bM(s=>s.backendUrl);if(!i)return v.jsx(am,{pt:0,px:0,className:"custom-scrollbar",bg:"blackAlpha.200",children:v.jsxs(ss,{direction:"column",align:"center",justify:"center",h:"full",color:"gray.500",children:[v.jsx(IV,{size:32,style:{opacity:.3,marginBottom:12}}),v.jsx(ke,{children:"Select a completed job to view results."})]})});if(!i.result)return v.jsx(am,{pt:0,px:0,className:"custom-scrollbar",bg:"blackAlpha.200",children:v.jsx(ss,{direction:"column",align:"center",justify:"center",h:"full",color:"gray.500",children:v.jsx(ke,{children:"No results available for this job."})})});const{results:t,best_model_name:n}=i.result,r=Object.keys(t).sort((s,a)=>s===n?-1:a===n?1:s.localeCompare(a));return v.jsx(am,{pt:0,px:0,className:"custom-scrollbar",bg:"blackAlpha.200",children:v.jsxs(Gy,{defaultValue:r[0],w:"full",children:[v.jsx(qe,{px:4,pt:4,borderBottomWidth:"1px",borderColor:"whiteAlpha.200",children:v.jsx(Wy,{gap:2,children:r.map(s=>v.jsx(ko,{value:s,px:3,py:2,_selected:{color:"cyan.400",borderColor:"cyan.400"},children:v.jsxs(gt,{gap:2,children:[v.jsx(ke,{children:s}),s===n&&v.jsx(ec,{colorPalette:"green",size:"xs",variant:"solid",children:"BEST"})]})},s))})}),v.jsx(qe,{p:4,children:r.map(s=>{const a=t[s],o=`${e}${a.plot_file_url}`,l=`${e}${a.plot_posterior_url}`;return v.jsx(Cy,{value:s,children:v.jsxs(ld,{align:"stretch",gap:6,children:[v.jsx(qe,{bg:"whiteAlpha.50",p:4,borderRadius:"md",borderWidth:"1px",borderColor:"whiteAlpha.100",children:v.jsxs(wt,{gap:3,children:[v.jsx(yc,{size:"xs",color:"gray.400",children:"Metrics"}),v.jsxs(gt,{gap:8,children:[v.jsxs(wt,{gap:0,children:[v.jsx(ke,{fontSize:"2xs",color:"gray.500",children:"WAIC"}),v.jsx(ke,{fontSize:"md",fontWeight:"bold",fontFamily:"mono",color:"cyan.200",children:a.waic.toFixed(2)})]}),v.jsxs(wt,{gap:0,children:[v.jsx(ke,{fontSize:"2xs",color:"gray.500",children:"WAIC SE"}),v.jsx(ke,{fontSize:"md",fontWeight:"bold",fontFamily:"mono",color:"gray.300",children:a.waic_se.toFixed(2)})]}),v.jsxs(wt,{gap:0,children:[v.jsx(ke,{fontSize:"2xs",color:"gray.500",children:"TRACE FILE"}),v.jsx(ke,{fontSize:"xs",fontFamily:"mono",color:"gray.500",children:a.trace_filename})]})]})]})}),v.jsxs(Gy,{defaultValue:"fit",variant:"enclosed",fitted:!0,children:[v.jsxs(Wy,{children:[v.jsx(ko,{value:"fit",children:"Fit Plot"}),v.jsx(ko,{value:"posterior",children:"Posterior Plot"})]}),v.jsxs(qe,{mt:4,children:[v.jsx(Cy,{value:"fit",children:v.jsx(ON,{title:"Model Fit",url:o})}),v.jsx(Cy,{value:"posterior",children:v.jsx(ON,{title:"Posterior Distribution",url:l})})]})]})]})},s)})})]})})}function l_e({selectedJob:i}){const{mutate:e,isPending:t}=zY(),n=()=>{i&&e({sourceId:i.job_id,tags:[]})};return v.jsx(AK,{borderTop:"1px solid #333",children:v.jsxs(ss,{w:"full",gap:2,children:[v.jsx(hr,{variant:"surface",flex:1,disabled:!0,children:"Tags (Coming Soon)"}),v.jsx(hr,{colorPalette:"blue",onClick:n,loading:t,disabled:!i||i.status!=="completed",children:"Save"})]})})}function c_e({jobs:i,selectedJobId:e,onSelectJob:t,onRemoveJob:n}){const r=[...i].reverse(),s=o=>{switch(o){case"completed":return v.jsx(c1e,{size:12});case"processing":return v.jsx(KD,{size:12,className:"animate-pulse"});case"pending":return v.jsx(KD,{size:12});case"failed":return v.jsx(PV,{size:12});default:return v.jsx(IV,{size:12})}},a=o=>{switch(o){case"completed":return"green";case"processing":return"blue";case"pending":return"gray";case"failed":return"red";default:return"gray"}};return v.jsxs($6,{borderBottom:"1px solid #222",pb:4,children:[v.jsxs(gt,{justify:"space-between",children:[v.jsx(yc,{size:"sm",color:"white",children:"Fit Jobs"}),v.jsx(X6,{asChild:!0,children:v.jsx(Fb,{size:"md"})})]}),v.jsx(qe,{mt:4,mb:2,children:v.jsx(qe,{h:"120px",overflowY:"auto",pr:2,className:"custom-scrollbar",children:v.jsxs(wt,{gap:2,children:[r.map(o=>{const l=e===o.job_id,c=o.status==="completed";return v.jsxs(ss,{justify:"space-between",align:"center",bg:l?"cyan.900/30":"whiteAlpha.50",borderColor:l?"cyan.500":"whiteAlpha.100",borderWidth:"1px",borderRadius:"md",p:2,cursor:"pointer",_hover:{borderColor:c?"cyan.400":void 0,bg:l?"cyan.900/40":"whiteAlpha.100"},onClick:()=>t(o.job_id,o.status),transition:"all 0.2s",children:[v.jsxs(gt,{gap:3,children:[v.jsx(ec,{variant:o.status==="processing"?"subtle":"solid",colorPalette:a(o.status),size:"sm",children:v.jsxs(gt,{gap:1,children:[s(o.status),v.jsx(ke,{children:o.status.toUpperCase()})]})}),v.jsxs(ke,{fontSize:"xs",fontFamily:"mono",color:"gray.400",children:["ID: ",o.job_id.slice(0,8)]})]}),(o.status==="completed"||o.status==="failed")&&v.jsx(ur,{size:"xs",variant:"ghost",colorPalette:"red","aria-label":"Delete job",onClick:u=>{u.stopPropagation(),n(o.job_id)},children:v.jsx(rC,{size:14})})]},o.job_id)}),r.length===0&&v.jsx(ke,{color:"gray.500",fontSize:"xs",textAlign:"center",py:2,children:"No jobs found."})]})})})]})}function u_e({children:i}){const e=Ai(l=>l.jobs),t=Ai(l=>l.removeJob),[n,r]=z.useState(null),s=e.find(l=>l.job_id===n),a=(l,c)=>{r(n===l?null:l)},o=l=>{t(l),n===l&&r(null)};return v.jsxs(G6,{placement:"end",size:"xl",children:[v.jsx(Y6,{}),v.jsx(FO,{asChild:!0,children:i}),v.jsx(W6,{children:v.jsxs(q6,{bg:"#09090b",borderLeft:"1px solid #333",children:[v.jsx(c_e,{jobs:e,selectedJobId:n,onSelectJob:a,onRemoveJob:o}),v.jsx(o_e,{selectedJob:s}),v.jsx(l_e,{selectedJob:s})]})})]})}const h_e=pr({slots:["root","left","title","leftSlot","rightSlot"],className:"forward-source-section-header",base:{root:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",columnGap:3,rowGap:2,gap:2,w:"full",minW:0},left:{display:"flex",alignItems:"center",gap:2,flex:"1 1 auto",minW:0,flexWrap:"wrap"},title:{fontSize:"sm",letterSpacing:"wide",fontWeight:"extrabold",textTransform:"uppercase",color:{base:"gray.700",_dark:"transparent"},bgGradient:{base:"none",_dark:"to-r"},gradientFrom:{_dark:"cyan.400"},gradientTo:{_dark:"purple.500"},bgClip:{base:"border-box",_dark:"text"}},leftSlot:{display:"flex",alignItems:"center",gap:2},rightSlot:{display:"flex",alignItems:"center",gap:2,flexShrink:0}}});function TC({title:i,tip:e,leftSlot:t,rightSlot:n}){const s=mr({recipe:h_e})();return v.jsxs(gt,{css:s.root,children:[v.jsxs(gt,{css:s.left,children:[v.jsx(yc,{css:s.title,children:i}),e?v.jsx(RG,{content:e}):null,t?v.jsx(qe,{css:s.leftSlot,children:t}):null]}),n?v.jsx(qe,{css:s.rightSlot,children:n}):null]})}const d_e="GRISMR";function f_e(){const{fitExtraction:i,setFitExtraction:e}=Ai(Tt(r=>({fitExtraction:r.fitExtraction,setFitExtraction:r.setFitExtraction}))),t=r=>{e({apertureSize:r})},n=r=>{const s=r[0]??d_e;e({extractMode:s})};return{fitApertureSize:i.apertureSize,fitExtractMode:[i.extractMode],setFitApertureSize:t,setFitExtractMode:n}}const p_e=pr({slots:["root","label","controls","controlBase","input","selectContent","selectItem"],className:"extraction-settings",base:{root:{gap:2},label:{fontSize:"2xs",fontWeight:"bold",color:"fg.muted",textTransform:"uppercase",letterSpacing:"0.05em",mb:1},controls:{gap:4,alignItems:"end"},controlBase:{bg:{base:"white",_dark:"blackAlpha.200"},borderColor:{base:"gray.200",_dark:"whiteAlpha.100"},_hover:{borderColor:"cyan.400"},_focusWithin:{borderColor:"cyan.500",boxShadow:"0 0 0 1px var(--chakra-colors-cyan-500)"}},input:{fontFamily:"mono"},selectContent:{bg:"bg.panel",borderColor:"border.subtle",backdropFilter:"blur(10px)"},selectItem:{cursor:"pointer",transition:"all 0.1s ease-out",borderRadius:"sm",fontSize:"xs",_hover:{bg:{base:"gray.100",_dark:"whiteAlpha.100"},color:{base:"cyan.600",_dark:"cyan.400"}},_highlighted:{bg:{base:"gray.100",_dark:"whiteAlpha.100"},color:{base:"cyan.600",_dark:"cyan.400"}}}}}),zN=oc({items:[{label:"GRISMR",value:"GRISMR"},{label:"GRISMC",value:"GRISMC"}]});function m_e(){const{fitApertureSize:i,fitExtractMode:e,setFitApertureSize:t,setFitExtractMode:n}=f_e(),s=mr({recipe:p_e})();return v.jsxs(wt,{css:s.root,children:[v.jsx(a_e,{}),v.jsx(TC,{title:"Extraction Settings",rightSlot:v.jsx(u_e,{children:v.jsxs(hr,{size:"xs",variant:"surface",colorPalette:"cyan",children:[v.jsx(a1e,{size:12,style:{marginRight:4}})," Jobs"]})})}),v.jsxs(gt,{css:s.controls,children:[v.jsxs(wt,{gap:0,children:[v.jsx(ke,{css:s.label,children:"Aperture (px)"}),v.jsxs(qo,{size:"xs",value:i.toString(),onValueChange:a=>t(Number(a.value)),w:"100px",children:[v.jsx(jO,{css:s.controlBase}),v.jsx(Xo,{css:s.input})]})]}),v.jsxs(wt,{gap:0,children:[v.jsx(ke,{css:s.label,children:"Mode"}),v.jsxs(Hb,{collection:zN,size:"xs",value:e,onValueChange:a=>n(a.value),width:"100px",children:[v.jsx(lT,{}),v.jsx(oT,{css:s.controlBase,children:v.jsx(jb,{children:v.jsx(Wb,{})})}),v.jsx(Au,{children:v.jsx(Vb,{children:v.jsx(Gb,{css:s.selectContent,children:zN.items.map(a=>v.jsxs(qb,{item:a,css:s.selectItem,children:[v.jsx(KO,{children:a.label}),v.jsx(aT,{})]},a.value))})})})]})]})]})]})}function g_e({configId:i}){const e=Ai(Tt(n=>n.configurations.find(r=>r.id===i)?.name||"")),t=Ai(n=>n.setConfigurationName);return v.jsx(F6,{variant:"flushed",size:"sm",fontWeight:"bold",fontSize:"md",placeholder:"Untitled Configuration",value:e,onChange:n=>t(i,n.target.value),_focus:{borderColor:"cyan.400"},maxLength:30})}const kG=i=>i==="gaussian"?[{label:"A",value:"amplitude"},{label:"",value:"mu"},{label:"",value:"sigma"}]:[{label:"k",value:"k"},{label:"b",value:"b"},{label:"x",value:"x0"}];function x_e(i){const{config:e,onChange:t,allModels:n,currentModelId:r,paramName:s}=i,a=n.find(m=>m.id===r),o=z.useMemo(()=>{const m=n.map(g=>({label:g.name,value:String(g.id)}));return oc({items:m})},[n]),l=n.find(m=>m.id===e.refModelId),c=z.useMemo(()=>{const m=l?kG(l.kind).map(g=>({label:g.label,value:g.value,disabled:l.id===r&&g.value===s})):[];return oc({items:m})},[l,r,s]),u=m=>{const g=Number(m.value[0]);t({...e,refModelId:g,refParam:void 0})},d=wM({collection:o,value:[String(e.refModelId)],onValueChange:u}),p=wM({collection:c,value:e.refParam?[e.refParam]:[],onValueChange:m=>t({...e,refParam:m.value[0]})});return v.jsxs(wt,{gap:5,children:[v.jsxs(Lb,{templateColumns:"1fr 1fr",gap:4,children:[v.jsxs(rE,{value:d,h:"100px",children:[v.jsx(TM,{fontSize:"xs",fontWeight:"medium",color:"fg.muted",children:"Reference Model"}),v.jsx(Im,{children:o.items.map(m=>v.jsxs(Dm,{item:m,children:[v.jsx(qy,{children:m.label}),v.jsx(Xy,{})]},m.value))})]}),v.jsxs(rE,{value:p,h:"100px",children:[v.jsx(TM,{fontSize:"xs",fontWeight:"medium",color:"fg.muted",children:"Parameter"}),v.jsx(Im,{children:c.items.length>0?c.items.map(m=>v.jsxs(Dm,{item:m,_disabled:{opacity:.5,cursor:"not-allowed",textDecoration:"line-through"},children:[v.jsx(qy,{children:m.label}),v.jsx(Xy,{})]},m.value)):v.jsx(qe,{p:2,fontSize:"xs",color:"fg.muted",children:"Select a model first"})})]})]}),v.jsxs(gt,{align:"end",gap:3,children:[v.jsxs(wt,{gap:1,children:[v.jsx(ke,{fontSize:"xs",fontWeight:"medium",color:"fg.muted",children:"Operation"}),v.jsxs(AM,{value:e.mode,onValueChange:m=>t({...e,mode:m.value}),size:"sm",width:"80px",children:[v.jsx(RM,{}),v.jsxs(CM,{value:"add",flex:1,children:[v.jsx(EM,{children:"+"}),v.jsx(PM,{})]}),v.jsxs(CM,{value:"multiply",flex:1,children:[v.jsx(EM,{children:""}),v.jsx(PM,{})]})]})]}),v.jsx(qe,{flex:1,children:v.jsx(mi,{label:"Value",value:e.value,onChange:m=>t({...e,value:m}),decimalScale:4})})]}),v.jsxs(gt,{bg:"bg.muted",justify:"space-between",children:[v.jsx(ke,{fontSize:"xs",children:"Preview:"}),v.jsx(y_e,{currentModel:a,paramName:s,refModel:l,config:e})]})]})}function y_e({currentModel:i,paramName:e,refModel:t,config:n}){if(!i)return v.jsx(ke,{fontSize:"xs",children:"N/A"});const r=kG(i.kind).find(l=>l.value===e)?.label||e,s=n.mode==="add"?"+":"",a=!n.refParam,o=a&&t?.kind===i.kind&&t?.id!==i.id;return v.jsx(ke,{fontSize:"xs",children:a?o?v.jsxs(v.Fragment,{children:[i.name,"-",r," = ",t?.name,"-",r," ",s," ",n.value]}):"Invalid Reference Parameter, choose a specific parameter.":v.jsxs(v.Fragment,{children:[r,"@",i.name," = ",n.refParam,"@",t?.name," ",s," ",n.value]})})}function v_e({config:i,onChange:e}){return v.jsx(wt,{gap:4,children:v.jsx(mi,{label:"Value",value:i.value,onChange:t=>e({...i,value:t}),decimalScale:4})})}function b_e(i){const{config:e,onChange:t}=i;return v.jsxs(wt,{gap:4,children:[v.jsx(mi,{label:"",value:e.mu,onChange:n=>t({...e,mu:n}),decimalScale:4}),v.jsx(mi,{label:"",value:e.sigma,onChange:n=>t({...e,sigma:n}),min:0,decimalScale:4}),e.type==="TruncatedNormal"&&v.jsxs(wt,{gap:1,children:[v.jsx(ke,{fontSize:"xs",fontWeight:"semibold",color:"fg.muted",children:"Truncation Bounds"}),v.jsxs(gt,{gap:2,children:[v.jsx(mi,{label:"Lower",value:e.lower??-1/0,onChange:n=>t({...e,lower:n}),labelWidth:"40px"}),v.jsx(mi,{label:"Upper",value:e.upper??1/0,onChange:n=>t({...e,upper:n}),labelWidth:"40px"})]})]})]})}function __e({config:i,onChange:e}){return v.jsxs(wt,{gap:4,children:[v.jsx(mi,{label:"Lower Bound",value:i.lower,onChange:t=>e({...i,lower:t}),decimalScale:4}),v.jsx(mi,{label:"Upper Bound",value:i.upper,onChange:t=>e({...i,upper:t}),decimalScale:4})]})}function S_e(i){const{modelId:e,paramName:t,allModels:n,config:r,onChange:s}=i,a=n.find(y=>y.id===e),o=a?.kind==="gaussian"&&t==="sigma",[l,c]=z.useState(!1),u=z.useMemo(()=>{if(!o||!a||a.kind!=="gaussian")return 1;const y=a.mu>0?a.mu:1;return bxe*iC/y},[o,a]),d=z.useMemo(()=>{if(!r)return;if(!l||u===1)return r;const y=structuredClone(r);return"mu"in y&&(y.mu*=u),"sigma"in y&&(y.sigma*=u),"value"in y&&(y.value*=u),"lower"in y&&y.lower!==void 0&&(y.lower*=u),"upper"in y&&y.upper!==void 0&&(y.upper*=u),y},[r,l,u]),p=z.useCallback(y=>{if(!l||u===1){s(y);return}const x=structuredClone(y);"mu"in x&&(x.mu/=u),"sigma"in x&&(x.sigma/=u),"value"in x&&(x.value/=u),"lower"in x&&x.lower!==void 0&&(x.lower/=u),"upper"in x&&x.upper!==void 0&&(x.upper/=u),s(x)},[l,u,s]);if(!a)return null;const m=r?.type??"Default",g=y=>{if(y===m)return;if(y==="Default"){s(void 0);return}let x=0;const _=d;if(_)"value"in _?x=_.value:"mu"in _?x=_.mu:"lower"in _&&"upper"in _&&_.lower!==void 0&&_.upper!==void 0&&(x=(_.lower+_.upper)/2);else{const T=L6(a,t)??0;x=l?T*u:T}const S=y;let w;switch(S){case"Fixed":w={type:"Fixed",value:x};break;case"Normal":w={type:"Normal",mu:x,sigma:Math.abs(x)*.1||1};break;case"TruncatedNormal":w={type:"TruncatedNormal",mu:x,sigma:Math.abs(x)*.1||1,lower:void 0,upper:void 0};break;case"Uniform":{const T=Math.abs(x)*.1||1;w={type:"Uniform",lower:x-T,upper:x+T};break}case"Deterministic":{const T=n.find(C=>C.id!==e);w={type:"Deterministic",mode:"add",value:0,refModelId:T?T.id:-1};break}default:return}p(w)};return v.jsxs(Gy,{value:m,onValueChange:y=>g(y.value),variant:"enclosed",size:"sm",fitted:!0,children:[v.jsxs(Wy,{children:[v.jsx(ko,{value:"Default",children:"Default"}),v.jsx(ko,{value:"Normal",children:"Normal"}),v.jsx(ko,{value:"TruncatedNormal",children:"Truncated"}),v.jsx(ko,{value:"Uniform",children:"Uniform"}),v.jsx(ko,{value:"Fixed",children:"Fixed"}),v.jsx(ko,{value:"Deterministic",children:"Link"})]}),v.jsxs(qe,{mt:4,p:4,borderWidth:"1px",borderRadius:"md",bg:"bg.subtle",minH:"220px",position:"relative",children:[o&&m!=="Default"&&v.jsx(qe,{position:"absolute",top:3,right:3,zIndex:2,children:v.jsx(Gr,{content:"Toggle to edit parameters in FWHM Velocity (km/s)",positioning:{placement:"top-end"},children:v.jsxs(gt,{gap:1.5,bg:"bg.panel",px:2,py:1,borderRadius:"md",shadow:"xs",borderWidth:"1px",children:[v.jsx(ke,{fontSize:"xs",fontWeight:"bold",color:l?"teal.600":"fg.muted",children:"km/s"}),v.jsxs(E0,{checked:l,onCheckedChange:y=>c(y.checked),size:"xs",colorPalette:"teal",children:[v.jsx(I0,{}),v.jsx(P0,{children:v.jsx(R0,{})})]})]})})}),m==="Default"&&v.jsxs(wt,{h:"full",align:"center",justify:"center",gap:4,opacity:.6,minH:"150px",children:[v.jsxs(ke,{fontSize:"sm",color:"fg.muted",textAlign:"center",maxW:"250px",children:["This parameter is using the ",v.jsx("br",{}),v.jsx("b",{children:"Default Prior"})," (Uninformative)."]}),v.jsx(ke,{fontSize:"xs",color:"fg.muted",children:"Select other tabs to constrain this parameter."})]}),d&&v.jsxs(qe,{pt:1,children:[(d.type==="Normal"||d.type==="TruncatedNormal")&&v.jsx(b_e,{config:d,onChange:p,model:a,paramName:t}),d.type==="Uniform"&&v.jsx(__e,{config:d,onChange:p}),d.type==="Fixed"&&v.jsx(v_e,{config:d,onChange:p}),d.type==="Deterministic"&&v.jsx(x_e,{config:d,onChange:p,allModels:n,currentModelId:e,paramName:t})]})]})]})}function w_e(i){const{allModels:e,updateModelPrior:t,modelId:n,paramName:r}=i,s=e.find(c=>c.id===n);if(!s)return null;const a=s.priors?.[r],o=c=>{t(n,r,c)},l=L6(s,r);return v.jsx(wt,{h:"full",gap:0,overflow:"hidden",children:v.jsx(qe,{flex:"1",overflowY:"auto",p:4,children:v.jsxs(wt,{gap:6,children:[v.jsx(S_e,{modelId:n,paramName:r,allModels:e,config:a,onChange:o}),v.jsx(qe,{h:"150px",bg:"bg.muted",borderRadius:"md",borderStyle:"dashed",borderWidth:"1px",display:"flex",alignItems:"center",justifyContent:"center",children:v.jsxs(ke,{fontSize:"xs",color:"fg.muted",children:["Initial value: ",l]})})]})})})}function M_e({allModels:i,updateModelPrior:e}){const t=()=>{let r=0;i.forEach(s=>{s.priors&&Object.keys(s.priors).forEach(a=>{e(s.id,a,void 0),r++})}),r>0?Ui.create({title:"Priors Cleared",description:`Reset ${r} parameters to default priors.`,type:"success"}):Ui.create({title:"No Priors to Clear",description:"All parameters are already using default values.",type:"info"})},n=()=>{const r=i.filter(l=>l.kind==="gaussian");if(r.length!==2){Ui.create({title:"Auto Guess Unavailable",description:"This feature currently requires exactly 2 Gaussian models.",type:"info"});return}const s=299792.458,a=2.35482;let o=0;r.forEach(l=>{e(l.id,"amplitude",{type:"TruncatedNormal",mu:l.amplitude,sigma:l.amplitude/2,lower:l.amplitude/3});const c=.001;e(l.id,"mu",{type:"TruncatedNormal",mu:l.mu,sigma:c,lower:l.mu-c,upper:l.mu+c});const u=100*l.mu/(s*a),d=Math.max(0,l.sigma-u);e(l.id,"sigma",{type:"TruncatedNormal",mu:l.sigma,sigma:l.sigma/2,lower:d,upper:l.sigma*2}),o++}),Ui.create({title:"Auto Guess Applied",description:`Applied priors to ${o} Gaussian models.`,type:"success"})};return v.jsxs(gt,{justify:"flex-end",gap:2,p:0,children:[v.jsx(Gr,{content:"Intelligently guess priors based on data",children:v.jsxs(hr,{size:"xs",variant:"outline",onClick:n,children:[v.jsx(wY,{}),"Auto"]})}),v.jsx(Gr,{content:"Reset all parameters of all models to default priors",children:v.jsxs(hr,{size:"xs",variant:"ghost",colorPalette:"red",onClick:t,children:[v.jsx(MY,{}),"Reset"]})})]})}class bs{constructor(e,t,n){this.lexer=void 0,this.start=void 0,this.end=void 0,this.lexer=e,this.start=t,this.end=n}static range(e,t){return t?!e||!e.loc||!t.loc||e.loc.lexer!==t.loc.lexer?null:new bs(e.loc.lexer,e.loc.start,t.loc.end):e&&e.loc}}class ra{constructor(e,t){this.text=void 0,this.loc=void 0,this.noexpand=void 0,this.treatAsRelax=void 0,this.text=e,this.loc=t}range(e,t){return new ra(t,bs.range(this,e))}}class Ye{constructor(e,t){this.name=void 0,this.position=void 0,this.length=void 0,this.rawMessage=void 0;var n="KaTeX parse error: "+e,r,s,a=t&&t.loc;if(a&&a.start<=a.end){var o=a.lexer.input;r=a.start,s=a.end,r===o.length?n+=" at end of input: ":n+=" at position "+(r+1)+": ";var l=o.slice(r,s).replace(/[^]/g,"$&"),c;r>15?c=""+o.slice(r-15,r):c=o.slice(0,r);var u;s+15<o.length?u=o.slice(s,s+15)+"":u=o.slice(s),n+=c+l+u}var d=new Error(n);return d.name="ParseError",d.__proto__=Ye.prototype,d.position=r,r!=null&&s!=null&&(d.length=s-r),d.rawMessage=e,d}}Ye.prototype.__proto__=Error.prototype;var T_e=function(e,t){return e===void 0?t:e},A_e=/([A-Z])/g,C_e=function(e){return e.replace(A_e,"-$1").toLowerCase()},E_e={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},R_e=/[&><"']/g;function P_e(i){return String(i).replace(R_e,e=>E_e[e])}var OG=function i(e){return e.type==="ordgroup"||e.type==="color"?e.body.length===1?i(e.body[0]):e:e.type==="font"?i(e.body):e},I_e=function(e){var t=OG(e);return t.type==="mathord"||t.type==="textord"||t.type==="atom"},D_e=function(e){if(!e)throw new Error("Expected non-null, but got "+String(e));return e},N_e=function(e){var t=/^[\x00-\x20]*([^\\/#?]*?)(:|&#0*58|&#x0*3a|&colon)/i.exec(e);return t?t[2]!==":"||!/^[a-zA-Z][a-zA-Z0-9+\-.]*$/.test(t[1])?null:t[1].toLowerCase():"_relative"},wn={deflt:T_e,escape:P_e,hyphenate:C_e,getBaseElem:OG,isCharacterBox:I_e,protocolFromUrl:N_e},Hy={displayMode:{type:"boolean",description:"Render math in display mode, which puts the math in display style (so \\int and \\sum are large, for example), and centers the math on the page on its own line.",cli:"-d, --display-mode"},output:{type:{enum:["htmlAndMathml","html","mathml"]},description:"Determines the markup language of the output.",cli:"-F, --format <type>"},leqno:{type:"boolean",description:"Render display math in leqno style (left-justified tags)."},fleqn:{type:"boolean",description:"Render display math flush left."},throwOnError:{type:"boolean",default:!0,cli:"-t, --no-throw-on-error",cliDescription:"Render errors (in the color given by --error-color) instead of throwing a ParseError exception when encountering an error."},errorColor:{type:"string",default:"#cc0000",cli:"-c, --error-color <color>",cliDescription:"A color string given in the format 'rgb' or 'rrggbb' (no #). This option determines the color of errors rendered by the -t option.",cliProcessor:i=>"#"+i},macros:{type:"object",cli:"-m, --macro <def>",cliDescription:"Define custom macro of the form '\\foo:expansion' (use multiple -m arguments for multiple macros).",cliDefault:[],cliProcessor:(i,e)=>(e.push(i),e)},minRuleThickness:{type:"number",description:"Specifies a minimum thickness, in ems, for fraction lines, `\\sqrt` top lines, `{array}` vertical lines, `\\hline`, `\\hdashline`, `\\underline`, `\\overline`, and the borders of `\\fbox`, `\\boxed`, and `\\fcolorbox`.",processor:i=>Math.max(0,i),cli:"--min-rule-thickness <size>",cliProcessor:parseFloat},colorIsTextColor:{type:"boolean",description:"Makes \\color behave like LaTeX's 2-argument \\textcolor, instead of LaTeX's one-argument \\color mode change.",cli:"-b, --color-is-text-color"},strict:{type:[{enum:["warn","ignore","error"]},"boolean","function"],description:"Turn on strict / LaTeX faithfulness mode, which throws an error if the input uses features that are not supported by LaTeX.",cli:"-S, --strict",cliDefault:!1},trust:{type:["boolean","function"],description:"Trust the input, enabling all HTML features such as \\url.",cli:"-T, --trust"},maxSize:{type:"number",default:1/0,description:"If non-zero, all user-specified sizes, e.g. in \\rule{500em}{500em}, will be capped to maxSize ems. Otherwise, elements and spaces can be arbitrarily large",processor:i=>Math.max(0,i),cli:"-s, --max-size <n>",cliProcessor:parseInt},maxExpand:{type:"number",default:1e3,description:"Limit the number of macro expansions to the specified number, to prevent e.g. infinite macro loops. If set to Infinity, the macro expander will try to fully expand as in LaTeX.",processor:i=>Math.max(0,i),cli:"-e, --max-expand <n>",cliProcessor:i=>i==="Infinity"?1/0:parseInt(i)},globalGroup:{type:"boolean",cli:!1}};function L_e(i){if(i.default)return i.default;var e=i.type,t=Array.isArray(e)?e[0]:e;if(typeof t!="string")return t.enum[0];switch(t){case"boolean":return!1;case"string":return"";case"number":return 0;case"object":return{}}}class AC{constructor(e){this.displayMode=void 0,this.output=void 0,this.leqno=void 0,this.fleqn=void 0,this.throwOnError=void 0,this.errorColor=void 0,this.macros=void 0,this.minRuleThickness=void 0,this.colorIsTextColor=void 0,this.strict=void 0,this.trust=void 0,this.maxSize=void 0,this.maxExpand=void 0,this.globalGroup=void 0,e=e||{};for(var t in Hy)if(Hy.hasOwnProperty(t)){var n=Hy[t];this[t]=e[t]!==void 0?n.processor?n.processor(e[t]):e[t]:L_e(n)}}reportNonstrict(e,t,n){var r=this.strict;if(typeof r=="function"&&(r=r(e,t,n)),!(!r||r==="ignore")){if(r===!0||r==="error")throw new Ye("LaTeX-incompatible input and strict mode is set to 'error': "+(t+" ["+e+"]"),n);r==="warn"?typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+(t+" ["+e+"]")):typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to "+("unrecognized '"+r+"': "+t+" ["+e+"]"))}}useStrictBehavior(e,t,n){var r=this.strict;if(typeof r=="function")try{r=r(e,t,n)}catch{r="error"}return!r||r==="ignore"?!1:r===!0||r==="error"?!0:r==="warn"?(typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+(t+" ["+e+"]")),!1):(typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to "+("unrecognized '"+r+"': "+t+" ["+e+"]")),!1)}isTrusted(e){if(e.url&&!e.protocol){var t=wn.protocolFromUrl(e.url);if(t==null)return!1;e.protocol=t}var n=typeof this.trust=="function"?this.trust(e):this.trust;return!!n}}class Yc{constructor(e,t,n){this.id=void 0,this.size=void 0,this.cramped=void 0,this.id=e,this.size=t,this.cramped=n}sup(){return Oo[k_e[this.id]]}sub(){return Oo[O_e[this.id]]}fracNum(){return Oo[z_e[this.id]]}fracDen(){return Oo[U_e[this.id]]}cramp(){return Oo[F_e[this.id]]}text(){return Oo[B_e[this.id]]}isTight(){return this.size>=2}}var CC=0,Mb=1,Kf=2,sc=3,Rg=4,Na=5,A0=6,rs=7,Oo=[new Yc(CC,0,!1),new Yc(Mb,0,!0),new Yc(Kf,1,!1),new Yc(sc,1,!0),new Yc(Rg,2,!1),new Yc(Na,2,!0),new Yc(A0,3,!1),new Yc(rs,3,!0)],k_e=[Rg,Na,Rg,Na,A0,rs,A0,rs],O_e=[Na,Na,Na,Na,rs,rs,rs,rs],z_e=[Kf,sc,Rg,Na,A0,rs,A0,rs],U_e=[sc,sc,Na,Na,rs,rs,rs,rs],F_e=[Mb,Mb,sc,sc,Na,Na,rs,rs],B_e=[CC,Mb,Kf,sc,Kf,sc,Kf,sc],zt={DISPLAY:Oo[CC],TEXT:Oo[Kf],SCRIPT:Oo[Rg],SCRIPTSCRIPT:Oo[A0]},v6=[{name:"latin",blocks:[[256,591],[768,879]]},{name:"cyrillic",blocks:[[1024,1279]]},{name:"armenian",blocks:[[1328,1423]]},{name:"brahmic",blocks:[[2304,4255]]},{name:"georgian",blocks:[[4256,4351]]},{name:"cjk",blocks:[[12288,12543],[19968,40879],[65280,65376]]},{name:"hangul",blocks:[[44032,55215]]}];function H_e(i){for(var e=0;e<v6.length;e++)for(var t=v6[e],n=0;n<t.blocks.length;n++){var r=t.blocks[n];if(i>=r[0]&&i<=r[1])return t.name}return null}var jy=[];v6.forEach(i=>i.blocks.forEach(e=>jy.push(...e)));function zG(i){for(var e=0;e<jy.length;e+=2)if(i>=jy[e]&&i<=jy[e+1])return!0;return!1}var Af=80,j_e=function(e,t){return"M95,"+(622+e+t)+`
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l`+e/2.075+" -"+e+`
c5.3,-9.3,12,-14,20,-14
H400000v`+(40+e)+`H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M`+(834+e)+" "+t+"h400000v"+(40+e)+"h-400000z"},V_e=function(e,t){return"M263,"+(601+e+t)+`c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l`+e/2.084+" -"+e+`
c4.7,-7.3,11,-11,19,-11
H40000v`+(40+e)+`H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M`+(1001+e)+" "+t+"h400000v"+(40+e)+"h-400000z"},G_e=function(e,t){return"M983 "+(10+e+t)+`
l`+e/3.13+" -"+e+`
c4,-6.7,10,-10,18,-10 H400000v`+(40+e)+`
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M`+(1001+e)+" "+t+"h400000v"+(40+e)+"h-400000z"},W_e=function(e,t){return"M424,"+(2398+e+t)+`
c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514
c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20
s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121
s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081
l`+e/4.223+" -"+e+`c4,-6.7,10,-10,18,-10 H400000
v`+(40+e)+`H1014.6
s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185
c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2z M`+(1001+e)+" "+t+`
h400000v`+(40+e)+"h-400000z"},q_e=function(e,t){return"M473,"+(2713+e+t)+`
c339.3,-1799.3,509.3,-2700,510,-2702 l`+e/5.298+" -"+e+`
c3.3,-7.3,9.3,-11,18,-11 H400000v`+(40+e)+`H1017.7
s-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200
c0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26
s76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,
606zM`+(1001+e)+" "+t+"h400000v"+(40+e)+"H1017.7z"},X_e=function(e){var t=e/2;return"M400000 "+e+" H0 L"+t+" 0 l65 45 L145 "+(e-80)+" H400000z"},Y_e=function(e,t,n){var r=n-54-t-e;return"M702 "+(e+t)+"H400000"+(40+e)+`
H742v`+r+`l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1
h-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170
c-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667
219 661 l218 661zM702 `+t+"H400000v"+(40+e)+"H742z"},$_e=function(e,t,n){t=1e3*t;var r="";switch(e){case"sqrtMain":r=j_e(t,Af);break;case"sqrtSize1":r=V_e(t,Af);break;case"sqrtSize2":r=G_e(t,Af);break;case"sqrtSize3":r=W_e(t,Af);break;case"sqrtSize4":r=q_e(t,Af);break;case"sqrtTall":r=Y_e(t,Af,n)}return r},K_e=function(e,t){switch(e){case"":return"M291 0 H417 V"+t+" H291z M291 0 H417 V"+t+" H291z";case"":return"M145 0 H188 V"+t+" H145z M145 0 H188 V"+t+" H145z";case"":return"M145 0 H188 V"+t+" H145z M145 0 H188 V"+t+" H145z"+("M367 0 H410 V"+t+" H367z M367 0 H410 V"+t+" H367z");case"":return"M457 0 H583 V"+t+" H457z M457 0 H583 V"+t+" H457z";case"":return"M319 0 H403 V"+t+" H319z M319 0 H403 V"+t+" H319z";case"":return"M263 0 H347 V"+t+" H263z M263 0 H347 V"+t+" H263z";case"":return"M384 0 H504 V"+t+" H384z M384 0 H504 V"+t+" H384z";case"":return"M312 0 H355 V"+t+" H312z M312 0 H355 V"+t+" H312z";case"":return"M257 0 H300 V"+t+" H257z M257 0 H300 V"+t+" H257z"+("M478 0 H521 V"+t+" H478z M478 0 H521 V"+t+" H478z");default:return""}},UN={doubleleftarrow:`M262 157
l10-10c34-36 62.7-77 86-123 3.3-8 5-13.3 5-16 0-5.3-6.7-8-20-8-7.3
 0-12.2.5-14.5 1.5-2.3 1-4.8 4.5-7.5 10.5-49.3 97.3-121.7 169.3-217 216-28
 14-57.3 25-88 33-6.7 2-11 3.8-13 5.5-2 1.7-3 4.2-3 7.5s1 5.8 3 7.5
c2 1.7 6.3 3.5 13 5.5 68 17.3 128.2 47.8 180.5 91.5 52.3 43.7 93.8 96.2 124.5
 157.5 9.3 8 15.3 12.3 18 13h6c12-.7 18-4 18-10 0-2-1.7-7-5-15-23.3-46-52-87
-86-123l-10-10h399738v-40H218c328 0 0 0 0 0l-10-8c-26.7-20-65.7-43-117-69 2.7
-2 6-3.7 10-5 36.7-16 72.3-37.3 107-64l10-8h399782v-40z
m8 0v40h399730v-40zm0 194v40h399730v-40z`,doublerightarrow:`M399738 392l
-10 10c-34 36-62.7 77-86 123-3.3 8-5 13.3-5 16 0 5.3 6.7 8 20 8 7.3 0 12.2-.5
 14.5-1.5 2.3-1 4.8-4.5 7.5-10.5 49.3-97.3 121.7-169.3 217-216 28-14 57.3-25 88
-33 6.7-2 11-3.8 13-5.5 2-1.7 3-4.2 3-7.5s-1-5.8-3-7.5c-2-1.7-6.3-3.5-13-5.5-68
-17.3-128.2-47.8-180.5-91.5-52.3-43.7-93.8-96.2-124.5-157.5-9.3-8-15.3-12.3-18
-13h-6c-12 .7-18 4-18 10 0 2 1.7 7 5 15 23.3 46 52 87 86 123l10 10H0v40h399782
c-328 0 0 0 0 0l10 8c26.7 20 65.7 43 117 69-2.7 2-6 3.7-10 5-36.7 16-72.3 37.3
-107 64l-10 8H0v40zM0 157v40h399730v-40zm0 194v40h399730v-40z`,leftarrow:`M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z`,leftbrace:`M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117
-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7
 5-6 9-10 13-.7 1-7.3 1-20 1H6z`,leftbraceunder:`M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z`,leftgroup:`M400000 80
H435C64 80 168.3 229.4 21 260c-5.9 1.2-18 0-18 0-2 0-3-1-3-3v-38C76 61 257 0
 435 0h399565z`,leftgroupunder:`M400000 262
H435C64 262 168.3 112.6 21 82c-5.9-1.2-18 0-18 0-2 0-3 1-3 3v38c76 158 257 219
 435 219h399565z`,leftharpoon:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3
-3.3 10.2-9.5 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5
-18.3 3-21-1.3-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7
-196 228-6.7 4.7-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40z`,leftharpoonplus:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3-3.3 10.2-9.5
 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5-18.3 3-21-1.3
-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7-196 228-6.7 4.7
-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40zM0 435v40h400000v-40z
m0 0v40h400000v-40z`,leftharpoondown:`M7 241c-4 4-6.333 8.667-7 14 0 5.333.667 9 2 11s5.333
 5.333 12 10c90.667 54 156 130 196 228 3.333 10.667 6.333 16.333 9 17 2 .667 5
 1 9 1h5c10.667 0 16.667-2 18-6 2-2.667 1-9.667-3-21-32-87.333-82.667-157.667
-152-211l-3-3h399907v-40zM93 281 H400000 v-40L7 241z`,leftharpoondownplus:`M7 435c-4 4-6.3 8.7-7 14 0 5.3.7 9 2 11s5.3 5.3 12
 10c90.7 54 156 130 196 228 3.3 10.7 6.3 16.3 9 17 2 .7 5 1 9 1h5c10.7 0 16.7
-2 18-6 2-2.7 1-9.7-3-21-32-87.3-82.7-157.7-152-211l-3-3h399907v-40H7zm93 0
v40h399900v-40zM0 241v40h399900v-40zm0 0v40h399900v-40z`,lefthook:`M400000 281 H103s-33-11.2-61-33.5S0 197.3 0 164s14.2-61.2 42.5
-83.5C70.8 58.2 104 47 142 47 c16.7 0 25 6.7 25 20 0 12-8.7 18.7-26 20-40 3.3
-68.7 15.7-86 37-10 12-15 25.3-15 40 0 22.7 9.8 40.7 29.5 54 19.7 13.3 43.5 21
 71.5 23h399859zM103 281v-40h399897v40z`,leftlinesegment:`M40 281 V428 H0 V94 H40 V241 H400000 v40z
M40 281 V428 H0 V94 H40 V241 H400000 v40z`,leftmapsto:`M40 281 V448H0V74H40V241H400000v40z
M40 281 V448H0V74H40V241H400000v40z`,leftToFrom:`M0 147h400000v40H0zm0 214c68 40 115.7 95.7 143 167h22c15.3 0 23
-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69-70-101l-7-8h399905v-40H95l7-8
c28.7-32 52-65.7 70-101 10.7-23.3 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 265.3
 68 321 0 361zm0-174v-40h399900v40zm100 154v40h399900v-40z`,longequal:`M0 50 h400000 v40H0z m0 194h40000v40H0z
M0 50 h400000 v40H0z m0 194h40000v40H0z`,midbrace:`M200428 334
c-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14
-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7
 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11
 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z`,midbraceunder:`M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z`,oiintSize1:`M512.6 71.6c272.6 0 320.3 106.8 320.3 178.2 0 70.8-47.7 177.6
-320.3 177.6S193.1 320.6 193.1 249.8c0-71.4 46.9-178.2 319.5-178.2z
m368.1 178.2c0-86.4-60.9-215.4-368.1-215.4-306.4 0-367.3 129-367.3 215.4 0 85.8
60.9 214.8 367.3 214.8 307.2 0 368.1-129 368.1-214.8z`,oiintSize2:`M757.8 100.1c384.7 0 451.1 137.6 451.1 230 0 91.3-66.4 228.8
-451.1 228.8-386.3 0-452.7-137.5-452.7-228.8 0-92.4 66.4-230 452.7-230z
m502.4 230c0-111.2-82.4-277.2-502.4-277.2s-504 166-504 277.2
c0 110 84 276 504 276s502.4-166 502.4-276z`,oiiintSize1:`M681.4 71.6c408.9 0 480.5 106.8 480.5 178.2 0 70.8-71.6 177.6
-480.5 177.6S202.1 320.6 202.1 249.8c0-71.4 70.5-178.2 479.3-178.2z
m525.8 178.2c0-86.4-86.8-215.4-525.7-215.4-437.9 0-524.7 129-524.7 215.4 0
85.8 86.8 214.8 524.7 214.8 438.9 0 525.7-129 525.7-214.8z`,oiiintSize2:`M1021.2 53c603.6 0 707.8 165.8 707.8 277.2 0 110-104.2 275.8
-707.8 275.8-606 0-710.2-165.8-710.2-275.8C311 218.8 415.2 53 1021.2 53z
m770.4 277.1c0-131.2-126.4-327.6-770.5-327.6S248.4 198.9 248.4 330.1
c0 130 128.8 326.4 772.7 326.4s770.5-196.4 770.5-326.4z`,rightarrow:`M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z`,rightbrace:`M400000 542l
-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5
s-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1
c124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z`,rightbraceunder:`M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z`,rightgroup:`M0 80h399565c371 0 266.7 149.4 414 180 5.9 1.2 18 0 18 0 2 0
 3-1 3-3v-38c-76-158-257-219-435-219H0z`,rightgroupunder:`M0 262h399565c371 0 266.7-149.4 414-180 5.9-1.2 18 0 18
 0 2 0 3 1 3 3v38c-76 158-257 219-435 219H0z`,rightharpoon:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3
-3.7-15.3-11-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2
-10.7 0-16.7 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58
 69.2 92 94.5zm0 0v40h399900v-40z`,rightharpoonplus:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3-3.7-15.3-11
-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2-10.7 0-16.7
 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58 69.2 92 94.5z
m0 0v40h399900v-40z m100 194v40h399900v-40zm0 0v40h399900v-40z`,rightharpoondown:`M399747 511c0 7.3 6.7 11 20 11 8 0 13-.8 15-2.5s4.7-6.8
 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3 8.5-5.8 9.5
-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3-64.7 57-92 95
-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 241v40h399900v-40z`,rightharpoondownplus:`M399747 705c0 7.3 6.7 11 20 11 8 0 13-.8
 15-2.5s4.7-6.8 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3
 8.5-5.8 9.5-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3
-64.7 57-92 95-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 435v40h399900v-40z
m0-194v40h400000v-40zm0 0v40h400000v-40z`,righthook:`M399859 241c-764 0 0 0 0 0 40-3.3 68.7-15.7 86-37 10-12 15-25.3
 15-40 0-22.7-9.8-40.7-29.5-54-19.7-13.3-43.5-21-71.5-23-17.3-1.3-26-8-26-20 0
-13.3 8.7-20 26-20 38 0 71 11.2 99 33.5 0 0 7 5.6 21 16.7 14 11.2 21 33.5 21
 66.8s-14 61.2-42 83.5c-28 22.3-61 33.5-99 33.5L0 241z M0 281v-40h399859v40z`,rightlinesegment:`M399960 241 V94 h40 V428 h-40 V281 H0 v-40z
M399960 241 V94 h40 V428 h-40 V281 H0 v-40z`,rightToFrom:`M400000 167c-70.7-42-118-97.7-142-167h-23c-15.3 0-23 .3-23
 1 0 1.3 5.3 13.7 16 37 18 35.3 41.3 69 70 101l7 8H0v40h399905l-7 8c-28.7 32
-52 65.7-70 101-10.7 23.3-16 35.7-16 37 0 .7 7.7 1 23 1h23c24-69.3 71.3-125 142
-167z M100 147v40h399900v-40zM0 341v40h399900v-40z`,twoheadleftarrow:`M0 167c68 40
 115.7 95.7 143 167h22c15.3 0 23-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69
-70-101l-7-8h125l9 7c50.7 39.3 85 86 103 140h46c0-4.7-6.3-18.7-19-42-18-35.3
-40-67.3-66-96l-9-9h399716v-40H284l9-9c26-28.7 48-60.7 66-96 12.7-23.333 19
-37.333 19-42h-46c-18 54-52.3 100.7-103 140l-9 7H95l7-8c28.7-32 52-65.7 70-101
 10.7-23.333 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 71.3 68 127 0 167z`,twoheadrightarrow:`M400000 167
c-68-40-115.7-95.7-143-167h-22c-15.3 0-23 .3-23 1 0 1.3 5.3 13.7 16 37 18 35.3
 41.3 69 70 101l7 8h-125l-9-7c-50.7-39.3-85-86-103-140h-46c0 4.7 6.3 18.7 19 42
 18 35.3 40 67.3 66 96l9 9H0v40h399716l-9 9c-26 28.7-48 60.7-66 96-12.7 23.333
-19 37.333-19 42h46c18-54 52.3-100.7 103-140l9-7h125l-7 8c-28.7 32-52 65.7-70
 101-10.7 23.333-16 35.7-16 37 0 .7 7.7 1 23 1h22c27.3-71.3 75-127 143-167z`,tilde1:`M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z`,tilde2:`M344 55.266c-142 0-300.638 81.316-311.5 86.418
-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9
 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114
c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751
 181.476 676 181.476c-149 0-189-126.21-332-126.21z`,tilde3:`M786 59C457 59 32 175.242 13 175.242c-6 0-10-3.457
-11-10.37L.15 138c-1-7 3-12 10-13l19.2-6.4C378.4 40.7 634.3 0 804.3 0c337 0
 411.8 157 746.8 157 328 0 754-112 773-112 5 0 10 3 11 9l1 14.075c1 8.066-.697
 16.595-6.697 17.492l-21.052 7.31c-367.9 98.146-609.15 122.696-778.15 122.696
 -338 0-409-156.573-744-156.573z`,tilde4:`M786 58C457 58 32 177.487 13 177.487c-6 0-10-3.345
-11-10.035L.15 143c-1-7 3-12 10-13l22-6.7C381.2 35 637.15 0 807.15 0c337 0 409
 177 744 177 328 0 754-127 773-127 5 0 10 3 11 9l1 14.794c1 7.805-3 13.38-9
 14.495l-20.7 5.574c-366.85 99.79-607.3 139.372-776.3 139.372-338 0-409
 -175.236-744-175.236z`,vec:`M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z`,widehat1:`M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z`,widehat2:`M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat3:`M1181 0h2l1171 236c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 280h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat4:`M1181 0h2l1171 296c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 340h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widecheck1:`M529,159h5l519,-115c5,-1,9,-5,9,-10c0,-1,-1,-2,-1,-3l-4,-22c-1,
-5,-5,-9,-11,-9h-2l-512,92l-513,-92h-2c-5,0,-9,4,-11,9l-5,22c-1,6,2,12,8,13z`,widecheck2:`M1181,220h2l1171,-176c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,153l-1167,-153h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck3:`M1181,280h2l1171,-236c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,213l-1167,-213h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck4:`M1181,340h2l1171,-296c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,273l-1167,-273h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,baraboveleftarrow:`M400000 620h-399890l3 -3c68.7 -52.7 113.7 -120 135 -202
c4 -14.7 6 -23 6 -25c0 -7.3 -7 -11 -21 -11c-8 0 -13.2 0.8 -15.5 2.5
c-2.3 1.7 -4.2 5.8 -5.5 12.5c-1.3 4.7 -2.7 10.3 -4 17c-12 48.7 -34.8 92 -68.5 130
s-74.2 66.3 -121.5 85c-10 4 -16 7.7 -18 11c0 8.7 6 14.3 18 17c47.3 18.7 87.8 47
121.5 85s56.5 81.3 68.5 130c0.7 2 1.3 5 2 9s1.2 6.7 1.5 8c0.3 1.3 1 3.3 2 6
s2.2 4.5 3.5 5.5c1.3 1 3.3 1.8 6 2.5s6 1 10 1c14 0 21 -3.7 21 -11
c0 -2 -2 -10.3 -6 -25c-20 -79.3 -65 -146.7 -135 -202l-3 -3h399890z
M100 620v40h399900v-40z M0 241v40h399900v-40zM0 241v40h399900v-40z`,rightarrowabovebar:`M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32
-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0
13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39
-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5
-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
151.7 139 205zm96 379h399894v40H0zm0 0h399904v40H0z`,baraboveshortleftharpoon:`M507,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11
c1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17
c2,0.7,5,1,9,1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21
c-32,-87.3,-82.7,-157.7,-152,-211c0,0,-3,-3,-3,-3l399351,0l0,-40
c-398570,0,-399437,0,-399437,0z M593 435 v40 H399500 v-40z
M0 281 v-40 H399908 v40z M0 281 v-40 H399908 v40z`,rightharpoonaboveshortbar:`M0,241 l0,40c399126,0,399993,0,399993,0
c4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,
-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6
c-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z
M0 241 v40 H399908 v-40z M0 475 v-40 H399500 v40z M0 475 v-40 H399500 v40z`,shortbaraboveleftharpoon:`M7,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11
c1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17c2,0.7,5,1,9,
1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21c-32,-87.3,-82.7,-157.7,
-152,-211c0,0,-3,-3,-3,-3l399907,0l0,-40c-399126,0,-399993,0,-399993,0z
M93 435 v40 H400000 v-40z M500 241 v40 H400000 v-40z M500 241 v40 H400000 v-40z`,shortrightharpoonabovebar:`M53,241l0,40c398570,0,399437,0,399437,0
c4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,
-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6
c-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z
M500 241 v40 H399408 v-40z M500 435 v40 H400000 v-40z`},Z_e=function(e,t){switch(e){case"lbrack":return"M403 1759 V84 H666 V0 H319 V1759 v"+t+` v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v`+t+" v1759 h84z";case"rbrack":return"M347 1759 V0 H0 V84 H263 V1759 v"+t+` v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v`+t+" v1759 h84z";case"vert":return"M145 15 v585 v"+t+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-t+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v`+t+" v585 h43z";case"doublevert":return"M145 15 v585 v"+t+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-t+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v`+t+` v585 h43z
M367 15 v585 v`+t+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-t+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v`+t+" v585 h43z";case"lfloor":return"M319 602 V0 H403 V602 v"+t+` v1715 h263 v84 H319z
MM319 602 V0 H403 V602 v`+t+" v1715 H319z";case"rfloor":return"M319 602 V0 H403 V602 v"+t+` v1799 H0 v-84 H319z
MM319 602 V0 H403 V602 v`+t+" v1715 H319z";case"lceil":return"M403 1759 V84 H666 V0 H319 V1759 v"+t+` v602 h84z
M403 1759 V0 H319 V1759 v`+t+" v602 h84z";case"rceil":return"M347 1759 V0 H0 V84 H263 V1759 v"+t+` v602 h84z
M347 1759 V0 h-84 V1759 v`+t+" v602 h84z";case"lparen":return`M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1
c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,
-36,557 l0,`+(t+84)+`c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,
949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9
c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,
-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189
l0,-`+(t+92)+`c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,
-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z`;case"rparen":return`M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,
63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5
c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,`+(t+9)+`
c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664
c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11
c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17
c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558
l0,-`+(t+144)+`c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,
-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z`;default:throw new Error("Unknown stretchy delimiter.")}};class lx{constructor(e){this.children=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.children=e,this.classes=[],this.height=0,this.depth=0,this.maxFontSize=0,this.style={}}hasClass(e){return this.classes.includes(e)}toNode(){for(var e=document.createDocumentFragment(),t=0;t<this.children.length;t++)e.appendChild(this.children[t].toNode());return e}toMarkup(){for(var e="",t=0;t<this.children.length;t++)e+=this.children[t].toMarkup();return e}toText(){var e=t=>t.toText();return this.children.map(e).join("")}}var Go={"AMS-Regular":{32:[0,0,0,0,.25],65:[0,.68889,0,0,.72222],66:[0,.68889,0,0,.66667],67:[0,.68889,0,0,.72222],68:[0,.68889,0,0,.72222],69:[0,.68889,0,0,.66667],70:[0,.68889,0,0,.61111],71:[0,.68889,0,0,.77778],72:[0,.68889,0,0,.77778],73:[0,.68889,0,0,.38889],74:[.16667,.68889,0,0,.5],75:[0,.68889,0,0,.77778],76:[0,.68889,0,0,.66667],77:[0,.68889,0,0,.94445],78:[0,.68889,0,0,.72222],79:[.16667,.68889,0,0,.77778],80:[0,.68889,0,0,.61111],81:[.16667,.68889,0,0,.77778],82:[0,.68889,0,0,.72222],83:[0,.68889,0,0,.55556],84:[0,.68889,0,0,.66667],85:[0,.68889,0,0,.72222],86:[0,.68889,0,0,.72222],87:[0,.68889,0,0,1],88:[0,.68889,0,0,.72222],89:[0,.68889,0,0,.72222],90:[0,.68889,0,0,.66667],107:[0,.68889,0,0,.55556],160:[0,0,0,0,.25],165:[0,.675,.025,0,.75],174:[.15559,.69224,0,0,.94666],240:[0,.68889,0,0,.55556],295:[0,.68889,0,0,.54028],710:[0,.825,0,0,2.33334],732:[0,.9,0,0,2.33334],770:[0,.825,0,0,2.33334],771:[0,.9,0,0,2.33334],989:[.08167,.58167,0,0,.77778],1008:[0,.43056,.04028,0,.66667],8245:[0,.54986,0,0,.275],8463:[0,.68889,0,0,.54028],8487:[0,.68889,0,0,.72222],8498:[0,.68889,0,0,.55556],8502:[0,.68889,0,0,.66667],8503:[0,.68889,0,0,.44445],8504:[0,.68889,0,0,.66667],8513:[0,.68889,0,0,.63889],8592:[-.03598,.46402,0,0,.5],8594:[-.03598,.46402,0,0,.5],8602:[-.13313,.36687,0,0,1],8603:[-.13313,.36687,0,0,1],8606:[.01354,.52239,0,0,1],8608:[.01354,.52239,0,0,1],8610:[.01354,.52239,0,0,1.11111],8611:[.01354,.52239,0,0,1.11111],8619:[0,.54986,0,0,1],8620:[0,.54986,0,0,1],8621:[-.13313,.37788,0,0,1.38889],8622:[-.13313,.36687,0,0,1],8624:[0,.69224,0,0,.5],8625:[0,.69224,0,0,.5],8630:[0,.43056,0,0,1],8631:[0,.43056,0,0,1],8634:[.08198,.58198,0,0,.77778],8635:[.08198,.58198,0,0,.77778],8638:[.19444,.69224,0,0,.41667],8639:[.19444,.69224,0,0,.41667],8642:[.19444,.69224,0,0,.41667],8643:[.19444,.69224,0,0,.41667],8644:[.1808,.675,0,0,1],8646:[.1808,.675,0,0,1],8647:[.1808,.675,0,0,1],8648:[.19444,.69224,0,0,.83334],8649:[.1808,.675,0,0,1],8650:[.19444,.69224,0,0,.83334],8651:[.01354,.52239,0,0,1],8652:[.01354,.52239,0,0,1],8653:[-.13313,.36687,0,0,1],8654:[-.13313,.36687,0,0,1],8655:[-.13313,.36687,0,0,1],8666:[.13667,.63667,0,0,1],8667:[.13667,.63667,0,0,1],8669:[-.13313,.37788,0,0,1],8672:[-.064,.437,0,0,1.334],8674:[-.064,.437,0,0,1.334],8705:[0,.825,0,0,.5],8708:[0,.68889,0,0,.55556],8709:[.08167,.58167,0,0,.77778],8717:[0,.43056,0,0,.42917],8722:[-.03598,.46402,0,0,.5],8724:[.08198,.69224,0,0,.77778],8726:[.08167,.58167,0,0,.77778],8733:[0,.69224,0,0,.77778],8736:[0,.69224,0,0,.72222],8737:[0,.69224,0,0,.72222],8738:[.03517,.52239,0,0,.72222],8739:[.08167,.58167,0,0,.22222],8740:[.25142,.74111,0,0,.27778],8741:[.08167,.58167,0,0,.38889],8742:[.25142,.74111,0,0,.5],8756:[0,.69224,0,0,.66667],8757:[0,.69224,0,0,.66667],8764:[-.13313,.36687,0,0,.77778],8765:[-.13313,.37788,0,0,.77778],8769:[-.13313,.36687,0,0,.77778],8770:[-.03625,.46375,0,0,.77778],8774:[.30274,.79383,0,0,.77778],8776:[-.01688,.48312,0,0,.77778],8778:[.08167,.58167,0,0,.77778],8782:[.06062,.54986,0,0,.77778],8783:[.06062,.54986,0,0,.77778],8785:[.08198,.58198,0,0,.77778],8786:[.08198,.58198,0,0,.77778],8787:[.08198,.58198,0,0,.77778],8790:[0,.69224,0,0,.77778],8791:[.22958,.72958,0,0,.77778],8796:[.08198,.91667,0,0,.77778],8806:[.25583,.75583,0,0,.77778],8807:[.25583,.75583,0,0,.77778],8808:[.25142,.75726,0,0,.77778],8809:[.25142,.75726,0,0,.77778],8812:[.25583,.75583,0,0,.5],8814:[.20576,.70576,0,0,.77778],8815:[.20576,.70576,0,0,.77778],8816:[.30274,.79383,0,0,.77778],8817:[.30274,.79383,0,0,.77778],8818:[.22958,.72958,0,0,.77778],8819:[.22958,.72958,0,0,.77778],8822:[.1808,.675,0,0,.77778],8823:[.1808,.675,0,0,.77778],8828:[.13667,.63667,0,0,.77778],8829:[.13667,.63667,0,0,.77778],8830:[.22958,.72958,0,0,.77778],8831:[.22958,.72958,0,0,.77778],8832:[.20576,.70576,0,0,.77778],8833:[.20576,.70576,0,0,.77778],8840:[.30274,.79383,0,0,.77778],8841:[.30274,.79383,0,0,.77778],8842:[.13597,.63597,0,0,.77778],8843:[.13597,.63597,0,0,.77778],8847:[.03517,.54986,0,0,.77778],8848:[.03517,.54986,0,0,.77778],8858:[.08198,.58198,0,0,.77778],8859:[.08198,.58198,0,0,.77778],8861:[.08198,.58198,0,0,.77778],8862:[0,.675,0,0,.77778],8863:[0,.675,0,0,.77778],8864:[0,.675,0,0,.77778],8865:[0,.675,0,0,.77778],8872:[0,.69224,0,0,.61111],8873:[0,.69224,0,0,.72222],8874:[0,.69224,0,0,.88889],8876:[0,.68889,0,0,.61111],8877:[0,.68889,0,0,.61111],8878:[0,.68889,0,0,.72222],8879:[0,.68889,0,0,.72222],8882:[.03517,.54986,0,0,.77778],8883:[.03517,.54986,0,0,.77778],8884:[.13667,.63667,0,0,.77778],8885:[.13667,.63667,0,0,.77778],8888:[0,.54986,0,0,1.11111],8890:[.19444,.43056,0,0,.55556],8891:[.19444,.69224,0,0,.61111],8892:[.19444,.69224,0,0,.61111],8901:[0,.54986,0,0,.27778],8903:[.08167,.58167,0,0,.77778],8905:[.08167,.58167,0,0,.77778],8906:[.08167,.58167,0,0,.77778],8907:[0,.69224,0,0,.77778],8908:[0,.69224,0,0,.77778],8909:[-.03598,.46402,0,0,.77778],8910:[0,.54986,0,0,.76042],8911:[0,.54986,0,0,.76042],8912:[.03517,.54986,0,0,.77778],8913:[.03517,.54986,0,0,.77778],8914:[0,.54986,0,0,.66667],8915:[0,.54986,0,0,.66667],8916:[0,.69224,0,0,.66667],8918:[.0391,.5391,0,0,.77778],8919:[.0391,.5391,0,0,.77778],8920:[.03517,.54986,0,0,1.33334],8921:[.03517,.54986,0,0,1.33334],8922:[.38569,.88569,0,0,.77778],8923:[.38569,.88569,0,0,.77778],8926:[.13667,.63667,0,0,.77778],8927:[.13667,.63667,0,0,.77778],8928:[.30274,.79383,0,0,.77778],8929:[.30274,.79383,0,0,.77778],8934:[.23222,.74111,0,0,.77778],8935:[.23222,.74111,0,0,.77778],8936:[.23222,.74111,0,0,.77778],8937:[.23222,.74111,0,0,.77778],8938:[.20576,.70576,0,0,.77778],8939:[.20576,.70576,0,0,.77778],8940:[.30274,.79383,0,0,.77778],8941:[.30274,.79383,0,0,.77778],8994:[.19444,.69224,0,0,.77778],8995:[.19444,.69224,0,0,.77778],9416:[.15559,.69224,0,0,.90222],9484:[0,.69224,0,0,.5],9488:[0,.69224,0,0,.5],9492:[0,.37788,0,0,.5],9496:[0,.37788,0,0,.5],9585:[.19444,.68889,0,0,.88889],9586:[.19444,.74111,0,0,.88889],9632:[0,.675,0,0,.77778],9633:[0,.675,0,0,.77778],9650:[0,.54986,0,0,.72222],9651:[0,.54986,0,0,.72222],9654:[.03517,.54986,0,0,.77778],9660:[0,.54986,0,0,.72222],9661:[0,.54986,0,0,.72222],9664:[.03517,.54986,0,0,.77778],9674:[.11111,.69224,0,0,.66667],9733:[.19444,.69224,0,0,.94445],10003:[0,.69224,0,0,.83334],10016:[0,.69224,0,0,.83334],10731:[.11111,.69224,0,0,.66667],10846:[.19444,.75583,0,0,.61111],10877:[.13667,.63667,0,0,.77778],10878:[.13667,.63667,0,0,.77778],10885:[.25583,.75583,0,0,.77778],10886:[.25583,.75583,0,0,.77778],10887:[.13597,.63597,0,0,.77778],10888:[.13597,.63597,0,0,.77778],10889:[.26167,.75726,0,0,.77778],10890:[.26167,.75726,0,0,.77778],10891:[.48256,.98256,0,0,.77778],10892:[.48256,.98256,0,0,.77778],10901:[.13667,.63667,0,0,.77778],10902:[.13667,.63667,0,0,.77778],10933:[.25142,.75726,0,0,.77778],10934:[.25142,.75726,0,0,.77778],10935:[.26167,.75726,0,0,.77778],10936:[.26167,.75726,0,0,.77778],10937:[.26167,.75726,0,0,.77778],10938:[.26167,.75726,0,0,.77778],10949:[.25583,.75583,0,0,.77778],10950:[.25583,.75583,0,0,.77778],10955:[.28481,.79383,0,0,.77778],10956:[.28481,.79383,0,0,.77778],57350:[.08167,.58167,0,0,.22222],57351:[.08167,.58167,0,0,.38889],57352:[.08167,.58167,0,0,.77778],57353:[0,.43056,.04028,0,.66667],57356:[.25142,.75726,0,0,.77778],57357:[.25142,.75726,0,0,.77778],57358:[.41951,.91951,0,0,.77778],57359:[.30274,.79383,0,0,.77778],57360:[.30274,.79383,0,0,.77778],57361:[.41951,.91951,0,0,.77778],57366:[.25142,.75726,0,0,.77778],57367:[.25142,.75726,0,0,.77778],57368:[.25142,.75726,0,0,.77778],57369:[.25142,.75726,0,0,.77778],57370:[.13597,.63597,0,0,.77778],57371:[.13597,.63597,0,0,.77778]},"Caligraphic-Regular":{32:[0,0,0,0,.25],65:[0,.68333,0,.19445,.79847],66:[0,.68333,.03041,.13889,.65681],67:[0,.68333,.05834,.13889,.52653],68:[0,.68333,.02778,.08334,.77139],69:[0,.68333,.08944,.11111,.52778],70:[0,.68333,.09931,.11111,.71875],71:[.09722,.68333,.0593,.11111,.59487],72:[0,.68333,.00965,.11111,.84452],73:[0,.68333,.07382,0,.54452],74:[.09722,.68333,.18472,.16667,.67778],75:[0,.68333,.01445,.05556,.76195],76:[0,.68333,0,.13889,.68972],77:[0,.68333,0,.13889,1.2009],78:[0,.68333,.14736,.08334,.82049],79:[0,.68333,.02778,.11111,.79611],80:[0,.68333,.08222,.08334,.69556],81:[.09722,.68333,0,.11111,.81667],82:[0,.68333,0,.08334,.8475],83:[0,.68333,.075,.13889,.60556],84:[0,.68333,.25417,0,.54464],85:[0,.68333,.09931,.08334,.62583],86:[0,.68333,.08222,0,.61278],87:[0,.68333,.08222,.08334,.98778],88:[0,.68333,.14643,.13889,.7133],89:[.09722,.68333,.08222,.08334,.66834],90:[0,.68333,.07944,.13889,.72473],160:[0,0,0,0,.25]},"Fraktur-Regular":{32:[0,0,0,0,.25],33:[0,.69141,0,0,.29574],34:[0,.69141,0,0,.21471],38:[0,.69141,0,0,.73786],39:[0,.69141,0,0,.21201],40:[.24982,.74947,0,0,.38865],41:[.24982,.74947,0,0,.38865],42:[0,.62119,0,0,.27764],43:[.08319,.58283,0,0,.75623],44:[0,.10803,0,0,.27764],45:[.08319,.58283,0,0,.75623],46:[0,.10803,0,0,.27764],47:[.24982,.74947,0,0,.50181],48:[0,.47534,0,0,.50181],49:[0,.47534,0,0,.50181],50:[0,.47534,0,0,.50181],51:[.18906,.47534,0,0,.50181],52:[.18906,.47534,0,0,.50181],53:[.18906,.47534,0,0,.50181],54:[0,.69141,0,0,.50181],55:[.18906,.47534,0,0,.50181],56:[0,.69141,0,0,.50181],57:[.18906,.47534,0,0,.50181],58:[0,.47534,0,0,.21606],59:[.12604,.47534,0,0,.21606],61:[-.13099,.36866,0,0,.75623],63:[0,.69141,0,0,.36245],65:[0,.69141,0,0,.7176],66:[0,.69141,0,0,.88397],67:[0,.69141,0,0,.61254],68:[0,.69141,0,0,.83158],69:[0,.69141,0,0,.66278],70:[.12604,.69141,0,0,.61119],71:[0,.69141,0,0,.78539],72:[.06302,.69141,0,0,.7203],73:[0,.69141,0,0,.55448],74:[.12604,.69141,0,0,.55231],75:[0,.69141,0,0,.66845],76:[0,.69141,0,0,.66602],77:[0,.69141,0,0,1.04953],78:[0,.69141,0,0,.83212],79:[0,.69141,0,0,.82699],80:[.18906,.69141,0,0,.82753],81:[.03781,.69141,0,0,.82699],82:[0,.69141,0,0,.82807],83:[0,.69141,0,0,.82861],84:[0,.69141,0,0,.66899],85:[0,.69141,0,0,.64576],86:[0,.69141,0,0,.83131],87:[0,.69141,0,0,1.04602],88:[0,.69141,0,0,.71922],89:[.18906,.69141,0,0,.83293],90:[.12604,.69141,0,0,.60201],91:[.24982,.74947,0,0,.27764],93:[.24982,.74947,0,0,.27764],94:[0,.69141,0,0,.49965],97:[0,.47534,0,0,.50046],98:[0,.69141,0,0,.51315],99:[0,.47534,0,0,.38946],100:[0,.62119,0,0,.49857],101:[0,.47534,0,0,.40053],102:[.18906,.69141,0,0,.32626],103:[.18906,.47534,0,0,.5037],104:[.18906,.69141,0,0,.52126],105:[0,.69141,0,0,.27899],106:[0,.69141,0,0,.28088],107:[0,.69141,0,0,.38946],108:[0,.69141,0,0,.27953],109:[0,.47534,0,0,.76676],110:[0,.47534,0,0,.52666],111:[0,.47534,0,0,.48885],112:[.18906,.52396,0,0,.50046],113:[.18906,.47534,0,0,.48912],114:[0,.47534,0,0,.38919],115:[0,.47534,0,0,.44266],116:[0,.62119,0,0,.33301],117:[0,.47534,0,0,.5172],118:[0,.52396,0,0,.5118],119:[0,.52396,0,0,.77351],120:[.18906,.47534,0,0,.38865],121:[.18906,.47534,0,0,.49884],122:[.18906,.47534,0,0,.39054],160:[0,0,0,0,.25],8216:[0,.69141,0,0,.21471],8217:[0,.69141,0,0,.21471],58112:[0,.62119,0,0,.49749],58113:[0,.62119,0,0,.4983],58114:[.18906,.69141,0,0,.33328],58115:[.18906,.69141,0,0,.32923],58116:[.18906,.47534,0,0,.50343],58117:[0,.69141,0,0,.33301],58118:[0,.62119,0,0,.33409],58119:[0,.47534,0,0,.50073]},"Main-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.35],34:[0,.69444,0,0,.60278],35:[.19444,.69444,0,0,.95833],36:[.05556,.75,0,0,.575],37:[.05556,.75,0,0,.95833],38:[0,.69444,0,0,.89444],39:[0,.69444,0,0,.31944],40:[.25,.75,0,0,.44722],41:[.25,.75,0,0,.44722],42:[0,.75,0,0,.575],43:[.13333,.63333,0,0,.89444],44:[.19444,.15556,0,0,.31944],45:[0,.44444,0,0,.38333],46:[0,.15556,0,0,.31944],47:[.25,.75,0,0,.575],48:[0,.64444,0,0,.575],49:[0,.64444,0,0,.575],50:[0,.64444,0,0,.575],51:[0,.64444,0,0,.575],52:[0,.64444,0,0,.575],53:[0,.64444,0,0,.575],54:[0,.64444,0,0,.575],55:[0,.64444,0,0,.575],56:[0,.64444,0,0,.575],57:[0,.64444,0,0,.575],58:[0,.44444,0,0,.31944],59:[.19444,.44444,0,0,.31944],60:[.08556,.58556,0,0,.89444],61:[-.10889,.39111,0,0,.89444],62:[.08556,.58556,0,0,.89444],63:[0,.69444,0,0,.54305],64:[0,.69444,0,0,.89444],65:[0,.68611,0,0,.86944],66:[0,.68611,0,0,.81805],67:[0,.68611,0,0,.83055],68:[0,.68611,0,0,.88194],69:[0,.68611,0,0,.75555],70:[0,.68611,0,0,.72361],71:[0,.68611,0,0,.90416],72:[0,.68611,0,0,.9],73:[0,.68611,0,0,.43611],74:[0,.68611,0,0,.59444],75:[0,.68611,0,0,.90138],76:[0,.68611,0,0,.69166],77:[0,.68611,0,0,1.09166],78:[0,.68611,0,0,.9],79:[0,.68611,0,0,.86388],80:[0,.68611,0,0,.78611],81:[.19444,.68611,0,0,.86388],82:[0,.68611,0,0,.8625],83:[0,.68611,0,0,.63889],84:[0,.68611,0,0,.8],85:[0,.68611,0,0,.88472],86:[0,.68611,.01597,0,.86944],87:[0,.68611,.01597,0,1.18888],88:[0,.68611,0,0,.86944],89:[0,.68611,.02875,0,.86944],90:[0,.68611,0,0,.70277],91:[.25,.75,0,0,.31944],92:[.25,.75,0,0,.575],93:[.25,.75,0,0,.31944],94:[0,.69444,0,0,.575],95:[.31,.13444,.03194,0,.575],97:[0,.44444,0,0,.55902],98:[0,.69444,0,0,.63889],99:[0,.44444,0,0,.51111],100:[0,.69444,0,0,.63889],101:[0,.44444,0,0,.52708],102:[0,.69444,.10903,0,.35139],103:[.19444,.44444,.01597,0,.575],104:[0,.69444,0,0,.63889],105:[0,.69444,0,0,.31944],106:[.19444,.69444,0,0,.35139],107:[0,.69444,0,0,.60694],108:[0,.69444,0,0,.31944],109:[0,.44444,0,0,.95833],110:[0,.44444,0,0,.63889],111:[0,.44444,0,0,.575],112:[.19444,.44444,0,0,.63889],113:[.19444,.44444,0,0,.60694],114:[0,.44444,0,0,.47361],115:[0,.44444,0,0,.45361],116:[0,.63492,0,0,.44722],117:[0,.44444,0,0,.63889],118:[0,.44444,.01597,0,.60694],119:[0,.44444,.01597,0,.83055],120:[0,.44444,0,0,.60694],121:[.19444,.44444,.01597,0,.60694],122:[0,.44444,0,0,.51111],123:[.25,.75,0,0,.575],124:[.25,.75,0,0,.31944],125:[.25,.75,0,0,.575],126:[.35,.34444,0,0,.575],160:[0,0,0,0,.25],163:[0,.69444,0,0,.86853],168:[0,.69444,0,0,.575],172:[0,.44444,0,0,.76666],176:[0,.69444,0,0,.86944],177:[.13333,.63333,0,0,.89444],184:[.17014,0,0,0,.51111],198:[0,.68611,0,0,1.04166],215:[.13333,.63333,0,0,.89444],216:[.04861,.73472,0,0,.89444],223:[0,.69444,0,0,.59722],230:[0,.44444,0,0,.83055],247:[.13333,.63333,0,0,.89444],248:[.09722,.54167,0,0,.575],305:[0,.44444,0,0,.31944],338:[0,.68611,0,0,1.16944],339:[0,.44444,0,0,.89444],567:[.19444,.44444,0,0,.35139],710:[0,.69444,0,0,.575],711:[0,.63194,0,0,.575],713:[0,.59611,0,0,.575],714:[0,.69444,0,0,.575],715:[0,.69444,0,0,.575],728:[0,.69444,0,0,.575],729:[0,.69444,0,0,.31944],730:[0,.69444,0,0,.86944],732:[0,.69444,0,0,.575],733:[0,.69444,0,0,.575],915:[0,.68611,0,0,.69166],916:[0,.68611,0,0,.95833],920:[0,.68611,0,0,.89444],923:[0,.68611,0,0,.80555],926:[0,.68611,0,0,.76666],928:[0,.68611,0,0,.9],931:[0,.68611,0,0,.83055],933:[0,.68611,0,0,.89444],934:[0,.68611,0,0,.83055],936:[0,.68611,0,0,.89444],937:[0,.68611,0,0,.83055],8211:[0,.44444,.03194,0,.575],8212:[0,.44444,.03194,0,1.14999],8216:[0,.69444,0,0,.31944],8217:[0,.69444,0,0,.31944],8220:[0,.69444,0,0,.60278],8221:[0,.69444,0,0,.60278],8224:[.19444,.69444,0,0,.51111],8225:[.19444,.69444,0,0,.51111],8242:[0,.55556,0,0,.34444],8407:[0,.72444,.15486,0,.575],8463:[0,.69444,0,0,.66759],8465:[0,.69444,0,0,.83055],8467:[0,.69444,0,0,.47361],8472:[.19444,.44444,0,0,.74027],8476:[0,.69444,0,0,.83055],8501:[0,.69444,0,0,.70277],8592:[-.10889,.39111,0,0,1.14999],8593:[.19444,.69444,0,0,.575],8594:[-.10889,.39111,0,0,1.14999],8595:[.19444,.69444,0,0,.575],8596:[-.10889,.39111,0,0,1.14999],8597:[.25,.75,0,0,.575],8598:[.19444,.69444,0,0,1.14999],8599:[.19444,.69444,0,0,1.14999],8600:[.19444,.69444,0,0,1.14999],8601:[.19444,.69444,0,0,1.14999],8636:[-.10889,.39111,0,0,1.14999],8637:[-.10889,.39111,0,0,1.14999],8640:[-.10889,.39111,0,0,1.14999],8641:[-.10889,.39111,0,0,1.14999],8656:[-.10889,.39111,0,0,1.14999],8657:[.19444,.69444,0,0,.70277],8658:[-.10889,.39111,0,0,1.14999],8659:[.19444,.69444,0,0,.70277],8660:[-.10889,.39111,0,0,1.14999],8661:[.25,.75,0,0,.70277],8704:[0,.69444,0,0,.63889],8706:[0,.69444,.06389,0,.62847],8707:[0,.69444,0,0,.63889],8709:[.05556,.75,0,0,.575],8711:[0,.68611,0,0,.95833],8712:[.08556,.58556,0,0,.76666],8715:[.08556,.58556,0,0,.76666],8722:[.13333,.63333,0,0,.89444],8723:[.13333,.63333,0,0,.89444],8725:[.25,.75,0,0,.575],8726:[.25,.75,0,0,.575],8727:[-.02778,.47222,0,0,.575],8728:[-.02639,.47361,0,0,.575],8729:[-.02639,.47361,0,0,.575],8730:[.18,.82,0,0,.95833],8733:[0,.44444,0,0,.89444],8734:[0,.44444,0,0,1.14999],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.31944],8741:[.25,.75,0,0,.575],8743:[0,.55556,0,0,.76666],8744:[0,.55556,0,0,.76666],8745:[0,.55556,0,0,.76666],8746:[0,.55556,0,0,.76666],8747:[.19444,.69444,.12778,0,.56875],8764:[-.10889,.39111,0,0,.89444],8768:[.19444,.69444,0,0,.31944],8771:[.00222,.50222,0,0,.89444],8773:[.027,.638,0,0,.894],8776:[.02444,.52444,0,0,.89444],8781:[.00222,.50222,0,0,.89444],8801:[.00222,.50222,0,0,.89444],8804:[.19667,.69667,0,0,.89444],8805:[.19667,.69667,0,0,.89444],8810:[.08556,.58556,0,0,1.14999],8811:[.08556,.58556,0,0,1.14999],8826:[.08556,.58556,0,0,.89444],8827:[.08556,.58556,0,0,.89444],8834:[.08556,.58556,0,0,.89444],8835:[.08556,.58556,0,0,.89444],8838:[.19667,.69667,0,0,.89444],8839:[.19667,.69667,0,0,.89444],8846:[0,.55556,0,0,.76666],8849:[.19667,.69667,0,0,.89444],8850:[.19667,.69667,0,0,.89444],8851:[0,.55556,0,0,.76666],8852:[0,.55556,0,0,.76666],8853:[.13333,.63333,0,0,.89444],8854:[.13333,.63333,0,0,.89444],8855:[.13333,.63333,0,0,.89444],8856:[.13333,.63333,0,0,.89444],8857:[.13333,.63333,0,0,.89444],8866:[0,.69444,0,0,.70277],8867:[0,.69444,0,0,.70277],8868:[0,.69444,0,0,.89444],8869:[0,.69444,0,0,.89444],8900:[-.02639,.47361,0,0,.575],8901:[-.02639,.47361,0,0,.31944],8902:[-.02778,.47222,0,0,.575],8968:[.25,.75,0,0,.51111],8969:[.25,.75,0,0,.51111],8970:[.25,.75,0,0,.51111],8971:[.25,.75,0,0,.51111],8994:[-.13889,.36111,0,0,1.14999],8995:[-.13889,.36111,0,0,1.14999],9651:[.19444,.69444,0,0,1.02222],9657:[-.02778,.47222,0,0,.575],9661:[.19444,.69444,0,0,1.02222],9667:[-.02778,.47222,0,0,.575],9711:[.19444,.69444,0,0,1.14999],9824:[.12963,.69444,0,0,.89444],9825:[.12963,.69444,0,0,.89444],9826:[.12963,.69444,0,0,.89444],9827:[.12963,.69444,0,0,.89444],9837:[0,.75,0,0,.44722],9838:[.19444,.69444,0,0,.44722],9839:[.19444,.69444,0,0,.44722],10216:[.25,.75,0,0,.44722],10217:[.25,.75,0,0,.44722],10815:[0,.68611,0,0,.9],10927:[.19667,.69667,0,0,.89444],10928:[.19667,.69667,0,0,.89444],57376:[.19444,.69444,0,0,0]},"Main-BoldItalic":{32:[0,0,0,0,.25],33:[0,.69444,.11417,0,.38611],34:[0,.69444,.07939,0,.62055],35:[.19444,.69444,.06833,0,.94444],37:[.05556,.75,.12861,0,.94444],38:[0,.69444,.08528,0,.88555],39:[0,.69444,.12945,0,.35555],40:[.25,.75,.15806,0,.47333],41:[.25,.75,.03306,0,.47333],42:[0,.75,.14333,0,.59111],43:[.10333,.60333,.03306,0,.88555],44:[.19444,.14722,0,0,.35555],45:[0,.44444,.02611,0,.41444],46:[0,.14722,0,0,.35555],47:[.25,.75,.15806,0,.59111],48:[0,.64444,.13167,0,.59111],49:[0,.64444,.13167,0,.59111],50:[0,.64444,.13167,0,.59111],51:[0,.64444,.13167,0,.59111],52:[.19444,.64444,.13167,0,.59111],53:[0,.64444,.13167,0,.59111],54:[0,.64444,.13167,0,.59111],55:[.19444,.64444,.13167,0,.59111],56:[0,.64444,.13167,0,.59111],57:[0,.64444,.13167,0,.59111],58:[0,.44444,.06695,0,.35555],59:[.19444,.44444,.06695,0,.35555],61:[-.10889,.39111,.06833,0,.88555],63:[0,.69444,.11472,0,.59111],64:[0,.69444,.09208,0,.88555],65:[0,.68611,0,0,.86555],66:[0,.68611,.0992,0,.81666],67:[0,.68611,.14208,0,.82666],68:[0,.68611,.09062,0,.87555],69:[0,.68611,.11431,0,.75666],70:[0,.68611,.12903,0,.72722],71:[0,.68611,.07347,0,.89527],72:[0,.68611,.17208,0,.8961],73:[0,.68611,.15681,0,.47166],74:[0,.68611,.145,0,.61055],75:[0,.68611,.14208,0,.89499],76:[0,.68611,0,0,.69777],77:[0,.68611,.17208,0,1.07277],78:[0,.68611,.17208,0,.8961],79:[0,.68611,.09062,0,.85499],80:[0,.68611,.0992,0,.78721],81:[.19444,.68611,.09062,0,.85499],82:[0,.68611,.02559,0,.85944],83:[0,.68611,.11264,0,.64999],84:[0,.68611,.12903,0,.7961],85:[0,.68611,.17208,0,.88083],86:[0,.68611,.18625,0,.86555],87:[0,.68611,.18625,0,1.15999],88:[0,.68611,.15681,0,.86555],89:[0,.68611,.19803,0,.86555],90:[0,.68611,.14208,0,.70888],91:[.25,.75,.1875,0,.35611],93:[.25,.75,.09972,0,.35611],94:[0,.69444,.06709,0,.59111],95:[.31,.13444,.09811,0,.59111],97:[0,.44444,.09426,0,.59111],98:[0,.69444,.07861,0,.53222],99:[0,.44444,.05222,0,.53222],100:[0,.69444,.10861,0,.59111],101:[0,.44444,.085,0,.53222],102:[.19444,.69444,.21778,0,.4],103:[.19444,.44444,.105,0,.53222],104:[0,.69444,.09426,0,.59111],105:[0,.69326,.11387,0,.35555],106:[.19444,.69326,.1672,0,.35555],107:[0,.69444,.11111,0,.53222],108:[0,.69444,.10861,0,.29666],109:[0,.44444,.09426,0,.94444],110:[0,.44444,.09426,0,.64999],111:[0,.44444,.07861,0,.59111],112:[.19444,.44444,.07861,0,.59111],113:[.19444,.44444,.105,0,.53222],114:[0,.44444,.11111,0,.50167],115:[0,.44444,.08167,0,.48694],116:[0,.63492,.09639,0,.385],117:[0,.44444,.09426,0,.62055],118:[0,.44444,.11111,0,.53222],119:[0,.44444,.11111,0,.76777],120:[0,.44444,.12583,0,.56055],121:[.19444,.44444,.105,0,.56166],122:[0,.44444,.13889,0,.49055],126:[.35,.34444,.11472,0,.59111],160:[0,0,0,0,.25],168:[0,.69444,.11473,0,.59111],176:[0,.69444,0,0,.94888],184:[.17014,0,0,0,.53222],198:[0,.68611,.11431,0,1.02277],216:[.04861,.73472,.09062,0,.88555],223:[.19444,.69444,.09736,0,.665],230:[0,.44444,.085,0,.82666],248:[.09722,.54167,.09458,0,.59111],305:[0,.44444,.09426,0,.35555],338:[0,.68611,.11431,0,1.14054],339:[0,.44444,.085,0,.82666],567:[.19444,.44444,.04611,0,.385],710:[0,.69444,.06709,0,.59111],711:[0,.63194,.08271,0,.59111],713:[0,.59444,.10444,0,.59111],714:[0,.69444,.08528,0,.59111],715:[0,.69444,0,0,.59111],728:[0,.69444,.10333,0,.59111],729:[0,.69444,.12945,0,.35555],730:[0,.69444,0,0,.94888],732:[0,.69444,.11472,0,.59111],733:[0,.69444,.11472,0,.59111],915:[0,.68611,.12903,0,.69777],916:[0,.68611,0,0,.94444],920:[0,.68611,.09062,0,.88555],923:[0,.68611,0,0,.80666],926:[0,.68611,.15092,0,.76777],928:[0,.68611,.17208,0,.8961],931:[0,.68611,.11431,0,.82666],933:[0,.68611,.10778,0,.88555],934:[0,.68611,.05632,0,.82666],936:[0,.68611,.10778,0,.88555],937:[0,.68611,.0992,0,.82666],8211:[0,.44444,.09811,0,.59111],8212:[0,.44444,.09811,0,1.18221],8216:[0,.69444,.12945,0,.35555],8217:[0,.69444,.12945,0,.35555],8220:[0,.69444,.16772,0,.62055],8221:[0,.69444,.07939,0,.62055]},"Main-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.12417,0,.30667],34:[0,.69444,.06961,0,.51444],35:[.19444,.69444,.06616,0,.81777],37:[.05556,.75,.13639,0,.81777],38:[0,.69444,.09694,0,.76666],39:[0,.69444,.12417,0,.30667],40:[.25,.75,.16194,0,.40889],41:[.25,.75,.03694,0,.40889],42:[0,.75,.14917,0,.51111],43:[.05667,.56167,.03694,0,.76666],44:[.19444,.10556,0,0,.30667],45:[0,.43056,.02826,0,.35778],46:[0,.10556,0,0,.30667],47:[.25,.75,.16194,0,.51111],48:[0,.64444,.13556,0,.51111],49:[0,.64444,.13556,0,.51111],50:[0,.64444,.13556,0,.51111],51:[0,.64444,.13556,0,.51111],52:[.19444,.64444,.13556,0,.51111],53:[0,.64444,.13556,0,.51111],54:[0,.64444,.13556,0,.51111],55:[.19444,.64444,.13556,0,.51111],56:[0,.64444,.13556,0,.51111],57:[0,.64444,.13556,0,.51111],58:[0,.43056,.0582,0,.30667],59:[.19444,.43056,.0582,0,.30667],61:[-.13313,.36687,.06616,0,.76666],63:[0,.69444,.1225,0,.51111],64:[0,.69444,.09597,0,.76666],65:[0,.68333,0,0,.74333],66:[0,.68333,.10257,0,.70389],67:[0,.68333,.14528,0,.71555],68:[0,.68333,.09403,0,.755],69:[0,.68333,.12028,0,.67833],70:[0,.68333,.13305,0,.65277],71:[0,.68333,.08722,0,.77361],72:[0,.68333,.16389,0,.74333],73:[0,.68333,.15806,0,.38555],74:[0,.68333,.14028,0,.525],75:[0,.68333,.14528,0,.76888],76:[0,.68333,0,0,.62722],77:[0,.68333,.16389,0,.89666],78:[0,.68333,.16389,0,.74333],79:[0,.68333,.09403,0,.76666],80:[0,.68333,.10257,0,.67833],81:[.19444,.68333,.09403,0,.76666],82:[0,.68333,.03868,0,.72944],83:[0,.68333,.11972,0,.56222],84:[0,.68333,.13305,0,.71555],85:[0,.68333,.16389,0,.74333],86:[0,.68333,.18361,0,.74333],87:[0,.68333,.18361,0,.99888],88:[0,.68333,.15806,0,.74333],89:[0,.68333,.19383,0,.74333],90:[0,.68333,.14528,0,.61333],91:[.25,.75,.1875,0,.30667],93:[.25,.75,.10528,0,.30667],94:[0,.69444,.06646,0,.51111],95:[.31,.12056,.09208,0,.51111],97:[0,.43056,.07671,0,.51111],98:[0,.69444,.06312,0,.46],99:[0,.43056,.05653,0,.46],100:[0,.69444,.10333,0,.51111],101:[0,.43056,.07514,0,.46],102:[.19444,.69444,.21194,0,.30667],103:[.19444,.43056,.08847,0,.46],104:[0,.69444,.07671,0,.51111],105:[0,.65536,.1019,0,.30667],106:[.19444,.65536,.14467,0,.30667],107:[0,.69444,.10764,0,.46],108:[0,.69444,.10333,0,.25555],109:[0,.43056,.07671,0,.81777],110:[0,.43056,.07671,0,.56222],111:[0,.43056,.06312,0,.51111],112:[.19444,.43056,.06312,0,.51111],113:[.19444,.43056,.08847,0,.46],114:[0,.43056,.10764,0,.42166],115:[0,.43056,.08208,0,.40889],116:[0,.61508,.09486,0,.33222],117:[0,.43056,.07671,0,.53666],118:[0,.43056,.10764,0,.46],119:[0,.43056,.10764,0,.66444],120:[0,.43056,.12042,0,.46389],121:[.19444,.43056,.08847,0,.48555],122:[0,.43056,.12292,0,.40889],126:[.35,.31786,.11585,0,.51111],160:[0,0,0,0,.25],168:[0,.66786,.10474,0,.51111],176:[0,.69444,0,0,.83129],184:[.17014,0,0,0,.46],198:[0,.68333,.12028,0,.88277],216:[.04861,.73194,.09403,0,.76666],223:[.19444,.69444,.10514,0,.53666],230:[0,.43056,.07514,0,.71555],248:[.09722,.52778,.09194,0,.51111],338:[0,.68333,.12028,0,.98499],339:[0,.43056,.07514,0,.71555],710:[0,.69444,.06646,0,.51111],711:[0,.62847,.08295,0,.51111],713:[0,.56167,.10333,0,.51111],714:[0,.69444,.09694,0,.51111],715:[0,.69444,0,0,.51111],728:[0,.69444,.10806,0,.51111],729:[0,.66786,.11752,0,.30667],730:[0,.69444,0,0,.83129],732:[0,.66786,.11585,0,.51111],733:[0,.69444,.1225,0,.51111],915:[0,.68333,.13305,0,.62722],916:[0,.68333,0,0,.81777],920:[0,.68333,.09403,0,.76666],923:[0,.68333,0,0,.69222],926:[0,.68333,.15294,0,.66444],928:[0,.68333,.16389,0,.74333],931:[0,.68333,.12028,0,.71555],933:[0,.68333,.11111,0,.76666],934:[0,.68333,.05986,0,.71555],936:[0,.68333,.11111,0,.76666],937:[0,.68333,.10257,0,.71555],8211:[0,.43056,.09208,0,.51111],8212:[0,.43056,.09208,0,1.02222],8216:[0,.69444,.12417,0,.30667],8217:[0,.69444,.12417,0,.30667],8220:[0,.69444,.1685,0,.51444],8221:[0,.69444,.06961,0,.51444],8463:[0,.68889,0,0,.54028]},"Main-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.27778],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.77778],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.19444,.10556,0,0,.27778],45:[0,.43056,0,0,.33333],46:[0,.10556,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.64444,0,0,.5],49:[0,.64444,0,0,.5],50:[0,.64444,0,0,.5],51:[0,.64444,0,0,.5],52:[0,.64444,0,0,.5],53:[0,.64444,0,0,.5],54:[0,.64444,0,0,.5],55:[0,.64444,0,0,.5],56:[0,.64444,0,0,.5],57:[0,.64444,0,0,.5],58:[0,.43056,0,0,.27778],59:[.19444,.43056,0,0,.27778],60:[.0391,.5391,0,0,.77778],61:[-.13313,.36687,0,0,.77778],62:[.0391,.5391,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.77778],65:[0,.68333,0,0,.75],66:[0,.68333,0,0,.70834],67:[0,.68333,0,0,.72222],68:[0,.68333,0,0,.76389],69:[0,.68333,0,0,.68056],70:[0,.68333,0,0,.65278],71:[0,.68333,0,0,.78472],72:[0,.68333,0,0,.75],73:[0,.68333,0,0,.36111],74:[0,.68333,0,0,.51389],75:[0,.68333,0,0,.77778],76:[0,.68333,0,0,.625],77:[0,.68333,0,0,.91667],78:[0,.68333,0,0,.75],79:[0,.68333,0,0,.77778],80:[0,.68333,0,0,.68056],81:[.19444,.68333,0,0,.77778],82:[0,.68333,0,0,.73611],83:[0,.68333,0,0,.55556],84:[0,.68333,0,0,.72222],85:[0,.68333,0,0,.75],86:[0,.68333,.01389,0,.75],87:[0,.68333,.01389,0,1.02778],88:[0,.68333,0,0,.75],89:[0,.68333,.025,0,.75],90:[0,.68333,0,0,.61111],91:[.25,.75,0,0,.27778],92:[.25,.75,0,0,.5],93:[.25,.75,0,0,.27778],94:[0,.69444,0,0,.5],95:[.31,.12056,.02778,0,.5],97:[0,.43056,0,0,.5],98:[0,.69444,0,0,.55556],99:[0,.43056,0,0,.44445],100:[0,.69444,0,0,.55556],101:[0,.43056,0,0,.44445],102:[0,.69444,.07778,0,.30556],103:[.19444,.43056,.01389,0,.5],104:[0,.69444,0,0,.55556],105:[0,.66786,0,0,.27778],106:[.19444,.66786,0,0,.30556],107:[0,.69444,0,0,.52778],108:[0,.69444,0,0,.27778],109:[0,.43056,0,0,.83334],110:[0,.43056,0,0,.55556],111:[0,.43056,0,0,.5],112:[.19444,.43056,0,0,.55556],113:[.19444,.43056,0,0,.52778],114:[0,.43056,0,0,.39167],115:[0,.43056,0,0,.39445],116:[0,.61508,0,0,.38889],117:[0,.43056,0,0,.55556],118:[0,.43056,.01389,0,.52778],119:[0,.43056,.01389,0,.72222],120:[0,.43056,0,0,.52778],121:[.19444,.43056,.01389,0,.52778],122:[0,.43056,0,0,.44445],123:[.25,.75,0,0,.5],124:[.25,.75,0,0,.27778],125:[.25,.75,0,0,.5],126:[.35,.31786,0,0,.5],160:[0,0,0,0,.25],163:[0,.69444,0,0,.76909],167:[.19444,.69444,0,0,.44445],168:[0,.66786,0,0,.5],172:[0,.43056,0,0,.66667],176:[0,.69444,0,0,.75],177:[.08333,.58333,0,0,.77778],182:[.19444,.69444,0,0,.61111],184:[.17014,0,0,0,.44445],198:[0,.68333,0,0,.90278],215:[.08333,.58333,0,0,.77778],216:[.04861,.73194,0,0,.77778],223:[0,.69444,0,0,.5],230:[0,.43056,0,0,.72222],247:[.08333,.58333,0,0,.77778],248:[.09722,.52778,0,0,.5],305:[0,.43056,0,0,.27778],338:[0,.68333,0,0,1.01389],339:[0,.43056,0,0,.77778],567:[.19444,.43056,0,0,.30556],710:[0,.69444,0,0,.5],711:[0,.62847,0,0,.5],713:[0,.56778,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.66786,0,0,.27778],730:[0,.69444,0,0,.75],732:[0,.66786,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.68333,0,0,.625],916:[0,.68333,0,0,.83334],920:[0,.68333,0,0,.77778],923:[0,.68333,0,0,.69445],926:[0,.68333,0,0,.66667],928:[0,.68333,0,0,.75],931:[0,.68333,0,0,.72222],933:[0,.68333,0,0,.77778],934:[0,.68333,0,0,.72222],936:[0,.68333,0,0,.77778],937:[0,.68333,0,0,.72222],8211:[0,.43056,.02778,0,.5],8212:[0,.43056,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5],8224:[.19444,.69444,0,0,.44445],8225:[.19444,.69444,0,0,.44445],8230:[0,.123,0,0,1.172],8242:[0,.55556,0,0,.275],8407:[0,.71444,.15382,0,.5],8463:[0,.68889,0,0,.54028],8465:[0,.69444,0,0,.72222],8467:[0,.69444,0,.11111,.41667],8472:[.19444,.43056,0,.11111,.63646],8476:[0,.69444,0,0,.72222],8501:[0,.69444,0,0,.61111],8592:[-.13313,.36687,0,0,1],8593:[.19444,.69444,0,0,.5],8594:[-.13313,.36687,0,0,1],8595:[.19444,.69444,0,0,.5],8596:[-.13313,.36687,0,0,1],8597:[.25,.75,0,0,.5],8598:[.19444,.69444,0,0,1],8599:[.19444,.69444,0,0,1],8600:[.19444,.69444,0,0,1],8601:[.19444,.69444,0,0,1],8614:[.011,.511,0,0,1],8617:[.011,.511,0,0,1.126],8618:[.011,.511,0,0,1.126],8636:[-.13313,.36687,0,0,1],8637:[-.13313,.36687,0,0,1],8640:[-.13313,.36687,0,0,1],8641:[-.13313,.36687,0,0,1],8652:[.011,.671,0,0,1],8656:[-.13313,.36687,0,0,1],8657:[.19444,.69444,0,0,.61111],8658:[-.13313,.36687,0,0,1],8659:[.19444,.69444,0,0,.61111],8660:[-.13313,.36687,0,0,1],8661:[.25,.75,0,0,.61111],8704:[0,.69444,0,0,.55556],8706:[0,.69444,.05556,.08334,.5309],8707:[0,.69444,0,0,.55556],8709:[.05556,.75,0,0,.5],8711:[0,.68333,0,0,.83334],8712:[.0391,.5391,0,0,.66667],8715:[.0391,.5391,0,0,.66667],8722:[.08333,.58333,0,0,.77778],8723:[.08333,.58333,0,0,.77778],8725:[.25,.75,0,0,.5],8726:[.25,.75,0,0,.5],8727:[-.03472,.46528,0,0,.5],8728:[-.05555,.44445,0,0,.5],8729:[-.05555,.44445,0,0,.5],8730:[.2,.8,0,0,.83334],8733:[0,.43056,0,0,.77778],8734:[0,.43056,0,0,1],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.27778],8741:[.25,.75,0,0,.5],8743:[0,.55556,0,0,.66667],8744:[0,.55556,0,0,.66667],8745:[0,.55556,0,0,.66667],8746:[0,.55556,0,0,.66667],8747:[.19444,.69444,.11111,0,.41667],8764:[-.13313,.36687,0,0,.77778],8768:[.19444,.69444,0,0,.27778],8771:[-.03625,.46375,0,0,.77778],8773:[-.022,.589,0,0,.778],8776:[-.01688,.48312,0,0,.77778],8781:[-.03625,.46375,0,0,.77778],8784:[-.133,.673,0,0,.778],8801:[-.03625,.46375,0,0,.77778],8804:[.13597,.63597,0,0,.77778],8805:[.13597,.63597,0,0,.77778],8810:[.0391,.5391,0,0,1],8811:[.0391,.5391,0,0,1],8826:[.0391,.5391,0,0,.77778],8827:[.0391,.5391,0,0,.77778],8834:[.0391,.5391,0,0,.77778],8835:[.0391,.5391,0,0,.77778],8838:[.13597,.63597,0,0,.77778],8839:[.13597,.63597,0,0,.77778],8846:[0,.55556,0,0,.66667],8849:[.13597,.63597,0,0,.77778],8850:[.13597,.63597,0,0,.77778],8851:[0,.55556,0,0,.66667],8852:[0,.55556,0,0,.66667],8853:[.08333,.58333,0,0,.77778],8854:[.08333,.58333,0,0,.77778],8855:[.08333,.58333,0,0,.77778],8856:[.08333,.58333,0,0,.77778],8857:[.08333,.58333,0,0,.77778],8866:[0,.69444,0,0,.61111],8867:[0,.69444,0,0,.61111],8868:[0,.69444,0,0,.77778],8869:[0,.69444,0,0,.77778],8872:[.249,.75,0,0,.867],8900:[-.05555,.44445,0,0,.5],8901:[-.05555,.44445,0,0,.27778],8902:[-.03472,.46528,0,0,.5],8904:[.005,.505,0,0,.9],8942:[.03,.903,0,0,.278],8943:[-.19,.313,0,0,1.172],8945:[-.1,.823,0,0,1.282],8968:[.25,.75,0,0,.44445],8969:[.25,.75,0,0,.44445],8970:[.25,.75,0,0,.44445],8971:[.25,.75,0,0,.44445],8994:[-.14236,.35764,0,0,1],8995:[-.14236,.35764,0,0,1],9136:[.244,.744,0,0,.412],9137:[.244,.745,0,0,.412],9651:[.19444,.69444,0,0,.88889],9657:[-.03472,.46528,0,0,.5],9661:[.19444,.69444,0,0,.88889],9667:[-.03472,.46528,0,0,.5],9711:[.19444,.69444,0,0,1],9824:[.12963,.69444,0,0,.77778],9825:[.12963,.69444,0,0,.77778],9826:[.12963,.69444,0,0,.77778],9827:[.12963,.69444,0,0,.77778],9837:[0,.75,0,0,.38889],9838:[.19444,.69444,0,0,.38889],9839:[.19444,.69444,0,0,.38889],10216:[.25,.75,0,0,.38889],10217:[.25,.75,0,0,.38889],10222:[.244,.744,0,0,.412],10223:[.244,.745,0,0,.412],10229:[.011,.511,0,0,1.609],10230:[.011,.511,0,0,1.638],10231:[.011,.511,0,0,1.859],10232:[.024,.525,0,0,1.609],10233:[.024,.525,0,0,1.638],10234:[.024,.525,0,0,1.858],10236:[.011,.511,0,0,1.638],10815:[0,.68333,0,0,.75],10927:[.13597,.63597,0,0,.77778],10928:[.13597,.63597,0,0,.77778],57376:[.19444,.69444,0,0,0]},"Math-BoldItalic":{32:[0,0,0,0,.25],48:[0,.44444,0,0,.575],49:[0,.44444,0,0,.575],50:[0,.44444,0,0,.575],51:[.19444,.44444,0,0,.575],52:[.19444,.44444,0,0,.575],53:[.19444,.44444,0,0,.575],54:[0,.64444,0,0,.575],55:[.19444,.44444,0,0,.575],56:[0,.64444,0,0,.575],57:[.19444,.44444,0,0,.575],65:[0,.68611,0,0,.86944],66:[0,.68611,.04835,0,.8664],67:[0,.68611,.06979,0,.81694],68:[0,.68611,.03194,0,.93812],69:[0,.68611,.05451,0,.81007],70:[0,.68611,.15972,0,.68889],71:[0,.68611,0,0,.88673],72:[0,.68611,.08229,0,.98229],73:[0,.68611,.07778,0,.51111],74:[0,.68611,.10069,0,.63125],75:[0,.68611,.06979,0,.97118],76:[0,.68611,0,0,.75555],77:[0,.68611,.11424,0,1.14201],78:[0,.68611,.11424,0,.95034],79:[0,.68611,.03194,0,.83666],80:[0,.68611,.15972,0,.72309],81:[.19444,.68611,0,0,.86861],82:[0,.68611,.00421,0,.87235],83:[0,.68611,.05382,0,.69271],84:[0,.68611,.15972,0,.63663],85:[0,.68611,.11424,0,.80027],86:[0,.68611,.25555,0,.67778],87:[0,.68611,.15972,0,1.09305],88:[0,.68611,.07778,0,.94722],89:[0,.68611,.25555,0,.67458],90:[0,.68611,.06979,0,.77257],97:[0,.44444,0,0,.63287],98:[0,.69444,0,0,.52083],99:[0,.44444,0,0,.51342],100:[0,.69444,0,0,.60972],101:[0,.44444,0,0,.55361],102:[.19444,.69444,.11042,0,.56806],103:[.19444,.44444,.03704,0,.5449],104:[0,.69444,0,0,.66759],105:[0,.69326,0,0,.4048],106:[.19444,.69326,.0622,0,.47083],107:[0,.69444,.01852,0,.6037],108:[0,.69444,.0088,0,.34815],109:[0,.44444,0,0,1.0324],110:[0,.44444,0,0,.71296],111:[0,.44444,0,0,.58472],112:[.19444,.44444,0,0,.60092],113:[.19444,.44444,.03704,0,.54213],114:[0,.44444,.03194,0,.5287],115:[0,.44444,0,0,.53125],116:[0,.63492,0,0,.41528],117:[0,.44444,0,0,.68102],118:[0,.44444,.03704,0,.56666],119:[0,.44444,.02778,0,.83148],120:[0,.44444,0,0,.65903],121:[.19444,.44444,.03704,0,.59028],122:[0,.44444,.04213,0,.55509],160:[0,0,0,0,.25],915:[0,.68611,.15972,0,.65694],916:[0,.68611,0,0,.95833],920:[0,.68611,.03194,0,.86722],923:[0,.68611,0,0,.80555],926:[0,.68611,.07458,0,.84125],928:[0,.68611,.08229,0,.98229],931:[0,.68611,.05451,0,.88507],933:[0,.68611,.15972,0,.67083],934:[0,.68611,0,0,.76666],936:[0,.68611,.11653,0,.71402],937:[0,.68611,.04835,0,.8789],945:[0,.44444,0,0,.76064],946:[.19444,.69444,.03403,0,.65972],947:[.19444,.44444,.06389,0,.59003],948:[0,.69444,.03819,0,.52222],949:[0,.44444,0,0,.52882],950:[.19444,.69444,.06215,0,.50833],951:[.19444,.44444,.03704,0,.6],952:[0,.69444,.03194,0,.5618],953:[0,.44444,0,0,.41204],954:[0,.44444,0,0,.66759],955:[0,.69444,0,0,.67083],956:[.19444,.44444,0,0,.70787],957:[0,.44444,.06898,0,.57685],958:[.19444,.69444,.03021,0,.50833],959:[0,.44444,0,0,.58472],960:[0,.44444,.03704,0,.68241],961:[.19444,.44444,0,0,.6118],962:[.09722,.44444,.07917,0,.42361],963:[0,.44444,.03704,0,.68588],964:[0,.44444,.13472,0,.52083],965:[0,.44444,.03704,0,.63055],966:[.19444,.44444,0,0,.74722],967:[.19444,.44444,0,0,.71805],968:[.19444,.69444,.03704,0,.75833],969:[0,.44444,.03704,0,.71782],977:[0,.69444,0,0,.69155],981:[.19444,.69444,0,0,.7125],982:[0,.44444,.03194,0,.975],1009:[.19444,.44444,0,0,.6118],1013:[0,.44444,0,0,.48333],57649:[0,.44444,0,0,.39352],57911:[.19444,.44444,0,0,.43889]},"Math-Italic":{32:[0,0,0,0,.25],48:[0,.43056,0,0,.5],49:[0,.43056,0,0,.5],50:[0,.43056,0,0,.5],51:[.19444,.43056,0,0,.5],52:[.19444,.43056,0,0,.5],53:[.19444,.43056,0,0,.5],54:[0,.64444,0,0,.5],55:[.19444,.43056,0,0,.5],56:[0,.64444,0,0,.5],57:[.19444,.43056,0,0,.5],65:[0,.68333,0,.13889,.75],66:[0,.68333,.05017,.08334,.75851],67:[0,.68333,.07153,.08334,.71472],68:[0,.68333,.02778,.05556,.82792],69:[0,.68333,.05764,.08334,.7382],70:[0,.68333,.13889,.08334,.64306],71:[0,.68333,0,.08334,.78625],72:[0,.68333,.08125,.05556,.83125],73:[0,.68333,.07847,.11111,.43958],74:[0,.68333,.09618,.16667,.55451],75:[0,.68333,.07153,.05556,.84931],76:[0,.68333,0,.02778,.68056],77:[0,.68333,.10903,.08334,.97014],78:[0,.68333,.10903,.08334,.80347],79:[0,.68333,.02778,.08334,.76278],80:[0,.68333,.13889,.08334,.64201],81:[.19444,.68333,0,.08334,.79056],82:[0,.68333,.00773,.08334,.75929],83:[0,.68333,.05764,.08334,.6132],84:[0,.68333,.13889,.08334,.58438],85:[0,.68333,.10903,.02778,.68278],86:[0,.68333,.22222,0,.58333],87:[0,.68333,.13889,0,.94445],88:[0,.68333,.07847,.08334,.82847],89:[0,.68333,.22222,0,.58056],90:[0,.68333,.07153,.08334,.68264],97:[0,.43056,0,0,.52859],98:[0,.69444,0,0,.42917],99:[0,.43056,0,.05556,.43276],100:[0,.69444,0,.16667,.52049],101:[0,.43056,0,.05556,.46563],102:[.19444,.69444,.10764,.16667,.48959],103:[.19444,.43056,.03588,.02778,.47697],104:[0,.69444,0,0,.57616],105:[0,.65952,0,0,.34451],106:[.19444,.65952,.05724,0,.41181],107:[0,.69444,.03148,0,.5206],108:[0,.69444,.01968,.08334,.29838],109:[0,.43056,0,0,.87801],110:[0,.43056,0,0,.60023],111:[0,.43056,0,.05556,.48472],112:[.19444,.43056,0,.08334,.50313],113:[.19444,.43056,.03588,.08334,.44641],114:[0,.43056,.02778,.05556,.45116],115:[0,.43056,0,.05556,.46875],116:[0,.61508,0,.08334,.36111],117:[0,.43056,0,.02778,.57246],118:[0,.43056,.03588,.02778,.48472],119:[0,.43056,.02691,.08334,.71592],120:[0,.43056,0,.02778,.57153],121:[.19444,.43056,.03588,.05556,.49028],122:[0,.43056,.04398,.05556,.46505],160:[0,0,0,0,.25],915:[0,.68333,.13889,.08334,.61528],916:[0,.68333,0,.16667,.83334],920:[0,.68333,.02778,.08334,.76278],923:[0,.68333,0,.16667,.69445],926:[0,.68333,.07569,.08334,.74236],928:[0,.68333,.08125,.05556,.83125],931:[0,.68333,.05764,.08334,.77986],933:[0,.68333,.13889,.05556,.58333],934:[0,.68333,0,.08334,.66667],936:[0,.68333,.11,.05556,.61222],937:[0,.68333,.05017,.08334,.7724],945:[0,.43056,.0037,.02778,.6397],946:[.19444,.69444,.05278,.08334,.56563],947:[.19444,.43056,.05556,0,.51773],948:[0,.69444,.03785,.05556,.44444],949:[0,.43056,0,.08334,.46632],950:[.19444,.69444,.07378,.08334,.4375],951:[.19444,.43056,.03588,.05556,.49653],952:[0,.69444,.02778,.08334,.46944],953:[0,.43056,0,.05556,.35394],954:[0,.43056,0,0,.57616],955:[0,.69444,0,0,.58334],956:[.19444,.43056,0,.02778,.60255],957:[0,.43056,.06366,.02778,.49398],958:[.19444,.69444,.04601,.11111,.4375],959:[0,.43056,0,.05556,.48472],960:[0,.43056,.03588,0,.57003],961:[.19444,.43056,0,.08334,.51702],962:[.09722,.43056,.07986,.08334,.36285],963:[0,.43056,.03588,0,.57141],964:[0,.43056,.1132,.02778,.43715],965:[0,.43056,.03588,.02778,.54028],966:[.19444,.43056,0,.08334,.65417],967:[.19444,.43056,0,.05556,.62569],968:[.19444,.69444,.03588,.11111,.65139],969:[0,.43056,.03588,0,.62245],977:[0,.69444,0,.08334,.59144],981:[.19444,.69444,0,.08334,.59583],982:[0,.43056,.02778,0,.82813],1009:[.19444,.43056,0,.08334,.51702],1013:[0,.43056,0,.05556,.4059],57649:[0,.43056,0,.02778,.32246],57911:[.19444,.43056,0,.08334,.38403]},"SansSerif-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.36667],34:[0,.69444,0,0,.55834],35:[.19444,.69444,0,0,.91667],36:[.05556,.75,0,0,.55],37:[.05556,.75,0,0,1.02912],38:[0,.69444,0,0,.83056],39:[0,.69444,0,0,.30556],40:[.25,.75,0,0,.42778],41:[.25,.75,0,0,.42778],42:[0,.75,0,0,.55],43:[.11667,.61667,0,0,.85556],44:[.10556,.13056,0,0,.30556],45:[0,.45833,0,0,.36667],46:[0,.13056,0,0,.30556],47:[.25,.75,0,0,.55],48:[0,.69444,0,0,.55],49:[0,.69444,0,0,.55],50:[0,.69444,0,0,.55],51:[0,.69444,0,0,.55],52:[0,.69444,0,0,.55],53:[0,.69444,0,0,.55],54:[0,.69444,0,0,.55],55:[0,.69444,0,0,.55],56:[0,.69444,0,0,.55],57:[0,.69444,0,0,.55],58:[0,.45833,0,0,.30556],59:[.10556,.45833,0,0,.30556],61:[-.09375,.40625,0,0,.85556],63:[0,.69444,0,0,.51945],64:[0,.69444,0,0,.73334],65:[0,.69444,0,0,.73334],66:[0,.69444,0,0,.73334],67:[0,.69444,0,0,.70278],68:[0,.69444,0,0,.79445],69:[0,.69444,0,0,.64167],70:[0,.69444,0,0,.61111],71:[0,.69444,0,0,.73334],72:[0,.69444,0,0,.79445],73:[0,.69444,0,0,.33056],74:[0,.69444,0,0,.51945],75:[0,.69444,0,0,.76389],76:[0,.69444,0,0,.58056],77:[0,.69444,0,0,.97778],78:[0,.69444,0,0,.79445],79:[0,.69444,0,0,.79445],80:[0,.69444,0,0,.70278],81:[.10556,.69444,0,0,.79445],82:[0,.69444,0,0,.70278],83:[0,.69444,0,0,.61111],84:[0,.69444,0,0,.73334],85:[0,.69444,0,0,.76389],86:[0,.69444,.01528,0,.73334],87:[0,.69444,.01528,0,1.03889],88:[0,.69444,0,0,.73334],89:[0,.69444,.0275,0,.73334],90:[0,.69444,0,0,.67223],91:[.25,.75,0,0,.34306],93:[.25,.75,0,0,.34306],94:[0,.69444,0,0,.55],95:[.35,.10833,.03056,0,.55],97:[0,.45833,0,0,.525],98:[0,.69444,0,0,.56111],99:[0,.45833,0,0,.48889],100:[0,.69444,0,0,.56111],101:[0,.45833,0,0,.51111],102:[0,.69444,.07639,0,.33611],103:[.19444,.45833,.01528,0,.55],104:[0,.69444,0,0,.56111],105:[0,.69444,0,0,.25556],106:[.19444,.69444,0,0,.28611],107:[0,.69444,0,0,.53056],108:[0,.69444,0,0,.25556],109:[0,.45833,0,0,.86667],110:[0,.45833,0,0,.56111],111:[0,.45833,0,0,.55],112:[.19444,.45833,0,0,.56111],113:[.19444,.45833,0,0,.56111],114:[0,.45833,.01528,0,.37222],115:[0,.45833,0,0,.42167],116:[0,.58929,0,0,.40417],117:[0,.45833,0,0,.56111],118:[0,.45833,.01528,0,.5],119:[0,.45833,.01528,0,.74445],120:[0,.45833,0,0,.5],121:[.19444,.45833,.01528,0,.5],122:[0,.45833,0,0,.47639],126:[.35,.34444,0,0,.55],160:[0,0,0,0,.25],168:[0,.69444,0,0,.55],176:[0,.69444,0,0,.73334],180:[0,.69444,0,0,.55],184:[.17014,0,0,0,.48889],305:[0,.45833,0,0,.25556],567:[.19444,.45833,0,0,.28611],710:[0,.69444,0,0,.55],711:[0,.63542,0,0,.55],713:[0,.63778,0,0,.55],728:[0,.69444,0,0,.55],729:[0,.69444,0,0,.30556],730:[0,.69444,0,0,.73334],732:[0,.69444,0,0,.55],733:[0,.69444,0,0,.55],915:[0,.69444,0,0,.58056],916:[0,.69444,0,0,.91667],920:[0,.69444,0,0,.85556],923:[0,.69444,0,0,.67223],926:[0,.69444,0,0,.73334],928:[0,.69444,0,0,.79445],931:[0,.69444,0,0,.79445],933:[0,.69444,0,0,.85556],934:[0,.69444,0,0,.79445],936:[0,.69444,0,0,.85556],937:[0,.69444,0,0,.79445],8211:[0,.45833,.03056,0,.55],8212:[0,.45833,.03056,0,1.10001],8216:[0,.69444,0,0,.30556],8217:[0,.69444,0,0,.30556],8220:[0,.69444,0,0,.55834],8221:[0,.69444,0,0,.55834]},"SansSerif-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.05733,0,.31945],34:[0,.69444,.00316,0,.5],35:[.19444,.69444,.05087,0,.83334],36:[.05556,.75,.11156,0,.5],37:[.05556,.75,.03126,0,.83334],38:[0,.69444,.03058,0,.75834],39:[0,.69444,.07816,0,.27778],40:[.25,.75,.13164,0,.38889],41:[.25,.75,.02536,0,.38889],42:[0,.75,.11775,0,.5],43:[.08333,.58333,.02536,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,.01946,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,.13164,0,.5],48:[0,.65556,.11156,0,.5],49:[0,.65556,.11156,0,.5],50:[0,.65556,.11156,0,.5],51:[0,.65556,.11156,0,.5],52:[0,.65556,.11156,0,.5],53:[0,.65556,.11156,0,.5],54:[0,.65556,.11156,0,.5],55:[0,.65556,.11156,0,.5],56:[0,.65556,.11156,0,.5],57:[0,.65556,.11156,0,.5],58:[0,.44444,.02502,0,.27778],59:[.125,.44444,.02502,0,.27778],61:[-.13,.37,.05087,0,.77778],63:[0,.69444,.11809,0,.47222],64:[0,.69444,.07555,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,.08293,0,.66667],67:[0,.69444,.11983,0,.63889],68:[0,.69444,.07555,0,.72223],69:[0,.69444,.11983,0,.59722],70:[0,.69444,.13372,0,.56945],71:[0,.69444,.11983,0,.66667],72:[0,.69444,.08094,0,.70834],73:[0,.69444,.13372,0,.27778],74:[0,.69444,.08094,0,.47222],75:[0,.69444,.11983,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,.08094,0,.875],78:[0,.69444,.08094,0,.70834],79:[0,.69444,.07555,0,.73611],80:[0,.69444,.08293,0,.63889],81:[.125,.69444,.07555,0,.73611],82:[0,.69444,.08293,0,.64584],83:[0,.69444,.09205,0,.55556],84:[0,.69444,.13372,0,.68056],85:[0,.69444,.08094,0,.6875],86:[0,.69444,.1615,0,.66667],87:[0,.69444,.1615,0,.94445],88:[0,.69444,.13372,0,.66667],89:[0,.69444,.17261,0,.66667],90:[0,.69444,.11983,0,.61111],91:[.25,.75,.15942,0,.28889],93:[.25,.75,.08719,0,.28889],94:[0,.69444,.0799,0,.5],95:[.35,.09444,.08616,0,.5],97:[0,.44444,.00981,0,.48056],98:[0,.69444,.03057,0,.51667],99:[0,.44444,.08336,0,.44445],100:[0,.69444,.09483,0,.51667],101:[0,.44444,.06778,0,.44445],102:[0,.69444,.21705,0,.30556],103:[.19444,.44444,.10836,0,.5],104:[0,.69444,.01778,0,.51667],105:[0,.67937,.09718,0,.23889],106:[.19444,.67937,.09162,0,.26667],107:[0,.69444,.08336,0,.48889],108:[0,.69444,.09483,0,.23889],109:[0,.44444,.01778,0,.79445],110:[0,.44444,.01778,0,.51667],111:[0,.44444,.06613,0,.5],112:[.19444,.44444,.0389,0,.51667],113:[.19444,.44444,.04169,0,.51667],114:[0,.44444,.10836,0,.34167],115:[0,.44444,.0778,0,.38333],116:[0,.57143,.07225,0,.36111],117:[0,.44444,.04169,0,.51667],118:[0,.44444,.10836,0,.46111],119:[0,.44444,.10836,0,.68334],120:[0,.44444,.09169,0,.46111],121:[.19444,.44444,.10836,0,.46111],122:[0,.44444,.08752,0,.43472],126:[.35,.32659,.08826,0,.5],160:[0,0,0,0,.25],168:[0,.67937,.06385,0,.5],176:[0,.69444,0,0,.73752],184:[.17014,0,0,0,.44445],305:[0,.44444,.04169,0,.23889],567:[.19444,.44444,.04169,0,.26667],710:[0,.69444,.0799,0,.5],711:[0,.63194,.08432,0,.5],713:[0,.60889,.08776,0,.5],714:[0,.69444,.09205,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,.09483,0,.5],729:[0,.67937,.07774,0,.27778],730:[0,.69444,0,0,.73752],732:[0,.67659,.08826,0,.5],733:[0,.69444,.09205,0,.5],915:[0,.69444,.13372,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,.07555,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,.12816,0,.66667],928:[0,.69444,.08094,0,.70834],931:[0,.69444,.11983,0,.72222],933:[0,.69444,.09031,0,.77778],934:[0,.69444,.04603,0,.72222],936:[0,.69444,.09031,0,.77778],937:[0,.69444,.08293,0,.72222],8211:[0,.44444,.08616,0,.5],8212:[0,.44444,.08616,0,1],8216:[0,.69444,.07816,0,.27778],8217:[0,.69444,.07816,0,.27778],8220:[0,.69444,.14205,0,.5],8221:[0,.69444,.00316,0,.5]},"SansSerif-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.31945],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.75834],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,0,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.65556,0,0,.5],49:[0,.65556,0,0,.5],50:[0,.65556,0,0,.5],51:[0,.65556,0,0,.5],52:[0,.65556,0,0,.5],53:[0,.65556,0,0,.5],54:[0,.65556,0,0,.5],55:[0,.65556,0,0,.5],56:[0,.65556,0,0,.5],57:[0,.65556,0,0,.5],58:[0,.44444,0,0,.27778],59:[.125,.44444,0,0,.27778],61:[-.13,.37,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,0,0,.66667],67:[0,.69444,0,0,.63889],68:[0,.69444,0,0,.72223],69:[0,.69444,0,0,.59722],70:[0,.69444,0,0,.56945],71:[0,.69444,0,0,.66667],72:[0,.69444,0,0,.70834],73:[0,.69444,0,0,.27778],74:[0,.69444,0,0,.47222],75:[0,.69444,0,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,0,0,.875],78:[0,.69444,0,0,.70834],79:[0,.69444,0,0,.73611],80:[0,.69444,0,0,.63889],81:[.125,.69444,0,0,.73611],82:[0,.69444,0,0,.64584],83:[0,.69444,0,0,.55556],84:[0,.69444,0,0,.68056],85:[0,.69444,0,0,.6875],86:[0,.69444,.01389,0,.66667],87:[0,.69444,.01389,0,.94445],88:[0,.69444,0,0,.66667],89:[0,.69444,.025,0,.66667],90:[0,.69444,0,0,.61111],91:[.25,.75,0,0,.28889],93:[.25,.75,0,0,.28889],94:[0,.69444,0,0,.5],95:[.35,.09444,.02778,0,.5],97:[0,.44444,0,0,.48056],98:[0,.69444,0,0,.51667],99:[0,.44444,0,0,.44445],100:[0,.69444,0,0,.51667],101:[0,.44444,0,0,.44445],102:[0,.69444,.06944,0,.30556],103:[.19444,.44444,.01389,0,.5],104:[0,.69444,0,0,.51667],105:[0,.67937,0,0,.23889],106:[.19444,.67937,0,0,.26667],107:[0,.69444,0,0,.48889],108:[0,.69444,0,0,.23889],109:[0,.44444,0,0,.79445],110:[0,.44444,0,0,.51667],111:[0,.44444,0,0,.5],112:[.19444,.44444,0,0,.51667],113:[.19444,.44444,0,0,.51667],114:[0,.44444,.01389,0,.34167],115:[0,.44444,0,0,.38333],116:[0,.57143,0,0,.36111],117:[0,.44444,0,0,.51667],118:[0,.44444,.01389,0,.46111],119:[0,.44444,.01389,0,.68334],120:[0,.44444,0,0,.46111],121:[.19444,.44444,.01389,0,.46111],122:[0,.44444,0,0,.43472],126:[.35,.32659,0,0,.5],160:[0,0,0,0,.25],168:[0,.67937,0,0,.5],176:[0,.69444,0,0,.66667],184:[.17014,0,0,0,.44445],305:[0,.44444,0,0,.23889],567:[.19444,.44444,0,0,.26667],710:[0,.69444,0,0,.5],711:[0,.63194,0,0,.5],713:[0,.60889,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.67937,0,0,.27778],730:[0,.69444,0,0,.66667],732:[0,.67659,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.69444,0,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,0,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,0,0,.66667],928:[0,.69444,0,0,.70834],931:[0,.69444,0,0,.72222],933:[0,.69444,0,0,.77778],934:[0,.69444,0,0,.72222],936:[0,.69444,0,0,.77778],937:[0,.69444,0,0,.72222],8211:[0,.44444,.02778,0,.5],8212:[0,.44444,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5]},"Script-Regular":{32:[0,0,0,0,.25],65:[0,.7,.22925,0,.80253],66:[0,.7,.04087,0,.90757],67:[0,.7,.1689,0,.66619],68:[0,.7,.09371,0,.77443],69:[0,.7,.18583,0,.56162],70:[0,.7,.13634,0,.89544],71:[0,.7,.17322,0,.60961],72:[0,.7,.29694,0,.96919],73:[0,.7,.19189,0,.80907],74:[.27778,.7,.19189,0,1.05159],75:[0,.7,.31259,0,.91364],76:[0,.7,.19189,0,.87373],77:[0,.7,.15981,0,1.08031],78:[0,.7,.3525,0,.9015],79:[0,.7,.08078,0,.73787],80:[0,.7,.08078,0,1.01262],81:[0,.7,.03305,0,.88282],82:[0,.7,.06259,0,.85],83:[0,.7,.19189,0,.86767],84:[0,.7,.29087,0,.74697],85:[0,.7,.25815,0,.79996],86:[0,.7,.27523,0,.62204],87:[0,.7,.27523,0,.80532],88:[0,.7,.26006,0,.94445],89:[0,.7,.2939,0,.70961],90:[0,.7,.24037,0,.8212],160:[0,0,0,0,.25]},"Size1-Regular":{32:[0,0,0,0,.25],40:[.35001,.85,0,0,.45834],41:[.35001,.85,0,0,.45834],47:[.35001,.85,0,0,.57778],91:[.35001,.85,0,0,.41667],92:[.35001,.85,0,0,.57778],93:[.35001,.85,0,0,.41667],123:[.35001,.85,0,0,.58334],125:[.35001,.85,0,0,.58334],160:[0,0,0,0,.25],710:[0,.72222,0,0,.55556],732:[0,.72222,0,0,.55556],770:[0,.72222,0,0,.55556],771:[0,.72222,0,0,.55556],8214:[-99e-5,.601,0,0,.77778],8593:[1e-5,.6,0,0,.66667],8595:[1e-5,.6,0,0,.66667],8657:[1e-5,.6,0,0,.77778],8659:[1e-5,.6,0,0,.77778],8719:[.25001,.75,0,0,.94445],8720:[.25001,.75,0,0,.94445],8721:[.25001,.75,0,0,1.05556],8730:[.35001,.85,0,0,1],8739:[-.00599,.606,0,0,.33333],8741:[-.00599,.606,0,0,.55556],8747:[.30612,.805,.19445,0,.47222],8748:[.306,.805,.19445,0,.47222],8749:[.306,.805,.19445,0,.47222],8750:[.30612,.805,.19445,0,.47222],8896:[.25001,.75,0,0,.83334],8897:[.25001,.75,0,0,.83334],8898:[.25001,.75,0,0,.83334],8899:[.25001,.75,0,0,.83334],8968:[.35001,.85,0,0,.47222],8969:[.35001,.85,0,0,.47222],8970:[.35001,.85,0,0,.47222],8971:[.35001,.85,0,0,.47222],9168:[-99e-5,.601,0,0,.66667],10216:[.35001,.85,0,0,.47222],10217:[.35001,.85,0,0,.47222],10752:[.25001,.75,0,0,1.11111],10753:[.25001,.75,0,0,1.11111],10754:[.25001,.75,0,0,1.11111],10756:[.25001,.75,0,0,.83334],10758:[.25001,.75,0,0,.83334]},"Size2-Regular":{32:[0,0,0,0,.25],40:[.65002,1.15,0,0,.59722],41:[.65002,1.15,0,0,.59722],47:[.65002,1.15,0,0,.81111],91:[.65002,1.15,0,0,.47222],92:[.65002,1.15,0,0,.81111],93:[.65002,1.15,0,0,.47222],123:[.65002,1.15,0,0,.66667],125:[.65002,1.15,0,0,.66667],160:[0,0,0,0,.25],710:[0,.75,0,0,1],732:[0,.75,0,0,1],770:[0,.75,0,0,1],771:[0,.75,0,0,1],8719:[.55001,1.05,0,0,1.27778],8720:[.55001,1.05,0,0,1.27778],8721:[.55001,1.05,0,0,1.44445],8730:[.65002,1.15,0,0,1],8747:[.86225,1.36,.44445,0,.55556],8748:[.862,1.36,.44445,0,.55556],8749:[.862,1.36,.44445,0,.55556],8750:[.86225,1.36,.44445,0,.55556],8896:[.55001,1.05,0,0,1.11111],8897:[.55001,1.05,0,0,1.11111],8898:[.55001,1.05,0,0,1.11111],8899:[.55001,1.05,0,0,1.11111],8968:[.65002,1.15,0,0,.52778],8969:[.65002,1.15,0,0,.52778],8970:[.65002,1.15,0,0,.52778],8971:[.65002,1.15,0,0,.52778],10216:[.65002,1.15,0,0,.61111],10217:[.65002,1.15,0,0,.61111],10752:[.55001,1.05,0,0,1.51112],10753:[.55001,1.05,0,0,1.51112],10754:[.55001,1.05,0,0,1.51112],10756:[.55001,1.05,0,0,1.11111],10758:[.55001,1.05,0,0,1.11111]},"Size3-Regular":{32:[0,0,0,0,.25],40:[.95003,1.45,0,0,.73611],41:[.95003,1.45,0,0,.73611],47:[.95003,1.45,0,0,1.04445],91:[.95003,1.45,0,0,.52778],92:[.95003,1.45,0,0,1.04445],93:[.95003,1.45,0,0,.52778],123:[.95003,1.45,0,0,.75],125:[.95003,1.45,0,0,.75],160:[0,0,0,0,.25],710:[0,.75,0,0,1.44445],732:[0,.75,0,0,1.44445],770:[0,.75,0,0,1.44445],771:[0,.75,0,0,1.44445],8730:[.95003,1.45,0,0,1],8968:[.95003,1.45,0,0,.58334],8969:[.95003,1.45,0,0,.58334],8970:[.95003,1.45,0,0,.58334],8971:[.95003,1.45,0,0,.58334],10216:[.95003,1.45,0,0,.75],10217:[.95003,1.45,0,0,.75]},"Size4-Regular":{32:[0,0,0,0,.25],40:[1.25003,1.75,0,0,.79167],41:[1.25003,1.75,0,0,.79167],47:[1.25003,1.75,0,0,1.27778],91:[1.25003,1.75,0,0,.58334],92:[1.25003,1.75,0,0,1.27778],93:[1.25003,1.75,0,0,.58334],123:[1.25003,1.75,0,0,.80556],125:[1.25003,1.75,0,0,.80556],160:[0,0,0,0,.25],710:[0,.825,0,0,1.8889],732:[0,.825,0,0,1.8889],770:[0,.825,0,0,1.8889],771:[0,.825,0,0,1.8889],8730:[1.25003,1.75,0,0,1],8968:[1.25003,1.75,0,0,.63889],8969:[1.25003,1.75,0,0,.63889],8970:[1.25003,1.75,0,0,.63889],8971:[1.25003,1.75,0,0,.63889],9115:[.64502,1.155,0,0,.875],9116:[1e-5,.6,0,0,.875],9117:[.64502,1.155,0,0,.875],9118:[.64502,1.155,0,0,.875],9119:[1e-5,.6,0,0,.875],9120:[.64502,1.155,0,0,.875],9121:[.64502,1.155,0,0,.66667],9122:[-99e-5,.601,0,0,.66667],9123:[.64502,1.155,0,0,.66667],9124:[.64502,1.155,0,0,.66667],9125:[-99e-5,.601,0,0,.66667],9126:[.64502,1.155,0,0,.66667],9127:[1e-5,.9,0,0,.88889],9128:[.65002,1.15,0,0,.88889],9129:[.90001,0,0,0,.88889],9130:[0,.3,0,0,.88889],9131:[1e-5,.9,0,0,.88889],9132:[.65002,1.15,0,0,.88889],9133:[.90001,0,0,0,.88889],9143:[.88502,.915,0,0,1.05556],10216:[1.25003,1.75,0,0,.80556],10217:[1.25003,1.75,0,0,.80556],57344:[-.00499,.605,0,0,1.05556],57345:[-.00499,.605,0,0,1.05556],57680:[0,.12,0,0,.45],57681:[0,.12,0,0,.45],57682:[0,.12,0,0,.45],57683:[0,.12,0,0,.45]},"Typewriter-Regular":{32:[0,0,0,0,.525],33:[0,.61111,0,0,.525],34:[0,.61111,0,0,.525],35:[0,.61111,0,0,.525],36:[.08333,.69444,0,0,.525],37:[.08333,.69444,0,0,.525],38:[0,.61111,0,0,.525],39:[0,.61111,0,0,.525],40:[.08333,.69444,0,0,.525],41:[.08333,.69444,0,0,.525],42:[0,.52083,0,0,.525],43:[-.08056,.53055,0,0,.525],44:[.13889,.125,0,0,.525],45:[-.08056,.53055,0,0,.525],46:[0,.125,0,0,.525],47:[.08333,.69444,0,0,.525],48:[0,.61111,0,0,.525],49:[0,.61111,0,0,.525],50:[0,.61111,0,0,.525],51:[0,.61111,0,0,.525],52:[0,.61111,0,0,.525],53:[0,.61111,0,0,.525],54:[0,.61111,0,0,.525],55:[0,.61111,0,0,.525],56:[0,.61111,0,0,.525],57:[0,.61111,0,0,.525],58:[0,.43056,0,0,.525],59:[.13889,.43056,0,0,.525],60:[-.05556,.55556,0,0,.525],61:[-.19549,.41562,0,0,.525],62:[-.05556,.55556,0,0,.525],63:[0,.61111,0,0,.525],64:[0,.61111,0,0,.525],65:[0,.61111,0,0,.525],66:[0,.61111,0,0,.525],67:[0,.61111,0,0,.525],68:[0,.61111,0,0,.525],69:[0,.61111,0,0,.525],70:[0,.61111,0,0,.525],71:[0,.61111,0,0,.525],72:[0,.61111,0,0,.525],73:[0,.61111,0,0,.525],74:[0,.61111,0,0,.525],75:[0,.61111,0,0,.525],76:[0,.61111,0,0,.525],77:[0,.61111,0,0,.525],78:[0,.61111,0,0,.525],79:[0,.61111,0,0,.525],80:[0,.61111,0,0,.525],81:[.13889,.61111,0,0,.525],82:[0,.61111,0,0,.525],83:[0,.61111,0,0,.525],84:[0,.61111,0,0,.525],85:[0,.61111,0,0,.525],86:[0,.61111,0,0,.525],87:[0,.61111,0,0,.525],88:[0,.61111,0,0,.525],89:[0,.61111,0,0,.525],90:[0,.61111,0,0,.525],91:[.08333,.69444,0,0,.525],92:[.08333,.69444,0,0,.525],93:[.08333,.69444,0,0,.525],94:[0,.61111,0,0,.525],95:[.09514,0,0,0,.525],96:[0,.61111,0,0,.525],97:[0,.43056,0,0,.525],98:[0,.61111,0,0,.525],99:[0,.43056,0,0,.525],100:[0,.61111,0,0,.525],101:[0,.43056,0,0,.525],102:[0,.61111,0,0,.525],103:[.22222,.43056,0,0,.525],104:[0,.61111,0,0,.525],105:[0,.61111,0,0,.525],106:[.22222,.61111,0,0,.525],107:[0,.61111,0,0,.525],108:[0,.61111,0,0,.525],109:[0,.43056,0,0,.525],110:[0,.43056,0,0,.525],111:[0,.43056,0,0,.525],112:[.22222,.43056,0,0,.525],113:[.22222,.43056,0,0,.525],114:[0,.43056,0,0,.525],115:[0,.43056,0,0,.525],116:[0,.55358,0,0,.525],117:[0,.43056,0,0,.525],118:[0,.43056,0,0,.525],119:[0,.43056,0,0,.525],120:[0,.43056,0,0,.525],121:[.22222,.43056,0,0,.525],122:[0,.43056,0,0,.525],123:[.08333,.69444,0,0,.525],124:[.08333,.69444,0,0,.525],125:[.08333,.69444,0,0,.525],126:[0,.61111,0,0,.525],127:[0,.61111,0,0,.525],160:[0,0,0,0,.525],176:[0,.61111,0,0,.525],184:[.19445,0,0,0,.525],305:[0,.43056,0,0,.525],567:[.22222,.43056,0,0,.525],711:[0,.56597,0,0,.525],713:[0,.56555,0,0,.525],714:[0,.61111,0,0,.525],715:[0,.61111,0,0,.525],728:[0,.61111,0,0,.525],730:[0,.61111,0,0,.525],770:[0,.61111,0,0,.525],771:[0,.61111,0,0,.525],776:[0,.61111,0,0,.525],915:[0,.61111,0,0,.525],916:[0,.61111,0,0,.525],920:[0,.61111,0,0,.525],923:[0,.61111,0,0,.525],926:[0,.61111,0,0,.525],928:[0,.61111,0,0,.525],931:[0,.61111,0,0,.525],933:[0,.61111,0,0,.525],934:[0,.61111,0,0,.525],936:[0,.61111,0,0,.525],937:[0,.61111,0,0,.525],8216:[0,.61111,0,0,.525],8217:[0,.61111,0,0,.525],8242:[0,.61111,0,0,.525],9251:[.11111,.21944,0,0,.525]}},yy={slant:[.25,.25,.25],space:[0,0,0],stretch:[0,0,0],shrink:[0,0,0],xHeight:[.431,.431,.431],quad:[1,1.171,1.472],extraSpace:[0,0,0],num1:[.677,.732,.925],num2:[.394,.384,.387],num3:[.444,.471,.504],denom1:[.686,.752,1.025],denom2:[.345,.344,.532],sup1:[.413,.503,.504],sup2:[.363,.431,.404],sup3:[.289,.286,.294],sub1:[.15,.143,.2],sub2:[.247,.286,.4],supDrop:[.386,.353,.494],subDrop:[.05,.071,.1],delim1:[2.39,1.7,1.98],delim2:[1.01,1.157,1.42],axisHeight:[.25,.25,.25],defaultRuleThickness:[.04,.049,.049],bigOpSpacing1:[.111,.111,.111],bigOpSpacing2:[.166,.166,.166],bigOpSpacing3:[.2,.2,.2],bigOpSpacing4:[.6,.611,.611],bigOpSpacing5:[.1,.143,.143],sqrtRuleThickness:[.04,.04,.04],ptPerEm:[10,10,10],doubleRuleSep:[.2,.2,.2],arrayRuleWidth:[.04,.04,.04],fboxsep:[.3,.3,.3],fboxrule:[.04,.04,.04]},FN={:"A",:"D",:"o",:"a",:"d",:"o",:"A",:"B",:"B",:"F",:"A",:"E",:"K",:"3",:"N",:"N",:"K",:"N",:"M",:"H",:"O",:"N",:"P",:"C",:"T",:"y",:"O",:"X",:"U",:"h",:"W",:"W",:"B",:"X",:"B",:"3",:"X",:"R",:"a",:"b",:"a",:"r",:"y",:"e",:"m",:"e",:"n",:"n",:"n",:"n",:"m",:"n",:"o",:"n",:"p",:"c",:"o",:"y",:"b",:"x",:"n",:"n",:"w",:"w",:"a",:"m",:"a",:"e",:"m",:"r"};function Q_e(i,e){Go[i]=e}function EC(i,e,t){if(!Go[e])throw new Error("Font metrics not found for font: "+e+".");var n=i.charCodeAt(0),r=Go[e][n];if(!r&&i[0]in FN&&(n=FN[i[0]].charCodeAt(0),r=Go[e][n]),!r&&t==="text"&&zG(n)&&(r=Go[e][77]),r)return{depth:r[0],height:r[1],italic:r[2],skew:r[3],width:r[4]}}var rM={};function J_e(i){var e;if(i>=5?e=0:i>=3?e=1:e=2,!rM[e]){var t=rM[e]={cssEmPerMu:yy.quad[e]/18};for(var n in yy)yy.hasOwnProperty(n)&&(t[n]=yy[n][e])}return rM[e]}var e3e=[[1,1,1],[2,1,1],[3,1,1],[4,2,1],[5,2,1],[6,3,1],[7,4,2],[8,6,3],[9,7,6],[10,8,7],[11,10,9]],BN=[.5,.6,.7,.8,.9,1,1.2,1.44,1.728,2.074,2.488],HN=function(e,t){return t.size<2?e:e3e[e-1][t.size-1]};class ql{constructor(e){this.style=void 0,this.color=void 0,this.size=void 0,this.textSize=void 0,this.phantom=void 0,this.font=void 0,this.fontFamily=void 0,this.fontWeight=void 0,this.fontShape=void 0,this.sizeMultiplier=void 0,this.maxSize=void 0,this.minRuleThickness=void 0,this._fontMetrics=void 0,this.style=e.style,this.color=e.color,this.size=e.size||ql.BASESIZE,this.textSize=e.textSize||this.size,this.phantom=!!e.phantom,this.font=e.font||"",this.fontFamily=e.fontFamily||"",this.fontWeight=e.fontWeight||"",this.fontShape=e.fontShape||"",this.sizeMultiplier=BN[this.size-1],this.maxSize=e.maxSize,this.minRuleThickness=e.minRuleThickness,this._fontMetrics=void 0}extend(e){var t={style:this.style,size:this.size,textSize:this.textSize,color:this.color,phantom:this.phantom,font:this.font,fontFamily:this.fontFamily,fontWeight:this.fontWeight,fontShape:this.fontShape,maxSize:this.maxSize,minRuleThickness:this.minRuleThickness};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return new ql(t)}havingStyle(e){return this.style===e?this:this.extend({style:e,size:HN(this.textSize,e)})}havingCrampedStyle(){return this.havingStyle(this.style.cramp())}havingSize(e){return this.size===e&&this.textSize===e?this:this.extend({style:this.style.text(),size:e,textSize:e,sizeMultiplier:BN[e-1]})}havingBaseStyle(e){e=e||this.style.text();var t=HN(ql.BASESIZE,e);return this.size===t&&this.textSize===ql.BASESIZE&&this.style===e?this:this.extend({style:e,size:t})}havingBaseSizing(){var e;switch(this.style.id){case 4:case 5:e=3;break;case 6:case 7:e=1;break;default:e=6}return this.extend({style:this.style.text(),size:e})}withColor(e){return this.extend({color:e})}withPhantom(){return this.extend({phantom:!0})}withFont(e){return this.extend({font:e})}withTextFontFamily(e){return this.extend({fontFamily:e,font:""})}withTextFontWeight(e){return this.extend({fontWeight:e,font:""})}withTextFontShape(e){return this.extend({fontShape:e,font:""})}sizingClasses(e){return e.size!==this.size?["sizing","reset-size"+e.size,"size"+this.size]:[]}baseSizingClasses(){return this.size!==ql.BASESIZE?["sizing","reset-size"+this.size,"size"+ql.BASESIZE]:[]}fontMetrics(){return this._fontMetrics||(this._fontMetrics=J_e(this.size)),this._fontMetrics}getColor(){return this.phantom?"transparent":this.color}}ql.BASESIZE=6;var b6={pt:1,mm:7227/2540,cm:7227/254,in:72.27,bp:803/800,pc:12,dd:1238/1157,cc:14856/1157,nd:685/642,nc:1370/107,sp:1/65536,px:803/800},t3e={ex:!0,em:!0,mu:!0},UG=function(e){return typeof e!="string"&&(e=e.unit),e in b6||e in t3e||e==="ex"},hi=function(e,t){var n;if(e.unit in b6)n=b6[e.unit]/t.fontMetrics().ptPerEm/t.sizeMultiplier;else if(e.unit==="mu")n=t.fontMetrics().cssEmPerMu;else{var r;if(t.style.isTight()?r=t.havingStyle(t.style.text()):r=t,e.unit==="ex")n=r.fontMetrics().xHeight;else if(e.unit==="em")n=r.fontMetrics().quad;else throw new Ye("Invalid unit: '"+e.unit+"'");r!==t&&(n*=r.sizeMultiplier/t.sizeMultiplier)}return Math.min(e.number*n,t.maxSize)},rt=function(e){return+e.toFixed(4)+"em"},wu=function(e){return e.filter(t=>t).join(" ")},FG=function(e,t,n){if(this.classes=e||[],this.attributes={},this.height=0,this.depth=0,this.maxFontSize=0,this.style=n||{},t){t.style.isTight()&&this.classes.push("mtight");var r=t.getColor();r&&(this.style.color=r)}},BG=function(e){var t=document.createElement(e);t.className=wu(this.classes);for(var n in this.style)this.style.hasOwnProperty(n)&&(t.style[n]=this.style[n]);for(var r in this.attributes)this.attributes.hasOwnProperty(r)&&t.setAttribute(r,this.attributes[r]);for(var s=0;s<this.children.length;s++)t.appendChild(this.children[s].toNode());return t},n3e=/[\s"'>/=\x00-\x1f]/,HG=function(e){var t="<"+e;this.classes.length&&(t+=' class="'+wn.escape(wu(this.classes))+'"');var n="";for(var r in this.style)this.style.hasOwnProperty(r)&&(n+=wn.hyphenate(r)+":"+this.style[r]+";");n&&(t+=' style="'+wn.escape(n)+'"');for(var s in this.attributes)if(this.attributes.hasOwnProperty(s)){if(n3e.test(s))throw new Ye("Invalid attribute name '"+s+"'");t+=" "+s+'="'+wn.escape(this.attributes[s])+'"'}t+=">";for(var a=0;a<this.children.length;a++)t+=this.children[a].toMarkup();return t+="</"+e+">",t};class cx{constructor(e,t,n,r){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.width=void 0,this.maxFontSize=void 0,this.style=void 0,FG.call(this,e,n,r),this.children=t||[]}setAttribute(e,t){this.attributes[e]=t}hasClass(e){return this.classes.includes(e)}toNode(){return BG.call(this,"span")}toMarkup(){return HG.call(this,"span")}}class RC{constructor(e,t,n,r){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,FG.call(this,t,r),this.children=n||[],this.setAttribute("href",e)}setAttribute(e,t){this.attributes[e]=t}hasClass(e){return this.classes.includes(e)}toNode(){return BG.call(this,"a")}toMarkup(){return HG.call(this,"a")}}class i3e{constructor(e,t,n){this.src=void 0,this.alt=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.alt=t,this.src=e,this.classes=["mord"],this.style=n}hasClass(e){return this.classes.includes(e)}toNode(){var e=document.createElement("img");e.src=this.src,e.alt=this.alt,e.className="mord";for(var t in this.style)this.style.hasOwnProperty(t)&&(e.style[t]=this.style[t]);return e}toMarkup(){var e='<img src="'+wn.escape(this.src)+'"'+(' alt="'+wn.escape(this.alt)+'"'),t="";for(var n in this.style)this.style.hasOwnProperty(n)&&(t+=wn.hyphenate(n)+":"+this.style[n]+";");return t&&(e+=' style="'+wn.escape(t)+'"'),e+="'/>",e}}var r3e={:"",:"",:"",:""};class Ua{constructor(e,t,n,r,s,a,o,l){this.text=void 0,this.height=void 0,this.depth=void 0,this.italic=void 0,this.skew=void 0,this.width=void 0,this.maxFontSize=void 0,this.classes=void 0,this.style=void 0,this.text=e,this.height=t||0,this.depth=n||0,this.italic=r||0,this.skew=s||0,this.width=a||0,this.classes=o||[],this.style=l||{},this.maxFontSize=0;var c=H_e(this.text.charCodeAt(0));c&&this.classes.push(c+"_fallback"),/[]/.test(this.text)&&(this.text=r3e[this.text])}hasClass(e){return this.classes.includes(e)}toNode(){var e=document.createTextNode(this.text),t=null;this.italic>0&&(t=document.createElement("span"),t.style.marginRight=rt(this.italic)),this.classes.length>0&&(t=t||document.createElement("span"),t.className=wu(this.classes));for(var n in this.style)this.style.hasOwnProperty(n)&&(t=t||document.createElement("span"),t.style[n]=this.style[n]);return t?(t.appendChild(e),t):e}toMarkup(){var e=!1,t="<span";this.classes.length&&(e=!0,t+=' class="',t+=wn.escape(wu(this.classes)),t+='"');var n="";this.italic>0&&(n+="margin-right:"+this.italic+"em;");for(var r in this.style)this.style.hasOwnProperty(r)&&(n+=wn.hyphenate(r)+":"+this.style[r]+";");n&&(e=!0,t+=' style="'+wn.escape(n)+'"');var s=wn.escape(this.text);return e?(t+=">",t+=s,t+="</span>",t):s}}class mc{constructor(e,t){this.children=void 0,this.attributes=void 0,this.children=e||[],this.attributes=t||{}}toNode(){var e="http://www.w3.org/2000/svg",t=document.createElementNS(e,"svg");for(var n in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,n)&&t.setAttribute(n,this.attributes[n]);for(var r=0;r<this.children.length;r++)t.appendChild(this.children[r].toNode());return t}toMarkup(){var e='<svg xmlns="http://www.w3.org/2000/svg"';for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&(e+=" "+t+'="'+wn.escape(this.attributes[t])+'"');e+=">";for(var n=0;n<this.children.length;n++)e+=this.children[n].toMarkup();return e+="</svg>",e}}class Mu{constructor(e,t){this.pathName=void 0,this.alternate=void 0,this.pathName=e,this.alternate=t}toNode(){var e="http://www.w3.org/2000/svg",t=document.createElementNS(e,"path");return this.alternate?t.setAttribute("d",this.alternate):t.setAttribute("d",UN[this.pathName]),t}toMarkup(){return this.alternate?'<path d="'+wn.escape(this.alternate)+'"/>':'<path d="'+wn.escape(UN[this.pathName])+'"/>'}}class _6{constructor(e){this.attributes=void 0,this.attributes=e||{}}toNode(){var e="http://www.w3.org/2000/svg",t=document.createElementNS(e,"line");for(var n in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,n)&&t.setAttribute(n,this.attributes[n]);return t}toMarkup(){var e="<line";for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&(e+=" "+t+'="'+wn.escape(this.attributes[t])+'"');return e+="/>",e}}function jN(i){if(i instanceof Ua)return i;throw new Error("Expected symbolNode but got "+String(i)+".")}function s3e(i){if(i instanceof cx)return i;throw new Error("Expected span<HtmlDomNode> but got "+String(i)+".")}var a3e={bin:1,close:1,inner:1,open:1,punct:1,rel:1},o3e={"accent-token":1,mathord:1,"op-token":1,spacing:1,textord:1},Yn={math:{},text:{}};function I(i,e,t,n,r,s){Yn[i][r]={font:e,group:t,replace:n},s&&n&&(Yn[i][n]=Yn[i][r])}var k="math",ze="text",F="main",ee="ams",ai="accent-token",xt="bin",ls="close",V0="inner",Ot="mathord",Hi="op-token",fa="open",l_="punct",ne="rel",_c="spacing",ae="textord";I(k,F,ne,"","\\equiv",!0);I(k,F,ne,"","\\prec",!0);I(k,F,ne,"","\\succ",!0);I(k,F,ne,"","\\sim",!0);I(k,F,ne,"","\\perp");I(k,F,ne,"","\\preceq",!0);I(k,F,ne,"","\\succeq",!0);I(k,F,ne,"","\\simeq",!0);I(k,F,ne,"","\\mid",!0);I(k,F,ne,"","\\ll",!0);I(k,F,ne,"","\\gg",!0);I(k,F,ne,"","\\asymp",!0);I(k,F,ne,"","\\parallel");I(k,F,ne,"","\\bowtie",!0);I(k,F,ne,"","\\smile",!0);I(k,F,ne,"","\\sqsubseteq",!0);I(k,F,ne,"","\\sqsupseteq",!0);I(k,F,ne,"","\\doteq",!0);I(k,F,ne,"","\\frown",!0);I(k,F,ne,"","\\ni",!0);I(k,F,ne,"","\\propto",!0);I(k,F,ne,"","\\vdash",!0);I(k,F,ne,"","\\dashv",!0);I(k,F,ne,"","\\owns");I(k,F,l_,".","\\ldotp");I(k,F,l_,"","\\cdotp");I(k,F,ae,"#","\\#");I(ze,F,ae,"#","\\#");I(k,F,ae,"&","\\&");I(ze,F,ae,"&","\\&");I(k,F,ae,"","\\aleph",!0);I(k,F,ae,"","\\forall",!0);I(k,F,ae,"","\\hbar",!0);I(k,F,ae,"","\\exists",!0);I(k,F,ae,"","\\nabla",!0);I(k,F,ae,"","\\flat",!0);I(k,F,ae,"","\\ell",!0);I(k,F,ae,"","\\natural",!0);I(k,F,ae,"","\\clubsuit",!0);I(k,F,ae,"","\\wp",!0);I(k,F,ae,"","\\sharp",!0);I(k,F,ae,"","\\diamondsuit",!0);I(k,F,ae,"","\\Re",!0);I(k,F,ae,"","\\heartsuit",!0);I(k,F,ae,"","\\Im",!0);I(k,F,ae,"","\\spadesuit",!0);I(k,F,ae,"","\\S",!0);I(ze,F,ae,"","\\S");I(k,F,ae,"","\\P",!0);I(ze,F,ae,"","\\P");I(k,F,ae,"","\\dag");I(ze,F,ae,"","\\dag");I(ze,F,ae,"","\\textdagger");I(k,F,ae,"","\\ddag");I(ze,F,ae,"","\\ddag");I(ze,F,ae,"","\\textdaggerdbl");I(k,F,ls,"","\\rmoustache",!0);I(k,F,fa,"","\\lmoustache",!0);I(k,F,ls,"","\\rgroup",!0);I(k,F,fa,"","\\lgroup",!0);I(k,F,xt,"","\\mp",!0);I(k,F,xt,"","\\ominus",!0);I(k,F,xt,"","\\uplus",!0);I(k,F,xt,"","\\sqcap",!0);I(k,F,xt,"","\\ast");I(k,F,xt,"","\\sqcup",!0);I(k,F,xt,"","\\bigcirc",!0);I(k,F,xt,"","\\bullet",!0);I(k,F,xt,"","\\ddagger");I(k,F,xt,"","\\wr",!0);I(k,F,xt,"","\\amalg");I(k,F,xt,"&","\\And");I(k,F,ne,"","\\longleftarrow",!0);I(k,F,ne,"","\\Leftarrow",!0);I(k,F,ne,"","\\Longleftarrow",!0);I(k,F,ne,"","\\longrightarrow",!0);I(k,F,ne,"","\\Rightarrow",!0);I(k,F,ne,"","\\Longrightarrow",!0);I(k,F,ne,"","\\leftrightarrow",!0);I(k,F,ne,"","\\longleftrightarrow",!0);I(k,F,ne,"","\\Leftrightarrow",!0);I(k,F,ne,"","\\Longleftrightarrow",!0);I(k,F,ne,"","\\mapsto",!0);I(k,F,ne,"","\\longmapsto",!0);I(k,F,ne,"","\\nearrow",!0);I(k,F,ne,"","\\hookleftarrow",!0);I(k,F,ne,"","\\hookrightarrow",!0);I(k,F,ne,"","\\searrow",!0);I(k,F,ne,"","\\leftharpoonup",!0);I(k,F,ne,"","\\rightharpoonup",!0);I(k,F,ne,"","\\swarrow",!0);I(k,F,ne,"","\\leftharpoondown",!0);I(k,F,ne,"","\\rightharpoondown",!0);I(k,F,ne,"","\\nwarrow",!0);I(k,F,ne,"","\\rightleftharpoons",!0);I(k,ee,ne,"","\\nless",!0);I(k,ee,ne,"","\\@nleqslant");I(k,ee,ne,"","\\@nleqq");I(k,ee,ne,"","\\lneq",!0);I(k,ee,ne,"","\\lneqq",!0);I(k,ee,ne,"","\\@lvertneqq");I(k,ee,ne,"","\\lnsim",!0);I(k,ee,ne,"","\\lnapprox",!0);I(k,ee,ne,"","\\nprec",!0);I(k,ee,ne,"","\\npreceq",!0);I(k,ee,ne,"","\\precnsim",!0);I(k,ee,ne,"","\\precnapprox",!0);I(k,ee,ne,"","\\nsim",!0);I(k,ee,ne,"","\\@nshortmid");I(k,ee,ne,"","\\nmid",!0);I(k,ee,ne,"","\\nvdash",!0);I(k,ee,ne,"","\\nvDash",!0);I(k,ee,ne,"","\\ntriangleleft");I(k,ee,ne,"","\\ntrianglelefteq",!0);I(k,ee,ne,"","\\subsetneq",!0);I(k,ee,ne,"","\\@varsubsetneq");I(k,ee,ne,"","\\subsetneqq",!0);I(k,ee,ne,"","\\@varsubsetneqq");I(k,ee,ne,"","\\ngtr",!0);I(k,ee,ne,"","\\@ngeqslant");I(k,ee,ne,"","\\@ngeqq");I(k,ee,ne,"","\\gneq",!0);I(k,ee,ne,"","\\gneqq",!0);I(k,ee,ne,"","\\@gvertneqq");I(k,ee,ne,"","\\gnsim",!0);I(k,ee,ne,"","\\gnapprox",!0);I(k,ee,ne,"","\\nsucc",!0);I(k,ee,ne,"","\\nsucceq",!0);I(k,ee,ne,"","\\succnsim",!0);I(k,ee,ne,"","\\succnapprox",!0);I(k,ee,ne,"","\\ncong",!0);I(k,ee,ne,"","\\@nshortparallel");I(k,ee,ne,"","\\nparallel",!0);I(k,ee,ne,"","\\nVDash",!0);I(k,ee,ne,"","\\ntriangleright");I(k,ee,ne,"","\\ntrianglerighteq",!0);I(k,ee,ne,"","\\@nsupseteqq");I(k,ee,ne,"","\\supsetneq",!0);I(k,ee,ne,"","\\@varsupsetneq");I(k,ee,ne,"","\\supsetneqq",!0);I(k,ee,ne,"","\\@varsupsetneqq");I(k,ee,ne,"","\\nVdash",!0);I(k,ee,ne,"","\\precneqq",!0);I(k,ee,ne,"","\\succneqq",!0);I(k,ee,ne,"","\\@nsubseteqq");I(k,ee,xt,"","\\unlhd");I(k,ee,xt,"","\\unrhd");I(k,ee,ne,"","\\nleftarrow",!0);I(k,ee,ne,"","\\nrightarrow",!0);I(k,ee,ne,"","\\nLeftarrow",!0);I(k,ee,ne,"","\\nRightarrow",!0);I(k,ee,ne,"","\\nleftrightarrow",!0);I(k,ee,ne,"","\\nLeftrightarrow",!0);I(k,ee,ne,"","\\vartriangle");I(k,ee,ae,"","\\hslash");I(k,ee,ae,"","\\triangledown");I(k,ee,ae,"","\\lozenge");I(k,ee,ae,"","\\circledS");I(k,ee,ae,"","\\circledR");I(ze,ee,ae,"","\\circledR");I(k,ee,ae,"","\\measuredangle",!0);I(k,ee,ae,"","\\nexists");I(k,ee,ae,"","\\mho");I(k,ee,ae,"","\\Finv",!0);I(k,ee,ae,"","\\Game",!0);I(k,ee,ae,"","\\backprime");I(k,ee,ae,"","\\blacktriangle");I(k,ee,ae,"","\\blacktriangledown");I(k,ee,ae,"","\\blacksquare");I(k,ee,ae,"","\\blacklozenge");I(k,ee,ae,"","\\bigstar");I(k,ee,ae,"","\\sphericalangle",!0);I(k,ee,ae,"","\\complement",!0);I(k,ee,ae,"","\\eth",!0);I(ze,F,ae,"","");I(k,ee,ae,"","\\diagup");I(k,ee,ae,"","\\diagdown");I(k,ee,ae,"","\\square");I(k,ee,ae,"","\\Box");I(k,ee,ae,"","\\Diamond");I(k,ee,ae,"","\\yen",!0);I(ze,ee,ae,"","\\yen",!0);I(k,ee,ae,"","\\checkmark",!0);I(ze,ee,ae,"","\\checkmark");I(k,ee,ae,"","\\beth",!0);I(k,ee,ae,"","\\daleth",!0);I(k,ee,ae,"","\\gimel",!0);I(k,ee,ae,"","\\digamma",!0);I(k,ee,ae,"","\\varkappa");I(k,ee,fa,"","\\@ulcorner",!0);I(k,ee,ls,"","\\@urcorner",!0);I(k,ee,fa,"","\\@llcorner",!0);I(k,ee,ls,"","\\@lrcorner",!0);I(k,ee,ne,"","\\leqq",!0);I(k,ee,ne,"","\\leqslant",!0);I(k,ee,ne,"","\\eqslantless",!0);I(k,ee,ne,"","\\lesssim",!0);I(k,ee,ne,"","\\lessapprox",!0);I(k,ee,ne,"","\\approxeq",!0);I(k,ee,xt,"","\\lessdot");I(k,ee,ne,"","\\lll",!0);I(k,ee,ne,"","\\lessgtr",!0);I(k,ee,ne,"","\\lesseqgtr",!0);I(k,ee,ne,"","\\lesseqqgtr",!0);I(k,ee,ne,"","\\doteqdot");I(k,ee,ne,"","\\risingdotseq",!0);I(k,ee,ne,"","\\fallingdotseq",!0);I(k,ee,ne,"","\\backsim",!0);I(k,ee,ne,"","\\backsimeq",!0);I(k,ee,ne,"","\\subseteqq",!0);I(k,ee,ne,"","\\Subset",!0);I(k,ee,ne,"","\\sqsubset",!0);I(k,ee,ne,"","\\preccurlyeq",!0);I(k,ee,ne,"","\\curlyeqprec",!0);I(k,ee,ne,"","\\precsim",!0);I(k,ee,ne,"","\\precapprox",!0);I(k,ee,ne,"","\\vartriangleleft");I(k,ee,ne,"","\\trianglelefteq");I(k,ee,ne,"","\\vDash",!0);I(k,ee,ne,"","\\Vvdash",!0);I(k,ee,ne,"","\\smallsmile");I(k,ee,ne,"","\\smallfrown");I(k,ee,ne,"","\\bumpeq",!0);I(k,ee,ne,"","\\Bumpeq",!0);I(k,ee,ne,"","\\geqq",!0);I(k,ee,ne,"","\\geqslant",!0);I(k,ee,ne,"","\\eqslantgtr",!0);I(k,ee,ne,"","\\gtrsim",!0);I(k,ee,ne,"","\\gtrapprox",!0);I(k,ee,xt,"","\\gtrdot");I(k,ee,ne,"","\\ggg",!0);I(k,ee,ne,"","\\gtrless",!0);I(k,ee,ne,"","\\gtreqless",!0);I(k,ee,ne,"","\\gtreqqless",!0);I(k,ee,ne,"","\\eqcirc",!0);I(k,ee,ne,"","\\circeq",!0);I(k,ee,ne,"","\\triangleq",!0);I(k,ee,ne,"","\\thicksim");I(k,ee,ne,"","\\thickapprox");I(k,ee,ne,"","\\supseteqq",!0);I(k,ee,ne,"","\\Supset",!0);I(k,ee,ne,"","\\sqsupset",!0);I(k,ee,ne,"","\\succcurlyeq",!0);I(k,ee,ne,"","\\curlyeqsucc",!0);I(k,ee,ne,"","\\succsim",!0);I(k,ee,ne,"","\\succapprox",!0);I(k,ee,ne,"","\\vartriangleright");I(k,ee,ne,"","\\trianglerighteq");I(k,ee,ne,"","\\Vdash",!0);I(k,ee,ne,"","\\shortmid");I(k,ee,ne,"","\\shortparallel");I(k,ee,ne,"","\\between",!0);I(k,ee,ne,"","\\pitchfork",!0);I(k,ee,ne,"","\\varpropto");I(k,ee,ne,"","\\blacktriangleleft");I(k,ee,ne,"","\\therefore",!0);I(k,ee,ne,"","\\backepsilon");I(k,ee,ne,"","\\blacktriangleright");I(k,ee,ne,"","\\because",!0);I(k,ee,ne,"","\\llless");I(k,ee,ne,"","\\gggtr");I(k,ee,xt,"","\\lhd");I(k,ee,xt,"","\\rhd");I(k,ee,ne,"","\\eqsim",!0);I(k,F,ne,"","\\Join");I(k,ee,ne,"","\\Doteq",!0);I(k,ee,xt,"","\\dotplus",!0);I(k,ee,xt,"","\\smallsetminus");I(k,ee,xt,"","\\Cap",!0);I(k,ee,xt,"","\\Cup",!0);I(k,ee,xt,"","\\doublebarwedge",!0);I(k,ee,xt,"","\\boxminus",!0);I(k,ee,xt,"","\\boxplus",!0);I(k,ee,xt,"","\\divideontimes",!0);I(k,ee,xt,"","\\ltimes",!0);I(k,ee,xt,"","\\rtimes",!0);I(k,ee,xt,"","\\leftthreetimes",!0);I(k,ee,xt,"","\\rightthreetimes",!0);I(k,ee,xt,"","\\curlywedge",!0);I(k,ee,xt,"","\\curlyvee",!0);I(k,ee,xt,"","\\circleddash",!0);I(k,ee,xt,"","\\circledast",!0);I(k,ee,xt,"","\\centerdot");I(k,ee,xt,"","\\intercal",!0);I(k,ee,xt,"","\\doublecap");I(k,ee,xt,"","\\doublecup");I(k,ee,xt,"","\\boxtimes",!0);I(k,ee,ne,"","\\dashrightarrow",!0);I(k,ee,ne,"","\\dashleftarrow",!0);I(k,ee,ne,"","\\leftleftarrows",!0);I(k,ee,ne,"","\\leftrightarrows",!0);I(k,ee,ne,"","\\Lleftarrow",!0);I(k,ee,ne,"","\\twoheadleftarrow",!0);I(k,ee,ne,"","\\leftarrowtail",!0);I(k,ee,ne,"","\\looparrowleft",!0);I(k,ee,ne,"","\\leftrightharpoons",!0);I(k,ee,ne,"","\\curvearrowleft",!0);I(k,ee,ne,"","\\circlearrowleft",!0);I(k,ee,ne,"","\\Lsh",!0);I(k,ee,ne,"","\\upuparrows",!0);I(k,ee,ne,"","\\upharpoonleft",!0);I(k,ee,ne,"","\\downharpoonleft",!0);I(k,F,ne,"","\\origof",!0);I(k,F,ne,"","\\imageof",!0);I(k,ee,ne,"","\\multimap",!0);I(k,ee,ne,"","\\leftrightsquigarrow",!0);I(k,ee,ne,"","\\rightrightarrows",!0);I(k,ee,ne,"","\\rightleftarrows",!0);I(k,ee,ne,"","\\twoheadrightarrow",!0);I(k,ee,ne,"","\\rightarrowtail",!0);I(k,ee,ne,"","\\looparrowright",!0);I(k,ee,ne,"","\\curvearrowright",!0);I(k,ee,ne,"","\\circlearrowright",!0);I(k,ee,ne,"","\\Rsh",!0);I(k,ee,ne,"","\\downdownarrows",!0);I(k,ee,ne,"","\\upharpoonright",!0);I(k,ee,ne,"","\\downharpoonright",!0);I(k,ee,ne,"","\\rightsquigarrow",!0);I(k,ee,ne,"","\\leadsto");I(k,ee,ne,"","\\Rrightarrow",!0);I(k,ee,ne,"","\\restriction");I(k,F,ae,"","`");I(k,F,ae,"$","\\$");I(ze,F,ae,"$","\\$");I(ze,F,ae,"$","\\textdollar");I(k,F,ae,"%","\\%");I(ze,F,ae,"%","\\%");I(k,F,ae,"_","\\_");I(ze,F,ae,"_","\\_");I(ze,F,ae,"_","\\textunderscore");I(k,F,ae,"","\\angle",!0);I(k,F,ae,"","\\infty",!0);I(k,F,ae,"","\\prime");I(k,F,ae,"","\\triangle");I(k,F,ae,"","\\Gamma",!0);I(k,F,ae,"","\\Delta",!0);I(k,F,ae,"","\\Theta",!0);I(k,F,ae,"","\\Lambda",!0);I(k,F,ae,"","\\Xi",!0);I(k,F,ae,"","\\Pi",!0);I(k,F,ae,"","\\Sigma",!0);I(k,F,ae,"","\\Upsilon",!0);I(k,F,ae,"","\\Phi",!0);I(k,F,ae,"","\\Psi",!0);I(k,F,ae,"","\\Omega",!0);I(k,F,ae,"A","");I(k,F,ae,"B","");I(k,F,ae,"E","");I(k,F,ae,"Z","");I(k,F,ae,"H","");I(k,F,ae,"I","");I(k,F,ae,"K","");I(k,F,ae,"M","");I(k,F,ae,"N","");I(k,F,ae,"O","");I(k,F,ae,"P","");I(k,F,ae,"T","");I(k,F,ae,"X","");I(k,F,ae,"","\\neg",!0);I(k,F,ae,"","\\lnot");I(k,F,ae,"","\\top");I(k,F,ae,"","\\bot");I(k,F,ae,"","\\emptyset");I(k,ee,ae,"","\\varnothing");I(k,F,Ot,"","\\alpha",!0);I(k,F,Ot,"","\\beta",!0);I(k,F,Ot,"","\\gamma",!0);I(k,F,Ot,"","\\delta",!0);I(k,F,Ot,"","\\epsilon",!0);I(k,F,Ot,"","\\zeta",!0);I(k,F,Ot,"","\\eta",!0);I(k,F,Ot,"","\\theta",!0);I(k,F,Ot,"","\\iota",!0);I(k,F,Ot,"","\\kappa",!0);I(k,F,Ot,"","\\lambda",!0);I(k,F,Ot,"","\\mu",!0);I(k,F,Ot,"","\\nu",!0);I(k,F,Ot,"","\\xi",!0);I(k,F,Ot,"","\\omicron",!0);I(k,F,Ot,"","\\pi",!0);I(k,F,Ot,"","\\rho",!0);I(k,F,Ot,"","\\sigma",!0);I(k,F,Ot,"","\\tau",!0);I(k,F,Ot,"","\\upsilon",!0);I(k,F,Ot,"","\\phi",!0);I(k,F,Ot,"","\\chi",!0);I(k,F,Ot,"","\\psi",!0);I(k,F,Ot,"","\\omega",!0);I(k,F,Ot,"","\\varepsilon",!0);I(k,F,Ot,"","\\vartheta",!0);I(k,F,Ot,"","\\varpi",!0);I(k,F,Ot,"","\\varrho",!0);I(k,F,Ot,"","\\varsigma",!0);I(k,F,Ot,"","\\varphi",!0);I(k,F,xt,"","*",!0);I(k,F,xt,"+","+");I(k,F,xt,"","-",!0);I(k,F,xt,"","\\cdot",!0);I(k,F,xt,"","\\circ",!0);I(k,F,xt,"","\\div",!0);I(k,F,xt,"","\\pm",!0);I(k,F,xt,"","\\times",!0);I(k,F,xt,"","\\cap",!0);I(k,F,xt,"","\\cup",!0);I(k,F,xt,"","\\setminus",!0);I(k,F,xt,"","\\land");I(k,F,xt,"","\\lor");I(k,F,xt,"","\\wedge",!0);I(k,F,xt,"","\\vee",!0);I(k,F,ae,"","\\surd");I(k,F,fa,"","\\langle",!0);I(k,F,fa,"","\\lvert");I(k,F,fa,"","\\lVert");I(k,F,ls,"?","?");I(k,F,ls,"!","!");I(k,F,ls,"","\\rangle",!0);I(k,F,ls,"","\\rvert");I(k,F,ls,"","\\rVert");I(k,F,ne,"=","=");I(k,F,ne,":",":");I(k,F,ne,"","\\approx",!0);I(k,F,ne,"","\\cong",!0);I(k,F,ne,"","\\ge");I(k,F,ne,"","\\geq",!0);I(k,F,ne,"","\\gets");I(k,F,ne,">","\\gt",!0);I(k,F,ne,"","\\in",!0);I(k,F,ne,"","\\@not");I(k,F,ne,"","\\subset",!0);I(k,F,ne,"","\\supset",!0);I(k,F,ne,"","\\subseteq",!0);I(k,F,ne,"","\\supseteq",!0);I(k,ee,ne,"","\\nsubseteq",!0);I(k,ee,ne,"","\\nsupseteq",!0);I(k,F,ne,"","\\models");I(k,F,ne,"","\\leftarrow",!0);I(k,F,ne,"","\\le");I(k,F,ne,"","\\leq",!0);I(k,F,ne,"<","\\lt",!0);I(k,F,ne,"","\\rightarrow",!0);I(k,F,ne,"","\\to");I(k,ee,ne,"","\\ngeq",!0);I(k,ee,ne,"","\\nleq",!0);I(k,F,_c,"","\\ ");I(k,F,_c,"","\\space");I(k,F,_c,"","\\nobreakspace");I(ze,F,_c,"","\\ ");I(ze,F,_c,""," ");I(ze,F,_c,"","\\space");I(ze,F,_c,"","\\nobreakspace");I(k,F,_c,null,"\\nobreak");I(k,F,_c,null,"\\allowbreak");I(k,F,l_,",",",");I(k,F,l_,";",";");I(k,ee,xt,"","\\barwedge",!0);I(k,ee,xt,"","\\veebar",!0);I(k,F,xt,"","\\odot",!0);I(k,F,xt,"","\\oplus",!0);I(k,F,xt,"","\\otimes",!0);I(k,F,ae,"","\\partial",!0);I(k,F,xt,"","\\oslash",!0);I(k,ee,xt,"","\\circledcirc",!0);I(k,ee,xt,"","\\boxdot",!0);I(k,F,xt,"","\\bigtriangleup");I(k,F,xt,"","\\bigtriangledown");I(k,F,xt,"","\\dagger");I(k,F,xt,"","\\diamond");I(k,F,xt,"","\\star");I(k,F,xt,"","\\triangleleft");I(k,F,xt,"","\\triangleright");I(k,F,fa,"{","\\{");I(ze,F,ae,"{","\\{");I(ze,F,ae,"{","\\textbraceleft");I(k,F,ls,"}","\\}");I(ze,F,ae,"}","\\}");I(ze,F,ae,"}","\\textbraceright");I(k,F,fa,"{","\\lbrace");I(k,F,ls,"}","\\rbrace");I(k,F,fa,"[","\\lbrack",!0);I(ze,F,ae,"[","\\lbrack",!0);I(k,F,ls,"]","\\rbrack",!0);I(ze,F,ae,"]","\\rbrack",!0);I(k,F,fa,"(","\\lparen",!0);I(k,F,ls,")","\\rparen",!0);I(ze,F,ae,"<","\\textless",!0);I(ze,F,ae,">","\\textgreater",!0);I(k,F,fa,"","\\lfloor",!0);I(k,F,ls,"","\\rfloor",!0);I(k,F,fa,"","\\lceil",!0);I(k,F,ls,"","\\rceil",!0);I(k,F,ae,"\\","\\backslash");I(k,F,ae,"","|");I(k,F,ae,"","\\vert");I(ze,F,ae,"|","\\textbar",!0);I(k,F,ae,"","\\|");I(k,F,ae,"","\\Vert");I(ze,F,ae,"","\\textbardbl");I(ze,F,ae,"~","\\textasciitilde");I(ze,F,ae,"\\","\\textbackslash");I(ze,F,ae,"^","\\textasciicircum");I(k,F,ne,"","\\uparrow",!0);I(k,F,ne,"","\\Uparrow",!0);I(k,F,ne,"","\\downarrow",!0);I(k,F,ne,"","\\Downarrow",!0);I(k,F,ne,"","\\updownarrow",!0);I(k,F,ne,"","\\Updownarrow",!0);I(k,F,Hi,"","\\coprod");I(k,F,Hi,"","\\bigvee");I(k,F,Hi,"","\\bigwedge");I(k,F,Hi,"","\\biguplus");I(k,F,Hi,"","\\bigcap");I(k,F,Hi,"","\\bigcup");I(k,F,Hi,"","\\int");I(k,F,Hi,"","\\intop");I(k,F,Hi,"","\\iint");I(k,F,Hi,"","\\iiint");I(k,F,Hi,"","\\prod");I(k,F,Hi,"","\\sum");I(k,F,Hi,"","\\bigotimes");I(k,F,Hi,"","\\bigoplus");I(k,F,Hi,"","\\bigodot");I(k,F,Hi,"","\\oint");I(k,F,Hi,"","\\oiint");I(k,F,Hi,"","\\oiiint");I(k,F,Hi,"","\\bigsqcup");I(k,F,Hi,"","\\smallint");I(ze,F,V0,"","\\textellipsis");I(k,F,V0,"","\\mathellipsis");I(ze,F,V0,"","\\ldots",!0);I(k,F,V0,"","\\ldots",!0);I(k,F,V0,"","\\@cdots",!0);I(k,F,V0,"","\\ddots",!0);I(k,F,ae,"","\\varvdots");I(ze,F,ae,"","\\varvdots");I(k,F,ai,"","\\acute");I(k,F,ai,"","\\grave");I(k,F,ai,"","\\ddot");I(k,F,ai,"~","\\tilde");I(k,F,ai,"","\\bar");I(k,F,ai,"","\\breve");I(k,F,ai,"","\\check");I(k,F,ai,"^","\\hat");I(k,F,ai,"","\\vec");I(k,F,ai,"","\\dot");I(k,F,ai,"","\\mathring");I(k,F,Ot,"","\\@imath");I(k,F,Ot,"","\\@jmath");I(k,F,ae,"","");I(k,F,ae,"","");I(ze,F,ae,"","\\i",!0);I(ze,F,ae,"","\\j",!0);I(ze,F,ae,"","\\ss",!0);I(ze,F,ae,"","\\ae",!0);I(ze,F,ae,"","\\oe",!0);I(ze,F,ae,"","\\o",!0);I(ze,F,ae,"","\\AE",!0);I(ze,F,ae,"","\\OE",!0);I(ze,F,ae,"","\\O",!0);I(ze,F,ai,"","\\'");I(ze,F,ai,"","\\`");I(ze,F,ai,"","\\^");I(ze,F,ai,"","\\~");I(ze,F,ai,"","\\=");I(ze,F,ai,"","\\u");I(ze,F,ai,"","\\.");I(ze,F,ai,"","\\c");I(ze,F,ai,"","\\r");I(ze,F,ai,"","\\v");I(ze,F,ai,"",'\\"');I(ze,F,ai,"","\\H");I(ze,F,ai,"","\\textcircled");var jG={"--":!0,"---":!0,"``":!0,"''":!0};I(ze,F,ae,"","--",!0);I(ze,F,ae,"","\\textendash");I(ze,F,ae,"","---",!0);I(ze,F,ae,"","\\textemdash");I(ze,F,ae,"","`",!0);I(ze,F,ae,"","\\textquoteleft");I(ze,F,ae,"","'",!0);I(ze,F,ae,"","\\textquoteright");I(ze,F,ae,"","``",!0);I(ze,F,ae,"","\\textquotedblleft");I(ze,F,ae,"","''",!0);I(ze,F,ae,"","\\textquotedblright");I(k,F,ae,"","\\degree",!0);I(ze,F,ae,"","\\degree");I(ze,F,ae,"","\\textdegree",!0);I(k,F,ae,"","\\pounds");I(k,F,ae,"","\\mathsterling",!0);I(ze,F,ae,"","\\pounds");I(ze,F,ae,"","\\textsterling",!0);I(k,ee,ae,"","\\maltese");I(ze,ee,ae,"","\\maltese");var VN='0123456789/@."';for(var sM=0;sM<VN.length;sM++){var GN=VN.charAt(sM);I(k,F,ae,GN,GN)}var WN='0123456789!@*()-=+";:?/.,';for(var aM=0;aM<WN.length;aM++){var qN=WN.charAt(aM);I(ze,F,ae,qN,qN)}var Tb="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(var oM=0;oM<Tb.length;oM++){var vy=Tb.charAt(oM);I(k,F,Ot,vy,vy),I(ze,F,ae,vy,vy)}I(k,ee,ae,"C","");I(ze,ee,ae,"C","");I(k,ee,ae,"H","");I(ze,ee,ae,"H","");I(k,ee,ae,"N","");I(ze,ee,ae,"N","");I(k,ee,ae,"P","");I(ze,ee,ae,"P","");I(k,ee,ae,"Q","");I(ze,ee,ae,"Q","");I(k,ee,ae,"R","");I(ze,ee,ae,"R","");I(k,ee,ae,"Z","");I(ze,ee,ae,"Z","");I(k,F,Ot,"h","");I(ze,F,Ot,"h","");var Ht="";for(var $r=0;$r<Tb.length;$r++){var _i=Tb.charAt($r);Ht=String.fromCharCode(55349,56320+$r),I(k,F,Ot,_i,Ht),I(ze,F,ae,_i,Ht),Ht=String.fromCharCode(55349,56372+$r),I(k,F,Ot,_i,Ht),I(ze,F,ae,_i,Ht),Ht=String.fromCharCode(55349,56424+$r),I(k,F,Ot,_i,Ht),I(ze,F,ae,_i,Ht),Ht=String.fromCharCode(55349,56580+$r),I(k,F,Ot,_i,Ht),I(ze,F,ae,_i,Ht),Ht=String.fromCharCode(55349,56684+$r),I(k,F,Ot,_i,Ht),I(ze,F,ae,_i,Ht),Ht=String.fromCharCode(55349,56736+$r),I(k,F,Ot,_i,Ht),I(ze,F,ae,_i,Ht),Ht=String.fromCharCode(55349,56788+$r),I(k,F,Ot,_i,Ht),I(ze,F,ae,_i,Ht),Ht=String.fromCharCode(55349,56840+$r),I(k,F,Ot,_i,Ht),I(ze,F,ae,_i,Ht),Ht=String.fromCharCode(55349,56944+$r),I(k,F,Ot,_i,Ht),I(ze,F,ae,_i,Ht),$r<26&&(Ht=String.fromCharCode(55349,56632+$r),I(k,F,Ot,_i,Ht),I(ze,F,ae,_i,Ht),Ht=String.fromCharCode(55349,56476+$r),I(k,F,Ot,_i,Ht),I(ze,F,ae,_i,Ht))}Ht="";I(k,F,Ot,"k",Ht);I(ze,F,ae,"k",Ht);for(var wh=0;wh<10;wh++){var $c=wh.toString();Ht=String.fromCharCode(55349,57294+wh),I(k,F,Ot,$c,Ht),I(ze,F,ae,$c,Ht),Ht=String.fromCharCode(55349,57314+wh),I(k,F,Ot,$c,Ht),I(ze,F,ae,$c,Ht),Ht=String.fromCharCode(55349,57324+wh),I(k,F,Ot,$c,Ht),I(ze,F,ae,$c,Ht),Ht=String.fromCharCode(55349,57334+wh),I(k,F,Ot,$c,Ht),I(ze,F,ae,$c,Ht)}var S6="";for(var lM=0;lM<S6.length;lM++){var by=S6.charAt(lM);I(k,F,Ot,by,by),I(ze,F,ae,by,by)}var _y=[["mathbf","textbf","Main-Bold"],["mathbf","textbf","Main-Bold"],["mathnormal","textit","Math-Italic"],["mathnormal","textit","Math-Italic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["mathscr","textscr","Script-Regular"],["","",""],["","",""],["","",""],["mathfrak","textfrak","Fraktur-Regular"],["mathfrak","textfrak","Fraktur-Regular"],["mathbb","textbb","AMS-Regular"],["mathbb","textbb","AMS-Regular"],["mathboldfrak","textboldfrak","Fraktur-Regular"],["mathboldfrak","textboldfrak","Fraktur-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathitsf","textitsf","SansSerif-Italic"],["mathitsf","textitsf","SansSerif-Italic"],["","",""],["","",""],["mathtt","texttt","Typewriter-Regular"],["mathtt","texttt","Typewriter-Regular"]],XN=[["mathbf","textbf","Main-Bold"],["","",""],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathtt","texttt","Typewriter-Regular"]],l3e=function(e,t){var n=e.charCodeAt(0),r=e.charCodeAt(1),s=(n-55296)*1024+(r-56320)+65536,a=t==="math"?0:1;if(119808<=s&&s<120484){var o=Math.floor((s-119808)/26);return[_y[o][2],_y[o][a]]}else if(120782<=s&&s<=120831){var l=Math.floor((s-120782)/10);return[XN[l][2],XN[l][a]]}else{if(s===120485||s===120486)return[_y[0][2],_y[0][a]];if(120486<s&&s<120782)return["",""];throw new Ye("Unsupported character: "+e)}},c_=function(e,t,n){return Yn[n][e]&&Yn[n][e].replace&&(e=Yn[n][e].replace),{value:e,metrics:EC(e,t,n)}},ro=function(e,t,n,r,s){var a=c_(e,t,n),o=a.metrics;e=a.value;var l;if(o){var c=o.italic;(n==="text"||r&&r.font==="mathit")&&(c=0),l=new Ua(e,o.height,o.depth,c,o.skew,o.width,s)}else typeof console<"u"&&console.warn("No character metrics "+("for '"+e+"' in style '"+t+"' and mode '"+n+"'")),l=new Ua(e,0,0,0,0,0,s);if(r){l.maxFontSize=r.sizeMultiplier,r.style.isTight()&&l.classes.push("mtight");var u=r.getColor();u&&(l.style.color=u)}return l},c3e=function(e,t,n,r){return r===void 0&&(r=[]),n.font==="boldsymbol"&&c_(e,"Main-Bold",t).metrics?ro(e,"Main-Bold",t,n,r.concat(["mathbf"])):e==="\\"||Yn[t][e].font==="main"?ro(e,"Main-Regular",t,n,r):ro(e,"AMS-Regular",t,n,r.concat(["amsrm"]))},u3e=function(e,t,n,r,s){return s!=="textord"&&c_(e,"Math-BoldItalic",t).metrics?{fontName:"Math-BoldItalic",fontClass:"boldsymbol"}:{fontName:"Main-Bold",fontClass:"mathbf"}},h3e=function(e,t,n){var r=e.mode,s=e.text,a=["mord"],o=r==="math"||r==="text"&&t.font,l=o?t.font:t.fontFamily,c="",u="";if(s.charCodeAt(0)===55349&&([c,u]=l3e(s,r)),c.length>0)return ro(s,c,r,t,a.concat(u));if(l){var d,p;if(l==="boldsymbol"){var m=u3e(s,r,t,a,n);d=m.fontName,p=[m.fontClass]}else o?(d=WG[l].fontName,p=[l]):(d=Sy(l,t.fontWeight,t.fontShape),p=[l,t.fontWeight,t.fontShape]);if(c_(s,d,r).metrics)return ro(s,d,r,t,a.concat(p));if(jG.hasOwnProperty(s)&&d.slice(0,10)==="Typewriter"){for(var g=[],y=0;y<s.length;y++)g.push(ro(s[y],d,r,t,a.concat(p)));return GG(g)}}if(n==="mathord")return ro(s,"Math-Italic",r,t,a.concat(["mathnormal"]));if(n==="textord"){var x=Yn[r][s]&&Yn[r][s].font;if(x==="ams"){var _=Sy("amsrm",t.fontWeight,t.fontShape);return ro(s,_,r,t,a.concat("amsrm",t.fontWeight,t.fontShape))}else if(x==="main"||!x){var S=Sy("textrm",t.fontWeight,t.fontShape);return ro(s,S,r,t,a.concat(t.fontWeight,t.fontShape))}else{var w=Sy(x,t.fontWeight,t.fontShape);return ro(s,w,r,t,a.concat(w,t.fontWeight,t.fontShape))}}else throw new Error("unexpected type: "+n+" in makeOrd")},d3e=(i,e)=>{if(wu(i.classes)!==wu(e.classes)||i.skew!==e.skew||i.maxFontSize!==e.maxFontSize)return!1;if(i.classes.length===1){var t=i.classes[0];if(t==="mbin"||t==="mord")return!1}for(var n in i.style)if(i.style.hasOwnProperty(n)&&i.style[n]!==e.style[n])return!1;for(var r in e.style)if(e.style.hasOwnProperty(r)&&i.style[r]!==e.style[r])return!1;return!0},f3e=i=>{for(var e=0;e<i.length-1;e++){var t=i[e],n=i[e+1];t instanceof Ua&&n instanceof Ua&&d3e(t,n)&&(t.text+=n.text,t.height=Math.max(t.height,n.height),t.depth=Math.max(t.depth,n.depth),t.italic=n.italic,i.splice(e+1,1),e--)}return i},PC=function(e){for(var t=0,n=0,r=0,s=0;s<e.children.length;s++){var a=e.children[s];a.height>t&&(t=a.height),a.depth>n&&(n=a.depth),a.maxFontSize>r&&(r=a.maxFontSize)}e.height=t,e.depth=n,e.maxFontSize=r},ms=function(e,t,n,r){var s=new cx(e,t,n,r);return PC(s),s},VG=(i,e,t,n)=>new cx(i,e,t,n),p3e=function(e,t,n){var r=ms([e],[],t);return r.height=Math.max(n||t.fontMetrics().defaultRuleThickness,t.minRuleThickness),r.style.borderBottomWidth=rt(r.height),r.maxFontSize=1,r},m3e=function(e,t,n,r){var s=new RC(e,t,n,r);return PC(s),s},GG=function(e){var t=new lx(e);return PC(t),t},g3e=function(e,t){return e instanceof lx?ms([],[e],t):e},x3e=function(e){if(e.positionType==="individualShift"){for(var t=e.children,n=[t[0]],r=-t[0].shift-t[0].elem.depth,s=r,a=1;a<t.length;a++){var o=-t[a].shift-s-t[a].elem.depth,l=o-(t[a-1].elem.height+t[a-1].elem.depth);s=s+o,n.push({type:"kern",size:l}),n.push(t[a])}return{children:n,depth:r}}var c;if(e.positionType==="top"){for(var u=e.positionData,d=0;d<e.children.length;d++){var p=e.children[d];u-=p.type==="kern"?p.size:p.elem.height+p.elem.depth}c=u}else if(e.positionType==="bottom")c=-e.positionData;else{var m=e.children[0];if(m.type!=="elem")throw new Error('First child must have type "elem".');if(e.positionType==="shift")c=-m.elem.depth-e.positionData;else if(e.positionType==="firstBaseline")c=-m.elem.depth;else throw new Error("Invalid positionType "+e.positionType+".")}return{children:e.children,depth:c}},y3e=function(e,t){for(var{children:n,depth:r}=x3e(e),s=0,a=0;a<n.length;a++){var o=n[a];if(o.type==="elem"){var l=o.elem;s=Math.max(s,l.maxFontSize,l.height)}}s+=2;var c=ms(["pstrut"],[]);c.style.height=rt(s);for(var u=[],d=r,p=r,m=r,g=0;g<n.length;g++){var y=n[g];if(y.type==="kern")m+=y.size;else{var x=y.elem,_=y.wrapperClasses||[],S=y.wrapperStyle||{},w=ms(_,[c,x],void 0,S);w.style.top=rt(-s-m-x.depth),y.marginLeft&&(w.style.marginLeft=y.marginLeft),y.marginRight&&(w.style.marginRight=y.marginRight),u.push(w),m+=x.height+x.depth}d=Math.min(d,m),p=Math.max(p,m)}var T=ms(["vlist"],u);T.style.height=rt(p);var C;if(d<0){var E=ms([],[]),D=ms(["vlist"],[E]);D.style.height=rt(-d);var O=ms(["vlist-s"],[new Ua("")]);C=[ms(["vlist-r"],[T,O]),ms(["vlist-r"],[D])]}else C=[ms(["vlist-r"],[T])];var R=ms(["vlist-t"],C);return C.length===2&&R.classes.push("vlist-t2"),R.height=p,R.depth=-d,R},v3e=(i,e)=>{var t=ms(["mspace"],[],e),n=hi(i,e);return t.style.marginRight=rt(n),t},Sy=function(e,t,n){var r="";switch(e){case"amsrm":r="AMS";break;case"textrm":r="Main";break;case"textsf":r="SansSerif";break;case"texttt":r="Typewriter";break;default:r=e}var s;return t==="textbf"&&n==="textit"?s="BoldItalic":t==="textbf"?s="Bold":t==="textit"?s="Italic":s="Regular",r+"-"+s},WG={mathbf:{variant:"bold",fontName:"Main-Bold"},mathrm:{variant:"normal",fontName:"Main-Regular"},textit:{variant:"italic",fontName:"Main-Italic"},mathit:{variant:"italic",fontName:"Main-Italic"},mathnormal:{variant:"italic",fontName:"Math-Italic"},mathsfit:{variant:"sans-serif-italic",fontName:"SansSerif-Italic"},mathbb:{variant:"double-struck",fontName:"AMS-Regular"},mathcal:{variant:"script",fontName:"Caligraphic-Regular"},mathfrak:{variant:"fraktur",fontName:"Fraktur-Regular"},mathscr:{variant:"script",fontName:"Script-Regular"},mathsf:{variant:"sans-serif",fontName:"SansSerif-Regular"},mathtt:{variant:"monospace",fontName:"Typewriter-Regular"}},qG={vec:["vec",.471,.714],oiintSize1:["oiintSize1",.957,.499],oiintSize2:["oiintSize2",1.472,.659],oiiintSize1:["oiiintSize1",1.304,.499],oiiintSize2:["oiiintSize2",1.98,.659]},b3e=function(e,t){var[n,r,s]=qG[e],a=new Mu(n),o=new mc([a],{width:rt(r),height:rt(s),style:"width:"+rt(r),viewBox:"0 0 "+1e3*r+" "+1e3*s,preserveAspectRatio:"xMinYMin"}),l=VG(["overlay"],[o],t);return l.height=s,l.style.height=rt(s),l.style.width=rt(r),l},de={fontMap:WG,makeSymbol:ro,mathsym:c3e,makeSpan:ms,makeSvgSpan:VG,makeLineSpan:p3e,makeAnchor:m3e,makeFragment:GG,wrapFragment:g3e,makeVList:y3e,makeOrd:h3e,makeGlue:v3e,staticSvg:b3e,svgData:qG,tryCombineChars:f3e},li={number:3,unit:"mu"},Mh={number:4,unit:"mu"},zl={number:5,unit:"mu"},_3e={mord:{mop:li,mbin:Mh,mrel:zl,minner:li},mop:{mord:li,mop:li,mrel:zl,minner:li},mbin:{mord:Mh,mop:Mh,mopen:Mh,minner:Mh},mrel:{mord:zl,mop:zl,mopen:zl,minner:zl},mopen:{},mclose:{mop:li,mbin:Mh,mrel:zl,minner:li},mpunct:{mord:li,mop:li,mrel:zl,mopen:li,mclose:li,mpunct:li,minner:li},minner:{mord:li,mop:li,mbin:Mh,mrel:zl,mopen:li,mpunct:li,minner:li}},S3e={mord:{mop:li},mop:{mord:li,mop:li},mbin:{},mrel:{},mopen:{},mclose:{mop:li},mpunct:{},minner:{mop:li}},XG={},Ab={},Cb={};function dt(i){for(var{type:e,names:t,props:n,handler:r,htmlBuilder:s,mathmlBuilder:a}=i,o={type:e,numArgs:n.numArgs,argTypes:n.argTypes,allowedInArgument:!!n.allowedInArgument,allowedInText:!!n.allowedInText,allowedInMath:n.allowedInMath===void 0?!0:n.allowedInMath,numOptionalArgs:n.numOptionalArgs||0,infix:!!n.infix,primitive:!!n.primitive,handler:r},l=0;l<t.length;++l)XG[t[l]]=o;e&&(s&&(Ab[e]=s),a&&(Cb[e]=a))}function bd(i){var{type:e,htmlBuilder:t,mathmlBuilder:n}=i;dt({type:e,names:[],props:{numArgs:0},handler(){throw new Error("Should never be called.")},htmlBuilder:t,mathmlBuilder:n})}var Eb=function(e){return e.type==="ordgroup"&&e.body.length===1?e.body[0]:e},Ii=function(e){return e.type==="ordgroup"?e.body:[e]},gc=de.makeSpan,w3e=["leftmost","mbin","mopen","mrel","mop","mpunct"],M3e=["rightmost","mrel","mclose","mpunct"],T3e={display:zt.DISPLAY,text:zt.TEXT,script:zt.SCRIPT,scriptscript:zt.SCRIPTSCRIPT},A3e={mord:"mord",mop:"mop",mbin:"mbin",mrel:"mrel",mopen:"mopen",mclose:"mclose",mpunct:"mpunct",minner:"minner"},Zi=function(e,t,n,r){r===void 0&&(r=[null,null]);for(var s=[],a=0;a<e.length;a++){var o=yn(e[a],t);if(o instanceof lx){var l=o.children;s.push(...l)}else s.push(o)}if(de.tryCombineChars(s),!n)return s;var c=t;if(e.length===1){var u=e[0];u.type==="sizing"?c=t.havingSize(u.size):u.type==="styling"&&(c=t.havingStyle(T3e[u.style]))}var d=gc([r[0]||"leftmost"],[],t),p=gc([r[1]||"rightmost"],[],t),m=n==="root";return YN(s,(g,y)=>{var x=y.classes[0],_=g.classes[0];x==="mbin"&&M3e.includes(_)?y.classes[0]="mord":_==="mbin"&&w3e.includes(x)&&(g.classes[0]="mord")},{node:d},p,m),YN(s,(g,y)=>{var x=w6(y),_=w6(g),S=x&&_?g.hasClass("mtight")?S3e[x][_]:_3e[x][_]:null;if(S)return de.makeGlue(S,c)},{node:d},p,m),s},YN=function i(e,t,n,r,s){r&&e.push(r);for(var a=0;a<e.length;a++){var o=e[a],l=YG(o);if(l){i(l.children,t,n,null,s);continue}var c=!o.hasClass("mspace");if(c){var u=t(o,n.node);u&&(n.insertAfter?n.insertAfter(u):(e.unshift(u),a++))}c?n.node=o:s&&o.hasClass("newline")&&(n.node=gc(["leftmost"])),n.insertAfter=(d=>p=>{e.splice(d+1,0,p),a++})(a)}r&&e.pop()},YG=function(e){return e instanceof lx||e instanceof RC||e instanceof cx&&e.hasClass("enclosing")?e:null},C3e=function i(e,t){var n=YG(e);if(n){var r=n.children;if(r.length){if(t==="right")return i(r[r.length-1],"right");if(t==="left")return i(r[0],"left")}}return e},w6=function(e,t){return e?(t&&(e=C3e(e,t)),A3e[e.classes[0]]||null):null},Pg=function(e,t){var n=["nulldelimiter"].concat(e.baseSizingClasses());return gc(t.concat(n))},yn=function(e,t,n){if(!e)return gc();if(Ab[e.type]){var r=Ab[e.type](e,t);if(n&&t.size!==n.size){r=gc(t.sizingClasses(n),[r],t);var s=t.sizeMultiplier/n.sizeMultiplier;r.height*=s,r.depth*=s}return r}else throw new Ye("Got group of unknown type: '"+e.type+"'")};function wy(i,e){var t=gc(["base"],i,e),n=gc(["strut"]);return n.style.height=rt(t.height+t.depth),t.depth&&(n.style.verticalAlign=rt(-t.depth)),t.children.unshift(n),t}function M6(i,e){var t=null;i.length===1&&i[0].type==="tag"&&(t=i[0].tag,i=i[0].body);var n=Zi(i,e,"root"),r;n.length===2&&n[1].hasClass("tag")&&(r=n.pop());for(var s=[],a=[],o=0;o<n.length;o++)if(a.push(n[o]),n[o].hasClass("mbin")||n[o].hasClass("mrel")||n[o].hasClass("allowbreak")){for(var l=!1;o<n.length-1&&n[o+1].hasClass("mspace")&&!n[o+1].hasClass("newline");)o++,a.push(n[o]),n[o].hasClass("nobreak")&&(l=!0);l||(s.push(wy(a,e)),a=[])}else n[o].hasClass("newline")&&(a.pop(),a.length>0&&(s.push(wy(a,e)),a=[]),s.push(n[o]));a.length>0&&s.push(wy(a,e));var c;t?(c=wy(Zi(t,e,!0)),c.classes=["tag"],s.push(c)):r&&s.push(r);var u=gc(["katex-html"],s);if(u.setAttribute("aria-hidden","true"),c){var d=c.children[0];d.style.height=rt(u.height+u.depth),u.depth&&(d.style.verticalAlign=rt(-u.depth))}return u}function $G(i){return new lx(i)}class Zs{constructor(e,t,n){this.type=void 0,this.attributes=void 0,this.children=void 0,this.classes=void 0,this.type=e,this.attributes={},this.children=t||[],this.classes=n||[]}setAttribute(e,t){this.attributes[e]=t}getAttribute(e){return this.attributes[e]}toNode(){var e=document.createElementNS("http://www.w3.org/1998/Math/MathML",this.type);for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&e.setAttribute(t,this.attributes[t]);this.classes.length>0&&(e.className=wu(this.classes));for(var n=0;n<this.children.length;n++)if(this.children[n]instanceof Wo&&this.children[n+1]instanceof Wo){for(var r=this.children[n].toText()+this.children[++n].toText();this.children[n+1]instanceof Wo;)r+=this.children[++n].toText();e.appendChild(new Wo(r).toNode())}else e.appendChild(this.children[n].toNode());return e}toMarkup(){var e="<"+this.type;for(var t in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,t)&&(e+=" "+t+'="',e+=wn.escape(this.attributes[t]),e+='"');this.classes.length>0&&(e+=' class ="'+wn.escape(wu(this.classes))+'"'),e+=">";for(var n=0;n<this.children.length;n++)e+=this.children[n].toMarkup();return e+="</"+this.type+">",e}toText(){return this.children.map(e=>e.toText()).join("")}}class Wo{constructor(e){this.text=void 0,this.text=e}toNode(){return document.createTextNode(this.text)}toMarkup(){return wn.escape(this.toText())}toText(){return this.text}}class E3e{constructor(e){this.width=void 0,this.character=void 0,this.width=e,e>=.05555&&e<=.05556?this.character="":e>=.1666&&e<=.1667?this.character="":e>=.2222&&e<=.2223?this.character="":e>=.2777&&e<=.2778?this.character="":e>=-.05556&&e<=-.05555?this.character="":e>=-.1667&&e<=-.1666?this.character="":e>=-.2223&&e<=-.2222?this.character="":e>=-.2778&&e<=-.2777?this.character="":this.character=null}toNode(){if(this.character)return document.createTextNode(this.character);var e=document.createElementNS("http://www.w3.org/1998/Math/MathML","mspace");return e.setAttribute("width",rt(this.width)),e}toMarkup(){return this.character?"<mtext>"+this.character+"</mtext>":'<mspace width="'+rt(this.width)+'"/>'}toText(){return this.character?this.character:" "}}var Ve={MathNode:Zs,TextNode:Wo,SpaceNode:E3e,newDocumentFragment:$G},Fa=function(e,t,n){return Yn[t][e]&&Yn[t][e].replace&&e.charCodeAt(0)!==55349&&!(jG.hasOwnProperty(e)&&n&&(n.fontFamily&&n.fontFamily.slice(4,6)==="tt"||n.font&&n.font.slice(4,6)==="tt"))&&(e=Yn[t][e].replace),new Ve.TextNode(e)},IC=function(e){return e.length===1?e[0]:new Ve.MathNode("mrow",e)},DC=function(e,t){if(t.fontFamily==="texttt")return"monospace";if(t.fontFamily==="textsf")return t.fontShape==="textit"&&t.fontWeight==="textbf"?"sans-serif-bold-italic":t.fontShape==="textit"?"sans-serif-italic":t.fontWeight==="textbf"?"bold-sans-serif":"sans-serif";if(t.fontShape==="textit"&&t.fontWeight==="textbf")return"bold-italic";if(t.fontShape==="textit")return"italic";if(t.fontWeight==="textbf")return"bold";var n=t.font;if(!n||n==="mathnormal")return null;var r=e.mode;if(n==="mathit")return"italic";if(n==="boldsymbol")return e.type==="textord"?"bold":"bold-italic";if(n==="mathbf")return"bold";if(n==="mathbb")return"double-struck";if(n==="mathsfit")return"sans-serif-italic";if(n==="mathfrak")return"fraktur";if(n==="mathscr"||n==="mathcal")return"script";if(n==="mathsf")return"sans-serif";if(n==="mathtt")return"monospace";var s=e.text;if(["\\imath","\\jmath"].includes(s))return null;Yn[r][s]&&Yn[r][s].replace&&(s=Yn[r][s].replace);var a=de.fontMap[n].fontName;return EC(s,a,r)?de.fontMap[n].variant:null};function cM(i){if(!i)return!1;if(i.type==="mi"&&i.children.length===1){var e=i.children[0];return e instanceof Wo&&e.text==="."}else if(i.type==="mo"&&i.children.length===1&&i.getAttribute("separator")==="true"&&i.getAttribute("lspace")==="0em"&&i.getAttribute("rspace")==="0em"){var t=i.children[0];return t instanceof Wo&&t.text===","}else return!1}var Ls=function(e,t,n){if(e.length===1){var r=jn(e[0],t);return n&&r instanceof Zs&&r.type==="mo"&&(r.setAttribute("lspace","0em"),r.setAttribute("rspace","0em")),[r]}for(var s=[],a,o=0;o<e.length;o++){var l=jn(e[o],t);if(l instanceof Zs&&a instanceof Zs){if(l.type==="mtext"&&a.type==="mtext"&&l.getAttribute("mathvariant")===a.getAttribute("mathvariant")){a.children.push(...l.children);continue}else if(l.type==="mn"&&a.type==="mn"){a.children.push(...l.children);continue}else if(cM(l)&&a.type==="mn"){a.children.push(...l.children);continue}else if(l.type==="mn"&&cM(a))l.children=[...a.children,...l.children],s.pop();else if((l.type==="msup"||l.type==="msub")&&l.children.length>=1&&(a.type==="mn"||cM(a))){var c=l.children[0];c instanceof Zs&&c.type==="mn"&&(c.children=[...a.children,...c.children],s.pop())}else if(a.type==="mi"&&a.children.length===1){var u=a.children[0];if(u instanceof Wo&&u.text===""&&(l.type==="mo"||l.type==="mi"||l.type==="mn")){var d=l.children[0];d instanceof Wo&&d.text.length>0&&(d.text=d.text.slice(0,1)+""+d.text.slice(1),s.pop())}}}s.push(l),a=l}return s},Tu=function(e,t,n){return IC(Ls(e,t,n))},jn=function(e,t){if(!e)return new Ve.MathNode("mrow");if(Cb[e.type]){var n=Cb[e.type](e,t);return n}else throw new Ye("Got group of unknown type: '"+e.type+"'")};function $N(i,e,t,n,r){var s=Ls(i,t),a;s.length===1&&s[0]instanceof Zs&&["mrow","mtable"].includes(s[0].type)?a=s[0]:a=new Ve.MathNode("mrow",s);var o=new Ve.MathNode("annotation",[new Ve.TextNode(e)]);o.setAttribute("encoding","application/x-tex");var l=new Ve.MathNode("semantics",[a,o]),c=new Ve.MathNode("math",[l]);c.setAttribute("xmlns","http://www.w3.org/1998/Math/MathML"),n&&c.setAttribute("display","block");var u=r?"katex":"katex-mathml";return de.makeSpan([u],[c])}var KG=function(e){return new ql({style:e.displayMode?zt.DISPLAY:zt.TEXT,maxSize:e.maxSize,minRuleThickness:e.minRuleThickness})},ZG=function(e,t){if(t.displayMode){var n=["katex-display"];t.leqno&&n.push("leqno"),t.fleqn&&n.push("fleqn"),e=de.makeSpan(n,[e])}return e},R3e=function(e,t,n){var r=KG(n),s;if(n.output==="mathml")return $N(e,t,r,n.displayMode,!0);if(n.output==="html"){var a=M6(e,r);s=de.makeSpan(["katex"],[a])}else{var o=$N(e,t,r,n.displayMode,!1),l=M6(e,r);s=de.makeSpan(["katex"],[o,l])}return ZG(s,n)},P3e=function(e,t,n){var r=KG(n),s=M6(e,r),a=de.makeSpan(["katex"],[s]);return ZG(a,n)},I3e={widehat:"^",widecheck:"",widetilde:"~",utilde:"~",overleftarrow:"",underleftarrow:"",xleftarrow:"",overrightarrow:"",underrightarrow:"",xrightarrow:"",underbrace:"",overbrace:"",overgroup:"",undergroup:"",overleftrightarrow:"",underleftrightarrow:"",xleftrightarrow:"",Overrightarrow:"",xRightarrow:"",overleftharpoon:"",xleftharpoonup:"",overrightharpoon:"",xrightharpoonup:"",xLeftarrow:"",xLeftrightarrow:"",xhookleftarrow:"",xhookrightarrow:"",xmapsto:"",xrightharpoondown:"",xleftharpoondown:"",xrightleftharpoons:"",xleftrightharpoons:"",xtwoheadleftarrow:"",xtwoheadrightarrow:"",xlongequal:"=",xtofrom:"",xrightleftarrows:"",xrightequilibrium:"",xleftequilibrium:"","\\cdrightarrow":"","\\cdleftarrow":"","\\cdlongequal":"="},D3e=function(e){var t=new Ve.MathNode("mo",[new Ve.TextNode(I3e[e.replace(/^\\/,"")])]);return t.setAttribute("stretchy","true"),t},N3e={overrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],overleftarrow:[["leftarrow"],.888,522,"xMinYMin"],underrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],underleftarrow:[["leftarrow"],.888,522,"xMinYMin"],xrightarrow:[["rightarrow"],1.469,522,"xMaxYMin"],"\\cdrightarrow":[["rightarrow"],3,522,"xMaxYMin"],xleftarrow:[["leftarrow"],1.469,522,"xMinYMin"],"\\cdleftarrow":[["leftarrow"],3,522,"xMinYMin"],Overrightarrow:[["doublerightarrow"],.888,560,"xMaxYMin"],xRightarrow:[["doublerightarrow"],1.526,560,"xMaxYMin"],xLeftarrow:[["doubleleftarrow"],1.526,560,"xMinYMin"],overleftharpoon:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoonup:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoondown:[["leftharpoondown"],.888,522,"xMinYMin"],overrightharpoon:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoonup:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoondown:[["rightharpoondown"],.888,522,"xMaxYMin"],xlongequal:[["longequal"],.888,334,"xMinYMin"],"\\cdlongequal":[["longequal"],3,334,"xMinYMin"],xtwoheadleftarrow:[["twoheadleftarrow"],.888,334,"xMinYMin"],xtwoheadrightarrow:[["twoheadrightarrow"],.888,334,"xMaxYMin"],overleftrightarrow:[["leftarrow","rightarrow"],.888,522],overbrace:[["leftbrace","midbrace","rightbrace"],1.6,548],underbrace:[["leftbraceunder","midbraceunder","rightbraceunder"],1.6,548],underleftrightarrow:[["leftarrow","rightarrow"],.888,522],xleftrightarrow:[["leftarrow","rightarrow"],1.75,522],xLeftrightarrow:[["doubleleftarrow","doublerightarrow"],1.75,560],xrightleftharpoons:[["leftharpoondownplus","rightharpoonplus"],1.75,716],xleftrightharpoons:[["leftharpoonplus","rightharpoondownplus"],1.75,716],xhookleftarrow:[["leftarrow","righthook"],1.08,522],xhookrightarrow:[["lefthook","rightarrow"],1.08,522],overlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],underlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],overgroup:[["leftgroup","rightgroup"],.888,342],undergroup:[["leftgroupunder","rightgroupunder"],.888,342],xmapsto:[["leftmapsto","rightarrow"],1.5,522],xtofrom:[["leftToFrom","rightToFrom"],1.75,528],xrightleftarrows:[["baraboveleftarrow","rightarrowabovebar"],1.75,901],xrightequilibrium:[["baraboveshortleftharpoon","rightharpoonaboveshortbar"],1.75,716],xleftequilibrium:[["shortbaraboveleftharpoon","shortrightharpoonabovebar"],1.75,716]},L3e=function(e){return e.type==="ordgroup"?e.body.length:1},k3e=function(e,t){function n(){var o=4e5,l=e.label.slice(1);if(["widehat","widecheck","widetilde","utilde"].includes(l)){var c=e,u=L3e(c.base),d,p,m;if(u>5)l==="widehat"||l==="widecheck"?(d=420,o=2364,m=.42,p=l+"4"):(d=312,o=2340,m=.34,p="tilde4");else{var g=[1,1,2,2,3,3][u];l==="widehat"||l==="widecheck"?(o=[0,1062,2364,2364,2364][g],d=[0,239,300,360,420][g],m=[0,.24,.3,.3,.36,.42][g],p=l+g):(o=[0,600,1033,2339,2340][g],d=[0,260,286,306,312][g],m=[0,.26,.286,.3,.306,.34][g],p="tilde"+g)}var y=new Mu(p),x=new mc([y],{width:"100%",height:rt(m),viewBox:"0 0 "+o+" "+d,preserveAspectRatio:"none"});return{span:de.makeSvgSpan([],[x],t),minWidth:0,height:m}}else{var _=[],S=N3e[l],[w,T,C]=S,E=C/1e3,D=w.length,O,R;if(D===1){var P=S[3];O=["hide-tail"],R=[P]}else if(D===2)O=["halfarrow-left","halfarrow-right"],R=["xMinYMin","xMaxYMin"];else if(D===3)O=["brace-left","brace-center","brace-right"],R=["xMinYMin","xMidYMin","xMaxYMin"];else throw new Error(`Correct katexImagesData or update code here to support
                    `+D+" children.");for(var L=0;L<D;L++){var V=new Mu(w[L]),j=new mc([V],{width:"400em",height:rt(E),viewBox:"0 0 "+o+" "+C,preserveAspectRatio:R[L]+" slice"}),B=de.makeSvgSpan([O[L]],[j],t);if(D===1)return{span:B,minWidth:T,height:E};B.style.height=rt(E),_.push(B)}return{span:de.makeSpan(["stretchy"],_,t),minWidth:T,height:E}}}var{span:r,minWidth:s,height:a}=n();return r.height=a,r.style.height=rt(a),s>0&&(r.style.minWidth=rt(s)),r},O3e=function(e,t,n,r,s){var a,o=e.height+e.depth+n+r;if(/fbox|color|angl/.test(t)){if(a=de.makeSpan(["stretchy",t],[],s),t==="fbox"){var l=s.color&&s.getColor();l&&(a.style.borderColor=l)}}else{var c=[];/^[bx]cancel$/.test(t)&&c.push(new _6({x1:"0",y1:"0",x2:"100%",y2:"100%","stroke-width":"0.046em"})),/^x?cancel$/.test(t)&&c.push(new _6({x1:"0",y1:"100%",x2:"100%",y2:"0","stroke-width":"0.046em"}));var u=new mc(c,{width:"100%",height:rt(o)});a=de.makeSvgSpan([],[u],s)}return a.height=o,a.style.height=rt(o),a},xc={encloseSpan:O3e,mathMLnode:D3e,svgSpan:k3e};function Jt(i,e){if(!i||i.type!==e)throw new Error("Expected node of type "+e+", but got "+(i?"node of type "+i.type:String(i)));return i}function NC(i){var e=u_(i);if(!e)throw new Error("Expected node of symbol group type, but got "+(i?"node of type "+i.type:String(i)));return e}function u_(i){return i&&(i.type==="atom"||o3e.hasOwnProperty(i.type))?i:null}var LC=(i,e)=>{var t,n,r;i&&i.type==="supsub"?(n=Jt(i.base,"accent"),t=n.base,i.base=t,r=s3e(yn(i,e)),i.base=n):(n=Jt(i,"accent"),t=n.base);var s=yn(t,e.havingCrampedStyle()),a=n.isShifty&&wn.isCharacterBox(t),o=0;if(a){var l=wn.getBaseElem(t),c=yn(l,e.havingCrampedStyle());o=jN(c).skew}var u=n.label==="\\c",d=u?s.height+s.depth:Math.min(s.height,e.fontMetrics().xHeight),p;if(n.isStretchy)p=xc.svgSpan(n,e),p=de.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:s},{type:"elem",elem:p,wrapperClasses:["svg-align"],wrapperStyle:o>0?{width:"calc(100% - "+rt(2*o)+")",marginLeft:rt(2*o)}:void 0}]},e);else{var m,g;n.label==="\\vec"?(m=de.staticSvg("vec",e),g=de.svgData.vec[1]):(m=de.makeOrd({mode:n.mode,text:n.label},e,"textord"),m=jN(m),m.italic=0,g=m.width,u&&(d+=m.depth)),p=de.makeSpan(["accent-body"],[m]);var y=n.label==="\\textcircled";y&&(p.classes.push("accent-full"),d=s.height);var x=o;y||(x-=g/2),p.style.left=rt(x),n.label==="\\textcircled"&&(p.style.top=".2em"),p=de.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:s},{type:"kern",size:-d},{type:"elem",elem:p}]},e)}var _=de.makeSpan(["mord","accent"],[p],e);return r?(r.children[0]=_,r.height=Math.max(_.height,r.height),r.classes[0]="mord",r):_},QG=(i,e)=>{var t=i.isStretchy?xc.mathMLnode(i.label):new Ve.MathNode("mo",[Fa(i.label,i.mode)]),n=new Ve.MathNode("mover",[jn(i.base,e),t]);return n.setAttribute("accent","true"),n},z3e=new RegExp(["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring"].map(i=>"\\"+i).join("|"));dt({type:"accent",names:["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring","\\widecheck","\\widehat","\\widetilde","\\overrightarrow","\\overleftarrow","\\Overrightarrow","\\overleftrightarrow","\\overgroup","\\overlinesegment","\\overleftharpoon","\\overrightharpoon"],props:{numArgs:1},handler:(i,e)=>{var t=Eb(e[0]),n=!z3e.test(i.funcName),r=!n||i.funcName==="\\widehat"||i.funcName==="\\widetilde"||i.funcName==="\\widecheck";return{type:"accent",mode:i.parser.mode,label:i.funcName,isStretchy:n,isShifty:r,base:t}},htmlBuilder:LC,mathmlBuilder:QG});dt({type:"accent",names:["\\'","\\`","\\^","\\~","\\=","\\u","\\.",'\\"',"\\c","\\r","\\H","\\v","\\textcircled"],props:{numArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["primitive"]},handler:(i,e)=>{var t=e[0],n=i.parser.mode;return n==="math"&&(i.parser.settings.reportNonstrict("mathVsTextAccents","LaTeX's accent "+i.funcName+" works only in text mode"),n="text"),{type:"accent",mode:n,label:i.funcName,isStretchy:!1,isShifty:!0,base:t}},htmlBuilder:LC,mathmlBuilder:QG});dt({type:"accentUnder",names:["\\underleftarrow","\\underrightarrow","\\underleftrightarrow","\\undergroup","\\underlinesegment","\\utilde"],props:{numArgs:1},handler:(i,e)=>{var{parser:t,funcName:n}=i,r=e[0];return{type:"accentUnder",mode:t.mode,label:n,base:r}},htmlBuilder:(i,e)=>{var t=yn(i.base,e),n=xc.svgSpan(i,e),r=i.label==="\\utilde"?.12:0,s=de.makeVList({positionType:"top",positionData:t.height,children:[{type:"elem",elem:n,wrapperClasses:["svg-align"]},{type:"kern",size:r},{type:"elem",elem:t}]},e);return de.makeSpan(["mord","accentunder"],[s],e)},mathmlBuilder:(i,e)=>{var t=xc.mathMLnode(i.label),n=new Ve.MathNode("munder",[jn(i.base,e),t]);return n.setAttribute("accentunder","true"),n}});var My=i=>{var e=new Ve.MathNode("mpadded",i?[i]:[]);return e.setAttribute("width","+0.6em"),e.setAttribute("lspace","0.3em"),e};dt({type:"xArrow",names:["\\xleftarrow","\\xrightarrow","\\xLeftarrow","\\xRightarrow","\\xleftrightarrow","\\xLeftrightarrow","\\xhookleftarrow","\\xhookrightarrow","\\xmapsto","\\xrightharpoondown","\\xrightharpoonup","\\xleftharpoondown","\\xleftharpoonup","\\xrightleftharpoons","\\xleftrightharpoons","\\xlongequal","\\xtwoheadrightarrow","\\xtwoheadleftarrow","\\xtofrom","\\xrightleftarrows","\\xrightequilibrium","\\xleftequilibrium","\\\\cdrightarrow","\\\\cdleftarrow","\\\\cdlongequal"],props:{numArgs:1,numOptionalArgs:1},handler(i,e,t){var{parser:n,funcName:r}=i;return{type:"xArrow",mode:n.mode,label:r,body:e[0],below:t[0]}},htmlBuilder(i,e){var t=e.style,n=e.havingStyle(t.sup()),r=de.wrapFragment(yn(i.body,n,e),e),s=i.label.slice(0,2)==="\\x"?"x":"cd";r.classes.push(s+"-arrow-pad");var a;i.below&&(n=e.havingStyle(t.sub()),a=de.wrapFragment(yn(i.below,n,e),e),a.classes.push(s+"-arrow-pad"));var o=xc.svgSpan(i,e),l=-e.fontMetrics().axisHeight+.5*o.height,c=-e.fontMetrics().axisHeight-.5*o.height-.111;(r.depth>.25||i.label==="\\xleftequilibrium")&&(c-=r.depth);var u;if(a){var d=-e.fontMetrics().axisHeight+a.height+.5*o.height+.111;u=de.makeVList({positionType:"individualShift",children:[{type:"elem",elem:r,shift:c},{type:"elem",elem:o,shift:l},{type:"elem",elem:a,shift:d}]},e)}else u=de.makeVList({positionType:"individualShift",children:[{type:"elem",elem:r,shift:c},{type:"elem",elem:o,shift:l}]},e);return u.children[0].children[0].children[1].classes.push("svg-align"),de.makeSpan(["mrel","x-arrow"],[u],e)},mathmlBuilder(i,e){var t=xc.mathMLnode(i.label);t.setAttribute("minsize",i.label.charAt(0)==="x"?"1.75em":"3.0em");var n;if(i.body){var r=My(jn(i.body,e));if(i.below){var s=My(jn(i.below,e));n=new Ve.MathNode("munderover",[t,s,r])}else n=new Ve.MathNode("mover",[t,r])}else if(i.below){var a=My(jn(i.below,e));n=new Ve.MathNode("munder",[t,a])}else n=My(),n=new Ve.MathNode("mover",[t,n]);return n}});var U3e=de.makeSpan;function JG(i,e){var t=Zi(i.body,e,!0);return U3e([i.mclass],t,e)}function eW(i,e){var t,n=Ls(i.body,e);return i.mclass==="minner"?t=new Ve.MathNode("mpadded",n):i.mclass==="mord"?i.isCharacterBox?(t=n[0],t.type="mi"):t=new Ve.MathNode("mi",n):(i.isCharacterBox?(t=n[0],t.type="mo"):t=new Ve.MathNode("mo",n),i.mclass==="mbin"?(t.attributes.lspace="0.22em",t.attributes.rspace="0.22em"):i.mclass==="mpunct"?(t.attributes.lspace="0em",t.attributes.rspace="0.17em"):i.mclass==="mopen"||i.mclass==="mclose"?(t.attributes.lspace="0em",t.attributes.rspace="0em"):i.mclass==="minner"&&(t.attributes.lspace="0.0556em",t.attributes.width="+0.1111em")),t}dt({type:"mclass",names:["\\mathord","\\mathbin","\\mathrel","\\mathopen","\\mathclose","\\mathpunct","\\mathinner"],props:{numArgs:1,primitive:!0},handler(i,e){var{parser:t,funcName:n}=i,r=e[0];return{type:"mclass",mode:t.mode,mclass:"m"+n.slice(5),body:Ii(r),isCharacterBox:wn.isCharacterBox(r)}},htmlBuilder:JG,mathmlBuilder:eW});var h_=i=>{var e=i.type==="ordgroup"&&i.body.length?i.body[0]:i;return e.type==="atom"&&(e.family==="bin"||e.family==="rel")?"m"+e.family:"mord"};dt({type:"mclass",names:["\\@binrel"],props:{numArgs:2},handler(i,e){var{parser:t}=i;return{type:"mclass",mode:t.mode,mclass:h_(e[0]),body:Ii(e[1]),isCharacterBox:wn.isCharacterBox(e[1])}}});dt({type:"mclass",names:["\\stackrel","\\overset","\\underset"],props:{numArgs:2},handler(i,e){var{parser:t,funcName:n}=i,r=e[1],s=e[0],a;n!=="\\stackrel"?a=h_(r):a="mrel";var o={type:"op",mode:r.mode,limits:!0,alwaysHandleSupSub:!0,parentIsSupSub:!1,symbol:!1,suppressBaseShift:n!=="\\stackrel",body:Ii(r)},l={type:"supsub",mode:s.mode,base:o,sup:n==="\\underset"?null:s,sub:n==="\\underset"?s:null};return{type:"mclass",mode:t.mode,mclass:a,body:[l],isCharacterBox:wn.isCharacterBox(l)}},htmlBuilder:JG,mathmlBuilder:eW});dt({type:"pmb",names:["\\pmb"],props:{numArgs:1,allowedInText:!0},handler(i,e){var{parser:t}=i;return{type:"pmb",mode:t.mode,mclass:h_(e[0]),body:Ii(e[0])}},htmlBuilder(i,e){var t=Zi(i.body,e,!0),n=de.makeSpan([i.mclass],t,e);return n.style.textShadow="0.02em 0.01em 0.04px",n},mathmlBuilder(i,e){var t=Ls(i.body,e),n=new Ve.MathNode("mstyle",t);return n.setAttribute("style","text-shadow: 0.02em 0.01em 0.04px"),n}});var F3e={">":"\\\\cdrightarrow","<":"\\\\cdleftarrow","=":"\\\\cdlongequal",A:"\\uparrow",V:"\\downarrow","|":"\\Vert",".":"no arrow"},KN=()=>({type:"styling",body:[],mode:"math",style:"display"}),ZN=i=>i.type==="textord"&&i.text==="@",B3e=(i,e)=>(i.type==="mathord"||i.type==="atom")&&i.text===e;function H3e(i,e,t){var n=F3e[i];switch(n){case"\\\\cdrightarrow":case"\\\\cdleftarrow":return t.callFunction(n,[e[0]],[e[1]]);case"\\uparrow":case"\\downarrow":{var r=t.callFunction("\\\\cdleft",[e[0]],[]),s={type:"atom",text:n,mode:"math",family:"rel"},a=t.callFunction("\\Big",[s],[]),o=t.callFunction("\\\\cdright",[e[1]],[]),l={type:"ordgroup",mode:"math",body:[r,a,o]};return t.callFunction("\\\\cdparent",[l],[])}case"\\\\cdlongequal":return t.callFunction("\\\\cdlongequal",[],[]);case"\\Vert":{var c={type:"textord",text:"\\Vert",mode:"math"};return t.callFunction("\\Big",[c],[])}default:return{type:"textord",text:" ",mode:"math"}}}function j3e(i){var e=[];for(i.gullet.beginGroup(),i.gullet.macros.set("\\cr","\\\\\\relax"),i.gullet.beginGroup();;){e.push(i.parseExpression(!1,"\\\\")),i.gullet.endGroup(),i.gullet.beginGroup();var t=i.fetch().text;if(t==="&"||t==="\\\\")i.consume();else if(t==="\\end"){e[e.length-1].length===0&&e.pop();break}else throw new Ye("Expected \\\\ or \\cr or \\end",i.nextToken)}for(var n=[],r=[n],s=0;s<e.length;s++){for(var a=e[s],o=KN(),l=0;l<a.length;l++)if(!ZN(a[l]))o.body.push(a[l]);else{n.push(o),l+=1;var c=NC(a[l]).text,u=new Array(2);if(u[0]={type:"ordgroup",mode:"math",body:[]},u[1]={type:"ordgroup",mode:"math",body:[]},!("=|.".indexOf(c)>-1))if("<>AV".indexOf(c)>-1)for(var d=0;d<2;d++){for(var p=!0,m=l+1;m<a.length;m++){if(B3e(a[m],c)){p=!1,l=m;break}if(ZN(a[m]))throw new Ye("Missing a "+c+" character to complete a CD arrow.",a[m]);u[d].body.push(a[m])}if(p)throw new Ye("Missing a "+c+" character to complete a CD arrow.",a[l])}else throw new Ye('Expected one of "<>AV=|." after @',a[l]);var g=H3e(c,u,i),y={type:"styling",body:[g],mode:"math",style:"display"};n.push(y),o=KN()}s%2===0?n.push(o):n.shift(),n=[],r.push(n)}i.gullet.endGroup(),i.gullet.endGroup();var x=new Array(r[0].length).fill({type:"align",align:"c",pregap:.25,postgap:.25});return{type:"array",mode:"math",body:r,arraystretch:1,addJot:!0,rowGaps:[null],cols:x,colSeparationType:"CD",hLinesBeforeRow:new Array(r.length+1).fill([])}}dt({type:"cdlabel",names:["\\\\cdleft","\\\\cdright"],props:{numArgs:1},handler(i,e){var{parser:t,funcName:n}=i;return{type:"cdlabel",mode:t.mode,side:n.slice(4),label:e[0]}},htmlBuilder(i,e){var t=e.havingStyle(e.style.sup()),n=de.wrapFragment(yn(i.label,t,e),e);return n.classes.push("cd-label-"+i.side),n.style.bottom=rt(.8-n.depth),n.height=0,n.depth=0,n},mathmlBuilder(i,e){var t=new Ve.MathNode("mrow",[jn(i.label,e)]);return t=new Ve.MathNode("mpadded",[t]),t.setAttribute("width","0"),i.side==="left"&&t.setAttribute("lspace","-1width"),t.setAttribute("voffset","0.7em"),t=new Ve.MathNode("mstyle",[t]),t.setAttribute("displaystyle","false"),t.setAttribute("scriptlevel","1"),t}});dt({type:"cdlabelparent",names:["\\\\cdparent"],props:{numArgs:1},handler(i,e){var{parser:t}=i;return{type:"cdlabelparent",mode:t.mode,fragment:e[0]}},htmlBuilder(i,e){var t=de.wrapFragment(yn(i.fragment,e),e);return t.classes.push("cd-vert-arrow"),t},mathmlBuilder(i,e){return new Ve.MathNode("mrow",[jn(i.fragment,e)])}});dt({type:"textord",names:["\\@char"],props:{numArgs:1,allowedInText:!0},handler(i,e){for(var{parser:t}=i,n=Jt(e[0],"ordgroup"),r=n.body,s="",a=0;a<r.length;a++){var o=Jt(r[a],"textord");s+=o.text}var l=parseInt(s),c;if(isNaN(l))throw new Ye("\\@char has non-numeric argument "+s);if(l<0||l>=1114111)throw new Ye("\\@char with invalid code point "+s);return l<=65535?c=String.fromCharCode(l):(l-=65536,c=String.fromCharCode((l>>10)+55296,(l&1023)+56320)),{type:"textord",mode:t.mode,text:c}}});var tW=(i,e)=>{var t=Zi(i.body,e.withColor(i.color),!1);return de.makeFragment(t)},nW=(i,e)=>{var t=Ls(i.body,e.withColor(i.color)),n=new Ve.MathNode("mstyle",t);return n.setAttribute("mathcolor",i.color),n};dt({type:"color",names:["\\textcolor"],props:{numArgs:2,allowedInText:!0,argTypes:["color","original"]},handler(i,e){var{parser:t}=i,n=Jt(e[0],"color-token").color,r=e[1];return{type:"color",mode:t.mode,color:n,body:Ii(r)}},htmlBuilder:tW,mathmlBuilder:nW});dt({type:"color",names:["\\color"],props:{numArgs:1,allowedInText:!0,argTypes:["color"]},handler(i,e){var{parser:t,breakOnTokenText:n}=i,r=Jt(e[0],"color-token").color;t.gullet.macros.set("\\current@color",r);var s=t.parseExpression(!0,n);return{type:"color",mode:t.mode,color:r,body:s}},htmlBuilder:tW,mathmlBuilder:nW});dt({type:"cr",names:["\\\\"],props:{numArgs:0,numOptionalArgs:0,allowedInText:!0},handler(i,e,t){var{parser:n}=i,r=n.gullet.future().text==="["?n.parseSizeGroup(!0):null,s=!n.settings.displayMode||!n.settings.useStrictBehavior("newLineInDisplayMode","In LaTeX, \\\\ or \\newline does nothing in display mode");return{type:"cr",mode:n.mode,newLine:s,size:r&&Jt(r,"size").value}},htmlBuilder(i,e){var t=de.makeSpan(["mspace"],[],e);return i.newLine&&(t.classes.push("newline"),i.size&&(t.style.marginTop=rt(hi(i.size,e)))),t},mathmlBuilder(i,e){var t=new Ve.MathNode("mspace");return i.newLine&&(t.setAttribute("linebreak","newline"),i.size&&t.setAttribute("height",rt(hi(i.size,e)))),t}});var T6={"\\global":"\\global","\\long":"\\\\globallong","\\\\globallong":"\\\\globallong","\\def":"\\gdef","\\gdef":"\\gdef","\\edef":"\\xdef","\\xdef":"\\xdef","\\let":"\\\\globallet","\\futurelet":"\\\\globalfuture"},iW=i=>{var e=i.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(e))throw new Ye("Expected a control sequence",i);return e},V3e=i=>{var e=i.gullet.popToken();return e.text==="="&&(e=i.gullet.popToken(),e.text===" "&&(e=i.gullet.popToken())),e},rW=(i,e,t,n)=>{var r=i.gullet.macros.get(t.text);r==null&&(t.noexpand=!0,r={tokens:[t],numArgs:0,unexpandable:!i.gullet.isExpandable(t.text)}),i.gullet.macros.set(e,r,n)};dt({type:"internal",names:["\\global","\\long","\\\\globallong"],props:{numArgs:0,allowedInText:!0},handler(i){var{parser:e,funcName:t}=i;e.consumeSpaces();var n=e.fetch();if(T6[n.text])return(t==="\\global"||t==="\\\\globallong")&&(n.text=T6[n.text]),Jt(e.parseFunction(),"internal");throw new Ye("Invalid token after macro prefix",n)}});dt({type:"internal",names:["\\def","\\gdef","\\edef","\\xdef"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(i){var{parser:e,funcName:t}=i,n=e.gullet.popToken(),r=n.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(r))throw new Ye("Expected a control sequence",n);for(var s=0,a,o=[[]];e.gullet.future().text!=="{";)if(n=e.gullet.popToken(),n.text==="#"){if(e.gullet.future().text==="{"){a=e.gullet.future(),o[s].push("{");break}if(n=e.gullet.popToken(),!/^[1-9]$/.test(n.text))throw new Ye('Invalid argument number "'+n.text+'"');if(parseInt(n.text)!==s+1)throw new Ye('Argument number "'+n.text+'" out of order');s++,o.push([])}else{if(n.text==="EOF")throw new Ye("Expected a macro definition");o[s].push(n.text)}var{tokens:l}=e.gullet.consumeArg();return a&&l.unshift(a),(t==="\\edef"||t==="\\xdef")&&(l=e.gullet.expandTokens(l),l.reverse()),e.gullet.macros.set(r,{tokens:l,numArgs:s,delimiters:o},t===T6[t]),{type:"internal",mode:e.mode}}});dt({type:"internal",names:["\\let","\\\\globallet"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(i){var{parser:e,funcName:t}=i,n=iW(e.gullet.popToken());e.gullet.consumeSpaces();var r=V3e(e);return rW(e,n,r,t==="\\\\globallet"),{type:"internal",mode:e.mode}}});dt({type:"internal",names:["\\futurelet","\\\\globalfuture"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(i){var{parser:e,funcName:t}=i,n=iW(e.gullet.popToken()),r=e.gullet.popToken(),s=e.gullet.popToken();return rW(e,n,s,t==="\\\\globalfuture"),e.gullet.pushToken(s),e.gullet.pushToken(r),{type:"internal",mode:e.mode}}});var rm=function(e,t,n){var r=Yn.math[e]&&Yn.math[e].replace,s=EC(r||e,t,n);if(!s)throw new Error("Unsupported symbol "+e+" and font size "+t+".");return s},kC=function(e,t,n,r){var s=n.havingBaseStyle(t),a=de.makeSpan(r.concat(s.sizingClasses(n)),[e],n),o=s.sizeMultiplier/n.sizeMultiplier;return a.height*=o,a.depth*=o,a.maxFontSize=s.sizeMultiplier,a},sW=function(e,t,n){var r=t.havingBaseStyle(n),s=(1-t.sizeMultiplier/r.sizeMultiplier)*t.fontMetrics().axisHeight;e.classes.push("delimcenter"),e.style.top=rt(s),e.height-=s,e.depth+=s},G3e=function(e,t,n,r,s,a){var o=de.makeSymbol(e,"Main-Regular",s,r),l=kC(o,t,r,a);return n&&sW(l,r,t),l},W3e=function(e,t,n,r){return de.makeSymbol(e,"Size"+t+"-Regular",n,r)},aW=function(e,t,n,r,s,a){var o=W3e(e,t,s,r),l=kC(de.makeSpan(["delimsizing","size"+t],[o],r),zt.TEXT,r,a);return n&&sW(l,r,zt.TEXT),l},uM=function(e,t,n){var r;t==="Size1-Regular"?r="delim-size1":r="delim-size4";var s=de.makeSpan(["delimsizinginner",r],[de.makeSpan([],[de.makeSymbol(e,t,n)])]);return{type:"elem",elem:s}},hM=function(e,t,n){var r=Go["Size4-Regular"][e.charCodeAt(0)]?Go["Size4-Regular"][e.charCodeAt(0)][4]:Go["Size1-Regular"][e.charCodeAt(0)][4],s=new Mu("inner",K_e(e,Math.round(1e3*t))),a=new mc([s],{width:rt(r),height:rt(t),style:"width:"+rt(r),viewBox:"0 0 "+1e3*r+" "+Math.round(1e3*t),preserveAspectRatio:"xMinYMin"}),o=de.makeSvgSpan([],[a],n);return o.height=t,o.style.height=rt(t),o.style.width=rt(r),{type:"elem",elem:o}},A6=.008,Ty={type:"kern",size:-1*A6},q3e=["|","\\lvert","\\rvert","\\vert"],X3e=["\\|","\\lVert","\\rVert","\\Vert"],oW=function(e,t,n,r,s,a){var o,l,c,u,d="",p=0;o=c=u=e,l=null;var m="Size1-Regular";e==="\\uparrow"?c=u="":e==="\\Uparrow"?c=u="":e==="\\downarrow"?o=c="":e==="\\Downarrow"?o=c="":e==="\\updownarrow"?(o="\\uparrow",c="",u="\\downarrow"):e==="\\Updownarrow"?(o="\\Uparrow",c="",u="\\Downarrow"):q3e.includes(e)?(c="",d="vert",p=333):X3e.includes(e)?(c="",d="doublevert",p=556):e==="["||e==="\\lbrack"?(o="",c="",u="",m="Size4-Regular",d="lbrack",p=667):e==="]"||e==="\\rbrack"?(o="",c="",u="",m="Size4-Regular",d="rbrack",p=667):e==="\\lfloor"||e===""?(c=o="",u="",m="Size4-Regular",d="lfloor",p=667):e==="\\lceil"||e===""?(o="",c=u="",m="Size4-Regular",d="lceil",p=667):e==="\\rfloor"||e===""?(c=o="",u="",m="Size4-Regular",d="rfloor",p=667):e==="\\rceil"||e===""?(o="",c=u="",m="Size4-Regular",d="rceil",p=667):e==="("||e==="\\lparen"?(o="",c="",u="",m="Size4-Regular",d="lparen",p=875):e===")"||e==="\\rparen"?(o="",c="",u="",m="Size4-Regular",d="rparen",p=875):e==="\\{"||e==="\\lbrace"?(o="",l="",u="",c="",m="Size4-Regular"):e==="\\}"||e==="\\rbrace"?(o="",l="",u="",c="",m="Size4-Regular"):e==="\\lgroup"||e===""?(o="",u="",c="",m="Size4-Regular"):e==="\\rgroup"||e===""?(o="",u="",c="",m="Size4-Regular"):e==="\\lmoustache"||e===""?(o="",u="",c="",m="Size4-Regular"):(e==="\\rmoustache"||e==="")&&(o="",u="",c="",m="Size4-Regular");var g=rm(o,m,s),y=g.height+g.depth,x=rm(c,m,s),_=x.height+x.depth,S=rm(u,m,s),w=S.height+S.depth,T=0,C=1;if(l!==null){var E=rm(l,m,s);T=E.height+E.depth,C=2}var D=y+w+T,O=Math.max(0,Math.ceil((t-D)/(C*_))),R=D+O*C*_,P=r.fontMetrics().axisHeight;n&&(P*=r.sizeMultiplier);var L=R/2-P,V=[];if(d.length>0){var j=R-y-w,B=Math.round(R*1e3),J=Z_e(d,Math.round(j*1e3)),U=new Mu(d,J),X=(p/1e3).toFixed(3)+"em",$=(B/1e3).toFixed(3)+"em",Q=new mc([U],{width:X,height:$,viewBox:"0 0 "+p+" "+B}),se=de.makeSvgSpan([],[Q],r);se.height=B/1e3,se.style.width=X,se.style.height=$,V.push({type:"elem",elem:se})}else{if(V.push(uM(u,m,s)),V.push(Ty),l===null){var ye=R-y-w+2*A6;V.push(hM(c,ye,r))}else{var we=(R-y-w-T)/2+2*A6;V.push(hM(c,we,r)),V.push(Ty),V.push(uM(l,m,s)),V.push(Ty),V.push(hM(c,we,r))}V.push(Ty),V.push(uM(o,m,s))}var He=r.havingBaseStyle(zt.TEXT),De=de.makeVList({positionType:"bottom",positionData:L,children:V},He);return kC(de.makeSpan(["delimsizing","mult"],[De],He),zt.TEXT,r,a)},dM=80,fM=.08,pM=function(e,t,n,r,s){var a=$_e(e,r,n),o=new Mu(e,a),l=new mc([o],{width:"400em",height:rt(t),viewBox:"0 0 400000 "+n,preserveAspectRatio:"xMinYMin slice"});return de.makeSvgSpan(["hide-tail"],[l],s)},Y3e=function(e,t){var n=t.havingBaseSizing(),r=hW("\\surd",e*n.sizeMultiplier,uW,n),s=n.sizeMultiplier,a=Math.max(0,t.minRuleThickness-t.fontMetrics().sqrtRuleThickness),o,l=0,c=0,u=0,d;return r.type==="small"?(u=1e3+1e3*a+dM,e<1?s=1:e<1.4&&(s=.7),l=(1+a+fM)/s,c=(1+a)/s,o=pM("sqrtMain",l,u,a,t),o.style.minWidth="0.853em",d=.833/s):r.type==="large"?(u=(1e3+dM)*Pm[r.size],c=(Pm[r.size]+a)/s,l=(Pm[r.size]+a+fM)/s,o=pM("sqrtSize"+r.size,l,u,a,t),o.style.minWidth="1.02em",d=1/s):(l=e+a+fM,c=e+a,u=Math.floor(1e3*e+a)+dM,o=pM("sqrtTall",l,u,a,t),o.style.minWidth="0.742em",d=1.056),o.height=c,o.style.height=rt(l),{span:o,advanceWidth:d,ruleWidth:(t.fontMetrics().sqrtRuleThickness+a)*s}},lW=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","","","\\lceil","\\rceil","","","\\surd"],$3e=["\\uparrow","\\downarrow","\\updownarrow","\\Uparrow","\\Downarrow","\\Updownarrow","|","\\|","\\vert","\\Vert","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","","","\\lmoustache","\\rmoustache","",""],cW=["<",">","\\langle","\\rangle","/","\\backslash","\\lt","\\gt"],Pm=[0,1.2,1.8,2.4,3],K3e=function(e,t,n,r,s){if(e==="<"||e==="\\lt"||e===""?e="\\langle":(e===">"||e==="\\gt"||e==="")&&(e="\\rangle"),lW.includes(e)||cW.includes(e))return aW(e,t,!1,n,r,s);if($3e.includes(e))return oW(e,Pm[t],!1,n,r,s);throw new Ye("Illegal delimiter: '"+e+"'")},Z3e=[{type:"small",style:zt.SCRIPTSCRIPT},{type:"small",style:zt.SCRIPT},{type:"small",style:zt.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4}],Q3e=[{type:"small",style:zt.SCRIPTSCRIPT},{type:"small",style:zt.SCRIPT},{type:"small",style:zt.TEXT},{type:"stack"}],uW=[{type:"small",style:zt.SCRIPTSCRIPT},{type:"small",style:zt.SCRIPT},{type:"small",style:zt.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4},{type:"stack"}],J3e=function(e){if(e.type==="small")return"Main-Regular";if(e.type==="large")return"Size"+e.size+"-Regular";if(e.type==="stack")return"Size4-Regular";throw new Error("Add support for delim type '"+e.type+"' here.")},hW=function(e,t,n,r){for(var s=Math.min(2,3-r.style.size),a=s;a<n.length&&n[a].type!=="stack";a++){var o=rm(e,J3e(n[a]),"math"),l=o.height+o.depth;if(n[a].type==="small"){var c=r.havingBaseStyle(n[a].style);l*=c.sizeMultiplier}if(l>t)return n[a]}return n[n.length-1]},dW=function(e,t,n,r,s,a){e==="<"||e==="\\lt"||e===""?e="\\langle":(e===">"||e==="\\gt"||e==="")&&(e="\\rangle");var o;cW.includes(e)?o=Z3e:lW.includes(e)?o=uW:o=Q3e;var l=hW(e,t,o,r);return l.type==="small"?G3e(e,l.style,n,r,s,a):l.type==="large"?aW(e,l.size,n,r,s,a):oW(e,t,n,r,s,a)},eSe=function(e,t,n,r,s,a){var o=r.fontMetrics().axisHeight*r.sizeMultiplier,l=901,c=5/r.fontMetrics().ptPerEm,u=Math.max(t-o,n+o),d=Math.max(u/500*l,2*u-c);return dW(e,d,!0,r,s,a)},ac={sqrtImage:Y3e,sizedDelim:K3e,sizeToMaxHeight:Pm,customSizedDelim:dW,leftRightDelim:eSe},QN={"\\bigl":{mclass:"mopen",size:1},"\\Bigl":{mclass:"mopen",size:2},"\\biggl":{mclass:"mopen",size:3},"\\Biggl":{mclass:"mopen",size:4},"\\bigr":{mclass:"mclose",size:1},"\\Bigr":{mclass:"mclose",size:2},"\\biggr":{mclass:"mclose",size:3},"\\Biggr":{mclass:"mclose",size:4},"\\bigm":{mclass:"mrel",size:1},"\\Bigm":{mclass:"mrel",size:2},"\\biggm":{mclass:"mrel",size:3},"\\Biggm":{mclass:"mrel",size:4},"\\big":{mclass:"mord",size:1},"\\Big":{mclass:"mord",size:2},"\\bigg":{mclass:"mord",size:3},"\\Bigg":{mclass:"mord",size:4}},tSe=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","","","\\lceil","\\rceil","","","<",">","\\langle","","\\rangle","","\\lt","\\gt","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","","","\\lmoustache","\\rmoustache","","","/","\\backslash","|","\\vert","\\|","\\Vert","\\uparrow","\\Uparrow","\\downarrow","\\Downarrow","\\updownarrow","\\Updownarrow","."];function d_(i,e){var t=u_(i);if(t&&tSe.includes(t.text))return t;throw t?new Ye("Invalid delimiter '"+t.text+"' after '"+e.funcName+"'",i):new Ye("Invalid delimiter type '"+i.type+"'",i)}dt({type:"delimsizing",names:["\\bigl","\\Bigl","\\biggl","\\Biggl","\\bigr","\\Bigr","\\biggr","\\Biggr","\\bigm","\\Bigm","\\biggm","\\Biggm","\\big","\\Big","\\bigg","\\Bigg"],props:{numArgs:1,argTypes:["primitive"]},handler:(i,e)=>{var t=d_(e[0],i);return{type:"delimsizing",mode:i.parser.mode,size:QN[i.funcName].size,mclass:QN[i.funcName].mclass,delim:t.text}},htmlBuilder:(i,e)=>i.delim==="."?de.makeSpan([i.mclass]):ac.sizedDelim(i.delim,i.size,e,i.mode,[i.mclass]),mathmlBuilder:i=>{var e=[];i.delim!=="."&&e.push(Fa(i.delim,i.mode));var t=new Ve.MathNode("mo",e);i.mclass==="mopen"||i.mclass==="mclose"?t.setAttribute("fence","true"):t.setAttribute("fence","false"),t.setAttribute("stretchy","true");var n=rt(ac.sizeToMaxHeight[i.size]);return t.setAttribute("minsize",n),t.setAttribute("maxsize",n),t}});function JN(i){if(!i.body)throw new Error("Bug: The leftright ParseNode wasn't fully parsed.")}dt({type:"leftright-right",names:["\\right"],props:{numArgs:1,primitive:!0},handler:(i,e)=>{var t=i.parser.gullet.macros.get("\\current@color");if(t&&typeof t!="string")throw new Ye("\\current@color set to non-string in \\right");return{type:"leftright-right",mode:i.parser.mode,delim:d_(e[0],i).text,color:t}}});dt({type:"leftright",names:["\\left"],props:{numArgs:1,primitive:!0},handler:(i,e)=>{var t=d_(e[0],i),n=i.parser;++n.leftrightDepth;var r=n.parseExpression(!1);--n.leftrightDepth,n.expect("\\right",!1);var s=Jt(n.parseFunction(),"leftright-right");return{type:"leftright",mode:n.mode,body:r,left:t.text,right:s.delim,rightColor:s.color}},htmlBuilder:(i,e)=>{JN(i);for(var t=Zi(i.body,e,!0,["mopen","mclose"]),n=0,r=0,s=!1,a=0;a<t.length;a++)t[a].isMiddle?s=!0:(n=Math.max(t[a].height,n),r=Math.max(t[a].depth,r));n*=e.sizeMultiplier,r*=e.sizeMultiplier;var o;if(i.left==="."?o=Pg(e,["mopen"]):o=ac.leftRightDelim(i.left,n,r,e,i.mode,["mopen"]),t.unshift(o),s)for(var l=1;l<t.length;l++){var c=t[l],u=c.isMiddle;u&&(t[l]=ac.leftRightDelim(u.delim,n,r,u.options,i.mode,[]))}var d;if(i.right===".")d=Pg(e,["mclose"]);else{var p=i.rightColor?e.withColor(i.rightColor):e;d=ac.leftRightDelim(i.right,n,r,p,i.mode,["mclose"])}return t.push(d),de.makeSpan(["minner"],t,e)},mathmlBuilder:(i,e)=>{JN(i);var t=Ls(i.body,e);if(i.left!=="."){var n=new Ve.MathNode("mo",[Fa(i.left,i.mode)]);n.setAttribute("fence","true"),t.unshift(n)}if(i.right!=="."){var r=new Ve.MathNode("mo",[Fa(i.right,i.mode)]);r.setAttribute("fence","true"),i.rightColor&&r.setAttribute("mathcolor",i.rightColor),t.push(r)}return IC(t)}});dt({type:"middle",names:["\\middle"],props:{numArgs:1,primitive:!0},handler:(i,e)=>{var t=d_(e[0],i);if(!i.parser.leftrightDepth)throw new Ye("\\middle without preceding \\left",t);return{type:"middle",mode:i.parser.mode,delim:t.text}},htmlBuilder:(i,e)=>{var t;if(i.delim===".")t=Pg(e,[]);else{t=ac.sizedDelim(i.delim,1,e,i.mode,[]);var n={delim:i.delim,options:e};t.isMiddle=n}return t},mathmlBuilder:(i,e)=>{var t=i.delim==="\\vert"||i.delim==="|"?Fa("|","text"):Fa(i.delim,i.mode),n=new Ve.MathNode("mo",[t]);return n.setAttribute("fence","true"),n.setAttribute("lspace","0.05em"),n.setAttribute("rspace","0.05em"),n}});var OC=(i,e)=>{var t=de.wrapFragment(yn(i.body,e),e),n=i.label.slice(1),r=e.sizeMultiplier,s,a=0,o=wn.isCharacterBox(i.body);if(n==="sout")s=de.makeSpan(["stretchy","sout"]),s.height=e.fontMetrics().defaultRuleThickness/r,a=-.5*e.fontMetrics().xHeight;else if(n==="phase"){var l=hi({number:.6,unit:"pt"},e),c=hi({number:.35,unit:"ex"},e),u=e.havingBaseSizing();r=r/u.sizeMultiplier;var d=t.height+t.depth+l+c;t.style.paddingLeft=rt(d/2+l);var p=Math.floor(1e3*d*r),m=X_e(p),g=new mc([new Mu("phase",m)],{width:"400em",height:rt(p/1e3),viewBox:"0 0 400000 "+p,preserveAspectRatio:"xMinYMin slice"});s=de.makeSvgSpan(["hide-tail"],[g],e),s.style.height=rt(d),a=t.depth+l+c}else{/cancel/.test(n)?o||t.classes.push("cancel-pad"):n==="angl"?t.classes.push("anglpad"):t.classes.push("boxpad");var y=0,x=0,_=0;/box/.test(n)?(_=Math.max(e.fontMetrics().fboxrule,e.minRuleThickness),y=e.fontMetrics().fboxsep+(n==="colorbox"?0:_),x=y):n==="angl"?(_=Math.max(e.fontMetrics().defaultRuleThickness,e.minRuleThickness),y=4*_,x=Math.max(0,.25-t.depth)):(y=o?.2:0,x=y),s=xc.encloseSpan(t,n,y,x,e),/fbox|boxed|fcolorbox/.test(n)?(s.style.borderStyle="solid",s.style.borderWidth=rt(_)):n==="angl"&&_!==.049&&(s.style.borderTopWidth=rt(_),s.style.borderRightWidth=rt(_)),a=t.depth+x,i.backgroundColor&&(s.style.backgroundColor=i.backgroundColor,i.borderColor&&(s.style.borderColor=i.borderColor))}var S;if(i.backgroundColor)S=de.makeVList({positionType:"individualShift",children:[{type:"elem",elem:s,shift:a},{type:"elem",elem:t,shift:0}]},e);else{var w=/cancel|phase/.test(n)?["svg-align"]:[];S=de.makeVList({positionType:"individualShift",children:[{type:"elem",elem:t,shift:0},{type:"elem",elem:s,shift:a,wrapperClasses:w}]},e)}return/cancel/.test(n)&&(S.height=t.height,S.depth=t.depth),/cancel/.test(n)&&!o?de.makeSpan(["mord","cancel-lap"],[S],e):de.makeSpan(["mord"],[S],e)},zC=(i,e)=>{var t=0,n=new Ve.MathNode(i.label.indexOf("colorbox")>-1?"mpadded":"menclose",[jn(i.body,e)]);switch(i.label){case"\\cancel":n.setAttribute("notation","updiagonalstrike");break;case"\\bcancel":n.setAttribute("notation","downdiagonalstrike");break;case"\\phase":n.setAttribute("notation","phasorangle");break;case"\\sout":n.setAttribute("notation","horizontalstrike");break;case"\\fbox":n.setAttribute("notation","box");break;case"\\angl":n.setAttribute("notation","actuarial");break;case"\\fcolorbox":case"\\colorbox":if(t=e.fontMetrics().fboxsep*e.fontMetrics().ptPerEm,n.setAttribute("width","+"+2*t+"pt"),n.setAttribute("height","+"+2*t+"pt"),n.setAttribute("lspace",t+"pt"),n.setAttribute("voffset",t+"pt"),i.label==="\\fcolorbox"){var r=Math.max(e.fontMetrics().fboxrule,e.minRuleThickness);n.setAttribute("style","border: "+r+"em solid "+String(i.borderColor))}break;case"\\xcancel":n.setAttribute("notation","updiagonalstrike downdiagonalstrike");break}return i.backgroundColor&&n.setAttribute("mathbackground",i.backgroundColor),n};dt({type:"enclose",names:["\\colorbox"],props:{numArgs:2,allowedInText:!0,argTypes:["color","text"]},handler(i,e,t){var{parser:n,funcName:r}=i,s=Jt(e[0],"color-token").color,a=e[1];return{type:"enclose",mode:n.mode,label:r,backgroundColor:s,body:a}},htmlBuilder:OC,mathmlBuilder:zC});dt({type:"enclose",names:["\\fcolorbox"],props:{numArgs:3,allowedInText:!0,argTypes:["color","color","text"]},handler(i,e,t){var{parser:n,funcName:r}=i,s=Jt(e[0],"color-token").color,a=Jt(e[1],"color-token").color,o=e[2];return{type:"enclose",mode:n.mode,label:r,backgroundColor:a,borderColor:s,body:o}},htmlBuilder:OC,mathmlBuilder:zC});dt({type:"enclose",names:["\\fbox"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!0},handler(i,e){var{parser:t}=i;return{type:"enclose",mode:t.mode,label:"\\fbox",body:e[0]}}});dt({type:"enclose",names:["\\cancel","\\bcancel","\\xcancel","\\sout","\\phase"],props:{numArgs:1},handler(i,e){var{parser:t,funcName:n}=i,r=e[0];return{type:"enclose",mode:t.mode,label:n,body:r}},htmlBuilder:OC,mathmlBuilder:zC});dt({type:"enclose",names:["\\angl"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!1},handler(i,e){var{parser:t}=i;return{type:"enclose",mode:t.mode,label:"\\angl",body:e[0]}}});var fW={};function dl(i){for(var{type:e,names:t,props:n,handler:r,htmlBuilder:s,mathmlBuilder:a}=i,o={type:e,numArgs:n.numArgs||0,allowedInText:!1,numOptionalArgs:0,handler:r},l=0;l<t.length;++l)fW[t[l]]=o;s&&(Ab[e]=s),a&&(Cb[e]=a)}var pW={};function W(i,e){pW[i]=e}function eL(i){var e=[];i.consumeSpaces();var t=i.fetch().text;for(t==="\\relax"&&(i.consume(),i.consumeSpaces(),t=i.fetch().text);t==="\\hline"||t==="\\hdashline";)i.consume(),e.push(t==="\\hdashline"),i.consumeSpaces(),t=i.fetch().text;return e}var f_=i=>{var e=i.parser.settings;if(!e.displayMode)throw new Ye("{"+i.envName+"} can be used only in display mode.")};function UC(i){if(i.indexOf("ed")===-1)return i.indexOf("*")===-1}function Uu(i,e,t){var{hskipBeforeAndAfter:n,addJot:r,cols:s,arraystretch:a,colSeparationType:o,autoTag:l,singleRow:c,emptySingleRow:u,maxNumCols:d,leqno:p}=e;if(i.gullet.beginGroup(),c||i.gullet.macros.set("\\cr","\\\\\\relax"),!a){var m=i.gullet.expandMacroAsText("\\arraystretch");if(m==null)a=1;else if(a=parseFloat(m),!a||a<0)throw new Ye("Invalid \\arraystretch: "+m)}i.gullet.beginGroup();var g=[],y=[g],x=[],_=[],S=l!=null?[]:void 0;function w(){l&&i.gullet.macros.set("\\@eqnsw","1",!0)}function T(){S&&(i.gullet.macros.get("\\df@tag")?(S.push(i.subparse([new ra("\\df@tag")])),i.gullet.macros.set("\\df@tag",void 0,!0)):S.push(!!l&&i.gullet.macros.get("\\@eqnsw")==="1"))}for(w(),_.push(eL(i));;){var C=i.parseExpression(!1,c?"\\end":"\\\\");i.gullet.endGroup(),i.gullet.beginGroup(),C={type:"ordgroup",mode:i.mode,body:C},t&&(C={type:"styling",mode:i.mode,style:t,body:[C]}),g.push(C);var E=i.fetch().text;if(E==="&"){if(d&&g.length===d){if(c||o)throw new Ye("Too many tab characters: &",i.nextToken);i.settings.reportNonstrict("textEnv","Too few columns specified in the {array} column argument.")}i.consume()}else if(E==="\\end"){T(),g.length===1&&C.type==="styling"&&C.body[0].body.length===0&&(y.length>1||!u)&&y.pop(),_.length<y.length+1&&_.push([]);break}else if(E==="\\\\"){i.consume();var D=void 0;i.gullet.future().text!==" "&&(D=i.parseSizeGroup(!0)),x.push(D?D.value:null),T(),_.push(eL(i)),g=[],y.push(g),w()}else throw new Ye("Expected & or \\\\ or \\cr or \\end",i.nextToken)}return i.gullet.endGroup(),i.gullet.endGroup(),{type:"array",mode:i.mode,addJot:r,arraystretch:a,body:y,cols:s,rowGaps:x,hskipBeforeAndAfter:n,hLinesBeforeRow:_,colSeparationType:o,tags:S,leqno:p}}function FC(i){return i.slice(0,1)==="d"?"display":"text"}var fl=function(e,t){var n,r,s=e.body.length,a=e.hLinesBeforeRow,o=0,l=new Array(s),c=[],u=Math.max(t.fontMetrics().arrayRuleWidth,t.minRuleThickness),d=1/t.fontMetrics().ptPerEm,p=5*d;if(e.colSeparationType&&e.colSeparationType==="small"){var m=t.havingStyle(zt.SCRIPT).sizeMultiplier;p=.2778*(m/t.sizeMultiplier)}var g=e.colSeparationType==="CD"?hi({number:3,unit:"ex"},t):12*d,y=3*d,x=e.arraystretch*g,_=.7*x,S=.3*x,w=0;function T(Ge){for(var Le=0;Le<Ge.length;++Le)Le>0&&(w+=.25),c.push({pos:w,isDashed:Ge[Le]})}for(T(a[0]),n=0;n<e.body.length;++n){var C=e.body[n],E=_,D=S;o<C.length&&(o=C.length);var O=new Array(C.length);for(r=0;r<C.length;++r){var R=yn(C[r],t);D<R.depth&&(D=R.depth),E<R.height&&(E=R.height),O[r]=R}var P=e.rowGaps[n],L=0;P&&(L=hi(P,t),L>0&&(L+=S,D<L&&(D=L),L=0)),e.addJot&&(D+=y),O.height=E,O.depth=D,w+=E,O.pos=w,w+=D+L,l[n]=O,T(a[n+1])}var V=w/2+t.fontMetrics().axisHeight,j=e.cols||[],B=[],J,U,X=[];if(e.tags&&e.tags.some(Ge=>Ge))for(n=0;n<s;++n){var $=l[n],Q=$.pos-V,se=e.tags[n],ye=void 0;se===!0?ye=de.makeSpan(["eqn-num"],[],t):se===!1?ye=de.makeSpan([],[],t):ye=de.makeSpan([],Zi(se,t,!0),t),ye.depth=$.depth,ye.height=$.height,X.push({type:"elem",elem:ye,shift:Q})}for(r=0,U=0;r<o||U<j.length;++r,++U){for(var we=j[U]||{},He=!0;we.type==="separator";){if(He||(J=de.makeSpan(["arraycolsep"],[]),J.style.width=rt(t.fontMetrics().doubleRuleSep),B.push(J)),we.separator==="|"||we.separator===":"){var De=we.separator==="|"?"solid":"dashed",Oe=de.makeSpan(["vertical-separator"],[],t);Oe.style.height=rt(w),Oe.style.borderRightWidth=rt(u),Oe.style.borderRightStyle=De,Oe.style.margin="0 "+rt(-u/2);var fe=w-V;fe&&(Oe.style.verticalAlign=rt(-fe)),B.push(Oe)}else throw new Ye("Invalid separator type: "+we.separator);U++,we=j[U]||{},He=!1}if(!(r>=o)){var ge=void 0;(r>0||e.hskipBeforeAndAfter)&&(ge=wn.deflt(we.pregap,p),ge!==0&&(J=de.makeSpan(["arraycolsep"],[]),J.style.width=rt(ge),B.push(J)));var Ne=[];for(n=0;n<s;++n){var Qe=l[n],et=Qe[r];if(et){var Nt=Qe.pos-V;et.depth=Qe.depth,et.height=Qe.height,Ne.push({type:"elem",elem:et,shift:Nt})}}Ne=de.makeVList({positionType:"individualShift",children:Ne},t),Ne=de.makeSpan(["col-align-"+(we.align||"c")],[Ne]),B.push(Ne),(r<o-1||e.hskipBeforeAndAfter)&&(ge=wn.deflt(we.postgap,p),ge!==0&&(J=de.makeSpan(["arraycolsep"],[]),J.style.width=rt(ge),B.push(J)))}}if(l=de.makeSpan(["mtable"],B),c.length>0){for(var Gt=de.makeLineSpan("hline",t,u),vt=de.makeLineSpan("hdashline",t,u),Te=[{type:"elem",elem:l,shift:0}];c.length>0;){var Y=c.pop(),Ee=Y.pos-V;Y.isDashed?Te.push({type:"elem",elem:vt,shift:Ee}):Te.push({type:"elem",elem:Gt,shift:Ee})}l=de.makeVList({positionType:"individualShift",children:Te},t)}if(X.length===0)return de.makeSpan(["mord"],[l],t);var Ie=de.makeVList({positionType:"individualShift",children:X},t);return Ie=de.makeSpan(["tag"],[Ie],t),de.makeFragment([l,Ie])},nSe={c:"center ",l:"left ",r:"right "},pl=function(e,t){for(var n=[],r=new Ve.MathNode("mtd",[],["mtr-glue"]),s=new Ve.MathNode("mtd",[],["mml-eqn-num"]),a=0;a<e.body.length;a++){for(var o=e.body[a],l=[],c=0;c<o.length;c++)l.push(new Ve.MathNode("mtd",[jn(o[c],t)]));e.tags&&e.tags[a]&&(l.unshift(r),l.push(r),e.leqno?l.unshift(s):l.push(s)),n.push(new Ve.MathNode("mtr",l))}var u=new Ve.MathNode("mtable",n),d=e.arraystretch===.5?.1:.16+e.arraystretch-1+(e.addJot?.09:0);u.setAttribute("rowspacing",rt(d));var p="",m="";if(e.cols&&e.cols.length>0){var g=e.cols,y="",x=!1,_=0,S=g.length;g[0].type==="separator"&&(p+="top ",_=1),g[g.length-1].type==="separator"&&(p+="bottom ",S-=1);for(var w=_;w<S;w++)g[w].type==="align"?(m+=nSe[g[w].align],x&&(y+="none "),x=!0):g[w].type==="separator"&&x&&(y+=g[w].separator==="|"?"solid ":"dashed ",x=!1);u.setAttribute("columnalign",m.trim()),/[sd]/.test(y)&&u.setAttribute("columnlines",y.trim())}if(e.colSeparationType==="align"){for(var T=e.cols||[],C="",E=1;E<T.length;E++)C+=E%2?"0em ":"1em ";u.setAttribute("columnspacing",C.trim())}else e.colSeparationType==="alignat"||e.colSeparationType==="gather"?u.setAttribute("columnspacing","0em"):e.colSeparationType==="small"?u.setAttribute("columnspacing","0.2778em"):e.colSeparationType==="CD"?u.setAttribute("columnspacing","0.5em"):u.setAttribute("columnspacing","1em");var D="",O=e.hLinesBeforeRow;p+=O[0].length>0?"left ":"",p+=O[O.length-1].length>0?"right ":"";for(var R=1;R<O.length-1;R++)D+=O[R].length===0?"none ":O[R][0]?"dashed ":"solid ";return/[sd]/.test(D)&&u.setAttribute("rowlines",D.trim()),p!==""&&(u=new Ve.MathNode("menclose",[u]),u.setAttribute("notation",p.trim())),e.arraystretch&&e.arraystretch<1&&(u=new Ve.MathNode("mstyle",[u]),u.setAttribute("scriptlevel","1")),u},mW=function(e,t){e.envName.indexOf("ed")===-1&&f_(e);var n=[],r=e.envName.indexOf("at")>-1?"alignat":"align",s=e.envName==="split",a=Uu(e.parser,{cols:n,addJot:!0,autoTag:s?void 0:UC(e.envName),emptySingleRow:!0,colSeparationType:r,maxNumCols:s?2:void 0,leqno:e.parser.settings.leqno},"display"),o,l=0,c={type:"ordgroup",mode:e.mode,body:[]};if(t[0]&&t[0].type==="ordgroup"){for(var u="",d=0;d<t[0].body.length;d++){var p=Jt(t[0].body[d],"textord");u+=p.text}o=Number(u),l=o*2}var m=!l;a.body.forEach(function(_){for(var S=1;S<_.length;S+=2){var w=Jt(_[S],"styling"),T=Jt(w.body[0],"ordgroup");T.body.unshift(c)}if(m)l<_.length&&(l=_.length);else{var C=_.length/2;if(o<C)throw new Ye("Too many math in a row: "+("expected "+o+", but got "+C),_[0])}});for(var g=0;g<l;++g){var y="r",x=0;g%2===1?y="l":g>0&&m&&(x=1),n[g]={type:"align",align:y,pregap:x,postgap:0}}return a.colSeparationType=m?"align":"alignat",a};dl({type:"array",names:["array","darray"],props:{numArgs:1},handler(i,e){var t=u_(e[0]),n=t?[e[0]]:Jt(e[0],"ordgroup").body,r=n.map(function(a){var o=NC(a),l=o.text;if("lcr".indexOf(l)!==-1)return{type:"align",align:l};if(l==="|")return{type:"separator",separator:"|"};if(l===":")return{type:"separator",separator:":"};throw new Ye("Unknown column alignment: "+l,a)}),s={cols:r,hskipBeforeAndAfter:!0,maxNumCols:r.length};return Uu(i.parser,s,FC(i.envName))},htmlBuilder:fl,mathmlBuilder:pl});dl({type:"array",names:["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","matrix*","pmatrix*","bmatrix*","Bmatrix*","vmatrix*","Vmatrix*"],props:{numArgs:0},handler(i){var e={matrix:null,pmatrix:["(",")"],bmatrix:["[","]"],Bmatrix:["\\{","\\}"],vmatrix:["|","|"],Vmatrix:["\\Vert","\\Vert"]}[i.envName.replace("*","")],t="c",n={hskipBeforeAndAfter:!1,cols:[{type:"align",align:t}]};if(i.envName.charAt(i.envName.length-1)==="*"){var r=i.parser;if(r.consumeSpaces(),r.fetch().text==="["){if(r.consume(),r.consumeSpaces(),t=r.fetch().text,"lcr".indexOf(t)===-1)throw new Ye("Expected l or c or r",r.nextToken);r.consume(),r.consumeSpaces(),r.expect("]"),r.consume(),n.cols=[{type:"align",align:t}]}}var s=Uu(i.parser,n,FC(i.envName)),a=Math.max(0,...s.body.map(o=>o.length));return s.cols=new Array(a).fill({type:"align",align:t}),e?{type:"leftright",mode:i.mode,body:[s],left:e[0],right:e[1],rightColor:void 0}:s},htmlBuilder:fl,mathmlBuilder:pl});dl({type:"array",names:["smallmatrix"],props:{numArgs:0},handler(i){var e={arraystretch:.5},t=Uu(i.parser,e,"script");return t.colSeparationType="small",t},htmlBuilder:fl,mathmlBuilder:pl});dl({type:"array",names:["subarray"],props:{numArgs:1},handler(i,e){var t=u_(e[0]),n=t?[e[0]]:Jt(e[0],"ordgroup").body,r=n.map(function(a){var o=NC(a),l=o.text;if("lc".indexOf(l)!==-1)return{type:"align",align:l};throw new Ye("Unknown column alignment: "+l,a)});if(r.length>1)throw new Ye("{subarray} can contain only one column");var s={cols:r,hskipBeforeAndAfter:!1,arraystretch:.5};if(s=Uu(i.parser,s,"script"),s.body.length>0&&s.body[0].length>1)throw new Ye("{subarray} can contain only one column");return s},htmlBuilder:fl,mathmlBuilder:pl});dl({type:"array",names:["cases","dcases","rcases","drcases"],props:{numArgs:0},handler(i){var e={arraystretch:1.2,cols:[{type:"align",align:"l",pregap:0,postgap:1},{type:"align",align:"l",pregap:0,postgap:0}]},t=Uu(i.parser,e,FC(i.envName));return{type:"leftright",mode:i.mode,body:[t],left:i.envName.indexOf("r")>-1?".":"\\{",right:i.envName.indexOf("r")>-1?"\\}":".",rightColor:void 0}},htmlBuilder:fl,mathmlBuilder:pl});dl({type:"array",names:["align","align*","aligned","split"],props:{numArgs:0},handler:mW,htmlBuilder:fl,mathmlBuilder:pl});dl({type:"array",names:["gathered","gather","gather*"],props:{numArgs:0},handler(i){["gather","gather*"].includes(i.envName)&&f_(i);var e={cols:[{type:"align",align:"c"}],addJot:!0,colSeparationType:"gather",autoTag:UC(i.envName),emptySingleRow:!0,leqno:i.parser.settings.leqno};return Uu(i.parser,e,"display")},htmlBuilder:fl,mathmlBuilder:pl});dl({type:"array",names:["alignat","alignat*","alignedat"],props:{numArgs:1},handler:mW,htmlBuilder:fl,mathmlBuilder:pl});dl({type:"array",names:["equation","equation*"],props:{numArgs:0},handler(i){f_(i);var e={autoTag:UC(i.envName),emptySingleRow:!0,singleRow:!0,maxNumCols:1,leqno:i.parser.settings.leqno};return Uu(i.parser,e,"display")},htmlBuilder:fl,mathmlBuilder:pl});dl({type:"array",names:["CD"],props:{numArgs:0},handler(i){return f_(i),j3e(i.parser)},htmlBuilder:fl,mathmlBuilder:pl});W("\\nonumber","\\gdef\\@eqnsw{0}");W("\\notag","\\nonumber");dt({type:"text",names:["\\hline","\\hdashline"],props:{numArgs:0,allowedInText:!0,allowedInMath:!0},handler(i,e){throw new Ye(i.funcName+" valid only within array environment")}});var tL=fW;dt({type:"environment",names:["\\begin","\\end"],props:{numArgs:1,argTypes:["text"]},handler(i,e){var{parser:t,funcName:n}=i,r=e[0];if(r.type!=="ordgroup")throw new Ye("Invalid environment name",r);for(var s="",a=0;a<r.body.length;++a)s+=Jt(r.body[a],"textord").text;if(n==="\\begin"){if(!tL.hasOwnProperty(s))throw new Ye("No such environment: "+s,r);var o=tL[s],{args:l,optArgs:c}=t.parseArguments("\\begin{"+s+"}",o),u={mode:t.mode,envName:s,parser:t},d=o.handler(u,l,c);t.expect("\\end",!1);var p=t.nextToken,m=Jt(t.parseFunction(),"environment");if(m.name!==s)throw new Ye("Mismatch: \\begin{"+s+"} matched by \\end{"+m.name+"}",p);return d}return{type:"environment",mode:t.mode,name:s,nameGroup:r}}});var gW=(i,e)=>{var t=i.font,n=e.withFont(t);return yn(i.body,n)},xW=(i,e)=>{var t=i.font,n=e.withFont(t);return jn(i.body,n)},nL={"\\Bbb":"\\mathbb","\\bold":"\\mathbf","\\frak":"\\mathfrak","\\bm":"\\boldsymbol"};dt({type:"font",names:["\\mathrm","\\mathit","\\mathbf","\\mathnormal","\\mathsfit","\\mathbb","\\mathcal","\\mathfrak","\\mathscr","\\mathsf","\\mathtt","\\Bbb","\\bold","\\frak"],props:{numArgs:1,allowedInArgument:!0},handler:(i,e)=>{var{parser:t,funcName:n}=i,r=Eb(e[0]),s=n;return s in nL&&(s=nL[s]),{type:"font",mode:t.mode,font:s.slice(1),body:r}},htmlBuilder:gW,mathmlBuilder:xW});dt({type:"mclass",names:["\\boldsymbol","\\bm"],props:{numArgs:1},handler:(i,e)=>{var{parser:t}=i,n=e[0],r=wn.isCharacterBox(n);return{type:"mclass",mode:t.mode,mclass:h_(n),body:[{type:"font",mode:t.mode,font:"boldsymbol",body:n}],isCharacterBox:r}}});dt({type:"font",names:["\\rm","\\sf","\\tt","\\bf","\\it","\\cal"],props:{numArgs:0,allowedInText:!0},handler:(i,e)=>{var{parser:t,funcName:n,breakOnTokenText:r}=i,{mode:s}=t,a=t.parseExpression(!0,r),o="math"+n.slice(1);return{type:"font",mode:s,font:o,body:{type:"ordgroup",mode:t.mode,body:a}}},htmlBuilder:gW,mathmlBuilder:xW});var yW=(i,e)=>{var t=e;return i==="display"?t=t.id>=zt.SCRIPT.id?t.text():zt.DISPLAY:i==="text"&&t.size===zt.DISPLAY.size?t=zt.TEXT:i==="script"?t=zt.SCRIPT:i==="scriptscript"&&(t=zt.SCRIPTSCRIPT),t},BC=(i,e)=>{var t=yW(i.size,e.style),n=t.fracNum(),r=t.fracDen(),s;s=e.havingStyle(n);var a=yn(i.numer,s,e);if(i.continued){var o=8.5/e.fontMetrics().ptPerEm,l=3.5/e.fontMetrics().ptPerEm;a.height=a.height<o?o:a.height,a.depth=a.depth<l?l:a.depth}s=e.havingStyle(r);var c=yn(i.denom,s,e),u,d,p;i.hasBarLine?(i.barSize?(d=hi(i.barSize,e),u=de.makeLineSpan("frac-line",e,d)):u=de.makeLineSpan("frac-line",e),d=u.height,p=u.height):(u=null,d=0,p=e.fontMetrics().defaultRuleThickness);var m,g,y;t.size===zt.DISPLAY.size||i.size==="display"?(m=e.fontMetrics().num1,d>0?g=3*p:g=7*p,y=e.fontMetrics().denom1):(d>0?(m=e.fontMetrics().num2,g=p):(m=e.fontMetrics().num3,g=3*p),y=e.fontMetrics().denom2);var x;if(u){var S=e.fontMetrics().axisHeight;m-a.depth-(S+.5*d)<g&&(m+=g-(m-a.depth-(S+.5*d))),S-.5*d-(c.height-y)<g&&(y+=g-(S-.5*d-(c.height-y)));var w=-(S-.5*d);x=de.makeVList({positionType:"individualShift",children:[{type:"elem",elem:c,shift:y},{type:"elem",elem:u,shift:w},{type:"elem",elem:a,shift:-m}]},e)}else{var _=m-a.depth-(c.height-y);_<g&&(m+=.5*(g-_),y+=.5*(g-_)),x=de.makeVList({positionType:"individualShift",children:[{type:"elem",elem:c,shift:y},{type:"elem",elem:a,shift:-m}]},e)}s=e.havingStyle(t),x.height*=s.sizeMultiplier/e.sizeMultiplier,x.depth*=s.sizeMultiplier/e.sizeMultiplier;var T;t.size===zt.DISPLAY.size?T=e.fontMetrics().delim1:t.size===zt.SCRIPTSCRIPT.size?T=e.havingStyle(zt.SCRIPT).fontMetrics().delim2:T=e.fontMetrics().delim2;var C,E;return i.leftDelim==null?C=Pg(e,["mopen"]):C=ac.customSizedDelim(i.leftDelim,T,!0,e.havingStyle(t),i.mode,["mopen"]),i.continued?E=de.makeSpan([]):i.rightDelim==null?E=Pg(e,["mclose"]):E=ac.customSizedDelim(i.rightDelim,T,!0,e.havingStyle(t),i.mode,["mclose"]),de.makeSpan(["mord"].concat(s.sizingClasses(e)),[C,de.makeSpan(["mfrac"],[x]),E],e)},HC=(i,e)=>{var t=new Ve.MathNode("mfrac",[jn(i.numer,e),jn(i.denom,e)]);if(!i.hasBarLine)t.setAttribute("linethickness","0px");else if(i.barSize){var n=hi(i.barSize,e);t.setAttribute("linethickness",rt(n))}var r=yW(i.size,e.style);if(r.size!==e.style.size){t=new Ve.MathNode("mstyle",[t]);var s=r.size===zt.DISPLAY.size?"true":"false";t.setAttribute("displaystyle",s),t.setAttribute("scriptlevel","0")}if(i.leftDelim!=null||i.rightDelim!=null){var a=[];if(i.leftDelim!=null){var o=new Ve.MathNode("mo",[new Ve.TextNode(i.leftDelim.replace("\\",""))]);o.setAttribute("fence","true"),a.push(o)}if(a.push(t),i.rightDelim!=null){var l=new Ve.MathNode("mo",[new Ve.TextNode(i.rightDelim.replace("\\",""))]);l.setAttribute("fence","true"),a.push(l)}return IC(a)}return t};dt({type:"genfrac",names:["\\dfrac","\\frac","\\tfrac","\\dbinom","\\binom","\\tbinom","\\\\atopfrac","\\\\bracefrac","\\\\brackfrac"],props:{numArgs:2,allowedInArgument:!0},handler:(i,e)=>{var{parser:t,funcName:n}=i,r=e[0],s=e[1],a,o=null,l=null,c="auto";switch(n){case"\\dfrac":case"\\frac":case"\\tfrac":a=!0;break;case"\\\\atopfrac":a=!1;break;case"\\dbinom":case"\\binom":case"\\tbinom":a=!1,o="(",l=")";break;case"\\\\bracefrac":a=!1,o="\\{",l="\\}";break;case"\\\\brackfrac":a=!1,o="[",l="]";break;default:throw new Error("Unrecognized genfrac command")}switch(n){case"\\dfrac":case"\\dbinom":c="display";break;case"\\tfrac":case"\\tbinom":c="text";break}return{type:"genfrac",mode:t.mode,continued:!1,numer:r,denom:s,hasBarLine:a,leftDelim:o,rightDelim:l,size:c,barSize:null}},htmlBuilder:BC,mathmlBuilder:HC});dt({type:"genfrac",names:["\\cfrac"],props:{numArgs:2},handler:(i,e)=>{var{parser:t,funcName:n}=i,r=e[0],s=e[1];return{type:"genfrac",mode:t.mode,continued:!0,numer:r,denom:s,hasBarLine:!0,leftDelim:null,rightDelim:null,size:"display",barSize:null}}});dt({type:"infix",names:["\\over","\\choose","\\atop","\\brace","\\brack"],props:{numArgs:0,infix:!0},handler(i){var{parser:e,funcName:t,token:n}=i,r;switch(t){case"\\over":r="\\frac";break;case"\\choose":r="\\binom";break;case"\\atop":r="\\\\atopfrac";break;case"\\brace":r="\\\\bracefrac";break;case"\\brack":r="\\\\brackfrac";break;default:throw new Error("Unrecognized infix genfrac command")}return{type:"infix",mode:e.mode,replaceWith:r,token:n}}});var iL=["display","text","script","scriptscript"],rL=function(e){var t=null;return e.length>0&&(t=e,t=t==="."?null:t),t};dt({type:"genfrac",names:["\\genfrac"],props:{numArgs:6,allowedInArgument:!0,argTypes:["math","math","size","text","math","math"]},handler(i,e){var{parser:t}=i,n=e[4],r=e[5],s=Eb(e[0]),a=s.type==="atom"&&s.family==="open"?rL(s.text):null,o=Eb(e[1]),l=o.type==="atom"&&o.family==="close"?rL(o.text):null,c=Jt(e[2],"size"),u,d=null;c.isBlank?u=!0:(d=c.value,u=d.number>0);var p="auto",m=e[3];if(m.type==="ordgroup"){if(m.body.length>0){var g=Jt(m.body[0],"textord");p=iL[Number(g.text)]}}else m=Jt(m,"textord"),p=iL[Number(m.text)];return{type:"genfrac",mode:t.mode,numer:n,denom:r,continued:!1,hasBarLine:u,barSize:d,leftDelim:a,rightDelim:l,size:p}},htmlBuilder:BC,mathmlBuilder:HC});dt({type:"infix",names:["\\above"],props:{numArgs:1,argTypes:["size"],infix:!0},handler(i,e){var{parser:t,funcName:n,token:r}=i;return{type:"infix",mode:t.mode,replaceWith:"\\\\abovefrac",size:Jt(e[0],"size").value,token:r}}});dt({type:"genfrac",names:["\\\\abovefrac"],props:{numArgs:3,argTypes:["math","size","math"]},handler:(i,e)=>{var{parser:t,funcName:n}=i,r=e[0],s=D_e(Jt(e[1],"infix").size),a=e[2],o=s.number>0;return{type:"genfrac",mode:t.mode,numer:r,denom:a,continued:!1,hasBarLine:o,barSize:s,leftDelim:null,rightDelim:null,size:"auto"}},htmlBuilder:BC,mathmlBuilder:HC});var vW=(i,e)=>{var t=e.style,n,r;i.type==="supsub"?(n=i.sup?yn(i.sup,e.havingStyle(t.sup()),e):yn(i.sub,e.havingStyle(t.sub()),e),r=Jt(i.base,"horizBrace")):r=Jt(i,"horizBrace");var s=yn(r.base,e.havingBaseStyle(zt.DISPLAY)),a=xc.svgSpan(r,e),o;if(r.isOver?(o=de.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:s},{type:"kern",size:.1},{type:"elem",elem:a}]},e),o.children[0].children[0].children[1].classes.push("svg-align")):(o=de.makeVList({positionType:"bottom",positionData:s.depth+.1+a.height,children:[{type:"elem",elem:a},{type:"kern",size:.1},{type:"elem",elem:s}]},e),o.children[0].children[0].children[0].classes.push("svg-align")),n){var l=de.makeSpan(["mord",r.isOver?"mover":"munder"],[o],e);r.isOver?o=de.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:l},{type:"kern",size:.2},{type:"elem",elem:n}]},e):o=de.makeVList({positionType:"bottom",positionData:l.depth+.2+n.height+n.depth,children:[{type:"elem",elem:n},{type:"kern",size:.2},{type:"elem",elem:l}]},e)}return de.makeSpan(["mord",r.isOver?"mover":"munder"],[o],e)},iSe=(i,e)=>{var t=xc.mathMLnode(i.label);return new Ve.MathNode(i.isOver?"mover":"munder",[jn(i.base,e),t])};dt({type:"horizBrace",names:["\\overbrace","\\underbrace"],props:{numArgs:1},handler(i,e){var{parser:t,funcName:n}=i;return{type:"horizBrace",mode:t.mode,label:n,isOver:/^\\over/.test(n),base:e[0]}},htmlBuilder:vW,mathmlBuilder:iSe});dt({type:"href",names:["\\href"],props:{numArgs:2,argTypes:["url","original"],allowedInText:!0},handler:(i,e)=>{var{parser:t}=i,n=e[1],r=Jt(e[0],"url").url;return t.settings.isTrusted({command:"\\href",url:r})?{type:"href",mode:t.mode,href:r,body:Ii(n)}:t.formatUnsupportedCmd("\\href")},htmlBuilder:(i,e)=>{var t=Zi(i.body,e,!1);return de.makeAnchor(i.href,[],t,e)},mathmlBuilder:(i,e)=>{var t=Tu(i.body,e);return t instanceof Zs||(t=new Zs("mrow",[t])),t.setAttribute("href",i.href),t}});dt({type:"href",names:["\\url"],props:{numArgs:1,argTypes:["url"],allowedInText:!0},handler:(i,e)=>{var{parser:t}=i,n=Jt(e[0],"url").url;if(!t.settings.isTrusted({command:"\\url",url:n}))return t.formatUnsupportedCmd("\\url");for(var r=[],s=0;s<n.length;s++){var a=n[s];a==="~"&&(a="\\textasciitilde"),r.push({type:"textord",mode:"text",text:a})}var o={type:"text",mode:t.mode,font:"\\texttt",body:r};return{type:"href",mode:t.mode,href:n,body:Ii(o)}}});dt({type:"hbox",names:["\\hbox"],props:{numArgs:1,argTypes:["text"],allowedInText:!0,primitive:!0},handler(i,e){var{parser:t}=i;return{type:"hbox",mode:t.mode,body:Ii(e[0])}},htmlBuilder(i,e){var t=Zi(i.body,e,!1);return de.makeFragment(t)},mathmlBuilder(i,e){return new Ve.MathNode("mrow",Ls(i.body,e))}});dt({type:"html",names:["\\htmlClass","\\htmlId","\\htmlStyle","\\htmlData"],props:{numArgs:2,argTypes:["raw","original"],allowedInText:!0},handler:(i,e)=>{var{parser:t,funcName:n,token:r}=i,s=Jt(e[0],"raw").string,a=e[1];t.settings.strict&&t.settings.reportNonstrict("htmlExtension","HTML extension is disabled on strict mode");var o,l={};switch(n){case"\\htmlClass":l.class=s,o={command:"\\htmlClass",class:s};break;case"\\htmlId":l.id=s,o={command:"\\htmlId",id:s};break;case"\\htmlStyle":l.style=s,o={command:"\\htmlStyle",style:s};break;case"\\htmlData":{for(var c=s.split(","),u=0;u<c.length;u++){var d=c[u],p=d.indexOf("=");if(p<0)throw new Ye("\\htmlData key/value '"+d+"' missing equals sign");var m=d.slice(0,p),g=d.slice(p+1);l["data-"+m.trim()]=g}o={command:"\\htmlData",attributes:l};break}default:throw new Error("Unrecognized html command")}return t.settings.isTrusted(o)?{type:"html",mode:t.mode,attributes:l,body:Ii(a)}:t.formatUnsupportedCmd(n)},htmlBuilder:(i,e)=>{var t=Zi(i.body,e,!1),n=["enclosing"];i.attributes.class&&n.push(...i.attributes.class.trim().split(/\s+/));var r=de.makeSpan(n,t,e);for(var s in i.attributes)s!=="class"&&i.attributes.hasOwnProperty(s)&&r.setAttribute(s,i.attributes[s]);return r},mathmlBuilder:(i,e)=>Tu(i.body,e)});dt({type:"htmlmathml",names:["\\html@mathml"],props:{numArgs:2,allowedInText:!0},handler:(i,e)=>{var{parser:t}=i;return{type:"htmlmathml",mode:t.mode,html:Ii(e[0]),mathml:Ii(e[1])}},htmlBuilder:(i,e)=>{var t=Zi(i.html,e,!1);return de.makeFragment(t)},mathmlBuilder:(i,e)=>Tu(i.mathml,e)});var mM=function(e){if(/^[-+]? *(\d+(\.\d*)?|\.\d+)$/.test(e))return{number:+e,unit:"bp"};var t=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(e);if(!t)throw new Ye("Invalid size: '"+e+"' in \\includegraphics");var n={number:+(t[1]+t[2]),unit:t[3]};if(!UG(n))throw new Ye("Invalid unit: '"+n.unit+"' in \\includegraphics.");return n};dt({type:"includegraphics",names:["\\includegraphics"],props:{numArgs:1,numOptionalArgs:1,argTypes:["raw","url"],allowedInText:!1},handler:(i,e,t)=>{var{parser:n}=i,r={number:0,unit:"em"},s={number:.9,unit:"em"},a={number:0,unit:"em"},o="";if(t[0])for(var l=Jt(t[0],"raw").string,c=l.split(","),u=0;u<c.length;u++){var d=c[u].split("=");if(d.length===2){var p=d[1].trim();switch(d[0].trim()){case"alt":o=p;break;case"width":r=mM(p);break;case"height":s=mM(p);break;case"totalheight":a=mM(p);break;default:throw new Ye("Invalid key: '"+d[0]+"' in \\includegraphics.")}}}var m=Jt(e[0],"url").url;return o===""&&(o=m,o=o.replace(/^.*[\\/]/,""),o=o.substring(0,o.lastIndexOf("."))),n.settings.isTrusted({command:"\\includegraphics",url:m})?{type:"includegraphics",mode:n.mode,alt:o,width:r,height:s,totalheight:a,src:m}:n.formatUnsupportedCmd("\\includegraphics")},htmlBuilder:(i,e)=>{var t=hi(i.height,e),n=0;i.totalheight.number>0&&(n=hi(i.totalheight,e)-t);var r=0;i.width.number>0&&(r=hi(i.width,e));var s={height:rt(t+n)};r>0&&(s.width=rt(r)),n>0&&(s.verticalAlign=rt(-n));var a=new i3e(i.src,i.alt,s);return a.height=t,a.depth=n,a},mathmlBuilder:(i,e)=>{var t=new Ve.MathNode("mglyph",[]);t.setAttribute("alt",i.alt);var n=hi(i.height,e),r=0;if(i.totalheight.number>0&&(r=hi(i.totalheight,e)-n,t.setAttribute("valign",rt(-r))),t.setAttribute("height",rt(n+r)),i.width.number>0){var s=hi(i.width,e);t.setAttribute("width",rt(s))}return t.setAttribute("src",i.src),t}});dt({type:"kern",names:["\\kern","\\mkern","\\hskip","\\mskip"],props:{numArgs:1,argTypes:["size"],primitive:!0,allowedInText:!0},handler(i,e){var{parser:t,funcName:n}=i,r=Jt(e[0],"size");if(t.settings.strict){var s=n[1]==="m",a=r.value.unit==="mu";s?(a||t.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+n+" supports only mu units, "+("not "+r.value.unit+" units")),t.mode!=="math"&&t.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+n+" works only in math mode")):a&&t.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+n+" doesn't support mu units")}return{type:"kern",mode:t.mode,dimension:r.value}},htmlBuilder(i,e){return de.makeGlue(i.dimension,e)},mathmlBuilder(i,e){var t=hi(i.dimension,e);return new Ve.SpaceNode(t)}});dt({type:"lap",names:["\\mathllap","\\mathrlap","\\mathclap"],props:{numArgs:1,allowedInText:!0},handler:(i,e)=>{var{parser:t,funcName:n}=i,r=e[0];return{type:"lap",mode:t.mode,alignment:n.slice(5),body:r}},htmlBuilder:(i,e)=>{var t;i.alignment==="clap"?(t=de.makeSpan([],[yn(i.body,e)]),t=de.makeSpan(["inner"],[t],e)):t=de.makeSpan(["inner"],[yn(i.body,e)]);var n=de.makeSpan(["fix"],[]),r=de.makeSpan([i.alignment],[t,n],e),s=de.makeSpan(["strut"]);return s.style.height=rt(r.height+r.depth),r.depth&&(s.style.verticalAlign=rt(-r.depth)),r.children.unshift(s),r=de.makeSpan(["thinbox"],[r],e),de.makeSpan(["mord","vbox"],[r],e)},mathmlBuilder:(i,e)=>{var t=new Ve.MathNode("mpadded",[jn(i.body,e)]);if(i.alignment!=="rlap"){var n=i.alignment==="llap"?"-1":"-0.5";t.setAttribute("lspace",n+"width")}return t.setAttribute("width","0px"),t}});dt({type:"styling",names:["\\(","$"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(i,e){var{funcName:t,parser:n}=i,r=n.mode;n.switchMode("math");var s=t==="\\("?"\\)":"$",a=n.parseExpression(!1,s);return n.expect(s),n.switchMode(r),{type:"styling",mode:n.mode,style:"text",body:a}}});dt({type:"text",names:["\\)","\\]"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(i,e){throw new Ye("Mismatched "+i.funcName)}});var sL=(i,e)=>{switch(e.style.size){case zt.DISPLAY.size:return i.display;case zt.TEXT.size:return i.text;case zt.SCRIPT.size:return i.script;case zt.SCRIPTSCRIPT.size:return i.scriptscript;default:return i.text}};dt({type:"mathchoice",names:["\\mathchoice"],props:{numArgs:4,primitive:!0},handler:(i,e)=>{var{parser:t}=i;return{type:"mathchoice",mode:t.mode,display:Ii(e[0]),text:Ii(e[1]),script:Ii(e[2]),scriptscript:Ii(e[3])}},htmlBuilder:(i,e)=>{var t=sL(i,e),n=Zi(t,e,!1);return de.makeFragment(n)},mathmlBuilder:(i,e)=>{var t=sL(i,e);return Tu(t,e)}});var bW=(i,e,t,n,r,s,a)=>{i=de.makeSpan([],[i]);var o=t&&wn.isCharacterBox(t),l,c;if(e){var u=yn(e,n.havingStyle(r.sup()),n);c={elem:u,kern:Math.max(n.fontMetrics().bigOpSpacing1,n.fontMetrics().bigOpSpacing3-u.depth)}}if(t){var d=yn(t,n.havingStyle(r.sub()),n);l={elem:d,kern:Math.max(n.fontMetrics().bigOpSpacing2,n.fontMetrics().bigOpSpacing4-d.height)}}var p;if(c&&l){var m=n.fontMetrics().bigOpSpacing5+l.elem.height+l.elem.depth+l.kern+i.depth+a;p=de.makeVList({positionType:"bottom",positionData:m,children:[{type:"kern",size:n.fontMetrics().bigOpSpacing5},{type:"elem",elem:l.elem,marginLeft:rt(-s)},{type:"kern",size:l.kern},{type:"elem",elem:i},{type:"kern",size:c.kern},{type:"elem",elem:c.elem,marginLeft:rt(s)},{type:"kern",size:n.fontMetrics().bigOpSpacing5}]},n)}else if(l){var g=i.height-a;p=de.makeVList({positionType:"top",positionData:g,children:[{type:"kern",size:n.fontMetrics().bigOpSpacing5},{type:"elem",elem:l.elem,marginLeft:rt(-s)},{type:"kern",size:l.kern},{type:"elem",elem:i}]},n)}else if(c){var y=i.depth+a;p=de.makeVList({positionType:"bottom",positionData:y,children:[{type:"elem",elem:i},{type:"kern",size:c.kern},{type:"elem",elem:c.elem,marginLeft:rt(s)},{type:"kern",size:n.fontMetrics().bigOpSpacing5}]},n)}else return i;var x=[p];if(l&&s!==0&&!o){var _=de.makeSpan(["mspace"],[],n);_.style.marginRight=rt(s),x.unshift(_)}return de.makeSpan(["mop","op-limits"],x,n)},_W=["\\smallint"],G0=(i,e)=>{var t,n,r=!1,s;i.type==="supsub"?(t=i.sup,n=i.sub,s=Jt(i.base,"op"),r=!0):s=Jt(i,"op");var a=e.style,o=!1;a.size===zt.DISPLAY.size&&s.symbol&&!_W.includes(s.name)&&(o=!0);var l;if(s.symbol){var c=o?"Size2-Regular":"Size1-Regular",u="";if((s.name==="\\oiint"||s.name==="\\oiiint")&&(u=s.name.slice(1),s.name=u==="oiint"?"\\iint":"\\iiint"),l=de.makeSymbol(s.name,c,"math",e,["mop","op-symbol",o?"large-op":"small-op"]),u.length>0){var d=l.italic,p=de.staticSvg(u+"Size"+(o?"2":"1"),e);l=de.makeVList({positionType:"individualShift",children:[{type:"elem",elem:l,shift:0},{type:"elem",elem:p,shift:o?.08:0}]},e),s.name="\\"+u,l.classes.unshift("mop"),l.italic=d}}else if(s.body){var m=Zi(s.body,e,!0);m.length===1&&m[0]instanceof Ua?(l=m[0],l.classes[0]="mop"):l=de.makeSpan(["mop"],m,e)}else{for(var g=[],y=1;y<s.name.length;y++)g.push(de.mathsym(s.name[y],s.mode,e));l=de.makeSpan(["mop"],g,e)}var x=0,_=0;return(l instanceof Ua||s.name==="\\oiint"||s.name==="\\oiiint")&&!s.suppressBaseShift&&(x=(l.height-l.depth)/2-e.fontMetrics().axisHeight,_=l.italic),r?bW(l,t,n,e,a,_,x):(x&&(l.style.position="relative",l.style.top=rt(x)),l)},ux=(i,e)=>{var t;if(i.symbol)t=new Zs("mo",[Fa(i.name,i.mode)]),_W.includes(i.name)&&t.setAttribute("largeop","false");else if(i.body)t=new Zs("mo",Ls(i.body,e));else{t=new Zs("mi",[new Wo(i.name.slice(1))]);var n=new Zs("mo",[Fa("","text")]);i.parentIsSupSub?t=new Zs("mrow",[t,n]):t=$G([t,n])}return t},rSe={"":"\\prod","":"\\coprod","":"\\sum","":"\\bigwedge","":"\\bigvee","":"\\bigcap","":"\\bigcup","":"\\bigodot","":"\\bigoplus","":"\\bigotimes","":"\\biguplus","":"\\bigsqcup"};dt({type:"op",names:["\\coprod","\\bigvee","\\bigwedge","\\biguplus","\\bigcap","\\bigcup","\\intop","\\prod","\\sum","\\bigotimes","\\bigoplus","\\bigodot","\\bigsqcup","\\smallint","","","","","","","","","","","",""],props:{numArgs:0},handler:(i,e)=>{var{parser:t,funcName:n}=i,r=n;return r.length===1&&(r=rSe[r]),{type:"op",mode:t.mode,limits:!0,parentIsSupSub:!1,symbol:!0,name:r}},htmlBuilder:G0,mathmlBuilder:ux});dt({type:"op",names:["\\mathop"],props:{numArgs:1,primitive:!0},handler:(i,e)=>{var{parser:t}=i,n=e[0];return{type:"op",mode:t.mode,limits:!1,parentIsSupSub:!1,symbol:!1,body:Ii(n)}},htmlBuilder:G0,mathmlBuilder:ux});var sSe={"":"\\int","":"\\iint","":"\\iiint","":"\\oint","":"\\oiint","":"\\oiiint"};dt({type:"op",names:["\\arcsin","\\arccos","\\arctan","\\arctg","\\arcctg","\\arg","\\ch","\\cos","\\cosec","\\cosh","\\cot","\\cotg","\\coth","\\csc","\\ctg","\\cth","\\deg","\\dim","\\exp","\\hom","\\ker","\\lg","\\ln","\\log","\\sec","\\sin","\\sinh","\\sh","\\tan","\\tanh","\\tg","\\th"],props:{numArgs:0},handler(i){var{parser:e,funcName:t}=i;return{type:"op",mode:e.mode,limits:!1,parentIsSupSub:!1,symbol:!1,name:t}},htmlBuilder:G0,mathmlBuilder:ux});dt({type:"op",names:["\\det","\\gcd","\\inf","\\lim","\\max","\\min","\\Pr","\\sup"],props:{numArgs:0},handler(i){var{parser:e,funcName:t}=i;return{type:"op",mode:e.mode,limits:!0,parentIsSupSub:!1,symbol:!1,name:t}},htmlBuilder:G0,mathmlBuilder:ux});dt({type:"op",names:["\\int","\\iint","\\iiint","\\oint","\\oiint","\\oiiint","","","","","",""],props:{numArgs:0,allowedInArgument:!0},handler(i){var{parser:e,funcName:t}=i,n=t;return n.length===1&&(n=sSe[n]),{type:"op",mode:e.mode,limits:!1,parentIsSupSub:!1,symbol:!0,name:n}},htmlBuilder:G0,mathmlBuilder:ux});var SW=(i,e)=>{var t,n,r=!1,s;i.type==="supsub"?(t=i.sup,n=i.sub,s=Jt(i.base,"operatorname"),r=!0):s=Jt(i,"operatorname");var a;if(s.body.length>0){for(var o=s.body.map(d=>{var p=d.text;return typeof p=="string"?{type:"textord",mode:d.mode,text:p}:d}),l=Zi(o,e.withFont("mathrm"),!0),c=0;c<l.length;c++){var u=l[c];u instanceof Ua&&(u.text=u.text.replace(/\u2212/,"-").replace(/\u2217/,"*"))}a=de.makeSpan(["mop"],l,e)}else a=de.makeSpan(["mop"],[],e);return r?bW(a,t,n,e,e.style,0,0):a},aSe=(i,e)=>{for(var t=Ls(i.body,e.withFont("mathrm")),n=!0,r=0;r<t.length;r++){var s=t[r];if(!(s instanceof Ve.SpaceNode))if(s instanceof Ve.MathNode)switch(s.type){case"mi":case"mn":case"ms":case"mspace":case"mtext":break;case"mo":{var a=s.children[0];s.children.length===1&&a instanceof Ve.TextNode?a.text=a.text.replace(/\u2212/,"-").replace(/\u2217/,"*"):n=!1;break}default:n=!1}else n=!1}if(n){var o=t.map(u=>u.toText()).join("");t=[new Ve.TextNode(o)]}var l=new Ve.MathNode("mi",t);l.setAttribute("mathvariant","normal");var c=new Ve.MathNode("mo",[Fa("","text")]);return i.parentIsSupSub?new Ve.MathNode("mrow",[l,c]):Ve.newDocumentFragment([l,c])};dt({type:"operatorname",names:["\\operatorname@","\\operatornamewithlimits"],props:{numArgs:1},handler:(i,e)=>{var{parser:t,funcName:n}=i,r=e[0];return{type:"operatorname",mode:t.mode,body:Ii(r),alwaysHandleSupSub:n==="\\operatornamewithlimits",limits:!1,parentIsSupSub:!1}},htmlBuilder:SW,mathmlBuilder:aSe});W("\\operatorname","\\@ifstar\\operatornamewithlimits\\operatorname@");bd({type:"ordgroup",htmlBuilder(i,e){return i.semisimple?de.makeFragment(Zi(i.body,e,!1)):de.makeSpan(["mord"],Zi(i.body,e,!0),e)},mathmlBuilder(i,e){return Tu(i.body,e,!0)}});dt({type:"overline",names:["\\overline"],props:{numArgs:1},handler(i,e){var{parser:t}=i,n=e[0];return{type:"overline",mode:t.mode,body:n}},htmlBuilder(i,e){var t=yn(i.body,e.havingCrampedStyle()),n=de.makeLineSpan("overline-line",e),r=e.fontMetrics().defaultRuleThickness,s=de.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:t},{type:"kern",size:3*r},{type:"elem",elem:n},{type:"kern",size:r}]},e);return de.makeSpan(["mord","overline"],[s],e)},mathmlBuilder(i,e){var t=new Ve.MathNode("mo",[new Ve.TextNode("")]);t.setAttribute("stretchy","true");var n=new Ve.MathNode("mover",[jn(i.body,e),t]);return n.setAttribute("accent","true"),n}});dt({type:"phantom",names:["\\phantom"],props:{numArgs:1,allowedInText:!0},handler:(i,e)=>{var{parser:t}=i,n=e[0];return{type:"phantom",mode:t.mode,body:Ii(n)}},htmlBuilder:(i,e)=>{var t=Zi(i.body,e.withPhantom(),!1);return de.makeFragment(t)},mathmlBuilder:(i,e)=>{var t=Ls(i.body,e);return new Ve.MathNode("mphantom",t)}});dt({type:"hphantom",names:["\\hphantom"],props:{numArgs:1,allowedInText:!0},handler:(i,e)=>{var{parser:t}=i,n=e[0];return{type:"hphantom",mode:t.mode,body:n}},htmlBuilder:(i,e)=>{var t=de.makeSpan([],[yn(i.body,e.withPhantom())]);if(t.height=0,t.depth=0,t.children)for(var n=0;n<t.children.length;n++)t.children[n].height=0,t.children[n].depth=0;return t=de.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:t}]},e),de.makeSpan(["mord"],[t],e)},mathmlBuilder:(i,e)=>{var t=Ls(Ii(i.body),e),n=new Ve.MathNode("mphantom",t),r=new Ve.MathNode("mpadded",[n]);return r.setAttribute("height","0px"),r.setAttribute("depth","0px"),r}});dt({type:"vphantom",names:["\\vphantom"],props:{numArgs:1,allowedInText:!0},handler:(i,e)=>{var{parser:t}=i,n=e[0];return{type:"vphantom",mode:t.mode,body:n}},htmlBuilder:(i,e)=>{var t=de.makeSpan(["inner"],[yn(i.body,e.withPhantom())]),n=de.makeSpan(["fix"],[]);return de.makeSpan(["mord","rlap"],[t,n],e)},mathmlBuilder:(i,e)=>{var t=Ls(Ii(i.body),e),n=new Ve.MathNode("mphantom",t),r=new Ve.MathNode("mpadded",[n]);return r.setAttribute("width","0px"),r}});dt({type:"raisebox",names:["\\raisebox"],props:{numArgs:2,argTypes:["size","hbox"],allowedInText:!0},handler(i,e){var{parser:t}=i,n=Jt(e[0],"size").value,r=e[1];return{type:"raisebox",mode:t.mode,dy:n,body:r}},htmlBuilder(i,e){var t=yn(i.body,e),n=hi(i.dy,e);return de.makeVList({positionType:"shift",positionData:-n,children:[{type:"elem",elem:t}]},e)},mathmlBuilder(i,e){var t=new Ve.MathNode("mpadded",[jn(i.body,e)]),n=i.dy.number+i.dy.unit;return t.setAttribute("voffset",n),t}});dt({type:"internal",names:["\\relax"],props:{numArgs:0,allowedInText:!0,allowedInArgument:!0},handler(i){var{parser:e}=i;return{type:"internal",mode:e.mode}}});dt({type:"rule",names:["\\rule"],props:{numArgs:2,numOptionalArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["size","size","size"]},handler(i,e,t){var{parser:n}=i,r=t[0],s=Jt(e[0],"size"),a=Jt(e[1],"size");return{type:"rule",mode:n.mode,shift:r&&Jt(r,"size").value,width:s.value,height:a.value}},htmlBuilder(i,e){var t=de.makeSpan(["mord","rule"],[],e),n=hi(i.width,e),r=hi(i.height,e),s=i.shift?hi(i.shift,e):0;return t.style.borderRightWidth=rt(n),t.style.borderTopWidth=rt(r),t.style.bottom=rt(s),t.width=n,t.height=r+s,t.depth=-s,t.maxFontSize=r*1.125*e.sizeMultiplier,t},mathmlBuilder(i,e){var t=hi(i.width,e),n=hi(i.height,e),r=i.shift?hi(i.shift,e):0,s=e.color&&e.getColor()||"black",a=new Ve.MathNode("mspace");a.setAttribute("mathbackground",s),a.setAttribute("width",rt(t)),a.setAttribute("height",rt(n));var o=new Ve.MathNode("mpadded",[a]);return r>=0?o.setAttribute("height",rt(r)):(o.setAttribute("height",rt(r)),o.setAttribute("depth",rt(-r))),o.setAttribute("voffset",rt(r)),o}});function wW(i,e,t){for(var n=Zi(i,e,!1),r=e.sizeMultiplier/t.sizeMultiplier,s=0;s<n.length;s++){var a=n[s].classes.indexOf("sizing");a<0?Array.prototype.push.apply(n[s].classes,e.sizingClasses(t)):n[s].classes[a+1]==="reset-size"+e.size&&(n[s].classes[a+1]="reset-size"+t.size),n[s].height*=r,n[s].depth*=r}return de.makeFragment(n)}var aL=["\\tiny","\\sixptsize","\\scriptsize","\\footnotesize","\\small","\\normalsize","\\large","\\Large","\\LARGE","\\huge","\\Huge"],oSe=(i,e)=>{var t=e.havingSize(i.size);return wW(i.body,t,e)};dt({type:"sizing",names:aL,props:{numArgs:0,allowedInText:!0},handler:(i,e)=>{var{breakOnTokenText:t,funcName:n,parser:r}=i,s=r.parseExpression(!1,t);return{type:"sizing",mode:r.mode,size:aL.indexOf(n)+1,body:s}},htmlBuilder:oSe,mathmlBuilder:(i,e)=>{var t=e.havingSize(i.size),n=Ls(i.body,t),r=new Ve.MathNode("mstyle",n);return r.setAttribute("mathsize",rt(t.sizeMultiplier)),r}});dt({type:"smash",names:["\\smash"],props:{numArgs:1,numOptionalArgs:1,allowedInText:!0},handler:(i,e,t)=>{var{parser:n}=i,r=!1,s=!1,a=t[0]&&Jt(t[0],"ordgroup");if(a)for(var o="",l=0;l<a.body.length;++l){var c=a.body[l];if(o=c.text,o==="t")r=!0;else if(o==="b")s=!0;else{r=!1,s=!1;break}}else r=!0,s=!0;var u=e[0];return{type:"smash",mode:n.mode,body:u,smashHeight:r,smashDepth:s}},htmlBuilder:(i,e)=>{var t=de.makeSpan([],[yn(i.body,e)]);if(!i.smashHeight&&!i.smashDepth)return t;if(i.smashHeight&&(t.height=0,t.children))for(var n=0;n<t.children.length;n++)t.children[n].height=0;if(i.smashDepth&&(t.depth=0,t.children))for(var r=0;r<t.children.length;r++)t.children[r].depth=0;var s=de.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:t}]},e);return de.makeSpan(["mord"],[s],e)},mathmlBuilder:(i,e)=>{var t=new Ve.MathNode("mpadded",[jn(i.body,e)]);return i.smashHeight&&t.setAttribute("height","0px"),i.smashDepth&&t.setAttribute("depth","0px"),t}});dt({type:"sqrt",names:["\\sqrt"],props:{numArgs:1,numOptionalArgs:1},handler(i,e,t){var{parser:n}=i,r=t[0],s=e[0];return{type:"sqrt",mode:n.mode,body:s,index:r}},htmlBuilder(i,e){var t=yn(i.body,e.havingCrampedStyle());t.height===0&&(t.height=e.fontMetrics().xHeight),t=de.wrapFragment(t,e);var n=e.fontMetrics(),r=n.defaultRuleThickness,s=r;e.style.id<zt.TEXT.id&&(s=e.fontMetrics().xHeight);var a=r+s/4,o=t.height+t.depth+a+r,{span:l,ruleWidth:c,advanceWidth:u}=ac.sqrtImage(o,e),d=l.height-c;d>t.height+t.depth+a&&(a=(a+d-t.height-t.depth)/2);var p=l.height-t.height-a-c;t.style.paddingLeft=rt(u);var m=de.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:t,wrapperClasses:["svg-align"]},{type:"kern",size:-(t.height+p)},{type:"elem",elem:l},{type:"kern",size:c}]},e);if(i.index){var g=e.havingStyle(zt.SCRIPTSCRIPT),y=yn(i.index,g,e),x=.6*(m.height-m.depth),_=de.makeVList({positionType:"shift",positionData:-x,children:[{type:"elem",elem:y}]},e),S=de.makeSpan(["root"],[_]);return de.makeSpan(["mord","sqrt"],[S,m],e)}else return de.makeSpan(["mord","sqrt"],[m],e)},mathmlBuilder(i,e){var{body:t,index:n}=i;return n?new Ve.MathNode("mroot",[jn(t,e),jn(n,e)]):new Ve.MathNode("msqrt",[jn(t,e)])}});var oL={display:zt.DISPLAY,text:zt.TEXT,script:zt.SCRIPT,scriptscript:zt.SCRIPTSCRIPT};dt({type:"styling",names:["\\displaystyle","\\textstyle","\\scriptstyle","\\scriptscriptstyle"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(i,e){var{breakOnTokenText:t,funcName:n,parser:r}=i,s=r.parseExpression(!0,t),a=n.slice(1,n.length-5);return{type:"styling",mode:r.mode,style:a,body:s}},htmlBuilder(i,e){var t=oL[i.style],n=e.havingStyle(t).withFont("");return wW(i.body,n,e)},mathmlBuilder(i,e){var t=oL[i.style],n=e.havingStyle(t),r=Ls(i.body,n),s=new Ve.MathNode("mstyle",r),a={display:["0","true"],text:["0","false"],script:["1","false"],scriptscript:["2","false"]},o=a[i.style];return s.setAttribute("scriptlevel",o[0]),s.setAttribute("displaystyle",o[1]),s}});var lSe=function(e,t){var n=e.base;if(n)if(n.type==="op"){var r=n.limits&&(t.style.size===zt.DISPLAY.size||n.alwaysHandleSupSub);return r?G0:null}else if(n.type==="operatorname"){var s=n.alwaysHandleSupSub&&(t.style.size===zt.DISPLAY.size||n.limits);return s?SW:null}else{if(n.type==="accent")return wn.isCharacterBox(n.base)?LC:null;if(n.type==="horizBrace"){var a=!e.sub;return a===n.isOver?vW:null}else return null}else return null};bd({type:"supsub",htmlBuilder(i,e){var t=lSe(i,e);if(t)return t(i,e);var{base:n,sup:r,sub:s}=i,a=yn(n,e),o,l,c=e.fontMetrics(),u=0,d=0,p=n&&wn.isCharacterBox(n);if(r){var m=e.havingStyle(e.style.sup());o=yn(r,m,e),p||(u=a.height-m.fontMetrics().supDrop*m.sizeMultiplier/e.sizeMultiplier)}if(s){var g=e.havingStyle(e.style.sub());l=yn(s,g,e),p||(d=a.depth+g.fontMetrics().subDrop*g.sizeMultiplier/e.sizeMultiplier)}var y;e.style===zt.DISPLAY?y=c.sup1:e.style.cramped?y=c.sup3:y=c.sup2;var x=e.sizeMultiplier,_=rt(.5/c.ptPerEm/x),S=null;if(l){var w=i.base&&i.base.type==="op"&&i.base.name&&(i.base.name==="\\oiint"||i.base.name==="\\oiiint");(a instanceof Ua||w)&&(S=rt(-a.italic))}var T;if(o&&l){u=Math.max(u,y,o.depth+.25*c.xHeight),d=Math.max(d,c.sub2);var C=c.defaultRuleThickness,E=4*C;if(u-o.depth-(l.height-d)<E){d=E-(u-o.depth)+l.height;var D=.8*c.xHeight-(u-o.depth);D>0&&(u+=D,d-=D)}var O=[{type:"elem",elem:l,shift:d,marginRight:_,marginLeft:S},{type:"elem",elem:o,shift:-u,marginRight:_}];T=de.makeVList({positionType:"individualShift",children:O},e)}else if(l){d=Math.max(d,c.sub1,l.height-.8*c.xHeight);var R=[{type:"elem",elem:l,marginLeft:S,marginRight:_}];T=de.makeVList({positionType:"shift",positionData:d,children:R},e)}else if(o)u=Math.max(u,y,o.depth+.25*c.xHeight),T=de.makeVList({positionType:"shift",positionData:-u,children:[{type:"elem",elem:o,marginRight:_}]},e);else throw new Error("supsub must have either sup or sub.");var P=w6(a,"right")||"mord";return de.makeSpan([P],[a,de.makeSpan(["msupsub"],[T])],e)},mathmlBuilder(i,e){var t=!1,n,r;i.base&&i.base.type==="horizBrace"&&(r=!!i.sup,r===i.base.isOver&&(t=!0,n=i.base.isOver)),i.base&&(i.base.type==="op"||i.base.type==="operatorname")&&(i.base.parentIsSupSub=!0);var s=[jn(i.base,e)];i.sub&&s.push(jn(i.sub,e)),i.sup&&s.push(jn(i.sup,e));var a;if(t)a=n?"mover":"munder";else if(i.sub)if(i.sup){var c=i.base;c&&c.type==="op"&&c.limits&&e.style===zt.DISPLAY||c&&c.type==="operatorname"&&c.alwaysHandleSupSub&&(e.style===zt.DISPLAY||c.limits)?a="munderover":a="msubsup"}else{var l=i.base;l&&l.type==="op"&&l.limits&&(e.style===zt.DISPLAY||l.alwaysHandleSupSub)||l&&l.type==="operatorname"&&l.alwaysHandleSupSub&&(l.limits||e.style===zt.DISPLAY)?a="munder":a="msub"}else{var o=i.base;o&&o.type==="op"&&o.limits&&(e.style===zt.DISPLAY||o.alwaysHandleSupSub)||o&&o.type==="operatorname"&&o.alwaysHandleSupSub&&(o.limits||e.style===zt.DISPLAY)?a="mover":a="msup"}return new Ve.MathNode(a,s)}});bd({type:"atom",htmlBuilder(i,e){return de.mathsym(i.text,i.mode,e,["m"+i.family])},mathmlBuilder(i,e){var t=new Ve.MathNode("mo",[Fa(i.text,i.mode)]);if(i.family==="bin"){var n=DC(i,e);n==="bold-italic"&&t.setAttribute("mathvariant",n)}else i.family==="punct"?t.setAttribute("separator","true"):(i.family==="open"||i.family==="close")&&t.setAttribute("stretchy","false");return t}});var MW={mi:"italic",mn:"normal",mtext:"normal"};bd({type:"mathord",htmlBuilder(i,e){return de.makeOrd(i,e,"mathord")},mathmlBuilder(i,e){var t=new Ve.MathNode("mi",[Fa(i.text,i.mode,e)]),n=DC(i,e)||"italic";return n!==MW[t.type]&&t.setAttribute("mathvariant",n),t}});bd({type:"textord",htmlBuilder(i,e){return de.makeOrd(i,e,"textord")},mathmlBuilder(i,e){var t=Fa(i.text,i.mode,e),n=DC(i,e)||"normal",r;return i.mode==="text"?r=new Ve.MathNode("mtext",[t]):/[0-9]/.test(i.text)?r=new Ve.MathNode("mn",[t]):i.text==="\\prime"?r=new Ve.MathNode("mo",[t]):r=new Ve.MathNode("mi",[t]),n!==MW[r.type]&&r.setAttribute("mathvariant",n),r}});var gM={"\\nobreak":"nobreak","\\allowbreak":"allowbreak"},xM={" ":{},"\\ ":{},"~":{className:"nobreak"},"\\space":{},"\\nobreakspace":{className:"nobreak"}};bd({type:"spacing",htmlBuilder(i,e){if(xM.hasOwnProperty(i.text)){var t=xM[i.text].className||"";if(i.mode==="text"){var n=de.makeOrd(i,e,"textord");return n.classes.push(t),n}else return de.makeSpan(["mspace",t],[de.mathsym(i.text,i.mode,e)],e)}else{if(gM.hasOwnProperty(i.text))return de.makeSpan(["mspace",gM[i.text]],[],e);throw new Ye('Unknown type of space "'+i.text+'"')}},mathmlBuilder(i,e){var t;if(xM.hasOwnProperty(i.text))t=new Ve.MathNode("mtext",[new Ve.TextNode("")]);else{if(gM.hasOwnProperty(i.text))return new Ve.MathNode("mspace");throw new Ye('Unknown type of space "'+i.text+'"')}return t}});var lL=()=>{var i=new Ve.MathNode("mtd",[]);return i.setAttribute("width","50%"),i};bd({type:"tag",mathmlBuilder(i,e){var t=new Ve.MathNode("mtable",[new Ve.MathNode("mtr",[lL(),new Ve.MathNode("mtd",[Tu(i.body,e)]),lL(),new Ve.MathNode("mtd",[Tu(i.tag,e)])])]);return t.setAttribute("width","100%"),t}});var cL={"\\text":void 0,"\\textrm":"textrm","\\textsf":"textsf","\\texttt":"texttt","\\textnormal":"textrm"},uL={"\\textbf":"textbf","\\textmd":"textmd"},cSe={"\\textit":"textit","\\textup":"textup"},hL=(i,e)=>{var t=i.font;if(t){if(cL[t])return e.withTextFontFamily(cL[t]);if(uL[t])return e.withTextFontWeight(uL[t]);if(t==="\\emph")return e.fontShape==="textit"?e.withTextFontShape("textup"):e.withTextFontShape("textit")}else return e;return e.withTextFontShape(cSe[t])};dt({type:"text",names:["\\text","\\textrm","\\textsf","\\texttt","\\textnormal","\\textbf","\\textmd","\\textit","\\textup","\\emph"],props:{numArgs:1,argTypes:["text"],allowedInArgument:!0,allowedInText:!0},handler(i,e){var{parser:t,funcName:n}=i,r=e[0];return{type:"text",mode:t.mode,body:Ii(r),font:n}},htmlBuilder(i,e){var t=hL(i,e),n=Zi(i.body,t,!0);return de.makeSpan(["mord","text"],n,t)},mathmlBuilder(i,e){var t=hL(i,e);return Tu(i.body,t)}});dt({type:"underline",names:["\\underline"],props:{numArgs:1,allowedInText:!0},handler(i,e){var{parser:t}=i;return{type:"underline",mode:t.mode,body:e[0]}},htmlBuilder(i,e){var t=yn(i.body,e),n=de.makeLineSpan("underline-line",e),r=e.fontMetrics().defaultRuleThickness,s=de.makeVList({positionType:"top",positionData:t.height,children:[{type:"kern",size:r},{type:"elem",elem:n},{type:"kern",size:3*r},{type:"elem",elem:t}]},e);return de.makeSpan(["mord","underline"],[s],e)},mathmlBuilder(i,e){var t=new Ve.MathNode("mo",[new Ve.TextNode("")]);t.setAttribute("stretchy","true");var n=new Ve.MathNode("munder",[jn(i.body,e),t]);return n.setAttribute("accentunder","true"),n}});dt({type:"vcenter",names:["\\vcenter"],props:{numArgs:1,argTypes:["original"],allowedInText:!1},handler(i,e){var{parser:t}=i;return{type:"vcenter",mode:t.mode,body:e[0]}},htmlBuilder(i,e){var t=yn(i.body,e),n=e.fontMetrics().axisHeight,r=.5*(t.height-n-(t.depth+n));return de.makeVList({positionType:"shift",positionData:r,children:[{type:"elem",elem:t}]},e)},mathmlBuilder(i,e){return new Ve.MathNode("mpadded",[jn(i.body,e)],["vcenter"])}});dt({type:"verb",names:["\\verb"],props:{numArgs:0,allowedInText:!0},handler(i,e,t){throw new Ye("\\verb ended by end of line instead of matching delimiter")},htmlBuilder(i,e){for(var t=dL(i),n=[],r=e.havingStyle(e.style.text()),s=0;s<t.length;s++){var a=t[s];a==="~"&&(a="\\textasciitilde"),n.push(de.makeSymbol(a,"Typewriter-Regular",i.mode,r,["mord","texttt"]))}return de.makeSpan(["mord","text"].concat(r.sizingClasses(e)),de.tryCombineChars(n),r)},mathmlBuilder(i,e){var t=new Ve.TextNode(dL(i)),n=new Ve.MathNode("mtext",[t]);return n.setAttribute("mathvariant","monospace"),n}});var dL=i=>i.body.replace(/ /g,i.star?"":""),ou=XG,TW=`[ \r
	]`,uSe="\\\\[a-zA-Z@]+",hSe="\\\\[^\uD800-\uDFFF]",dSe="("+uSe+")"+TW+"*",fSe=`\\\\(
|[ \r	]+
?)[ \r	]*`,C6="[-]",pSe=new RegExp(C6+"+$"),mSe="("+TW+"+)|"+(fSe+"|")+"([!-\\[\\]---]"+(C6+"*")+"|[\uD800-\uDBFF][\uDC00-\uDFFF]"+(C6+"*")+"|\\\\verb\\*([^]).*?\\4|\\\\verb([^*a-zA-Z]).*?\\5"+("|"+dSe)+("|"+hSe+")");class fL{constructor(e,t){this.input=void 0,this.settings=void 0,this.tokenRegex=void 0,this.catcodes=void 0,this.input=e,this.settings=t,this.tokenRegex=new RegExp(mSe,"g"),this.catcodes={"%":14,"~":13}}setCatcode(e,t){this.catcodes[e]=t}lex(){var e=this.input,t=this.tokenRegex.lastIndex;if(t===e.length)return new ra("EOF",new bs(this,t,t));var n=this.tokenRegex.exec(e);if(n===null||n.index!==t)throw new Ye("Unexpected character: '"+e[t]+"'",new ra(e[t],new bs(this,t,t+1)));var r=n[6]||n[3]||(n[2]?"\\ ":" ");if(this.catcodes[r]===14){var s=e.indexOf(`
`,this.tokenRegex.lastIndex);return s===-1?(this.tokenRegex.lastIndex=e.length,this.settings.reportNonstrict("commentAtEnd","% comment has no terminating newline; LaTeX would fail because of commenting the end of math mode (e.g. $)")):this.tokenRegex.lastIndex=s+1,this.lex()}return new ra(r,new bs(this,t,this.tokenRegex.lastIndex))}}class gSe{constructor(e,t){e===void 0&&(e={}),t===void 0&&(t={}),this.current=void 0,this.builtins=void 0,this.undefStack=void 0,this.current=t,this.builtins=e,this.undefStack=[]}beginGroup(){this.undefStack.push({})}endGroup(){if(this.undefStack.length===0)throw new Ye("Unbalanced namespace destruction: attempt to pop global namespace; please report this as a bug");var e=this.undefStack.pop();for(var t in e)e.hasOwnProperty(t)&&(e[t]==null?delete this.current[t]:this.current[t]=e[t])}endGroups(){for(;this.undefStack.length>0;)this.endGroup()}has(e){return this.current.hasOwnProperty(e)||this.builtins.hasOwnProperty(e)}get(e){return this.current.hasOwnProperty(e)?this.current[e]:this.builtins[e]}set(e,t,n){if(n===void 0&&(n=!1),n){for(var r=0;r<this.undefStack.length;r++)delete this.undefStack[r][e];this.undefStack.length>0&&(this.undefStack[this.undefStack.length-1][e]=t)}else{var s=this.undefStack[this.undefStack.length-1];s&&!s.hasOwnProperty(e)&&(s[e]=this.current[e])}t==null?delete this.current[e]:this.current[e]=t}}var xSe=pW;W("\\noexpand",function(i){var e=i.popToken();return i.isExpandable(e.text)&&(e.noexpand=!0,e.treatAsRelax=!0),{tokens:[e],numArgs:0}});W("\\expandafter",function(i){var e=i.popToken();return i.expandOnce(!0),{tokens:[e],numArgs:0}});W("\\@firstoftwo",function(i){var e=i.consumeArgs(2);return{tokens:e[0],numArgs:0}});W("\\@secondoftwo",function(i){var e=i.consumeArgs(2);return{tokens:e[1],numArgs:0}});W("\\@ifnextchar",function(i){var e=i.consumeArgs(3);i.consumeSpaces();var t=i.future();return e[0].length===1&&e[0][0].text===t.text?{tokens:e[1],numArgs:0}:{tokens:e[2],numArgs:0}});W("\\@ifstar","\\@ifnextchar *{\\@firstoftwo{#1}}");W("\\TextOrMath",function(i){var e=i.consumeArgs(2);return i.mode==="text"?{tokens:e[0],numArgs:0}:{tokens:e[1],numArgs:0}});var pL={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};W("\\char",function(i){var e=i.popToken(),t,n="";if(e.text==="'")t=8,e=i.popToken();else if(e.text==='"')t=16,e=i.popToken();else if(e.text==="`")if(e=i.popToken(),e.text[0]==="\\")n=e.text.charCodeAt(1);else{if(e.text==="EOF")throw new Ye("\\char` missing argument");n=e.text.charCodeAt(0)}else t=10;if(t){if(n=pL[e.text],n==null||n>=t)throw new Ye("Invalid base-"+t+" digit "+e.text);for(var r;(r=pL[i.future().text])!=null&&r<t;)n*=t,n+=r,i.popToken()}return"\\@char{"+n+"}"});var jC=(i,e,t,n)=>{var r=i.consumeArg().tokens;if(r.length!==1)throw new Ye("\\newcommand's first argument must be a macro name");var s=r[0].text,a=i.isDefined(s);if(a&&!e)throw new Ye("\\newcommand{"+s+"} attempting to redefine "+(s+"; use \\renewcommand"));if(!a&&!t)throw new Ye("\\renewcommand{"+s+"} when command "+s+" does not yet exist; use \\newcommand");var o=0;if(r=i.consumeArg().tokens,r.length===1&&r[0].text==="["){for(var l="",c=i.expandNextToken();c.text!=="]"&&c.text!=="EOF";)l+=c.text,c=i.expandNextToken();if(!l.match(/^\s*[0-9]+\s*$/))throw new Ye("Invalid number of arguments: "+l);o=parseInt(l),r=i.consumeArg().tokens}return a&&n||i.macros.set(s,{tokens:r,numArgs:o}),""};W("\\newcommand",i=>jC(i,!1,!0,!1));W("\\renewcommand",i=>jC(i,!0,!1,!1));W("\\providecommand",i=>jC(i,!0,!0,!0));W("\\message",i=>{var e=i.consumeArgs(1)[0];return console.log(e.reverse().map(t=>t.text).join("")),""});W("\\errmessage",i=>{var e=i.consumeArgs(1)[0];return console.error(e.reverse().map(t=>t.text).join("")),""});W("\\show",i=>{var e=i.popToken(),t=e.text;return console.log(e,i.macros.get(t),ou[t],Yn.math[t],Yn.text[t]),""});W("\\bgroup","{");W("\\egroup","}");W("~","\\nobreakspace");W("\\lq","`");W("\\rq","'");W("\\aa","\\r a");W("\\AA","\\r A");W("\\textcopyright","\\html@mathml{\\textcircled{c}}{\\char`}");W("\\copyright","\\TextOrMath{\\textcopyright}{\\text{\\textcopyright}}");W("\\textregistered","\\html@mathml{\\textcircled{\\scriptsize R}}{\\char`}");W("","\\mathscr{B}");W("","\\mathscr{E}");W("","\\mathscr{F}");W("","\\mathscr{H}");W("","\\mathscr{I}");W("","\\mathscr{L}");W("","\\mathscr{M}");W("","\\mathscr{R}");W("","\\mathfrak{C}");W("","\\mathfrak{H}");W("","\\mathfrak{Z}");W("\\Bbbk","\\Bbb{k}");W("","\\cdotp");W("\\llap","\\mathllap{\\textrm{#1}}");W("\\rlap","\\mathrlap{\\textrm{#1}}");W("\\clap","\\mathclap{\\textrm{#1}}");W("\\mathstrut","\\vphantom{(}");W("\\underbar","\\underline{\\text{#1}}");W("\\not",'\\html@mathml{\\mathrel{\\mathrlap\\@not}}{\\char"338}');W("\\neq","\\html@mathml{\\mathrel{\\not=}}{\\mathrel{\\char`}}");W("\\ne","\\neq");W("","\\neq");W("\\notin","\\html@mathml{\\mathrel{{\\in}\\mathllap{/\\mskip1mu}}}{\\mathrel{\\char`}}");W("","\\notin");W("","\\html@mathml{\\mathrel{=\\kern{-1em}\\raisebox{0.4em}{$\\scriptsize\\frown$}}}{\\mathrel{\\char`}}");W("","\\html@mathml{\\stackrel{\\tiny\\wedge}{=}}{\\mathrel{\\char`}}");W("","\\html@mathml{\\stackrel{\\tiny\\vee}{=}}{\\mathrel{\\char`}}");W("","\\html@mathml{\\stackrel{\\scriptsize\\star}{=}}{\\mathrel{\\char`}}");W("","\\html@mathml{\\stackrel{\\tiny\\mathrm{def}}{=}}{\\mathrel{\\char`}}");W("","\\html@mathml{\\stackrel{\\tiny\\mathrm{m}}{=}}{\\mathrel{\\char`}}");W("","\\html@mathml{\\stackrel{\\tiny?}{=}}{\\mathrel{\\char`}}");W("","\\perp");W("","\\mathclose{!\\mkern-0.8mu!}");W("","\\notni");W("","\\ulcorner");W("","\\urcorner");W("","\\llcorner");W("","\\lrcorner");W("","\\copyright");W("","\\textregistered");W("","\\textregistered");W("\\ulcorner",'\\html@mathml{\\@ulcorner}{\\mathop{\\char"231c}}');W("\\urcorner",'\\html@mathml{\\@urcorner}{\\mathop{\\char"231d}}');W("\\llcorner",'\\html@mathml{\\@llcorner}{\\mathop{\\char"231e}}');W("\\lrcorner",'\\html@mathml{\\@lrcorner}{\\mathop{\\char"231f}}');W("\\vdots","{\\varvdots\\rule{0pt}{15pt}}");W("","\\vdots");W("\\varGamma","\\mathit{\\Gamma}");W("\\varDelta","\\mathit{\\Delta}");W("\\varTheta","\\mathit{\\Theta}");W("\\varLambda","\\mathit{\\Lambda}");W("\\varXi","\\mathit{\\Xi}");W("\\varPi","\\mathit{\\Pi}");W("\\varSigma","\\mathit{\\Sigma}");W("\\varUpsilon","\\mathit{\\Upsilon}");W("\\varPhi","\\mathit{\\Phi}");W("\\varPsi","\\mathit{\\Psi}");W("\\varOmega","\\mathit{\\Omega}");W("\\substack","\\begin{subarray}{c}#1\\end{subarray}");W("\\colon","\\nobreak\\mskip2mu\\mathpunct{}\\mathchoice{\\mkern-3mu}{\\mkern-3mu}{}{}{:}\\mskip6mu\\relax");W("\\boxed","\\fbox{$\\displaystyle{#1}$}");W("\\iff","\\DOTSB\\;\\Longleftrightarrow\\;");W("\\implies","\\DOTSB\\;\\Longrightarrow\\;");W("\\impliedby","\\DOTSB\\;\\Longleftarrow\\;");W("\\dddot","{\\overset{\\raisebox{-0.1ex}{\\normalsize ...}}{#1}}");W("\\ddddot","{\\overset{\\raisebox{-0.1ex}{\\normalsize ....}}{#1}}");var mL={",":"\\dotsc","\\not":"\\dotsb","+":"\\dotsb","=":"\\dotsb","<":"\\dotsb",">":"\\dotsb","-":"\\dotsb","*":"\\dotsb",":":"\\dotsb","\\DOTSB":"\\dotsb","\\coprod":"\\dotsb","\\bigvee":"\\dotsb","\\bigwedge":"\\dotsb","\\biguplus":"\\dotsb","\\bigcap":"\\dotsb","\\bigcup":"\\dotsb","\\prod":"\\dotsb","\\sum":"\\dotsb","\\bigotimes":"\\dotsb","\\bigoplus":"\\dotsb","\\bigodot":"\\dotsb","\\bigsqcup":"\\dotsb","\\And":"\\dotsb","\\longrightarrow":"\\dotsb","\\Longrightarrow":"\\dotsb","\\longleftarrow":"\\dotsb","\\Longleftarrow":"\\dotsb","\\longleftrightarrow":"\\dotsb","\\Longleftrightarrow":"\\dotsb","\\mapsto":"\\dotsb","\\longmapsto":"\\dotsb","\\hookrightarrow":"\\dotsb","\\doteq":"\\dotsb","\\mathbin":"\\dotsb","\\mathrel":"\\dotsb","\\relbar":"\\dotsb","\\Relbar":"\\dotsb","\\xrightarrow":"\\dotsb","\\xleftarrow":"\\dotsb","\\DOTSI":"\\dotsi","\\int":"\\dotsi","\\oint":"\\dotsi","\\iint":"\\dotsi","\\iiint":"\\dotsi","\\iiiint":"\\dotsi","\\idotsint":"\\dotsi","\\DOTSX":"\\dotsx"};W("\\dots",function(i){var e="\\dotso",t=i.expandAfterFuture().text;return t in mL?e=mL[t]:(t.slice(0,4)==="\\not"||t in Yn.math&&["bin","rel"].includes(Yn.math[t].group))&&(e="\\dotsb"),e});var VC={")":!0,"]":!0,"\\rbrack":!0,"\\}":!0,"\\rbrace":!0,"\\rangle":!0,"\\rceil":!0,"\\rfloor":!0,"\\rgroup":!0,"\\rmoustache":!0,"\\right":!0,"\\bigr":!0,"\\biggr":!0,"\\Bigr":!0,"\\Biggr":!0,$:!0,";":!0,".":!0,",":!0};W("\\dotso",function(i){var e=i.future().text;return e in VC?"\\ldots\\,":"\\ldots"});W("\\dotsc",function(i){var e=i.future().text;return e in VC&&e!==","?"\\ldots\\,":"\\ldots"});W("\\cdots",function(i){var e=i.future().text;return e in VC?"\\@cdots\\,":"\\@cdots"});W("\\dotsb","\\cdots");W("\\dotsm","\\cdots");W("\\dotsi","\\!\\cdots");W("\\dotsx","\\ldots\\,");W("\\DOTSI","\\relax");W("\\DOTSB","\\relax");W("\\DOTSX","\\relax");W("\\tmspace","\\TextOrMath{\\kern#1#3}{\\mskip#1#2}\\relax");W("\\,","\\tmspace+{3mu}{.1667em}");W("\\thinspace","\\,");W("\\>","\\mskip{4mu}");W("\\:","\\tmspace+{4mu}{.2222em}");W("\\medspace","\\:");W("\\;","\\tmspace+{5mu}{.2777em}");W("\\thickspace","\\;");W("\\!","\\tmspace-{3mu}{.1667em}");W("\\negthinspace","\\!");W("\\negmedspace","\\tmspace-{4mu}{.2222em}");W("\\negthickspace","\\tmspace-{5mu}{.277em}");W("\\enspace","\\kern.5em ");W("\\enskip","\\hskip.5em\\relax");W("\\quad","\\hskip1em\\relax");W("\\qquad","\\hskip2em\\relax");W("\\tag","\\@ifstar\\tag@literal\\tag@paren");W("\\tag@paren","\\tag@literal{({#1})}");W("\\tag@literal",i=>{if(i.macros.get("\\df@tag"))throw new Ye("Multiple \\tag");return"\\gdef\\df@tag{\\text{#1}}"});W("\\bmod","\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}\\mathbin{\\rm mod}\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}");W("\\pod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern8mu}{\\mkern8mu}{\\mkern8mu}(#1)");W("\\pmod","\\pod{{\\rm mod}\\mkern6mu#1}");W("\\mod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern12mu}{\\mkern12mu}{\\mkern12mu}{\\rm mod}\\,\\,#1");W("\\newline","\\\\\\relax");W("\\TeX","\\textrm{\\html@mathml{T\\kern-.1667em\\raisebox{-.5ex}{E}\\kern-.125emX}{TeX}}");var AW=rt(Go["Main-Regular"][84][1]-.7*Go["Main-Regular"][65][1]);W("\\LaTeX","\\textrm{\\html@mathml{"+("L\\kern-.36em\\raisebox{"+AW+"}{\\scriptstyle A}")+"\\kern-.15em\\TeX}{LaTeX}}");W("\\KaTeX","\\textrm{\\html@mathml{"+("K\\kern-.17em\\raisebox{"+AW+"}{\\scriptstyle A}")+"\\kern-.15em\\TeX}{KaTeX}}");W("\\hspace","\\@ifstar\\@hspacer\\@hspace");W("\\@hspace","\\hskip #1\\relax");W("\\@hspacer","\\rule{0pt}{0pt}\\hskip #1\\relax");W("\\ordinarycolon",":");W("\\vcentcolon","\\mathrel{\\mathop\\ordinarycolon}");W("\\dblcolon",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-.9mu}\\vcentcolon}}{\\mathop{\\char"2237}}');W("\\coloneqq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2254}}');W("\\Coloneqq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2237\\char"3d}}');W("\\coloneq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"3a\\char"2212}}');W("\\Coloneq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"2237\\char"2212}}');W("\\eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2255}}');W("\\Eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"3d\\char"2237}}');W("\\eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2239}}');W("\\Eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"2212\\char"2237}}');W("\\colonapprox",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"3a\\char"2248}}');W("\\Colonapprox",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"2237\\char"2248}}');W("\\colonsim",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"3a\\char"223c}}');W("\\Colonsim",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"2237\\char"223c}}');W("","\\dblcolon");W("","\\eqcolon");W("","\\coloneqq");W("","\\eqqcolon");W("","\\Coloneqq");W("\\ratio","\\vcentcolon");W("\\coloncolon","\\dblcolon");W("\\colonequals","\\coloneqq");W("\\coloncolonequals","\\Coloneqq");W("\\equalscolon","\\eqqcolon");W("\\equalscoloncolon","\\Eqqcolon");W("\\colonminus","\\coloneq");W("\\coloncolonminus","\\Coloneq");W("\\minuscolon","\\eqcolon");W("\\minuscoloncolon","\\Eqcolon");W("\\coloncolonapprox","\\Colonapprox");W("\\coloncolonsim","\\Colonsim");W("\\simcolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\vcentcolon}");W("\\simcoloncolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\dblcolon}");W("\\approxcolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\vcentcolon}");W("\\approxcoloncolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\dblcolon}");W("\\notni","\\html@mathml{\\not\\ni}{\\mathrel{\\char`}}");W("\\limsup","\\DOTSB\\operatorname*{lim\\,sup}");W("\\liminf","\\DOTSB\\operatorname*{lim\\,inf}");W("\\injlim","\\DOTSB\\operatorname*{inj\\,lim}");W("\\projlim","\\DOTSB\\operatorname*{proj\\,lim}");W("\\varlimsup","\\DOTSB\\operatorname*{\\overline{lim}}");W("\\varliminf","\\DOTSB\\operatorname*{\\underline{lim}}");W("\\varinjlim","\\DOTSB\\operatorname*{\\underrightarrow{lim}}");W("\\varprojlim","\\DOTSB\\operatorname*{\\underleftarrow{lim}}");W("\\gvertneqq","\\html@mathml{\\@gvertneqq}{}");W("\\lvertneqq","\\html@mathml{\\@lvertneqq}{}");W("\\ngeqq","\\html@mathml{\\@ngeqq}{}");W("\\ngeqslant","\\html@mathml{\\@ngeqslant}{}");W("\\nleqq","\\html@mathml{\\@nleqq}{}");W("\\nleqslant","\\html@mathml{\\@nleqslant}{}");W("\\nshortmid","\\html@mathml{\\@nshortmid}{}");W("\\nshortparallel","\\html@mathml{\\@nshortparallel}{}");W("\\nsubseteqq","\\html@mathml{\\@nsubseteqq}{}");W("\\nsupseteqq","\\html@mathml{\\@nsupseteqq}{}");W("\\varsubsetneq","\\html@mathml{\\@varsubsetneq}{}");W("\\varsubsetneqq","\\html@mathml{\\@varsubsetneqq}{}");W("\\varsupsetneq","\\html@mathml{\\@varsupsetneq}{}");W("\\varsupsetneqq","\\html@mathml{\\@varsupsetneqq}{}");W("\\imath","\\html@mathml{\\@imath}{}");W("\\jmath","\\html@mathml{\\@jmath}{}");W("\\llbracket","\\html@mathml{\\mathopen{[\\mkern-3.2mu[}}{\\mathopen{\\char`}}");W("\\rrbracket","\\html@mathml{\\mathclose{]\\mkern-3.2mu]}}{\\mathclose{\\char`}}");W("","\\llbracket");W("","\\rrbracket");W("\\lBrace","\\html@mathml{\\mathopen{\\{\\mkern-3.2mu[}}{\\mathopen{\\char`}}");W("\\rBrace","\\html@mathml{\\mathclose{]\\mkern-3.2mu\\}}}{\\mathclose{\\char`}}");W("","\\lBrace");W("","\\rBrace");W("\\minuso","\\mathbin{\\html@mathml{{\\mathrlap{\\mathchoice{\\kern{0.145em}}{\\kern{0.145em}}{\\kern{0.1015em}}{\\kern{0.0725em}}\\circ}{-}}}{\\char`}}");W("","\\minuso");W("\\darr","\\downarrow");W("\\dArr","\\Downarrow");W("\\Darr","\\Downarrow");W("\\lang","\\langle");W("\\rang","\\rangle");W("\\uarr","\\uparrow");W("\\uArr","\\Uparrow");W("\\Uarr","\\Uparrow");W("\\N","\\mathbb{N}");W("\\R","\\mathbb{R}");W("\\Z","\\mathbb{Z}");W("\\alef","\\aleph");W("\\alefsym","\\aleph");W("\\Alpha","\\mathrm{A}");W("\\Beta","\\mathrm{B}");W("\\bull","\\bullet");W("\\Chi","\\mathrm{X}");W("\\clubs","\\clubsuit");W("\\cnums","\\mathbb{C}");W("\\Complex","\\mathbb{C}");W("\\Dagger","\\ddagger");W("\\diamonds","\\diamondsuit");W("\\empty","\\emptyset");W("\\Epsilon","\\mathrm{E}");W("\\Eta","\\mathrm{H}");W("\\exist","\\exists");W("\\harr","\\leftrightarrow");W("\\hArr","\\Leftrightarrow");W("\\Harr","\\Leftrightarrow");W("\\hearts","\\heartsuit");W("\\image","\\Im");W("\\infin","\\infty");W("\\Iota","\\mathrm{I}");W("\\isin","\\in");W("\\Kappa","\\mathrm{K}");W("\\larr","\\leftarrow");W("\\lArr","\\Leftarrow");W("\\Larr","\\Leftarrow");W("\\lrarr","\\leftrightarrow");W("\\lrArr","\\Leftrightarrow");W("\\Lrarr","\\Leftrightarrow");W("\\Mu","\\mathrm{M}");W("\\natnums","\\mathbb{N}");W("\\Nu","\\mathrm{N}");W("\\Omicron","\\mathrm{O}");W("\\plusmn","\\pm");W("\\rarr","\\rightarrow");W("\\rArr","\\Rightarrow");W("\\Rarr","\\Rightarrow");W("\\real","\\Re");W("\\reals","\\mathbb{R}");W("\\Reals","\\mathbb{R}");W("\\Rho","\\mathrm{P}");W("\\sdot","\\cdot");W("\\sect","\\S");W("\\spades","\\spadesuit");W("\\sub","\\subset");W("\\sube","\\subseteq");W("\\supe","\\supseteq");W("\\Tau","\\mathrm{T}");W("\\thetasym","\\vartheta");W("\\weierp","\\wp");W("\\Zeta","\\mathrm{Z}");W("\\argmin","\\DOTSB\\operatorname*{arg\\,min}");W("\\argmax","\\DOTSB\\operatorname*{arg\\,max}");W("\\plim","\\DOTSB\\mathop{\\operatorname{plim}}\\limits");W("\\bra","\\mathinner{\\langle{#1}|}");W("\\ket","\\mathinner{|{#1}\\rangle}");W("\\braket","\\mathinner{\\langle{#1}\\rangle}");W("\\Bra","\\left\\langle#1\\right|");W("\\Ket","\\left|#1\\right\\rangle");var CW=i=>e=>{var t=e.consumeArg().tokens,n=e.consumeArg().tokens,r=e.consumeArg().tokens,s=e.consumeArg().tokens,a=e.macros.get("|"),o=e.macros.get("\\|");e.macros.beginGroup();var l=d=>p=>{i&&(p.macros.set("|",a),r.length&&p.macros.set("\\|",o));var m=d;if(!d&&r.length){var g=p.future();g.text==="|"&&(p.popToken(),m=!0)}return{tokens:m?r:n,numArgs:0}};e.macros.set("|",l(!1)),r.length&&e.macros.set("\\|",l(!0));var c=e.consumeArg().tokens,u=e.expandTokens([...s,...c,...t]);return e.macros.endGroup(),{tokens:u.reverse(),numArgs:0}};W("\\bra@ket",CW(!1));W("\\bra@set",CW(!0));W("\\Braket","\\bra@ket{\\left\\langle}{\\,\\middle\\vert\\,}{\\,\\middle\\vert\\,}{\\right\\rangle}");W("\\Set","\\bra@set{\\left\\{\\:}{\\;\\middle\\vert\\;}{\\;\\middle\\Vert\\;}{\\:\\right\\}}");W("\\set","\\bra@set{\\{\\,}{\\mid}{}{\\,\\}}");W("\\angln","{\\angl n}");W("\\blue","\\textcolor{##6495ed}{#1}");W("\\orange","\\textcolor{##ffa500}{#1}");W("\\pink","\\textcolor{##ff00af}{#1}");W("\\red","\\textcolor{##df0030}{#1}");W("\\green","\\textcolor{##28ae7b}{#1}");W("\\gray","\\textcolor{gray}{#1}");W("\\purple","\\textcolor{##9d38bd}{#1}");W("\\blueA","\\textcolor{##ccfaff}{#1}");W("\\blueB","\\textcolor{##80f6ff}{#1}");W("\\blueC","\\textcolor{##63d9ea}{#1}");W("\\blueD","\\textcolor{##11accd}{#1}");W("\\blueE","\\textcolor{##0c7f99}{#1}");W("\\tealA","\\textcolor{##94fff5}{#1}");W("\\tealB","\\textcolor{##26edd5}{#1}");W("\\tealC","\\textcolor{##01d1c1}{#1}");W("\\tealD","\\textcolor{##01a995}{#1}");W("\\tealE","\\textcolor{##208170}{#1}");W("\\greenA","\\textcolor{##b6ffb0}{#1}");W("\\greenB","\\textcolor{##8af281}{#1}");W("\\greenC","\\textcolor{##74cf70}{#1}");W("\\greenD","\\textcolor{##1fab54}{#1}");W("\\greenE","\\textcolor{##0d923f}{#1}");W("\\goldA","\\textcolor{##ffd0a9}{#1}");W("\\goldB","\\textcolor{##ffbb71}{#1}");W("\\goldC","\\textcolor{##ff9c39}{#1}");W("\\goldD","\\textcolor{##e07d10}{#1}");W("\\goldE","\\textcolor{##a75a05}{#1}");W("\\redA","\\textcolor{##fca9a9}{#1}");W("\\redB","\\textcolor{##ff8482}{#1}");W("\\redC","\\textcolor{##f9685d}{#1}");W("\\redD","\\textcolor{##e84d39}{#1}");W("\\redE","\\textcolor{##bc2612}{#1}");W("\\maroonA","\\textcolor{##ffbde0}{#1}");W("\\maroonB","\\textcolor{##ff92c6}{#1}");W("\\maroonC","\\textcolor{##ed5fa6}{#1}");W("\\maroonD","\\textcolor{##ca337c}{#1}");W("\\maroonE","\\textcolor{##9e034e}{#1}");W("\\purpleA","\\textcolor{##ddd7ff}{#1}");W("\\purpleB","\\textcolor{##c6b9fc}{#1}");W("\\purpleC","\\textcolor{##aa87ff}{#1}");W("\\purpleD","\\textcolor{##7854ab}{#1}");W("\\purpleE","\\textcolor{##543b78}{#1}");W("\\mintA","\\textcolor{##f5f9e8}{#1}");W("\\mintB","\\textcolor{##edf2df}{#1}");W("\\mintC","\\textcolor{##e0e5cc}{#1}");W("\\grayA","\\textcolor{##f6f7f7}{#1}");W("\\grayB","\\textcolor{##f0f1f2}{#1}");W("\\grayC","\\textcolor{##e3e5e6}{#1}");W("\\grayD","\\textcolor{##d6d8da}{#1}");W("\\grayE","\\textcolor{##babec2}{#1}");W("\\grayF","\\textcolor{##888d93}{#1}");W("\\grayG","\\textcolor{##626569}{#1}");W("\\grayH","\\textcolor{##3b3e40}{#1}");W("\\grayI","\\textcolor{##21242c}{#1}");W("\\kaBlue","\\textcolor{##314453}{#1}");W("\\kaGreen","\\textcolor{##71B307}{#1}");var EW={"^":!0,_:!0,"\\limits":!0,"\\nolimits":!0};class ySe{constructor(e,t,n){this.settings=void 0,this.expansionCount=void 0,this.lexer=void 0,this.macros=void 0,this.stack=void 0,this.mode=void 0,this.settings=t,this.expansionCount=0,this.feed(e),this.macros=new gSe(xSe,t.macros),this.mode=n,this.stack=[]}feed(e){this.lexer=new fL(e,this.settings)}switchMode(e){this.mode=e}beginGroup(){this.macros.beginGroup()}endGroup(){this.macros.endGroup()}endGroups(){this.macros.endGroups()}future(){return this.stack.length===0&&this.pushToken(this.lexer.lex()),this.stack[this.stack.length-1]}popToken(){return this.future(),this.stack.pop()}pushToken(e){this.stack.push(e)}pushTokens(e){this.stack.push(...e)}scanArgument(e){var t,n,r;if(e){if(this.consumeSpaces(),this.future().text!=="[")return null;t=this.popToken(),{tokens:r,end:n}=this.consumeArg(["]"])}else({tokens:r,start:t,end:n}=this.consumeArg());return this.pushToken(new ra("EOF",n.loc)),this.pushTokens(r),new ra("",bs.range(t,n))}consumeSpaces(){for(;;){var e=this.future();if(e.text===" ")this.stack.pop();else break}}consumeArg(e){var t=[],n=e&&e.length>0;n||this.consumeSpaces();var r=this.future(),s,a=0,o=0;do{if(s=this.popToken(),t.push(s),s.text==="{")++a;else if(s.text==="}"){if(--a,a===-1)throw new Ye("Extra }",s)}else if(s.text==="EOF")throw new Ye("Unexpected end of input in a macro argument, expected '"+(e&&n?e[o]:"}")+"'",s);if(e&&n)if((a===0||a===1&&e[o]==="{")&&s.text===e[o]){if(++o,o===e.length){t.splice(-o,o);break}}else o=0}while(a!==0||n);return r.text==="{"&&t[t.length-1].text==="}"&&(t.pop(),t.shift()),t.reverse(),{tokens:t,start:r,end:s}}consumeArgs(e,t){if(t){if(t.length!==e+1)throw new Ye("The length of delimiters doesn't match the number of args!");for(var n=t[0],r=0;r<n.length;r++){var s=this.popToken();if(n[r]!==s.text)throw new Ye("Use of the macro doesn't match its definition",s)}}for(var a=[],o=0;o<e;o++)a.push(this.consumeArg(t&&t[o+1]).tokens);return a}countExpansion(e){if(this.expansionCount+=e,this.expansionCount>this.settings.maxExpand)throw new Ye("Too many expansions: infinite loop or need to increase maxExpand setting")}expandOnce(e){var t=this.popToken(),n=t.text,r=t.noexpand?null:this._getExpansion(n);if(r==null||e&&r.unexpandable){if(e&&r==null&&n[0]==="\\"&&!this.isDefined(n))throw new Ye("Undefined control sequence: "+n);return this.pushToken(t),!1}this.countExpansion(1);var s=r.tokens,a=this.consumeArgs(r.numArgs,r.delimiters);if(r.numArgs){s=s.slice();for(var o=s.length-1;o>=0;--o){var l=s[o];if(l.text==="#"){if(o===0)throw new Ye("Incomplete placeholder at end of macro body",l);if(l=s[--o],l.text==="#")s.splice(o+1,1);else if(/^[1-9]$/.test(l.text))s.splice(o,2,...a[+l.text-1]);else throw new Ye("Not a valid argument number",l)}}}return this.pushTokens(s),s.length}expandAfterFuture(){return this.expandOnce(),this.future()}expandNextToken(){for(;;)if(this.expandOnce()===!1){var e=this.stack.pop();return e.treatAsRelax&&(e.text="\\relax"),e}throw new Error}expandMacro(e){return this.macros.has(e)?this.expandTokens([new ra(e)]):void 0}expandTokens(e){var t=[],n=this.stack.length;for(this.pushTokens(e);this.stack.length>n;)if(this.expandOnce(!0)===!1){var r=this.stack.pop();r.treatAsRelax&&(r.noexpand=!1,r.treatAsRelax=!1),t.push(r)}return this.countExpansion(t.length),t}expandMacroAsText(e){var t=this.expandMacro(e);return t&&t.map(n=>n.text).join("")}_getExpansion(e){var t=this.macros.get(e);if(t==null)return t;if(e.length===1){var n=this.lexer.catcodes[e];if(n!=null&&n!==13)return}var r=typeof t=="function"?t(this):t;if(typeof r=="string"){var s=0;if(r.indexOf("#")!==-1)for(var a=r.replace(/##/g,"");a.indexOf("#"+(s+1))!==-1;)++s;for(var o=new fL(r,this.settings),l=[],c=o.lex();c.text!=="EOF";)l.push(c),c=o.lex();l.reverse();var u={tokens:l,numArgs:s};return u}return r}isDefined(e){return this.macros.has(e)||ou.hasOwnProperty(e)||Yn.math.hasOwnProperty(e)||Yn.text.hasOwnProperty(e)||EW.hasOwnProperty(e)}isExpandable(e){var t=this.macros.get(e);return t!=null?typeof t=="string"||typeof t=="function"||!t.unexpandable:ou.hasOwnProperty(e)&&!ou[e].primitive}}var gL=/^[]/,Ay=Object.freeze({"":"+","":"-","":"=","":"(","":")","":"0","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"a","":"e","":"h","":"i","":"j","":"k","":"l","":"m","":"n","":"o","":"p","":"r","":"s","":"t","":"u","":"v","":"x","":"","":"","":"","":"","":"","":"+","":"-","":"=","":"(","":")","":"0","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"A","":"B","":"D","":"E","":"G","":"H","":"I","":"J","":"K","":"L","":"M","":"N","":"O","":"P","":"R","":"T","":"U","":"V","":"W","":"a","":"b","":"c","":"d","":"e","":"f","":"g",:"h","":"i",:"j","":"k",:"l","":"m",:"n","":"o","":"p",:"r",:"s","":"t","":"u","":"v",:"w",:"x",:"y","":"z","":"","":"","":"","":"","":"","":""}),yM={"":{text:"\\'",math:"\\acute"},"":{text:"\\`",math:"\\grave"},"":{text:'\\"',math:"\\ddot"},"":{text:"\\~",math:"\\tilde"},"":{text:"\\=",math:"\\bar"},"":{text:"\\u",math:"\\breve"},"":{text:"\\v",math:"\\check"},"":{text:"\\^",math:"\\hat"},"":{text:"\\.",math:"\\dot"},"":{text:"\\r",math:"\\mathring"},"":{text:"\\H"},"":{text:"\\c"}},xL={:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"b",:"c",:"c",:"c",:"c",:"c",:"c",:"d",:"d",:"d",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"f",:"g",:"g",:"g",:"g",:"g",:"g",:"g",:"h",:"h",:"h",:"h",:"h",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"j",:"j",:"k",:"k",:"k",:"l",:"l",:"l",:"m",:"m",:"n",:"n",:"n",:"n",:"n",:"n",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"p",:"p",:"r",:"r",:"r",:"r",:"s",:"s",:"s",:"s",:"s",:"s",:"s",:"t",:"t",:"t",:"t",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"v",:"w",:"w",:"w",:"w",:"w",:"w",:"x",:"x",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"z",:"z",:"z",:"z",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"B",:"C",:"C",:"C",:"C",:"C",:"C",:"D",:"D",:"D",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"F",:"G",:"G",:"G",:"G",:"G",:"G",:"G",:"H",:"H",:"H",:"H",:"H",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"J",:"K",:"K",:"K",:"L",:"L",:"L",:"M",:"M",:"N",:"N",:"N",:"N",:"N",:"N",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"P",:"P",:"R",:"R",:"R",:"R",:"S",:"S",:"S",:"S",:"S",:"S",:"S",:"T",:"T",:"T",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"V",:"W",:"W",:"W",:"W",:"W",:"X",:"X",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Z",:"Z",:"Z",:"Z",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""};class p_{constructor(e,t){this.mode=void 0,this.gullet=void 0,this.settings=void 0,this.leftrightDepth=void 0,this.nextToken=void 0,this.mode="math",this.gullet=new ySe(e,t,this.mode),this.settings=t,this.leftrightDepth=0}expect(e,t){if(t===void 0&&(t=!0),this.fetch().text!==e)throw new Ye("Expected '"+e+"', got '"+this.fetch().text+"'",this.fetch());t&&this.consume()}consume(){this.nextToken=null}fetch(){return this.nextToken==null&&(this.nextToken=this.gullet.expandNextToken()),this.nextToken}switchMode(e){this.mode=e,this.gullet.switchMode(e)}parse(){this.settings.globalGroup||this.gullet.beginGroup(),this.settings.colorIsTextColor&&this.gullet.macros.set("\\color","\\textcolor");try{var e=this.parseExpression(!1);return this.expect("EOF"),this.settings.globalGroup||this.gullet.endGroup(),e}finally{this.gullet.endGroups()}}subparse(e){var t=this.nextToken;this.consume(),this.gullet.pushToken(new ra("}")),this.gullet.pushTokens(e);var n=this.parseExpression(!1);return this.expect("}"),this.nextToken=t,n}parseExpression(e,t){for(var n=[];;){this.mode==="math"&&this.consumeSpaces();var r=this.fetch();if(p_.endOfExpression.indexOf(r.text)!==-1||t&&r.text===t||e&&ou[r.text]&&ou[r.text].infix)break;var s=this.parseAtom(t);if(s){if(s.type==="internal")continue}else break;n.push(s)}return this.mode==="text"&&this.formLigatures(n),this.handleInfixNodes(n)}handleInfixNodes(e){for(var t=-1,n,r=0;r<e.length;r++)if(e[r].type==="infix"){if(t!==-1)throw new Ye("only one infix operator per group",e[r].token);t=r,n=e[r].replaceWith}if(t!==-1&&n){var s,a,o=e.slice(0,t),l=e.slice(t+1);o.length===1&&o[0].type==="ordgroup"?s=o[0]:s={type:"ordgroup",mode:this.mode,body:o},l.length===1&&l[0].type==="ordgroup"?a=l[0]:a={type:"ordgroup",mode:this.mode,body:l};var c;return n==="\\\\abovefrac"?c=this.callFunction(n,[s,e[t],a],[]):c=this.callFunction(n,[s,a],[]),[c]}else return e}handleSupSubscript(e){var t=this.fetch(),n=t.text;this.consume(),this.consumeSpaces();var r;do{var s;r=this.parseGroup(e)}while(((s=r)==null?void 0:s.type)==="internal");if(!r)throw new Ye("Expected group after '"+n+"'",t);return r}formatUnsupportedCmd(e){for(var t=[],n=0;n<e.length;n++)t.push({type:"textord",mode:"text",text:e[n]});var r={type:"text",mode:this.mode,body:t},s={type:"color",mode:this.mode,color:this.settings.errorColor,body:[r]};return s}parseAtom(e){var t=this.parseGroup("atom",e);if(t?.type==="internal"||this.mode==="text")return t;for(var n,r;;){this.consumeSpaces();var s=this.fetch();if(s.text==="\\limits"||s.text==="\\nolimits"){if(t&&t.type==="op"){var a=s.text==="\\limits";t.limits=a,t.alwaysHandleSupSub=!0}else if(t&&t.type==="operatorname")t.alwaysHandleSupSub&&(t.limits=s.text==="\\limits");else throw new Ye("Limit controls must follow a math operator",s);this.consume()}else if(s.text==="^"){if(n)throw new Ye("Double superscript",s);n=this.handleSupSubscript("superscript")}else if(s.text==="_"){if(r)throw new Ye("Double subscript",s);r=this.handleSupSubscript("subscript")}else if(s.text==="'"){if(n)throw new Ye("Double superscript",s);var o={type:"textord",mode:this.mode,text:"\\prime"},l=[o];for(this.consume();this.fetch().text==="'";)l.push(o),this.consume();this.fetch().text==="^"&&l.push(this.handleSupSubscript("superscript")),n={type:"ordgroup",mode:this.mode,body:l}}else if(Ay[s.text]){var c=gL.test(s.text),u=[];for(u.push(new ra(Ay[s.text])),this.consume();;){var d=this.fetch().text;if(!Ay[d]||gL.test(d)!==c)break;u.unshift(new ra(Ay[d])),this.consume()}var p=this.subparse(u);c?r={type:"ordgroup",mode:"math",body:p}:n={type:"ordgroup",mode:"math",body:p}}else break}return n||r?{type:"supsub",mode:this.mode,base:t,sup:n,sub:r}:t}parseFunction(e,t){var n=this.fetch(),r=n.text,s=ou[r];if(!s)return null;if(this.consume(),t&&t!=="atom"&&!s.allowedInArgument)throw new Ye("Got function '"+r+"' with no arguments"+(t?" as "+t:""),n);if(this.mode==="text"&&!s.allowedInText)throw new Ye("Can't use function '"+r+"' in text mode",n);if(this.mode==="math"&&s.allowedInMath===!1)throw new Ye("Can't use function '"+r+"' in math mode",n);var{args:a,optArgs:o}=this.parseArguments(r,s);return this.callFunction(r,a,o,n,e)}callFunction(e,t,n,r,s){var a={funcName:e,parser:this,token:r,breakOnTokenText:s},o=ou[e];if(o&&o.handler)return o.handler(a,t,n);throw new Ye("No function handler for "+e)}parseArguments(e,t){var n=t.numArgs+t.numOptionalArgs;if(n===0)return{args:[],optArgs:[]};for(var r=[],s=[],a=0;a<n;a++){var o=t.argTypes&&t.argTypes[a],l=a<t.numOptionalArgs;(t.primitive&&o==null||t.type==="sqrt"&&a===1&&s[0]==null)&&(o="primitive");var c=this.parseGroupOfType("argument to '"+e+"'",o,l);if(l)s.push(c);else if(c!=null)r.push(c);else throw new Ye("Null argument, please report this as a bug")}return{args:r,optArgs:s}}parseGroupOfType(e,t,n){switch(t){case"color":return this.parseColorGroup(n);case"size":return this.parseSizeGroup(n);case"url":return this.parseUrlGroup(n);case"math":case"text":return this.parseArgumentGroup(n,t);case"hbox":{var r=this.parseArgumentGroup(n,"text");return r!=null?{type:"styling",mode:r.mode,body:[r],style:"text"}:null}case"raw":{var s=this.parseStringGroup("raw",n);return s!=null?{type:"raw",mode:"text",string:s.text}:null}case"primitive":{if(n)throw new Ye("A primitive argument cannot be optional");var a=this.parseGroup(e);if(a==null)throw new Ye("Expected group as "+e,this.fetch());return a}case"original":case null:case void 0:return this.parseArgumentGroup(n);default:throw new Ye("Unknown group type as "+e,this.fetch())}}consumeSpaces(){for(;this.fetch().text===" ";)this.consume()}parseStringGroup(e,t){var n=this.gullet.scanArgument(t);if(n==null)return null;for(var r="",s;(s=this.fetch()).text!=="EOF";)r+=s.text,this.consume();return this.consume(),n.text=r,n}parseRegexGroup(e,t){for(var n=this.fetch(),r=n,s="",a;(a=this.fetch()).text!=="EOF"&&e.test(s+a.text);)r=a,s+=r.text,this.consume();if(s==="")throw new Ye("Invalid "+t+": '"+n.text+"'",n);return n.range(r,s)}parseColorGroup(e){var t=this.parseStringGroup("color",e);if(t==null)return null;var n=/^(#[a-f0-9]{3,4}|#[a-f0-9]{6}|#[a-f0-9]{8}|[a-f0-9]{6}|[a-z]+)$/i.exec(t.text);if(!n)throw new Ye("Invalid color: '"+t.text+"'",t);var r=n[0];return/^[0-9a-f]{6}$/i.test(r)&&(r="#"+r),{type:"color-token",mode:this.mode,color:r}}parseSizeGroup(e){var t,n=!1;if(this.gullet.consumeSpaces(),!e&&this.gullet.future().text!=="{"?t=this.parseRegexGroup(/^[-+]? *(?:$|\d+|\d+\.\d*|\.\d*) *[a-z]{0,2} *$/,"size"):t=this.parseStringGroup("size",e),!t)return null;!e&&t.text.length===0&&(t.text="0pt",n=!0);var r=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(t.text);if(!r)throw new Ye("Invalid size: '"+t.text+"'",t);var s={number:+(r[1]+r[2]),unit:r[3]};if(!UG(s))throw new Ye("Invalid unit: '"+s.unit+"'",t);return{type:"size",mode:this.mode,value:s,isBlank:n}}parseUrlGroup(e){this.gullet.lexer.setCatcode("%",13),this.gullet.lexer.setCatcode("~",12);var t=this.parseStringGroup("url",e);if(this.gullet.lexer.setCatcode("%",14),this.gullet.lexer.setCatcode("~",13),t==null)return null;var n=t.text.replace(/\\([#$%&~_^{}])/g,"$1");return{type:"url",mode:this.mode,url:n}}parseArgumentGroup(e,t){var n=this.gullet.scanArgument(e);if(n==null)return null;var r=this.mode;t&&this.switchMode(t),this.gullet.beginGroup();var s=this.parseExpression(!1,"EOF");this.expect("EOF"),this.gullet.endGroup();var a={type:"ordgroup",mode:this.mode,loc:n.loc,body:s};return t&&this.switchMode(r),a}parseGroup(e,t){var n=this.fetch(),r=n.text,s;if(r==="{"||r==="\\begingroup"){this.consume();var a=r==="{"?"}":"\\endgroup";this.gullet.beginGroup();var o=this.parseExpression(!1,a),l=this.fetch();this.expect(a),this.gullet.endGroup(),s={type:"ordgroup",mode:this.mode,loc:bs.range(n,l),body:o,semisimple:r==="\\begingroup"||void 0}}else if(s=this.parseFunction(t,e)||this.parseSymbol(),s==null&&r[0]==="\\"&&!EW.hasOwnProperty(r)){if(this.settings.throwOnError)throw new Ye("Undefined control sequence: "+r,n);s=this.formatUnsupportedCmd(r),this.consume()}return s}formLigatures(e){for(var t=e.length-1,n=0;n<t;++n){var r=e[n],s=r.text;s==="-"&&e[n+1].text==="-"&&(n+1<t&&e[n+2].text==="-"?(e.splice(n,3,{type:"textord",mode:"text",loc:bs.range(r,e[n+2]),text:"---"}),t-=2):(e.splice(n,2,{type:"textord",mode:"text",loc:bs.range(r,e[n+1]),text:"--"}),t-=1)),(s==="'"||s==="`")&&e[n+1].text===s&&(e.splice(n,2,{type:"textord",mode:"text",loc:bs.range(r,e[n+1]),text:s+s}),t-=1)}}parseSymbol(){var e=this.fetch(),t=e.text;if(/^\\verb[^a-zA-Z]/.test(t)){this.consume();var n=t.slice(5),r=n.charAt(0)==="*";if(r&&(n=n.slice(1)),n.length<2||n.charAt(0)!==n.slice(-1))throw new Ye(`\\verb assertion failed --
                    please report what input caused this bug`);return n=n.slice(1,-1),{type:"verb",mode:"text",body:n,star:r}}xL.hasOwnProperty(t[0])&&!Yn[this.mode][t[0]]&&(this.settings.strict&&this.mode==="math"&&this.settings.reportNonstrict("unicodeTextInMathMode",'Accented Unicode text character "'+t[0]+'" used in math mode',e),t=xL[t[0]]+t.slice(1));var s=pSe.exec(t);s&&(t=t.substring(0,s.index),t==="i"?t="":t==="j"&&(t=""));var a;if(Yn[this.mode][t]){this.settings.strict&&this.mode==="math"&&S6.indexOf(t)>=0&&this.settings.reportNonstrict("unicodeTextInMathMode",'Latin-1/Unicode text character "'+t[0]+'" used in math mode',e);var o=Yn[this.mode][t].group,l=bs.range(e),c;if(a3e.hasOwnProperty(o)){var u=o;c={type:"atom",mode:this.mode,family:u,loc:l,text:t}}else c={type:o,mode:this.mode,loc:l,text:t};a=c}else if(t.charCodeAt(0)>=128)this.settings.strict&&(zG(t.charCodeAt(0))?this.mode==="math"&&this.settings.reportNonstrict("unicodeTextInMathMode",'Unicode text character "'+t[0]+'" used in math mode',e):this.settings.reportNonstrict("unknownSymbol",'Unrecognized Unicode character "'+t[0]+'"'+(" ("+t.charCodeAt(0)+")"),e)),a={type:"textord",mode:"text",loc:bs.range(e),text:t};else return null;if(this.consume(),s)for(var d=0;d<s[0].length;d++){var p=s[0][d];if(!yM[p])throw new Ye("Unknown accent ' "+p+"'",e);var m=yM[p][this.mode]||yM[p].text;if(!m)throw new Ye("Accent "+p+" unsupported in "+this.mode+" mode",e);a={type:"accent",mode:this.mode,loc:bs.range(e),label:m,isStretchy:!1,isShifty:!0,base:a}}return a}}p_.endOfExpression=["}","\\endgroup","\\end","\\right","&"];var GC=function(e,t){if(!(typeof e=="string"||e instanceof String))throw new TypeError("KaTeX can only parse string typed expression");var n=new p_(e,t);delete n.gullet.macros.current["\\df@tag"];var r=n.parse();if(delete n.gullet.macros.current["\\current@color"],delete n.gullet.macros.current["\\color"],n.gullet.macros.get("\\df@tag")){if(!t.displayMode)throw new Ye("\\tag works only in display equations");r=[{type:"tag",mode:"text",body:r,tag:n.subparse([new ra("\\df@tag")])}]}return r},RW=function(e,t,n){t.textContent="";var r=WC(e,n).toNode();t.appendChild(r)};typeof document<"u"&&document.compatMode!=="CSS1Compat"&&(typeof console<"u"&&console.warn("Warning: KaTeX doesn't work in quirks mode. Make sure your website has a suitable doctype."),RW=function(){throw new Ye("KaTeX doesn't work in quirks mode.")});var vSe=function(e,t){var n=WC(e,t).toMarkup();return n},bSe=function(e,t){var n=new AC(t);return GC(e,n)},PW=function(e,t,n){if(n.throwOnError||!(e instanceof Ye))throw e;var r=de.makeSpan(["katex-error"],[new Ua(t)]);return r.setAttribute("title",e.toString()),r.setAttribute("style","color:"+n.errorColor),r},WC=function(e,t){var n=new AC(t);try{var r=GC(e,n);return R3e(r,e,n)}catch(s){return PW(s,e,n)}},_Se=function(e,t){var n=new AC(t);try{var r=GC(e,n);return P3e(r,e,n)}catch(s){return PW(s,e,n)}},SSe="0.16.27",wSe={Span:cx,Anchor:RC,SymbolNode:Ua,SvgNode:mc,PathNode:Mu,LineNode:_6},MSe={version:SSe,render:RW,renderToString:vSe,ParseError:Ye,SETTINGS_SCHEMA:Hy,__parse:bSe,__renderToDomTree:WC,__renderToHTMLTree:_Se,__setFontMetrics:Q_e,__defineSymbol:I,__defineFunction:dt,__defineMacro:W,__domTree:wSe};function TSe({children:i,block:e=!1}){const t=z.useMemo(()=>{try{return MSe.renderToString(i,{displayMode:e,throwOnError:!1,errorColor:"#cc0000"})}catch{return i}},[i,e]);return v.jsx("span",{dangerouslySetInnerHTML:{__html:t},style:{display:e?"block":"inline-block"}})}const ASe=["k","b"],CSe=["amplitude","mu","sigma"],ESe={amplitude:"A",mu:"",sigma:"",k:"k",b:"b"},RSe=i=>{switch(i){case"linear":return"y = k(x - x_0) + b";case"gaussian":return String.raw`y = A \exp \left( -\frac{(x - \mu)^2}{2\sigma^2} \right)`;default:return i}};function PSe(i){const{allModels:e,selectedModelId:t,selectedParam:n,onSelectModel:r,onSelectParam:s}=i,a=z.useMemo(()=>oc({items:e.map(l=>({label:l.name,value:String(l.id),formula:RSe(l.kind),hasPriors:!!(l.priors&&Object.keys(l.priors).length>0)})),itemToString:l=>l.label,itemToValue:l=>l.value}),[e]),o=z.useMemo(()=>{const l=e.find(u=>u.id===t),c=l?l.kind==="linear"?ASe:CSe:[];return oc({items:c.map(u=>({label:ESe[u]||u,value:u,isConfigured:!!(l?.priors&&L6(l,u)!==void 0)})),itemToString:u=>u.label,itemToValue:u=>u.value})},[e,t]);return v.jsxs(ss,{w:"full",h:"full",gap:3,children:[v.jsx(MM,{collection:a,value:t?[String(t)]:[],onValueChange:l=>r(Number(l.value[0])),children:v.jsxs(ss,{direction:"column",h:"full",flex:1,borderWidth:"1px",borderRadius:"md",borderColor:"border.subtle",bg:"bg.subtle",overflow:"hidden",children:[v.jsx(qe,{p:2,bg:"bg.muted",borderBottomWidth:"1px",borderColor:"border.subtle",children:v.jsx(ke,{fontSize:"xs",fontWeight:"bold",color:"fg.muted",children:"MODELS"})}),v.jsx(Im,{bg:"transparent",flex:"1",overflowY:"auto",p:1,children:a.items.length===0?v.jsx(qe,{p:4,textAlign:"center",children:v.jsx(ke,{fontSize:"xs",color:"fg.muted",children:"No models"})}):a.items.map(l=>v.jsxs(Dm,{item:l,px:3,py:2,mb:1,borderRadius:"sm",cursor:"pointer",_hover:{bg:"bg.emphasized"},_selected:{bg:"bg.emphasized",boxShadow:"xs"},justifyContent:"space-between",children:[v.jsxs(qe,{overflow:"hidden",children:[v.jsx(qy,{fontWeight:"medium",fontSize:"sm",children:l.label}),v.jsx(qe,{fontSize:"xs",color:"fg.muted",mt:.5,children:v.jsx(TSe,{children:l.formula})})]}),l.hasPriors&&v.jsx(jY,{color:"teal.500",size:"xs",ml:2,children:v.jsx(TY,{})})]},l.value))})]})}),v.jsx(MM,{collection:o,value:n?[n]:[],onValueChange:l=>s(l.value[0]),disabled:!t,children:v.jsxs(ss,{direction:"column",h:"full",flex:1,borderWidth:"1px",borderRadius:"md",borderColor:"border.subtle",bg:"bg.surface",overflow:"hidden",children:[v.jsx(qe,{p:2,bg:"bg.muted",borderBottomWidth:"1px",borderColor:"border.subtle",children:v.jsx(ke,{fontSize:"xs",fontWeight:"bold",color:"fg.muted",children:"PARAMETERS"})}),v.jsx(Im,{bg:"transparent",flex:"1",overflowY:"auto",p:1,children:t?o.items.map(l=>v.jsxs(Dm,{item:l,px:3,mb:.5,borderRadius:"sm",cursor:"pointer",_hover:{bg:"teal.subtle"},_selected:{bg:"teal.subtle",color:"teal.fg"},justifyContent:"space-between",children:[v.jsx(qe,{fontSize:"sm",fontWeight:"medium",children:l.label}),l.isConfigured&&v.jsx(Xy,{children:v.jsx(AY,{})})]},l.value)):v.jsx(qe,{p:4,textAlign:"center",children:v.jsx(ke,{fontSize:"xs",color:"fg.muted",children:"Select a model"})})})]})})]})}function ISe({configId:i,isOpen:e,onClose:t,models:n,onUpdatePrior:r,title:s="Model Settings"}){const a=Ai(Tt(g=>i?g.configurations.find(y=>y.id===i):void 0)),o=Ai(g=>g.updateConfigurationModelPrior),l=i?a?.models:n,c=(g,y,x)=>{i?o(i,g,y,x):r&&r(g,y,x)},[u,d]=z.useState(null),[p,m]=z.useState(null);return l?v.jsxs(G6,{open:e,onOpenChange:g=>!g.open&&t(),size:"md",children:[v.jsx(Y6,{}),v.jsx(W6,{children:v.jsxs(q6,{children:[v.jsxs($6,{children:[v.jsxs(wt,{gap:1,w:"full",children:[v.jsx(ke,{fontSize:"xs",color:"fg.muted",fontWeight:"medium",children:i?"Configuration Settings":"Active Model Settings"}),i?v.jsx(g_e,{configId:i}):v.jsx(ke,{fontWeight:"bold",fontSize:"md",children:s})]}),v.jsx(X6,{asChild:!0,children:v.jsx(Fb,{size:"sm",onClick:t})})]}),v.jsx(am,{p:0,children:v.jsxs(ss,{direction:"column",h:"full",children:[v.jsx(wt,{p:4,pb:2,gap:4,children:v.jsx(M_e,{allModels:l,updateModelPrior:c})}),v.jsx(Iu,{}),v.jsx(ss,{h:"180px",p:4,justify:"center",bg:"bg.subtle",borderBottomWidth:"1px",borderColor:"border.subtle",children:v.jsx(PSe,{allModels:l,selectedModelId:u,selectedParam:p,onSelectModel:g=>{d(g),m(null)},onSelectParam:m})}),v.jsx(qe,{flex:"1",overflowY:"auto",p:4,children:u&&p?v.jsx(w_e,{allModels:l,updateModelPrior:c,modelId:u,paramName:p}):v.jsx(wt,{h:"full",justify:"center",align:"center",color:"fg.muted",children:v.jsx(ke,{fontSize:"sm",children:"Select a model and parameter above."})})})]})})]})})]}):null}const DSe=pr({slots:["root","body","name","meta","checkbox","actionGroup","actionButton","removeButton"],className:"fit-configuration-card",base:{root:{minW:"160px",cursor:"pointer",transition:"all 0.2s ease-out",borderWidth:"1px",borderColor:"border.subtle",bg:"bg.panel",boxShadow:"shadows.card",_hover:{borderColor:"cyan.400",bg:{base:"gray.50",_dark:"whiteAlpha.100"}}},body:{p:3},name:{fontWeight:"bold",fontSize:"xs",maxW:"110px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontFamily:"mono",color:"fg"},meta:{fontSize:"2xs",color:"fg.muted",letterSpacing:"wide"},checkbox:{borderColor:"border.subtle"},actionGroup:{gap:0},actionButton:{color:"fg.muted",_hover:{color:"cyan.400",bg:"whiteAlpha.200"}},removeButton:{color:"fg.muted",_hover:{color:"red.400",bg:"whiteAlpha.200"}}},variants:{selected:{true:{root:{borderColor:{base:"cyan.500",_dark:"cyan.500"},bg:{base:"cyan.50",_dark:"whiteAlpha.100"},boxShadow:{base:"0 0 0 1px var(--chakra-colors-cyan-500)",_dark:"0 0 10px rgba(6, 182, 212, 0.15)"}},name:{color:{base:"cyan.600",_dark:"cyan.300"}}}}}});function NSe({config:i,onToggle:e,onOpenPrior:t,onRemove:n}){const s=mr({recipe:DSe})({selected:i.selected});return v.jsx(yK,{css:s.root,onClick:()=>e(i.id),children:v.jsx(vK,{css:s.body,children:v.jsxs(wt,{gap:2,children:[v.jsxs(gt,{justify:"space-between",align:"start",children:[v.jsx(ke,{css:s.name,title:i.name,children:i.name}),v.jsxs(_K,{checked:i.selected,size:"xs",pointerEvents:"none",colorPalette:"cyan",children:[v.jsx(MK,{}),v.jsx(wK,{css:s.checkbox})]})]}),v.jsxs(gt,{justify:"space-between",align:"center",children:[v.jsxs(ke,{css:s.meta,children:[i.models.length," MODELS"]}),v.jsxs(gt,{css:s.actionGroup,children:[v.jsx(ur,{"aria-label":"Configure Prior",size:"xs",variant:"ghost",css:s.actionButton,onClick:a=>{a.stopPropagation(),t(i.id)},children:v.jsx(N6,{size:12})}),v.jsx(ur,{"aria-label":"Delete config",size:"xs",variant:"ghost",css:s.removeButton,onClick:a=>{a.stopPropagation(),n(i.id)},children:v.jsx(rC,{size:12})})]})]})]})})})}function LSe(){const{configurations:i,toggleConfigurationSelection:e,removeConfiguration:t}=Ai(Tt(l=>({configurations:l.configurations,toggleConfigurationSelection:l.toggleConfigurationSelection,removeConfiguration:l.removeConfiguration}))),[n,r]=z.useState(null);return{configurations:i,editingId:n,openPrior:l=>r(l),closePrior:()=>r(null),removeConfig:l=>{n===l&&r(null),t(l)},toggleConfigurationSelection:e}}const kSe=pr({slots:["root","scrollArea","listRow","emptyState","emptyTitle","emptySubtitle"],className:"fit-configuration-list",base:{root:{gap:3},scrollArea:{overflowX:"auto",whiteSpace:"nowrap",pb:1,px:1},listRow:{gap:3,px:1},emptyState:{p:4,borderWidth:"1px",borderStyle:"dashed",borderColor:"border.subtle",borderRadius:"md",textAlign:"center",bg:"bg.card"},emptyTitle:{fontSize:"xs",color:"fg.muted",fontWeight:"semibold",letterSpacing:"wide"},emptySubtitle:{fontSize:"2xs",color:"fg.subtle",mt:1}}});function OSe(){const{configurations:i,editingId:e,openPrior:t,closePrior:n,removeConfig:r,toggleConfigurationSelection:s}=LSe(),o=mr({recipe:kSe})();return v.jsxs(wt,{css:o.root,children:[v.jsx(TC,{title:"Fit Configurations",rightSlot:v.jsx(ec,{variant:"surface",colorPalette:"cyan",size:"sm",children:i.length})}),i.length===0?v.jsxs(qe,{css:o.emptyState,children:[v.jsx(ke,{css:o.emptyTitle,children:"NO CONFIGURATIONS FOUND"}),v.jsx(ke,{css:o.emptySubtitle,children:'Save a model set in "Fit" panel first'})]}):v.jsx(qe,{css:o.scrollArea,children:v.jsx(gt,{css:o.listRow,children:i.map(l=>v.jsx(NSe,{config:l,onToggle:s,onOpenPrior:t,onRemove:r},l.id))})}),v.jsx(ISe,{configId:e,isOpen:!!e,onClose:n})]})}function zSe(){const{traceSources:i}=sa(Tt(t=>({traceSources:t.traceSources})));return{readySources:z.useMemo(()=>i.filter(t=>t.spectrumReady),[i])}}const USe=pr({slots:["root","content","emptyState","emptyTitle","emptySubtitle"],className:"target-source-list",base:{root:{gap:0,flex:1,minH:0},content:{px:4,pb:6,pt:2},emptyState:{alignItems:"center",justifyContent:"center",minH:"200px",gap:1,textAlign:"center",color:"fg.muted",opacity:.7},emptyTitle:{fontSize:"xs",fontWeight:"bold",letterSpacing:"wide"},emptySubtitle:{fontSize:"2xs",color:"fg.subtle"}}});function FSe(i){const{displayedTraceSourceId:e,setDisplayedTraceSource:t}=sa(Tt(C=>({displayedTraceSourceId:C.displayedTraceSourceId,setDisplayedTraceSource:C.setDisplayedTraceSource}))),{apertureSize:n,forwardWaveRange:r,setForwardSourcePosition:s,setSpectrumQueryKey:a}=un(Tt(C=>({apertureSize:C.apertureSize,forwardWaveRange:C.forwardWaveRange,setForwardSourcePosition:C.setForwardSourcePosition,setSpectrumQueryKey:C.setSpectrumQueryKey}))),{configurations:o,fitExtraction:l,jobs:c}=Ai(Tt(C=>({configurations:C.configurations,fitExtraction:C.fitExtraction,jobs:C.jobs}))),u=e===i.id,d=o.some(C=>C.selected),p=d,m=z.useMemo(()=>c.find(C=>C.job_id===i.id&&(C.status==="pending"||C.status==="processing")),[c,i.id]),g=!!m,y=p&&!g?"surface":"ghost",x=p&&!g?"cyan":"gray",_=m?`Job Running (${m.status})`:p?"Run MCMC Analysis":"Select a Config first",{mutate:S}=UY();return{isSelected:u,canRun:p,activeJob:m,isRunning:g,runVariant:y,runPalette:x,tooltipContent:_,handleSelect:()=>{const C=["extract_spectrum",i.id,r.min,r.max,n,i.ra?.toFixed(10),i.dec?.toFixed(10)];t(i.id),a(C),s({x:Math.round(i.x),y:Math.round(i.y)})},handleRun:()=>{if(!d){Ui.create({title:"Configuration Missing",description:"Please select at least one Fit Configuration to run.",type:"warning"});return}S({sourceId:i.id,extractionConfig:{aperture_size:l.apertureSize,extraction_mode:l.extractMode}})}}}const BSe=pr({slots:["root","indicator","idText","coordText","runButton"],className:"target-source-item",base:{root:{p:2,borderRadius:"md",borderWidth:"1px",borderColor:"border.subtle",bg:"bg.card",transition:"all 0.2s ease-out",cursor:"pointer",minW:0,_hover:{borderColor:"cyan.300",bg:{base:"gray.50",_dark:"whiteAlpha.50"}}},indicator:{w:"8px",h:"8px",borderRadius:"full",boxShadow:"0 0 6px var(--source-color)",opacity:.8},idText:{fontSize:"xs",fontWeight:"bold",fontFamily:"mono",color:"fg",truncate:!0},coordText:{fontSize:"2xs",color:"fg.subtle",fontFamily:"mono",mt:.5},runButton:{minW:"24px",h:"24px",transition:"all 0.2s"}},variants:{selected:{true:{root:{borderColor:{base:"cyan.500",_dark:"cyan.500"},bg:{base:"cyan.50",_dark:"whiteAlpha.100"}},idText:{color:{base:"cyan.700",_dark:"cyan.300"}}}},runnable:{true:{runButton:{_hover:{transform:"scale(1.1)",bg:"cyan.500",color:"white",boxShadow:"0 0 8px rgba(6, 182, 212, 0.6)"}}},false:{runButton:{variant:"ghost",colorPalette:"gray"}}},running:{true:{runButton:{opacity:.7,pointerEvents:"none"}}}}});function HSe({source:i}){const{isRunning:e,isSelected:t,canRun:n,runVariant:r,runPalette:s,tooltipContent:a,handleSelect:o,handleRun:l}=FSe(i),u=mr({recipe:BSe})({selected:t,runnable:n,running:e});return v.jsxs(ss,{css:u.root,justify:"space-between",align:"center",onClick:o,children:[v.jsxs(gt,{gap:3,minW:0,children:[v.jsx(qe,{css:u.indicator,style:{backgroundColor:i.color,"--source-color":i.color}}),v.jsxs(wt,{gap:0,minW:0,children:[v.jsx(ke,{css:u.idText,title:i.id,children:i.id.slice(0,6).toUpperCase()}),v.jsxs(ke,{css:u.coordText,children:["X:",i.x.toFixed(1)," Y:",i.y.toFixed(1)]})]})]}),v.jsx(gt,{onClick:d=>d.stopPropagation(),gap:1,children:v.jsx(Gr,{content:a,children:v.jsx(ur,{"aria-label":"Run MCMC Fit",size:"xs",variant:r,colorPalette:s,disabled:!n||e,css:u.runButton,onClick:l,children:v.jsx(d1e,{size:14})})})})]})}function jSe(){const{readySources:i}=zSe(),t=mr({recipe:USe})();return v.jsxs(wt,{css:t.root,children:[v.jsx(qe,{px:4,pt:4,pb:2,children:v.jsx(TC,{title:"Target Sources",rightSlot:v.jsxs(ec,{colorPalette:"cyan",variant:"solid",size:"xs",children:[i.length," READY"]})})}),v.jsxs(eT,{flex:"1",minH:"0",children:[v.jsx(tT,{children:v.jsx(nT,{css:t.content,children:i.length===0?v.jsxs(wt,{css:t.emptyState,children:[v.jsx(CY,{size:28,style:{opacity:.3}}),v.jsx(ke,{css:t.emptyTitle,children:"NO SOURCES READY"}),v.jsx(ke,{css:t.emptySubtitle,children:'Extract sources in "Trace" panel first'})]}):v.jsx(wt,{gap:2,children:i.map(n=>v.jsx(HSe,{source:n},n.id))})})}),v.jsx(iT,{children:v.jsx(Bb,{})}),v.jsx(rT,{})]})]})}function VSe(){return v.jsxs(wC,{children:[v.jsxs(qe,{css:Su.topSection,children:[v.jsx(OSe,{}),v.jsx(Iu,{css:Su.divider}),v.jsx(m_e,{})]}),v.jsx(jSe,{})]})}const vM=[{value:"panel",title:"Extract",icon:EY,content:v.jsx(j2e,{})},{value:"fit",title:"Fit",icon:RY,content:v.jsx(r_e,{})},{value:"sources",title:"Sources",icon:_L,content:v.jsx(VSe,{})}];function GSe(){return v.jsx(qe,{w:"425px",h:"100vh",children:v.jsxs(Gy,{defaultValue:vM[0].value,size:"sm",lazyMount:!0,h:"100%",children:[v.jsxs(Wy,{children:[vM.map(i=>v.jsx(ko,{value:i.value,children:v.jsxs(gt,{gap:1,align:"center",children:[v.jsx(i.icon,{}),v.jsx(ke,{as:"span",children:i.title})]})},i.value)),v.jsx(FY,{})]}),vM.map(i=>v.jsx(Cy,{value:i.value,h:"100%",children:i.content},i.value))]})})}function WSe(){const i=qV("shift+2",{offset:0});return v.jsxs(gt,{alignItems:"stretch",height:"100vh",ref:i,children:[v.jsxs(wt,{gap:2,flex:"1",minW:0,height:"100%",children:[v.jsx(S2e,{}),v.jsx(kbe,{})]}),v.jsx(GSe,{})]})}function qSe(){const i=[{value:"forward",title:"Grism Forward",item:v.jsx(WSe,{})},{value:"backward",title:"Grism Backward",item:v.jsx(rye,{})}];return v.jsx(hK,{multiple:!0,defaultValue:["forward","backward"],children:i.map(e=>v.jsxs(dK,{value:e.value,children:[v.jsxs(mK,{children:[v.jsx(PY,{fontSize:"large",children:e.title}),v.jsx(gK,{})]}),v.jsx(fK,{children:v.jsx(pK,{children:e.item})})]},`item-${e.value}`))})}function XSe(){return v.jsxs(ld,{align:"start",p:4,gap:4,gapY:20,height:"100%",overflow:"auto",children:[v.jsx(GK,{}),v.jsx(Hie,{}),v.jsx(qSe,{})]})}const x4e=Object.freeze(Object.defineProperty({__proto__:null,component:XSe},Symbol.toStringTag,{value:"Module"}));export{Yy as $,Jz as A,_s as B,Fi as C,ta as D,In as E,hd as F,Hg as G,mo as H,Sz as I,bE as J,$y as K,uQ as L,hn as M,_Q as N,Bg as O,Sn as P,Mi as Q,BM as R,vQ as S,qp as T,zM as U,Qn as V,FQ as W,SE as X,q3 as Y,wE as Z,HZ as _,ll as a,Wi as a0,FZ as a1,yz as a2,eU as a3,Tn as a4,wi as a5,GQ as a6,gJ as a7,cJ as a8,kJ as a9,zJ as aa,jJ as ab,GJ as ac,WJ as ad,iU as ae,Rf as af,Ky as ag,hR as ah,Fm as ai,qQ as aj,Ef as ak,pU as al,BE as am,UE as an,Jo as ao,lZ as ap,mR as aq,xU as ar,x4e as as,aJ as b,zm as c,Ry as d,Es as e,FE as f,iJ as g,gT as h,Kz as i,Rz as j,yo as k,Vz as l,ZM as m,LJ as n,OJ as o,BJ as p,VJ as q,SZ as r,Yb as s,cn as t,oZ as u,xT as v,Hr as w,qJ as x,ka as y,mz as z};
